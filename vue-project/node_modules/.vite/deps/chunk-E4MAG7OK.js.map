{
  "version": 3,
  "sources": ["../../@arcgis/core/support/arcadeOnDemand.js"],
  "sourcesContent": ["/*\r\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\r\nSee https://js.arcgis.com/4.26/esri/copyright.txt for details.\r\n*/\r\nimport\"../geometry.js\";import e from\"../core/Error.js\";import r from\"../core/Logger.js\";import{isSome as t}from\"../core/maybe.js\";import a from\"../geometry/SpatialReference.js\";const s=r.getLogger(\"esri.support.arcadeOnDemand\");let c;function i(){return c||(c=(async()=>{const e=await import(\"./arcadeUtils.js\");return{arcade:e.arcade,arcadeUtils:e,Dictionary:e.Dictionary,Feature:e.arcadeFeature}})()),c}const n=(e,r,t)=>u.create(e,r,t,null,[\"$feature\"]),o=(e,r,t)=>u.create(e,r,t,null,[\"$feature\",\"$view\"]),l=o,p=(e,r,t,a)=>u.create(e,r,t,a,[\"$feature\",\"$view\"]);class u{constructor(e,r,t,a,s,c,i){this.script=e,this.evaluate=a;const n=Array.isArray(c)?c:c.fields;this.fields=n,this._syntaxTree=t,this._arcade=r,this._arcadeFeature=s,this._spatialReference=i,this._referencesGeometry=r.scriptTouchesGeometry(this._syntaxTree),this._referencesScale=this._arcade.referencesMember(this._syntaxTree,\"scale\")}static async create(r,c,n,o,l,p){const{arcade:m,Feature:f,Dictionary:d}=await i(),y=a.fromJSON(c);let h;try{h=m.parseScript(r,p)}catch(A){return s.error(new e(\"arcade-bad-expression\",\"Failed to parse arcade script\",{script:r,error:A})),null}const w=l.reduce(((e,r)=>({...e,[r]:null})),{});let g=null;t(o)&&(g=new d(o),g.immutable=!0,w.$config=null);const _=m.scriptUsesGeometryEngine(h),F=_&&m.enableGeometrySupport(),S=m.scriptUsesFeatureSet(h)&&m.enableFeatureSetSupport(),$=m.scriptIsAsync(h),b=$&&m.enableAsyncSupport(),v={vars:w,spatialReference:y,useAsync:!!b};await Promise.all([F,S,b]);const j=new Set;await m.loadDependentModules(j,h,null,$,_);const G=new d;G.immutable=!1,G.setField(\"scale\",0);const R=m.compileScript(h,v),x=e=>(\"$view\"in e&&e.$view&&(G.setField(\"scale\",\"object\"==typeof e.$view?e.$view.scale:void 0),e.$view=G),g&&(e.$config=g),R({vars:e,spatialReference:y}));return new u(r,m,h,x,new f,n,y)}repurposeFeature(e){return e.geometry&&!e.geometry.spatialReference&&(e.geometry.spatialReference=this._spatialReference),this._arcadeFeature.repurposeFromGraphicLikeObject(e.geometry,e.attributes,{fields:this.fields}),this._arcadeFeature}referencesGeometry(){return this._referencesGeometry}referencesScale(){return this._referencesScale}}export{u as ArcadeExpression,p as createDictionaryExpression,n as createLabelExpression,o as createRendererExpression,l as createVVExpression,i as loadArcade};\r\n"],
  "mappings": "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",
  "names": ["s", "r", "r", "s", "c", "i", "n", "o", "p", "f"]
}
