import {
  e as e11,
  l as l8,
  r as r12,
  s as s11,
  w as w6
} from "./chunk-P76USQXP.js";
import {
  P,
  e as e9,
  i as i13,
  o as o6,
  u as u4
} from "./chunk-VVXG6GJ2.js";
import {
  Gt,
  H,
  St,
  Y,
  Z,
  _ as _2,
  e as e10,
  ft,
  gt,
  ht,
  jt,
  lt,
  ot,
  pt,
  tt,
  ut,
  wt,
  xt,
  yt
} from "./chunk-TZ6ULSSY.js";
import {
  c as c10
} from "./chunk-Y5D76CBW.js";
import "./chunk-X6QOURMW.js";
import "./chunk-DBAHFVCB.js";
import "./chunk-E4NB2TTC.js";
import {
  d as d4
} from "./chunk-WX5P72F3.js";
import "./chunk-U4SHM5SM.js";
import {
  h as h4
} from "./chunk-KS2FU363.js";
import "./chunk-UPHB5F2K.js";
import "./chunk-SXVHYYSN.js";
import {
  l as l7
} from "./chunk-A7TOAPHC.js";
import {
  r as r11,
  t as t11
} from "./chunk-V6MDPPDP.js";
import "./chunk-EPKCQJY3.js";
import {
  a as a11,
  i as i10,
  l as l6
} from "./chunk-K5VZNBYA.js";
import "./chunk-27PI5J6E.js";
import {
  s as s10
} from "./chunk-CSCDZ47H.js";
import {
  a as a10
} from "./chunk-DX6Y7FYI.js";
import {
  t as t10
} from "./chunk-3JVZYYA3.js";
import {
  e as e8
} from "./chunk-MWIMWDJV.js";
import {
  r as r10
} from "./chunk-6D47PMZF.js";
import {
  l as l5
} from "./chunk-RCI7RPZB.js";
import {
  n as n8
} from "./chunk-2KKFAUOD.js";
import {
  M as M2,
  h as h3,
  i as i5,
  r as r8,
  s as s7
} from "./chunk-M2DTCG2D.js";
import {
  a as a8,
  m as m3,
  o as o5,
  r as r7,
  z
} from "./chunk-AVTBKAM2.js";
import "./chunk-4GYUU3KZ.js";
import "./chunk-XCZVGB7V.js";
import {
  j as j5,
  p as p3
} from "./chunk-ZNI6KX7M.js";
import "./chunk-LT2MTVPF.js";
import "./chunk-JJIMX2OW.js";
import "./chunk-T5EL7TIL.js";
import {
  s as s8
} from "./chunk-V6QYNDMP.js";
import {
  D,
  R as R2
} from "./chunk-W7XI6AVS.js";
import "./chunk-IJT6XLR5.js";
import "./chunk-VOUOLBXG.js";
import "./chunk-KGJHWKNE.js";
import "./chunk-X7NPMCZZ.js";
import "./chunk-CFTD44JM.js";
import "./chunk-MI7FJDLG.js";
import "./chunk-E4FSIE7C.js";
import {
  e as e6,
  t as t9
} from "./chunk-XHDX5MVO.js";
import {
  R as R3,
  b as b5,
  n as n9
} from "./chunk-DYZZL2SH.js";
import "./chunk-OOCVC5ZO.js";
import "./chunk-7MCQCXYO.js";
import "./chunk-QZ6NXEME.js";
import {
  n as n7
} from "./chunk-HERKGCCA.js";
import {
  e as e7,
  f as f5,
  i as i6,
  r as r9
} from "./chunk-SB6UPWEY.js";
import "./chunk-2ZJIK5UJ.js";
import "./chunk-XTUZNPIG.js";
import "./chunk-VY77CAXT.js";
import "./chunk-JST2N5RE.js";
import "./chunk-6VXAAN5J.js";
import "./chunk-6ZR5GOPR.js";
import {
  L as L3,
  m as m6
} from "./chunk-TSUWIKX5.js";
import {
  u as u3
} from "./chunk-5X34WYS6.js";
import "./chunk-BEHPXS4P.js";
import "./chunk-7B4WWJ6P.js";
import "./chunk-NNA7CB4P.js";
import "./chunk-BTEFJQ26.js";
import "./chunk-HJLHUX6U.js";
import {
  l as l4
} from "./chunk-2R5APDPQ.js";
import "./chunk-IN3HJEU7.js";
import "./chunk-KQSNRPAM.js";
import {
  e as e5
} from "./chunk-X5VQRQNB.js";
import {
  W,
  e as e3,
  e2 as e4,
  n as n6,
  o as o4,
  r as r5,
  r2 as r6,
  t as t7,
  t2 as t8
} from "./chunk-MILH3W4Q.js";
import {
  f as f4,
  h as h2,
  i as i4,
  n2 as n5,
  v as v5,
  w as w5
} from "./chunk-X37SQ4HC.js";
import "./chunk-QPO5PHJF.js";
import "./chunk-5EUH7VZ3.js";
import "./chunk-JTNRBNRF.js";
import {
  He
} from "./chunk-IHRAZ7MK.js";
import "./chunk-GOYDAXAP.js";
import "./chunk-3QWM2HE5.js";
import "./chunk-WFXJ47MA.js";
import "./chunk-T6DIF5KS.js";
import {
  c as c7
} from "./chunk-PDVH4HZW.js";
import {
  d as d3
} from "./chunk-Z6WPQYGK.js";
import "./chunk-SFUDEAZG.js";
import "./chunk-NQCDYIHT.js";
import "./chunk-MXGJESZW.js";
import "./chunk-DNJQQSFB.js";
import "./chunk-XS5XP6X5.js";
import "./chunk-Z7AKZY4L.js";
import "./chunk-LPHHLKEB.js";
import "./chunk-IFDPYOSC.js";
import "./chunk-RD6VLGGM.js";
import "./chunk-PVSQPGR7.js";
import "./chunk-Y4NY4HIB.js";
import {
  a as a5
} from "./chunk-2YEIG5KK.js";
import "./chunk-MR5AZ53H.js";
import "./chunk-Q7J3Z6A4.js";
import "./chunk-KCW42CAI.js";
import {
  v as v7
} from "./chunk-3IOMFATH.js";
import "./chunk-UGSPONPD.js";
import {
  c as c8
} from "./chunk-B536ET7B.js";
import "./chunk-54NTLRPC.js";
import "./chunk-7HK5OJHH.js";
import "./chunk-3CGPJKWL.js";
import "./chunk-LDHIIMGH.js";
import "./chunk-Y5U3GPYY.js";
import "./chunk-XFW76F64.js";
import "./chunk-TXZADL6E.js";
import "./chunk-72FH64H2.js";
import "./chunk-XSWH32P3.js";
import "./chunk-MR6MDWDW.js";
import "./chunk-TGWKHDFY.js";
import {
  b as b4
} from "./chunk-RLEK6TWZ.js";
import "./chunk-A3YQWDU2.js";
import "./chunk-UXCEKL3W.js";
import {
  d as d2
} from "./chunk-4HI3DYZK.js";
import "./chunk-7WIVOZQ6.js";
import "./chunk-RZLXFQKV.js";
import {
  An,
  en,
  rn,
  tn
} from "./chunk-UBZEFQ76.js";
import "./chunk-D5KVII6M.js";
import "./chunk-G3ZCYHOR.js";
import "./chunk-PDQWP33P.js";
import "./chunk-RZNNSB7A.js";
import "./chunk-5Z6OHN6Z.js";
import "./chunk-TKZTELJQ.js";
import "./chunk-OXPHYLAY.js";
import "./chunk-JKIHHWKC.js";
import "./chunk-NBVRAQMU.js";
import {
  b as b3,
  j as j4
} from "./chunk-BLEGKDS6.js";
import "./chunk-BHKUW5DD.js";
import "./chunk-FI2SN5P7.js";
import "./chunk-SU4IQNSG.js";
import {
  a as a9,
  c as c3,
  d
} from "./chunk-ZUCPDNAU.js";
import {
  s as s6
} from "./chunk-A4GUE3HH.js";
import "./chunk-ZJBIBQFZ.js";
import {
  a as a7
} from "./chunk-HNMSCBZJ.js";
import "./chunk-PVXAD5LL.js";
import "./chunk-IKDJIJNE.js";
import "./chunk-CZLGELTA.js";
import "./chunk-OIMP53SC.js";
import "./chunk-43D3HGVY.js";
import "./chunk-DZGHLWSV.js";
import "./chunk-P4V73ZOM.js";
import "./chunk-6UZRMITW.js";
import "./chunk-HSDJ4PR2.js";
import {
  U as U2,
  a as a6,
  f as f3,
  h,
  j as j3,
  l as l3,
  w as w4
} from "./chunk-Y44VKGHM.js";
import "./chunk-266JJ3A2.js";
import "./chunk-GDTCKTOE.js";
import "./chunk-WPXKVF3K.js";
import "./chunk-EXVE3AJP.js";
import "./chunk-VEZKY6SV.js";
import "./chunk-Y74QPJ3T.js";
import "./chunk-OVUZXV2P.js";
import {
  v as v6
} from "./chunk-VTZGYKHD.js";
import "./chunk-MI3ZQEJV.js";
import "./chunk-HRIBADXS.js";
import {
  g as g3
} from "./chunk-GPWY2LRL.js";
import {
  S2
} from "./chunk-3ZZKMNU2.js";
import "./chunk-SXUQWH7K.js";
import "./chunk-WAUZFAX7.js";
import "./chunk-3JPUCMWK.js";
import "./chunk-GCXFCVSM.js";
import "./chunk-CU2KO5NT.js";
import "./chunk-EXL23DF3.js";
import {
  m as m5
} from "./chunk-ECM7B2HV.js";
import "./chunk-L5JOPRWD.js";
import "./chunk-JYFMP3PO.js";
import "./chunk-CBAVHWPY.js";
import "./chunk-OJCBSPLX.js";
import "./chunk-EMRZKKP3.js";
import "./chunk-VWOAL3VX.js";
import {
  _,
  m as m2
} from "./chunk-SQBJ6KPL.js";
import {
  U as U3
} from "./chunk-MKMLHQNH.js";
import "./chunk-PHPHIDTF.js";
import "./chunk-P6SQPYDS.js";
import {
  I,
  a as a12,
  a2 as a13,
  c as c4,
  c2 as c5,
  c4 as c6,
  c5 as c9,
  i2 as i8,
  i3 as i9,
  i4 as i11,
  u as u2
} from "./chunk-SFT755VT.js";
import {
  i as i7,
  s as s9
} from "./chunk-GWFG4NRK.js";
import {
  he,
  ie,
  xe
} from "./chunk-YXFIF2O5.js";
import {
  i as i12
} from "./chunk-E4MAG7OK.js";
import {
  j as j2
} from "./chunk-YVQV6YXG.js";
import "./chunk-3KALZGFA.js";
import {
  L as L2,
  S,
  m,
  u
} from "./chunk-M47YTHQ5.js";
import {
  n as n4
} from "./chunk-OJKTPYH5.js";
import {
  l as l2,
  s as s5
} from "./chunk-PEP3ZFMY.js";
import {
  m as m4,
  x
} from "./chunk-DXGYZ4HI.js";
import "./chunk-CKHNR7DG.js";
import "./chunk-FY3NCRRH.js";
import "./chunk-CIPSOFMY.js";
import {
  i as i3
} from "./chunk-3U7SS7RC.js";
import "./chunk-FJD2EURD.js";
import {
  T
} from "./chunk-UHF3OUQV.js";
import "./chunk-6U5BQYRW.js";
import "./chunk-LUOENZ4F.js";
import "./chunk-QGRPG4XS.js";
import {
  o as o3,
  v2 as v4
} from "./chunk-M73MMEC7.js";
import {
  E as E2,
  M,
  R3 as R,
  c3 as c,
  f2,
  r2 as r3,
  w as w2,
  w2 as w3
} from "./chunk-A5CTLI5A.js";
import {
  s as s4
} from "./chunk-WUBKNERF.js";
import "./chunk-UULERHP5.js";
import "./chunk-VACYSSCT.js";
import "./chunk-4HXSKBAW.js";
import "./chunk-FFQG5TD2.js";
import "./chunk-DDRAFOUW.js";
import {
  c as c2
} from "./chunk-F4DUNBGT.js";
import {
  a as a4,
  b as b2
} from "./chunk-BF3T2CWA.js";
import {
  g as g2
} from "./chunk-PTCP7EIR.js";
import "./chunk-Z4G4Y7TU.js";
import {
  r as r4
} from "./chunk-4TEGWGCF.js";
import "./chunk-GLDJLPWH.js";
import "./chunk-GMLVDTS4.js";
import "./chunk-G7CHVXDR.js";
import "./chunk-OAZLVZFS.js";
import {
  l
} from "./chunk-CPSZPA6H.js";
import {
  A as A2,
  a2 as a3,
  e,
  n2 as n,
  n4 as n2,
  o,
  t,
  t2 as t3,
  t6,
  v as v2,
  v2 as v3,
  y3 as y2
} from "./chunk-Y54MR3BP.js";
import "./chunk-6VTYOWNK.js";
import {
  n as n3,
  t as t4
} from "./chunk-JY6H6KI3.js";
import {
  A,
  C,
  E,
  L,
  U,
  a as a2,
  b,
  f,
  g,
  i as i2,
  j,
  p as p2,
  t as t5,
  v,
  y
} from "./chunk-TTCQP5LX.js";
import {
  s as s2,
  s2 as s3
} from "./chunk-C2WY74GI.js";
import {
  r as r2
} from "./chunk-MCOYI7PX.js";
import "./chunk-EL4OGCJC.js";
import {
  has
} from "./chunk-XPATKIHO.js";
import "./chunk-MKHZ5X6F.js";
import {
  a,
  e as e2,
  i,
  o as o2,
  p,
  r,
  s,
  t as t2,
  w
} from "./chunk-HVCAHUYB.js";
import "./chunk-4EOJPDL2.js";

// node_modules/@arcgis/core/views/BreakpointsOwner.js
var n10 = { widthBreakpoint: { getValue(e24) {
  const i34 = e24.viewSize[0], s27 = e24.breakpoints, a34 = this.values;
  return i34 <= s27.xsmall ? a34.xsmall : i34 <= s27.small ? a34.small : i34 <= s27.medium ? a34.medium : i34 <= s27.large ? a34.large : a34.xlarge;
}, values: { xsmall: "xsmall", small: "small", medium: "medium", large: "large", xlarge: "xlarge" }, valueToClassName: { xsmall: "esri-view-width-xsmall esri-view-width-less-than-small esri-view-width-less-than-medium esri-view-width-less-than-large esri-view-width-less-than-xlarge", small: "esri-view-width-small esri-view-width-greater-than-xsmall esri-view-width-less-than-medium esri-view-width-less-than-large esri-view-width-less-than-xlarge", medium: "esri-view-width-medium esri-view-width-greater-than-xsmall esri-view-width-greater-than-small esri-view-width-less-than-large esri-view-width-less-than-xlarge", large: "esri-view-width-large esri-view-width-greater-than-xsmall esri-view-width-greater-than-small esri-view-width-greater-than-medium esri-view-width-less-than-xlarge", xlarge: "esri-view-width-xlarge esri-view-width-greater-than-xsmall esri-view-width-greater-than-small esri-view-width-greater-than-medium esri-view-width-greater-than-large" } }, heightBreakpoint: { getValue(e24) {
  const i34 = e24.viewSize[1], s27 = e24.breakpoints, a34 = this.values;
  return i34 <= s27.xsmall ? a34.xsmall : i34 <= s27.small ? a34.small : i34 <= s27.medium ? a34.medium : i34 <= s27.large ? a34.large : a34.xlarge;
}, values: { xsmall: "xsmall", small: "small", medium: "medium", large: "large", xlarge: "xlarge" }, valueToClassName: { xsmall: "esri-view-height-xsmall esri-view-height-less-than-small esri-view-height-less-than-medium esri-view-height-less-than-large esri-view-height-less-than-xlarge", small: "esri-view-height-small esri-view-height-greater-than-xsmall esri-view-height-less-than-medium esri-view-height-less-than-large esri-view-height-less-than-xlarge", medium: "esri-view-height-medium esri-view-height-greater-than-xsmall esri-view-height-greater-than-small esri-view-height-less-than-large esri-view-height-less-than-xlarge", large: "esri-view-height-large esri-view-height-greater-than-xsmall esri-view-height-greater-than-small esri-view-height-greater-than-medium esri-view-height-less-than-xlarge", xlarge: "esri-view-height-xlarge esri-view-height-greater-than-xsmall esri-view-height-greater-than-small esri-view-height-greater-than-medium esri-view-height-greater-than-large" } }, orientation: { getValue(e24) {
  const i34 = e24.viewSize, s27 = i34[0], a34 = i34[1], t30 = this.values;
  return a34 >= s27 ? t30.portrait : t30.landscape;
}, values: { portrait: "portrait", landscape: "landscape" }, valueToClassName: { portrait: "esri-view-orientation-portrait", landscape: "esri-view-orientation-landscape" } } };
var o7 = { xsmall: 544, small: 768, medium: 992, large: 1200 };
function m7(e24) {
  const i34 = e24;
  return i34 && i34.xsmall < i34.small && i34.small < i34.medium && i34.medium < i34.large;
}
function g4(e24, i34) {
  return i34 ? n10[e24].valueToClassName[i34].split(" ") : [];
}
var w7 = (w18) => {
  let d18 = class extends w18 {
    constructor(...e24) {
      super(...e24), this._breakpointsHandles = new t3(), this.orientation = null, this.widthBreakpoint = null, this.heightBreakpoint = null, this.breakpoints = o7;
    }
    initialize() {
      this._breakpointsHandles.add(l3(() => [this.breakpoints, this.size], () => this._updateClassNames(), h));
    }
    destroy() {
      this.destroyed || (this._removeActiveClassNames(), this._breakpointsHandles = a(this._breakpointsHandles));
    }
    set breakpoints(e24) {
      if (e24 === this._get("breakpoints"))
        return;
      const i34 = m7(e24);
      if (!i34) {
        const e25 = JSON.stringify(o7, null, 2);
        console.warn("provided breakpoints are not valid, using defaults:" + e25);
      }
      e24 = i34 ? e24 : o7, this._set("breakpoints", { ...e24 });
    }
    _updateClassNames() {
      if (!this.container)
        return;
      const e24 = t4.acquire(), s27 = t4.acquire();
      let a34, t30 = false;
      for (a34 in n10) {
        const i34 = this[a34], r24 = n10[a34].getValue({ viewSize: this.size, breakpoints: this.breakpoints });
        i34 !== r24 && (t30 = true, this[a34] = r24, g4(a34, i34).forEach((e25) => s27.push(e25)), g4(a34, r24).forEach((i35) => e24.push(i35)));
      }
      t30 && (this._applyClassNameChanges(e24, s27), t4.release(e24), t4.release(s27));
    }
    _applyClassNameChanges(e24, i34) {
      const s27 = this.container;
      s27 && (i34.forEach((e25) => s27.classList.remove(e25)), e24.forEach((e25) => s27.classList.add(e25)));
    }
    _removeActiveClassNames() {
      const e24 = this.container;
      if (!e24)
        return;
      let i34;
      for (i34 in n10)
        g4(i34, this[i34]).forEach((i35) => e24.classList.remove(i35));
    }
  };
  return e([y2()], d18.prototype, "breakpoints", null), e([y2()], d18.prototype, "orientation", void 0), e([y2()], d18.prototype, "widthBreakpoint", void 0), e([y2()], d18.prototype, "heightBreakpoint", void 0), d18 = e([a3("esri.views.BreakpointsOwner")], d18), d18;
};

// node_modules/@arcgis/core/views/overlay/ViewOverlay.js
var a14 = class extends v3 {
  constructor() {
    super(...arguments), this.items = new j2(), this._watchUpdatingTracking = new c3(), this._callbacks = /* @__PURE__ */ new Map(), this._projector = i4(), this._hiddenProjector = i4();
  }
  get needsRender() {
    return this.items.length > 0;
  }
  get updating() {
    var _a;
    return ((_a = this._watchUpdatingTracking) == null ? void 0 : _a.updating) ?? false;
  }
  initialize() {
    const t30 = document.createElement("div");
    t30.className = "esri-overlay-surface", this._set("surface", t30), this._hiddenSurface = document.createElement("div"), this._hiddenSurface.setAttribute("style", "visibility: hidden;"), t30.appendChild(this._hiddenSurface), this._watchUpdatingTracking.addOnCollectionChange(() => this.items, (t31) => {
      for (const e24 of t31.added) {
        const t32 = () => e24.render();
        this._callbacks.set(e24, t32), this._projector.append(this.surface, t32);
      }
      for (const e24 of t31.removed) {
        const t32 = this._projector.detach(this._callbacks.get(e24));
        this.surface.removeChild(t32.domNode), this._callbacks.delete(e24);
      }
    });
  }
  addItem(t30) {
    this.items.add(t30);
  }
  removeItem(t30) {
    this.items.remove(t30);
  }
  destroy() {
    this.items.removeAll(), this._callbacks.forEach((t30) => this._projector.detach(t30)), this._callbacks = null, this._projector = null, this._watchUpdatingTracking.destroy();
  }
  render() {
    this._projector.renderNow();
  }
  computeBoundingRect(t30) {
    const e24 = this._hiddenSurface, r24 = this._hiddenProjector;
    let o27;
    const s27 = () => (o27 = t30.render(), o27);
    r24.append(e24, s27), r24.renderNow();
    const i34 = { left: 0, top: 0, right: 0, bottom: 0 };
    if (o27 && o27.domNode) {
      const t31 = o27.domNode.getBoundingClientRect();
      i34.left = t31.left, i34.top = t31.top, i34.right = t31.right, i34.bottom = t31.bottom;
    }
    for (r24.detach(s27); e24.firstChild; )
      e24.removeChild(e24.firstChild);
    return i34;
  }
  overlaps(t30, e24) {
    const r24 = this.computeBoundingRect(t30), o27 = this.computeBoundingRect(e24);
    return Math.max(r24.left, o27.left) <= Math.min(r24.right, o27.right) && Math.max(r24.top, o27.top) <= Math.min(r24.bottom, o27.bottom);
  }
  get hasVisibleItems() {
    return this.items.some((t30) => t30.visible);
  }
  async prepare() {
    await document.fonts.load(this._fontString()).catch(() => {
    });
  }
  renderCanvas(t30) {
    if (!this.items.some((t31) => t31.visible))
      return;
    const e24 = t30.getContext("2d");
    e24.save(), e24.font = this._fontString(), this.items.forEach((t31) => {
      e24.save(), t31.renderCanvas(e24), e24.restore();
    }), e24.restore();
  }
  _fontString() {
    return `10px ${getComputedStyle(this.surface).fontFamily}`;
  }
};
e([y2({ readOnly: true })], a14.prototype, "surface", void 0), e([y2({ readOnly: true })], a14.prototype, "items", void 0), e([y2({ readOnly: true })], a14.prototype, "needsRender", null), e([y2({ readOnly: true })], a14.prototype, "_watchUpdatingTracking", void 0), e([y2({ readOnly: true })], a14.prototype, "updating", null), a14 = e([a3("esri.views.overlay.ViewOverlay")], a14);
var c11 = a14;

// node_modules/@arcgis/core/core/unitFormatUtils.js
var U4 = ["B", "kB", "MB", "GB", "TB"];
function v8(n31, i34) {
  let o27 = 0 === i34 ? 0 : Math.floor(Math.log(i34) / Math.log(s8.KILOBYTES));
  o27 = a4(o27, 0, U4.length - 1);
  const u21 = m(i34 / s8.KILOBYTES ** o27, { maximumFractionDigits: 2 });
  return r2(n31.units.bytes[U4[o27]], { fileSize: u21 });
}

// node_modules/@arcgis/core/widgets/Feature/support/featureUtils.js
var p4 = "esri.widgets.Feature.support.featureUtils";
var m8 = s2.getLogger(p4);
var y3 = /href=(""|'')/gi;
var g5 = /(\{([^\{\r\n]+)\})/g;
var h5 = /\'/g;
var I2 = /^\s*expression\//i;
var b6 = /(\n)/gi;
var F = /[\u00A0-\u9999<>\&]/gim;
var w8 = /href\s*=\s*(?:\"([^\"]+)\"|\'([^\']+)\')/gi;
var N2 = /^(?:mailto:|tel:)/;
var E3 = "relationships/";
var T3 = S("short-date-short-time");
function j6(e24) {
  if (!t2(e24))
    return e24.get("sourceLayer") || e24.get("layer");
}
async function x2(e24, t30) {
  return "function" == typeof e24 ? e24.call(null, t30) : e24;
}
function C2(e24 = "") {
  if (e24)
    return !N2.test(e24.trim().toLowerCase());
}
function M3(e24) {
  return !!e24 && I2.test(e24);
}
function q(e24, t30) {
  if (!M3(t30) || !e24)
    return null;
  const r24 = t30.replace(I2, "").toLowerCase();
  let n31 = null;
  return e24.some((e25) => e25.name.toLowerCase() === r24 && (n31 = e25, true)), n31;
}
function R5(e24, t30) {
  const r24 = q(t30, e24 == null ? void 0 : e24.fieldName);
  return r24 ? r24.title || null : e24 ? e24.label || e24.fieldName : null;
}
function v9(e24, t30) {
  const r24 = t30.get(e24.toLowerCase());
  return `{${r24 && r24.fieldName || e24}}`;
}
function D2(e24) {
  return e24.replace(y3, "");
}
function L4(e24, t30) {
  const r24 = A4(t30, e24);
  return r24 ? r24.name : e24;
}
function U5(e24, t30) {
  return e24 && e24.map((e25) => L4(e25, t30));
}
function A4(e24, t30) {
  return e24 && "function" == typeof e24.getField && t30 ? e24.getField(t30) ?? null : null;
}
function $(e24) {
  return `${e24}`.trim();
}
function S3({ attributes: e24, globalAttributes: t30, layer: r24, text: n31, expressionAttributes: i34, fieldInfoMap: o27 }) {
  return n31 ? G({ formattedAttributes: t30, template: z2(n31, { ...t30, ...i34, ...e24 }, r24), fieldInfoMap: o27 }) : "";
}
function G({ formattedAttributes: e24, template: t30, fieldInfoMap: r24 }) {
  return $(D2(r2(r2(t30, (e25) => v9(e25, r24)), e24)));
}
function k(e24, t30, r24 = false) {
  const n31 = t30[e24];
  if ("string" == typeof n31) {
    const i34 = "%27", o27 = (r24 ? encodeURIComponent(n31) : n31).replace(h5, i34);
    t30[e24] = o27;
  }
}
function O2(e24, t30 = false) {
  const r24 = { ...e24 };
  return Object.keys(r24).forEach((e25) => k(e25, r24, t30)), r24;
}
function P2(e24, t30, r24) {
  const i34 = (t30 = $(t30)) && "{" !== t30[0];
  return r2(e24, O2(r24, i34 || false));
}
function _3(e24, t30) {
  return e24.replace(g5, (e25, r24, n31) => {
    const i34 = A4(t30, n31);
    return i34 ? `{${i34.name}}` : r24;
  });
}
function z2(e24, t30, r24) {
  const n31 = _3(e24, r24);
  return n31 ? n31.replace(w8, (e25, r25, n32) => P2(e25, r25 || n32, t30)) : n31;
}
function H2(e24, t30) {
  if ("string" == typeof e24 && t30 && null == t30.dateFormat && (null != t30.places || null != t30.digitSeparator)) {
    const t31 = Number(e24);
    if (!isNaN(t31))
      return t31;
  }
  return e24;
}
function Q(e24) {
  return "feature" === (e24 == null ? void 0 : e24.type);
}
function Z2(e24) {
  return !!(e24 == null ? void 0 : e24.layer);
}
function V(e24) {
  return "map-image" === (e24 == null ? void 0 : e24.type);
}
function B(e24, t30) {
  var _a;
  const r24 = t30.fieldInfos, n31 = t30.fieldName, i34 = (_a = J2(r24, n31)) == null ? void 0 : _a.clone(), o27 = t30.preventPlacesFormatting, s27 = t30.layer, f18 = A4(s27, n31);
  if (i34 && "date" === (f18 == null ? void 0 : f18.type)) {
    const e25 = i34.format || new u2();
    e25.dateFormat = e25.dateFormat || "short-date-short-time", e25.dateTimeFormatOptions = !Z2(s27) && Q(s27) && s27.datesInUnknownTimezone || Z2(s27) && V(s27.layer) && s27.layer.datesInUnknownTimezone ? { timeZone: "UTC" } : null, i34.format = e25;
  }
  const d18 = i34 && i34.format;
  return "string" == typeof e24 && he(n31) && d18 ? d18.formatRasterPixelValue(e24) : "string" == typeof (e24 = H2(e24, d18)) || null == e24 || null == d18 ? re(e24) : o27 ? m(e24, { ...u(d18), minimumFractionDigits: 0, maximumFractionDigits: 20 }) : d18.format(e24);
}
function J2(e24, t30) {
  if (!e24 || !e24.length || !t30)
    return;
  const r24 = t30.toLowerCase();
  let n31;
  return e24.some((e25) => !(!e25.fieldName || e25.fieldName.toLowerCase() !== r24) && (n31 = e25, true)), n31;
}
function K2({ fieldName: e24, graphic: t30, layer: r24 }) {
  if (ue(e24))
    return null;
  if (!r24 || "function" != typeof r24.getFeatureType)
    return null;
  const { typeIdField: n31 } = r24;
  if (!n31 || e24 !== n31)
    return null;
  const i34 = r24.getFeatureType(t30);
  return i34 ? i34.name : null;
}
function W2({ fieldName: e24, value: t30, graphic: r24, layer: n31 }) {
  if (ue(e24))
    return null;
  if (!n31 || "function" != typeof n31.getFieldDomain)
    return null;
  const i34 = r24 && n31.getFieldDomain(e24, { feature: r24 });
  return i34 && "coded-value" === i34.type ? i34.getName(t30) : null;
}
function X(e24, t30) {
  const { creatorField: r24, creationDateField: n31, editorField: o27, editDateField: a34 } = e24;
  if (!t30)
    return;
  const l25 = t30[a34];
  if ("number" == typeof l25) {
    const e25 = t30[o27];
    return { type: "edit", date: L2(l25, T3), user: e25 };
  }
  const u21 = t30[n31];
  if ("number" == typeof u21) {
    const e25 = t30[r24];
    return { type: "create", date: L2(u21, T3), user: e25 };
  }
  return null;
}
function Y2(e24, t30) {
  const r24 = /* @__PURE__ */ new Map();
  return e24 ? (e24.forEach((e25) => {
    const n31 = L4(e25.fieldName, t30);
    e25.fieldName = n31, r24.set(n31.toLowerCase(), e25);
  }), r24) : r24;
}
function ee(e24) {
  const t30 = [];
  if (!e24)
    return t30;
  const { fieldInfos: r24, content: n31 } = e24;
  return r24 && t30.push(...r24), n31 && Array.isArray(n31) ? (n31.forEach((e25) => {
    if ("fields" === e25.type) {
      const r25 = e25 && e25.fieldInfos;
      r25 && t30.push(...r25);
    }
  }), t30) : t30;
}
function te(e24) {
  return e24.replace(F, (e25) => `&#${e25.charCodeAt(0)};`);
}
function re(e24) {
  return "string" == typeof e24 ? e24.replace(b6, '<br class="esri-text-new-line" />') : e24;
}
function ne(e24) {
  const { value: t30, fieldName: r24, fieldInfos: n31, fieldInfoMap: o27, layer: a34, graphic: l25 } = e24;
  if (null == t30)
    return "";
  const u21 = W2({ fieldName: r24, value: t30, graphic: l25, layer: a34 });
  if (u21)
    return u21;
  const s27 = K2({ fieldName: r24, graphic: l25, layer: a34 });
  if (s27)
    return s27;
  if (o27.get(r24.toLowerCase()))
    return B(t30, { fieldInfos: n31 || Array.from(o27.values()), fieldName: r24, layer: a34 });
  const f18 = a34 && a34.fieldsIndex;
  return f18 && f18.isDateField(r24) ? L2(t30, T3) : re(t30);
}
function ie2({ fieldInfos: e24, attributes: t30, layer: r24, graphic: n31, fieldInfoMap: i34, relatedInfos: o27 }) {
  const a34 = {};
  return o27 == null ? void 0 : o27.forEach((t31) => ce({ attributes: a34, relatedInfo: t31, fieldInfoMap: i34, fieldInfos: e24, layer: r24 })), t30 && Object.keys(t30).forEach((o28) => {
    const l25 = t30[o28];
    a34[o28] = ne({ fieldName: o28, fieldInfos: e24, fieldInfoMap: i34, layer: r24, value: l25, graphic: n31 });
  }), a34;
}
async function oe(e24, t30) {
  var _a, _b;
  const { layer: r24, graphic: n31, outFields: i34, objectIds: o27, returnGeometry: a34, spatialReference: l25 } = e24, u21 = o27[0];
  if ("number" != typeof u21 && "string" != typeof u21) {
    const e25 = "Could not query required fields for the specified feature. The feature's ID is invalid.", t31 = { layer: r24, graphic: n31, objectId: u21, requiredFields: i34 };
    return m8.warn(e25, t31), null;
  }
  if (!((_b = (_a = v6(r24)) == null ? void 0 : _a.operations) == null ? void 0 : _b.supportsQuery)) {
    const e25 = "The specified layer cannot be queried. The following fields will not be available.", t31 = { layer: r24, graphic: n31, requiredFields: i34, returnGeometry: a34 };
    return m8.warn(e25, t31), null;
  }
  const s27 = r24.createQuery();
  s27.objectIds = o27, s27.outFields = (i34 == null ? void 0 : i34.length) ? i34 : [r24.objectIdField], s27.returnGeometry = !!a34, s27.returnZ = !!a34, s27.returnM = !!a34, s27.outSpatialReference = l25;
  return (await r24.queryFeatures(s27, t30)).features[0];
}
async function ae(e24) {
  var _a;
  if (!((_a = e24.expressionInfos) == null ? void 0 : _a.length))
    return false;
  const t30 = await i12(), { arcadeUtils: { hasGeometryFunctions: r24 } } = t30;
  return r24(e24);
}
async function le({ graphic: e24, popupTemplate: t30, layer: r24, spatialReference: n31 }, i34) {
  if (!r24 || !t30)
    return;
  if ("function" == typeof r24.load && await r24.load(i34), !e24.attributes)
    return;
  const o27 = e24.attributes[r24.objectIdField];
  if (null == o27)
    return;
  const a34 = [o27], l25 = await t30.getRequiredFields(r24.fieldsIndex), u21 = xe(l25, e24), f18 = u21 ? [] : l25, c37 = t30.returnGeometry || await ae(t30);
  if (u21 && !c37)
    return;
  const d18 = await oe({ layer: r24, graphic: e24, outFields: f18, objectIds: a34, returnGeometry: c37, spatialReference: n31 }, i34);
  d18 && (d18.geometry && (e24.geometry = d18.geometry), d18.attributes && (e24.attributes = { ...e24.attributes, ...d18.attributes }));
}
function ue(e24 = "") {
  return !!e24 && e24.includes(E3);
}
function se(e24) {
  return e24 ? `${E3}${e24.layerId}/${e24.fieldName}` : "";
}
function fe({ attributes: e24, graphic: t30, relatedInfo: r24, fieldInfos: n31, fieldInfoMap: i34, layer: o27 }) {
  e24 && t30 && r24 && Object.keys(t30.attributes).forEach((a34) => {
    const l25 = se({ layerId: r24.relation.id.toString(), fieldName: a34 }), u21 = t30.attributes[a34];
    e24[l25] = ne({ fieldName: l25, fieldInfos: n31, fieldInfoMap: i34, layer: o27, value: u21, graphic: t30 });
  });
}
function ce({ attributes: e24, relatedInfo: t30, fieldInfoMap: r24, fieldInfos: n31, layer: i34 }) {
  e24 && t30 && (t30.relatedFeatures && t30.relatedFeatures && t30.relatedFeatures.forEach((o27) => fe({ attributes: e24, graphic: o27, relatedInfo: t30, fieldInfoMap: r24, fieldInfos: n31, layer: i34 })), t30.relatedStatsFeatures && t30.relatedStatsFeatures && t30.relatedStatsFeatures.forEach((o27) => fe({ attributes: e24, graphic: o27, relatedInfo: t30, fieldInfoMap: r24, fieldInfos: n31, layer: i34 })));
}
var de = (e24) => {
  if (!e24)
    return false;
  const t30 = e24.toUpperCase();
  return t30.includes("CURRENT_TIMESTAMP") || t30.includes("CURRENT_DATE") || t30.includes("CURRENT_TIME");
};
var pe = ({ layer: e24, method: t30, query: n31, definitionExpression: i34 }) => {
  var _a, _b;
  if (!((_b = (_a = e24.capabilities) == null ? void 0 : _a.query) == null ? void 0 : _b.supportsCacheHint) || "attachments" === t30)
    return;
  const o27 = r(n31.where) ? n31.where : null, a34 = r(n31.geometry) ? n31.geometry : null;
  de(i34) || de(o27) || "extent" === (a34 == null ? void 0 : a34.type) || "tile" === n31.resultType || (n31.cacheHint = true);
};
var me = ({ query: e24, layer: t30, method: r24 }) => {
  pe({ layer: t30, method: r24, query: e24, definitionExpression: `${t30.definitionExpression} ${t30.serviceDefinitionExpression}` });
};
var ye = ({ queryPayload: e24, layer: t30, method: r24 }) => {
  pe({ layer: t30, method: r24, query: e24, definitionExpression: `${t30.definitionExpression} ${t30.serviceDefinitionExpression}` });
};
function ge(e24, t30, r24) {
  return e24 && t30 && r24 ? he2(e24.allLayers, t30, r24) || he2(e24.allTables, t30, r24) : null;
}
function he2(e24, t30, r24) {
  return e24.find((e25) => e25 !== t30 && "feature" === e25.type && e25.url === t30.url && e25.layerId === r24.relatedTableId);
}

// node_modules/@arcgis/core/widgets/Attachments/AttachmentsViewModel.js
var f6 = { editing: false, operations: { add: true, update: true, delete: true } };
var u5 = j2.ofType(a10);
var y4 = class extends v3 {
  constructor(t30) {
    super(t30), this._getAttachmentsPromise = null, this._attachmentLayer = null, this.abilities = { ...f6 }, this.activeAttachmentInfo = null, this.activeFileInfo = null, this.attachmentInfos = new u5(), this.fileInfos = new j2(), this.graphic = null, this.mode = "view", this.filesEnabled = false, this.addHandles(l3(() => this.graphic, () => this._graphicChanged(), h));
  }
  destroy() {
    this._attachmentLayer = null, this.graphic = null;
  }
  castAbilities(t30) {
    return { ...f6, ...t30 };
  }
  get state() {
    return this._getAttachmentsPromise ? "loading" : this.graphic ? "ready" : "disabled";
  }
  get supportsResizeAttachments() {
    const { graphic: t30 } = this;
    if (!t30)
      return false;
    const e24 = t30.layer || t30.sourceLayer;
    return (e24 == null ? void 0 : e24.loaded) && "capabilities" in e24 && e24.capabilities && "operations" in e24.capabilities && "supportsResizeAttachments" in e24.capabilities.operations && e24.capabilities.operations.supportsResizeAttachments || false;
  }
  async getAttachments() {
    const { _attachmentLayer: t30, attachmentInfos: e24 } = this;
    if (!t30 || "function" != typeof t30.queryAttachments)
      throw new s3("invalid-layer", "getAttachments(): A valid layer is required.");
    const i34 = this._getObjectId(), a34 = new c7({ objectIds: [i34], returnMetadata: true }), r24 = [], s27 = t30.queryAttachments(a34).then((t31) => t31[i34] || r24).catch(() => r24);
    this._getAttachmentsPromise = s27, this.notifyChange("state");
    const o27 = await s27;
    return e24.removeAll(), o27.length && e24.addMany(o27), this._getAttachmentsPromise = null, this.notifyChange("state"), o27;
  }
  async addAttachment(t30, e24 = this.graphic) {
    var _a;
    const { _attachmentLayer: i34, attachmentInfos: a34, abilities: r24 } = this;
    if (!e24)
      throw new s3("invalid-graphic", "addAttachment(): A valid graphic is required.", { graphic: e24 });
    if (!t30)
      throw new s3("invalid-attachment", "addAttachment(): An attachment is required.", { attachment: t30 });
    if (!((_a = r24.operations) == null ? void 0 : _a.add))
      throw new s3("invalid-abilities", "addAttachment(): add abilities are required.");
    if (!i34 || "function" != typeof i34.addAttachment)
      throw new s3("invalid-layer", "addAttachment(): A valid layer is required.");
    const s27 = i34.addAttachment(e24, t30).then((t31) => this._queryAttachment(t31.objectId, e24)), o27 = await s27;
    return a34.add(o27), o27;
  }
  async deleteAttachment(t30) {
    var _a;
    const { _attachmentLayer: e24, attachmentInfos: i34, graphic: a34, abilities: r24 } = this;
    if (!t30)
      throw new s3("invalid-attachment-info", "deleteAttachment(): An attachmentInfo is required.", { attachmentInfo: t30 });
    if (!((_a = r24.operations) == null ? void 0 : _a.delete))
      throw new s3("invalid-abilities", "deleteAttachment(): delete abilities are required.");
    if (!e24 || "function" != typeof e24.deleteAttachments)
      throw new s3("invalid-layer", "deleteAttachment(): A valid layer is required.");
    if (!a34)
      throw new s3("invalid-graphic", "deleteAttachment(): A graphic is required.");
    const s27 = e24.deleteAttachments(a34, [t30.id]).then(() => t30), o27 = await s27;
    return i34.remove(o27), o27;
  }
  async updateAttachment(t30, e24 = this.activeAttachmentInfo) {
    var _a;
    const { _attachmentLayer: i34, attachmentInfos: a34, graphic: r24, abilities: s27 } = this;
    if (!t30)
      throw new s3("invalid-attachment", "updateAttachment(): An attachment is required.", { attachment: t30 });
    if (!e24)
      throw new s3("invalid-attachment-info", "updateAttachment(): An attachmentInfo is required.", { attachmentInfo: e24 });
    if (!((_a = s27.operations) == null ? void 0 : _a.update))
      throw new s3("invalid-abilities", "updateAttachment(): Update abilities are required.");
    const o27 = a34.findIndex((t31) => t31 === e24);
    if (!i34 || "function" != typeof i34.updateAttachment)
      throw new s3("invalid-layer", "updateAttachment(): A valid layer is required.");
    if (!r24)
      throw new s3("invalid-graphic", "updateAttachment(): A graphic is required.");
    const c37 = i34.updateAttachment(r24, e24.id, t30).then((t31) => this._queryAttachment(t31.objectId)), h20 = await c37;
    return a34.splice(o27, 1, h20), h20;
  }
  async commitFiles() {
    return await Promise.all(this.fileInfos.items.map((t30) => this.addAttachment(t30.form))), this.fileInfos.removeAll(), this.getAttachments();
  }
  addFile(t30, e24) {
    if (!t30 || !e24)
      return null;
    const i34 = { file: t30, form: e24 };
    return this.fileInfos.add(i34), i34;
  }
  updateFile(t30, e24, i34 = this.activeFileInfo) {
    if (!t30 || !e24 || !i34)
      return null;
    const a34 = this.fileInfos.findIndex((t31) => i34 === t31);
    return a34 > -1 && this.fileInfos.splice(a34, 1, { file: t30, form: e24 }), this.fileInfos.items[a34];
  }
  deleteFile(t30) {
    const e24 = this.fileInfos.find((e25) => e25.file === t30);
    return e24 ? (this.fileInfos.remove(e24), e24) : null;
  }
  async _queryAttachment(t30, e24) {
    const { _attachmentLayer: i34 } = this;
    if (!t30 || !(i34 == null ? void 0 : i34.queryAttachments))
      throw new s3("invalid-attachment-id", "Could not query attachment.");
    const a34 = this._getObjectId(e24), r24 = new c7({ objectIds: [a34], attachmentsWhere: `AttachmentId=${t30}`, returnMetadata: true });
    return i34.queryAttachments(r24).then((t31) => t31[a34][0]);
  }
  _getObjectId(t30 = this.graphic) {
    return (t30 == null ? void 0 : t30.getObjectId()) ?? null;
  }
  _graphicChanged() {
    this.graphic && (this._setAttachmentLayer(), this.getAttachments().catch(() => {
    }));
  }
  _setAttachmentLayer() {
    const { graphic: t30 } = this, e24 = j6(t30);
    this._attachmentLayer = e24 ? "scene" === e24.type && r(e24.associatedLayer) ? e24.associatedLayer : e24 : null;
  }
};
e([y2()], y4.prototype, "abilities", void 0), e([s4("abilities")], y4.prototype, "castAbilities", null), e([y2()], y4.prototype, "activeAttachmentInfo", void 0), e([y2()], y4.prototype, "activeFileInfo", void 0), e([y2({ readOnly: true, type: u5 })], y4.prototype, "attachmentInfos", void 0), e([y2()], y4.prototype, "fileInfos", void 0), e([y2({ type: g3 })], y4.prototype, "graphic", void 0), e([y2()], y4.prototype, "mode", void 0), e([y2({ readOnly: true })], y4.prototype, "state", null), e([y2()], y4.prototype, "filesEnabled", void 0), e([y2({ readOnly: true })], y4.prototype, "supportsResizeAttachments", null), y4 = e([a3("esri.widgets.Attachments.AttachmentsViewModel")], y4);
var A5 = y4;

// node_modules/@arcgis/core/widgets/Attachments/support/attachmentUtils.js
function e12(i34) {
  const e24 = i34.toLowerCase();
  return "image/bmp" === e24 || "image/emf" === e24 || "image/exif" === e24 || "image/gif" === e24 || "image/x-icon" === e24 || "image/jpeg" === e24 || "image/png" === e24 || "image/tiff" === e24 || "image/x-wmf" === e24;
}
function p5(e24) {
  const p30 = a7("esri/themes/base/images/files/");
  return e24 ? "text/plain" === e24 ? `${p30}text-32.svg` : "application/pdf" === e24 ? `${p30}pdf-32.svg` : "text/csv" === e24 ? `${p30}csv-32.svg` : "application/gpx+xml" === e24 ? `${p30}gpx-32.svg` : "application/x-dwf" === e24 ? `${p30}cad-32.svg` : "application/postscript" === e24 || "application/json" === e24 || "text/xml" === e24 || "model/vrml" === e24 ? `${p30}code-32.svg` : "application/x-zip-compressed" === e24 || "application/x-7z-compressed" === e24 || "application/x-gzip" === e24 || "application/x-tar" === e24 || "application/x-gtar" === e24 || "application/x-bzip2" === e24 || "application/gzip" === e24 || "application/x-compress" === e24 || "application/x-apple-diskimage" === e24 || "application/x-rar-compressed" === e24 || "application/zip" === e24 ? `${p30}zip-32.svg` : e24.includes("image/") ? `${p30}image-32.svg` : e24.includes("audio/") ? `${p30}sound-32.svg` : e24.includes("video/") ? `${p30}video-32.svg` : e24.includes("msexcel") || e24.includes("ms-excel") || e24.includes("spreadsheetml") ? `${p30}excel-32.svg` : e24.includes("msword") || e24.includes("ms-word") || e24.includes("wordprocessingml") ? `${p30}word-32.svg` : e24.includes("powerpoint") || e24.includes("presentationml") ? `${p30}report-32.svg` : `${p30}generic-32.svg` : `${p30}generic-32.svg`;
}

// node_modules/@arcgis/core/widgets/Attachments.js
var v10 = { addButton: true, addSubmitButton: true, cancelAddButton: true, cancelUpdateButton: true, deleteButton: true, errorMessage: true, progressBar: true, updateButton: true };
var y5 = "esri-attachments";
var w9 = "esri-button";
var A6 = { base: y5, loaderContainer: `${y5}__loader-container`, loader: `${y5}__loader`, fadeIn: `${y5}--fade-in`, container: `${y5}__container`, containerList: `${y5}__container--list`, containerPreview: `${y5}__container--preview`, actions: `${y5}__actions`, deleteButton: `${y5}__delete-button`, addAttachmentButton: `${y5}__add-attachment-button`, errorMessage: `${y5}__error-message`, items: `${y5}__items`, item: `${y5}__item`, itemButton: `${y5}__item-button`, itemMask: `${y5}__item-mask`, itemMaskIcon: `${y5}__item-mask--icon`, itemImage: `${y5}__image`, itemImageResizable: `${y5}__image--resizable`, itemLabel: `${y5}__label`, itemFilename: `${y5}__filename`, itemChevronIcon: `${y5}__item-chevron-icon`, itemLink: `${y5}__item-link`, itemLinkOverlay: `${y5}__item-link-overlay`, itemLinkOverlayIcon: `${y5}__item-link-overlay-icon`, itemEditIcon: `${y5}__item-edit-icon`, itemAddIcon: `${y5}__item-add-icon`, itemAddButton: `${y5}__item-add-button`, formNode: `${y5}__form-node`, fileFieldset: `${y5}__file-fieldset`, fileLabel: `${y5}__file-label`, fileName: `${y5}__file-name`, fileInput: `${y5}__file-input`, metadata: `${y5}__metadata`, metadataFieldset: `${y5}__metadata-fieldset`, progressBar: `${y5}__progress-bar`, esriWidget: "esri-widget", esriButton: w9, buttonDisabled: `${w9}--disabled`, esriButtonSecondary: `${w9}--secondary`, esriButtonTertiary: `${w9}--tertiary`, esriButtonThird: `${w9}--third`, esriButtonSmall: `${w9}--small`, esriButtonHalf: `${w9}--half`, empty: "esri-widget__content--empty", iconExternalLink: "esri-icon-link-external", iconEdit: "esri-icon-edit", iconRight: "esri-icon-right", iconLeft: "esri-icon-left", iconPlus: "esri-icon-plus" };
var F2 = window.CSS;
var k2 = class extends W {
  constructor(e24, t30) {
    super(e24, t30), this.displayType = "auto", this.messages = null, this.messagesUnits = null, this.selectedFile = null, this.submitting = false, this.viewModel = null, this.visibleElements = { ...v10 }, this._supportsImageOrientation = F2 && F2.supports && F2.supports("image-orientation", "from-image"), this._addAttachmentForm = null, this._updateAttachmentForm = null;
  }
  initialize() {
    this.viewModel || (this.viewModel = new A5()), this.addHandles([a6(() => {
      var _a;
      return (_a = this.viewModel) == null ? void 0 : _a.attachmentInfos;
    }, "change", () => this.scheduleRender()), a6(() => {
      var _a;
      return (_a = this.viewModel) == null ? void 0 : _a.fileInfos;
    }, "change", () => this.scheduleRender()), l3(() => {
      var _a;
      return (_a = this.viewModel) == null ? void 0 : _a.mode;
    }, () => this._modeChanged(), h)]);
  }
  loadDependencies() {
    return Promise.all([import("./calcite-icon-E63XSY7C.js")]);
  }
  get abilities() {
    return this.viewModel.abilities;
  }
  set abilities(e24) {
    this.viewModel.abilities = e24;
  }
  get effectiveDisplayType() {
    const { displayType: e24 } = this;
    return e24 && "auto" !== e24 ? e24 : this.viewModel.supportsResizeAttachments ? "preview" : "list";
  }
  get graphic() {
    return this.viewModel.graphic;
  }
  set graphic(e24) {
    this.viewModel.graphic = e24;
  }
  get label() {
    var _a;
    return ((_a = this.messages) == null ? void 0 : _a.widgetLabel) ?? "";
  }
  set label(e24) {
    this._overrideIfSome("label", e24);
  }
  castVisibleElements(e24) {
    return { ...v10, ...e24 };
  }
  addAttachment() {
    const { _addAttachmentForm: e24, viewModel: s27 } = this;
    return this._set("submitting", true), this._set("error", null), s27.addAttachment(e24).then((e25) => (this._set("submitting", false), this._set("error", null), s27.mode = "view", e25)).catch((e25) => {
      throw this._set("submitting", false), this._set("error", new s3("attachments:add-attachment", this.messages.addErrorMessage, e25)), e25;
    });
  }
  deleteAttachment(e24) {
    const { viewModel: s27 } = this;
    return this._set("submitting", true), this._set("error", null), s27.deleteAttachment(e24).then((e25) => (this._set("submitting", false), this._set("error", null), s27.mode = "view", e25)).catch((e25) => {
      throw this._set("submitting", false), this._set("error", new s3("attachments:delete-attachment", this.messages.deleteErrorMessage, e25)), e25;
    });
  }
  updateAttachment() {
    const { viewModel: e24 } = this, { _updateAttachmentForm: s27 } = this;
    return this._set("submitting", true), this._set("error", null), e24.updateAttachment(s27).then((t30) => (this._set("submitting", false), this._set("error", null), e24.mode = "view", t30)).catch((e25) => {
      throw this._set("submitting", false), this._set("error", new s3("attachments:update-attachment", this.messages.updateErrorMessage, e25)), e25;
    });
  }
  addFile() {
    const e24 = this.viewModel.addFile(this.selectedFile, this._addAttachmentForm);
    return this.viewModel.mode = "view", e24;
  }
  updateFile() {
    const { viewModel: e24 } = this, t30 = e24.updateFile(this.selectedFile, this._updateAttachmentForm, e24.activeFileInfo);
    return e24.mode = "view", t30;
  }
  deleteFile(e24) {
    var _a;
    const t30 = this.viewModel.deleteFile(e24 || ((_a = this.viewModel.activeFileInfo) == null ? void 0 : _a.file));
    return this.viewModel.mode = "view", t30;
  }
  render() {
    const { submitting: e24, viewModel: t30 } = this, { state: s27 } = t30;
    return n5("div", { class: this.classes(A6.base, A6.esriWidget) }, e24 ? this.renderProgressBar() : null, "loading" === s27 ? this.renderLoading() : this.renderAttachments(), this.renderErrorMessage());
  }
  renderErrorMessage() {
    const { error: e24, visibleElements: t30 } = this;
    return e24 && t30.errorMessage ? n5("div", { key: "error-message", class: A6.errorMessage }, e24.message) : null;
  }
  renderAttachments() {
    const { activeFileInfo: e24, mode: t30, activeAttachmentInfo: s27 } = this.viewModel;
    return "add" === t30 ? this.renderAddForm() : "edit" === t30 ? this.renderDetailsForm(s27 || e24) : this.renderAttachmentContainer();
  }
  renderLoading() {
    return n5("div", { class: A6.loaderContainer, key: "loader" }, n5("div", { class: A6.loader }));
  }
  renderProgressBar() {
    return this.visibleElements.progressBar ? n5("div", { class: A6.progressBar, key: "progress-bar" }) : null;
  }
  renderAddForm() {
    const { submitting: e24, selectedFile: t30 } = this, s27 = e24 || !t30, i34 = this.visibleElements.cancelAddButton ? n5("button", { type: "button", bind: this, disabled: e24, onclick: this._cancelForm, class: this.classes(A6.esriButton, A6.esriButtonTertiary, A6.esriButtonSmall, A6.esriButtonHalf, e24 && A6.buttonDisabled) }, this.messages.cancel) : null, a34 = this.visibleElements.addSubmitButton ? n5("button", { type: "submit", disabled: s27, class: this.classes(A6.esriButton, A6.esriButtonSecondary, A6.esriButtonSmall, A6.esriButtonHalf, { [A6.buttonDisabled]: s27 }) }, this.messages.add) : null, n31 = t30 ? n5("span", { key: "file-name", class: A6.fileName }, t30.name) : null, r24 = n5("form", { bind: this, afterCreate: v5, afterRemoved: h2, "data-node-ref": "_addAttachmentForm", onsubmit: this._submitAddAttachment }, n5("fieldset", { class: A6.fileFieldset }, n31, n5("label", { class: this.classes(A6.fileLabel, A6.esriButton, A6.esriButtonSecondary) }, t30 ? this.messages.changeFile : this.messages.selectFile, n5("input", { class: A6.fileInput, type: "file", name: "attachment", bind: this, onchange: this._handleFileInputChange }))), a34, i34);
    return n5("div", { key: "add-form-container", class: A6.formNode }, r24);
  }
  renderDetailsForm(e24) {
    var _a, _b, _c;
    const { visibleElements: t30, viewModel: i34, selectedFile: a34, submitting: n31 } = this, { abilities: l25 } = i34, o27 = n31 || !a34;
    let d18, c37, m25, h20;
    a34 ? (d18 = a34.type, c37 = a34.name, m25 = a34.size) : e24 && "file" in e24 ? (d18 = e24.file.type, c37 = e24.file.name, m25 = e24.file.size) : e24 && "contentType" in e24 && (d18 = e24.contentType, c37 = e24.name, m25 = e24.size, h20 = e24.url);
    const u21 = l25.editing && ((_a = l25.operations) == null ? void 0 : _a.delete) && t30.deleteButton ? n5("button", { key: "delete-button", type: "button", disabled: n31, bind: this, onclick: (t31) => this._submitDeleteAttachment(t31, e24), class: this.classes(A6.esriButton, A6.esriButtonSmall, A6.esriButtonTertiary, A6.deleteButton, { [A6.buttonDisabled]: n31 }) }, this.messages.delete) : void 0, b17 = l25.editing && ((_b = l25.operations) == null ? void 0 : _b.update) && t30.updateButton ? n5("button", { disabled: o27, key: "update-button", type: "submit", class: this.classes(A6.esriButton, A6.esriButtonSmall, A6.esriButtonThird, { [A6.buttonDisabled]: o27 }) }, this.messages.update) : void 0, f18 = this.visibleElements.cancelUpdateButton ? n5("button", { disabled: n31, key: "cancel-button", type: "button", bind: this, onclick: this._cancelForm, class: this.classes(A6.esriButton, A6.esriButtonSmall, A6.esriButtonTertiary, A6.esriButtonThird, { [A6.buttonDisabled]: n31 }) }, this.messages.cancel) : void 0, v16 = l25.editing && ((_c = l25.operations) == null ? void 0 : _c.update) ? n5("fieldset", { key: "file", class: A6.fileFieldset }, n5("span", { key: "file-name", class: A6.fileName }, c37), n5("label", { class: this.classes(A6.fileLabel, A6.esriButton, A6.esriButtonSecondary) }, this.messages.changeFile, n5("input", { class: A6.fileInput, type: "file", name: "attachment", bind: this, onchange: this._handleFileInputChange }))) : void 0, y16 = n5("fieldset", { key: "size", class: A6.metadataFieldset }, n5("label", null, v8(this.messagesUnits, m25 ?? 0))), w18 = n5("fieldset", { key: "content-type", class: A6.metadataFieldset }, n5("label", null, d18)), F7 = r(h20) ? n5("a", { class: A6.itemLink, href: h20, rel: "noreferrer", target: "_blank" }, this.renderImageMask(e24, 400), n5("div", { class: A6.itemLinkOverlay }, n5("span", { class: A6.itemLinkOverlayIcon }, n5("calcite-icon", { icon: "launch" })))) : this.renderImageMask(e24, 400), k4 = n5("form", { bind: this, afterCreate: v5, afterRemoved: h2, "data-node-ref": "_updateAttachmentForm", onsubmit: (t31) => this._submitUpdateAttachment(t31, e24) }, n5("div", { class: A6.metadata }, y16, w18), v16, n5("div", { class: A6.actions }, u21, f18, b17));
    return n5("div", { key: "edit-form-container", class: A6.formNode }, F7, k4);
  }
  renderImageMask(e24, t30) {
    return e24 ? "file" in e24 ? this.renderGenericImageMask(e24.file.name, e24.file.type) : this.renderImageMaskForAttachment(e24, t30) : null;
  }
  renderGenericImageMask(e24, t30) {
    const { supportsResizeAttachments: s27 } = this.viewModel, i34 = p5(t30), a34 = { [A6.itemImageResizable]: s27 };
    return n5("div", { class: this.classes(A6.itemMaskIcon, A6.itemMask) }, n5("img", { title: e24, alt: e24, src: i34, class: this.classes(a34, A6.itemImage) }));
  }
  renderImageMaskForAttachment(e24, t30) {
    const { supportsResizeAttachments: s27 } = this.viewModel;
    if (!e24)
      return null;
    const { contentType: i34, name: a34, url: n31 } = e24;
    if (!s27 || !e12(i34))
      return this.renderGenericImageMask(a34, i34);
    const r24 = this._getCSSTransform(e24), l25 = r24 ? { transform: r24, "image-orientation": "none" } : {}, o27 = `${n31}${(n31 == null ? void 0 : n31.includes("?")) ? "&" : "?"}w=${t30}`, d18 = { [A6.itemImageResizable]: s27 };
    return n5("div", { class: this.classes(A6.itemMask) }, n5("img", { styles: l25, alt: a34, title: a34, src: o27, class: this.classes(d18, A6.itemImage) }));
  }
  renderFile(e24) {
    const { file: t30 } = e24;
    return n5("li", { class: A6.item, key: t30 }, n5("button", { key: "details-button", bind: this, class: A6.itemButton, title: this.messages.attachmentDetails, "aria-label": this.messages.attachmentDetails, onclick: () => this._startEditFile(e24), type: "button" }, this.renderImageMask(e24), n5("label", { class: A6.itemLabel }, n5("span", { class: A6.itemFilename }, t30.name || this.messages.noTitle), n5("span", { "aria-hidden": "true", class: this.classes(A6.itemChevronIcon, f4(this.container) ? A6.iconLeft : A6.iconRight) }))));
  }
  renderAttachmentInfo({ attachmentInfo: e24, displayType: t30 }) {
    const { viewModel: s27, effectiveDisplayType: i34 } = this, { abilities: a34, supportsResizeAttachments: n31 } = s27, { contentType: r24, name: l25, url: o27 } = e24, d18 = this.renderImageMask(e24, "list" === t30 ? 48 : 400), c37 = a34.editing ? n5("span", { "aria-hidden": "true", class: this.classes(A6.itemChevronIcon, f4(this.container) ? A6.iconLeft : A6.iconRight) }) : null, m25 = [d18, "preview" === i34 && n31 && e12(r24) ? null : n5("label", { class: A6.itemLabel }, n5("span", { class: A6.itemFilename }, l25 || this.messages.noTitle), c37)], h20 = a34.editing ? n5("button", { key: "details-button", bind: this, class: A6.itemButton, title: this.messages.attachmentDetails, "aria-label": this.messages.attachmentDetails, "data-attachment-info-id": e24.id, onclick: () => this._startEditAttachment(e24), type: "button" }, m25) : n5("a", { key: "details-link", class: A6.itemButton, href: o27 ?? void 0, target: "_blank" }, m25);
    return n5("li", { class: A6.item, key: e24 }, h20);
  }
  renderAttachmentContainer() {
    var _a;
    const { effectiveDisplayType: e24, viewModel: t30, visibleElements: s27 } = this, { attachmentInfos: i34, abilities: a34, fileInfos: n31 } = t30, r24 = !!(i34 == null ? void 0 : i34.length), l25 = !!(n31 == null ? void 0 : n31.length), o27 = { [A6.containerList]: "preview" !== e24, [A6.containerPreview]: "preview" === e24 }, d18 = a34.editing && ((_a = a34.operations) == null ? void 0 : _a.add) && s27.addButton ? n5("button", { bind: this, onclick: () => this._startAddAttachment(), class: this.classes(A6.esriButton, A6.esriButtonTertiary, A6.addAttachmentButton), type: "button" }, n5("span", { "aria-hidden": "true", class: this.classes(A6.itemAddIcon, A6.iconPlus) }), this.messages.add) : void 0, c37 = r24 ? n5("ul", { key: "attachments-list", class: A6.items }, i34.toArray().map((t31) => this.renderAttachmentInfo({ attachmentInfo: t31, displayType: e24 }))) : void 0, m25 = l25 ? n5("ul", { key: "file-list", class: A6.items }, n31.toArray().map((e25) => this.renderFile(e25))) : void 0, h20 = l25 || r24 ? void 0 : n5("div", { class: A6.empty }, this.messages.noAttachments);
    return n5("div", { key: "attachments-container", class: this.classes(A6.container, o27) }, c37, m25, h20, d18);
  }
  _modeChanged() {
    this._set("error", null), this._set("selectedFile", null);
  }
  _handleFileInputChange(e24) {
    const t30 = e24.target, s27 = t30 && t30.files && t30.files.item(0);
    this._set("selectedFile", s27);
  }
  _submitDeleteAttachment(e24, t30) {
    e24.preventDefault(), t30 && ("file" in t30 ? this.deleteFile(t30.file) : t30 && this.deleteAttachment(t30));
  }
  _submitAddAttachment(e24) {
    e24.preventDefault(), this.viewModel.filesEnabled ? this.addFile() : this.addAttachment();
  }
  _submitUpdateAttachment(e24, t30) {
    e24.preventDefault(), t30 && "file" in t30 ? this.updateFile() : this.updateAttachment();
  }
  _startEditAttachment(e24) {
    const { viewModel: t30 } = this;
    t30.activeFileInfo = null, t30.activeAttachmentInfo = e24, t30.mode = "edit";
  }
  _startEditFile(e24) {
    const { viewModel: t30 } = this;
    t30.activeAttachmentInfo = null, t30.activeFileInfo = e24, t30.mode = "edit";
  }
  _startAddAttachment() {
    this.viewModel.mode = "add";
  }
  _cancelForm(e24) {
    e24.preventDefault(), this.viewModel.mode = "view";
  }
  _getCSSTransform(e24) {
    const { orientationInfo: t30 } = e24;
    return !this._supportsImageOrientation && t30 ? [t30.rotation ? `rotate(${t30.rotation}deg)` : "", t30.mirrored ? "scaleX(-1)" : ""].join(" ") : "";
  }
};
e([y2()], k2.prototype, "abilities", null), e([y2()], k2.prototype, "displayType", void 0), e([y2({ readOnly: true })], k2.prototype, "effectiveDisplayType", null), e([y2()], k2.prototype, "graphic", null), e([y2()], k2.prototype, "label", null), e([y2(), e4("esri/widgets/Attachments/t9n/Attachments")], k2.prototype, "messages", void 0), e([y2(), e4("esri/core/t9n/Units")], k2.prototype, "messagesUnits", void 0), e([y2({ readOnly: true })], k2.prototype, "selectedFile", void 0), e([y2({ readOnly: true })], k2.prototype, "submitting", void 0), e([y2({ readOnly: true })], k2.prototype, "error", void 0), e([y2({ type: A5 })], k2.prototype, "viewModel", void 0), e([y2()], k2.prototype, "visibleElements", void 0), e([s4("visibleElements")], k2.prototype, "castVisibleElements", null), k2 = e([a3("esri.widgets.Attachments")], k2);
var B2 = k2;

// node_modules/@arcgis/core/widgets/Feature/FeatureAttachments/FeatureAttachmentsViewModel.js
var o8 = class extends A5 {
  constructor(t30) {
    super(t30), this.description = null, this.title = null;
  }
};
e([y2()], o8.prototype, "description", void 0), e([y2()], o8.prototype, "title", void 0), o8 = e([a3("esri.widgets.Feature.FeatureAttachments.FeatureAttachmentsViewModel")], o8);
var c12 = o8;

// node_modules/@arcgis/core/widgets/Feature/support/FeatureElementInfo.js
var p6 = "esri-feature-element-info";
var n11 = { base: p6, title: `${p6}__title`, description: `${p6}__description` };
var c13 = class extends W {
  constructor(e24, t30) {
    super(e24, t30), this.description = null, this.headingLevel = 2, this.title = null;
  }
  render() {
    return n5("div", { class: n11.base }, this.renderTitle(), this.renderDescription());
  }
  renderTitle() {
    const { title: e24 } = this;
    return e24 ? n5(n9, { level: this.headingLevel, class: n11.title }, e24) : null;
  }
  renderDescription() {
    const { description: e24 } = this;
    return e24 ? n5("div", { key: "description", class: n11.description }, e24) : null;
  }
};
e([y2()], c13.prototype, "description", void 0), e([y2()], c13.prototype, "headingLevel", void 0), e([y2()], c13.prototype, "title", void 0), c13 = e([a3("esri.widgets.Feature.support.FeatureElementInfo")], c13);
var l10 = c13;

// node_modules/@arcgis/core/widgets/Feature/FeatureAttachments.js
var d5 = { base: "esri-feature-attachments" };
var c14 = class extends W {
  constructor(e24, t30) {
    super(e24, t30), this._featureElementInfo = null, this.attachmentsWidget = new B2(), this.headingLevel = 2, this.viewModel = new c12();
  }
  initialize() {
    this._featureElementInfo = new l10(), this.addHandles([l3(() => {
      var _a, _b;
      return [(_a = this.viewModel) == null ? void 0 : _a.description, (_b = this.viewModel) == null ? void 0 : _b.title, this.headingLevel];
    }, () => this._setupFeatureElementInfo(), h), l3(() => this.viewModel, (e24) => this.attachmentsWidget.viewModel = e24, h)]);
  }
  destroy() {
    var _a;
    this.attachmentsWidget.destroy(), (_a = this._featureElementInfo) == null ? void 0 : _a.destroy();
  }
  get description() {
    return this.viewModel.description;
  }
  set description(e24) {
    this.viewModel.description = e24;
  }
  get displayType() {
    return this.attachmentsWidget.displayType;
  }
  set displayType(e24) {
    this.attachmentsWidget.displayType = e24;
  }
  get graphic() {
    return this.viewModel.graphic;
  }
  set graphic(e24) {
    this.viewModel.graphic = e24;
  }
  get title() {
    return this.viewModel.title;
  }
  set title(e24) {
    this.viewModel.title = e24;
  }
  render() {
    var _a;
    const { attachmentsWidget: e24 } = this;
    return n5("div", { class: d5.base }, (_a = this._featureElementInfo) == null ? void 0 : _a.render(), e24 == null ? void 0 : e24.render());
  }
  _setupFeatureElementInfo() {
    var _a;
    const { description: e24, title: t30, headingLevel: i34 } = this;
    (_a = this._featureElementInfo) == null ? void 0 : _a.set({ description: e24, title: t30, headingLevel: i34 });
  }
};
e([y2({ readOnly: true })], c14.prototype, "attachmentsWidget", void 0), e([y2()], c14.prototype, "description", null), e([y2()], c14.prototype, "displayType", null), e([y2()], c14.prototype, "graphic", null), e([y2()], c14.prototype, "headingLevel", void 0), e([y2()], c14.prototype, "title", null), e([y2({ type: c12 })], c14.prototype, "viewModel", void 0), c14 = e([a3("esri.widgets.Feature.FeatureAttachments")], c14);
var h6 = c14;

// node_modules/@arcgis/core/widgets/Feature/FeatureContent/FeatureContentViewModel.js
var p7 = class extends a9(v3) {
  constructor(t30) {
    super(t30), this._loadingPromise = null, this.created = null, this.creator = null, this.destroyer = null, this.graphic = null, this.handles.add(l3(() => this.creator, (t31) => {
      this._destroyContent(), this._createContent(t31);
    }, h));
  }
  destroy() {
    this._destroyContent();
  }
  get state() {
    return this._loadingPromise ? "loading" : "ready";
  }
  _destroyContent() {
    const { created: t30, graphic: e24, destroyer: r24 } = this;
    t30 && e24 && (x2(r24, { graphic: e24 }).catch(() => null), this._set("created", null));
  }
  async _createContent(t30) {
    const e24 = this.graphic;
    if (!e24 || !t30)
      return;
    const r24 = x2(t30, { graphic: e24 }).catch(() => null);
    this._loadingPromise = r24, this.notifyChange("state");
    const o27 = await r24;
    r24 === this._loadingPromise && (this._loadingPromise = null, this.notifyChange("state"), this._set("created", o27));
  }
};
e([y2({ readOnly: true })], p7.prototype, "created", void 0), e([y2()], p7.prototype, "creator", void 0), e([y2()], p7.prototype, "destroyer", void 0), e([y2({ type: g3 })], p7.prototype, "graphic", void 0), e([y2({ readOnly: true })], p7.prototype, "state", null), p7 = e([a3("esri.widgets.Feature.FeatureContent.FeatureContentViewModel")], p7);
var l11 = p7;

// node_modules/@arcgis/core/widgets/Feature/FeatureContent.js
var n12 = "esri-feature-content";
var c15 = { base: n12, loaderContainer: `${n12}__loader-container`, loader: `${n12}__loader` };
var l12 = class extends W {
  constructor(e24, r24) {
    super(e24, r24), this.viewModel = null, this._addTargetToAnchors = (e25) => {
      Array.from(e25.querySelectorAll("a")).forEach((e26) => {
        C2(e26.href) && !e26.hasAttribute("target") && e26.setAttribute("target", "_blank");
      });
    };
  }
  get creator() {
    var _a;
    return (_a = this.viewModel) == null ? void 0 : _a.creator;
  }
  set creator(e24) {
    this.viewModel && (this.viewModel.creator = e24);
  }
  get graphic() {
    var _a;
    return (_a = this.viewModel) == null ? void 0 : _a.graphic;
  }
  set graphic(e24) {
    this.viewModel && (this.viewModel.graphic = e24);
  }
  renderLoading() {
    return n5("div", { class: c15.loaderContainer, key: "loader" }, n5("div", { class: c15.loader }));
  }
  renderCreated() {
    var _a;
    const e24 = (_a = this.viewModel) == null ? void 0 : _a.created;
    return e24 ? e24 instanceof HTMLElement ? n5("div", { key: e24, bind: e24, afterCreate: this._attachToNode }) : e6(e24) ? n5("div", { key: e24 }, !e24.destroyed && e24.render()) : n5("div", { key: e24, innerHTML: e24, afterCreate: this._addTargetToAnchors }) : null;
  }
  render() {
    var _a;
    const e24 = (_a = this.viewModel) == null ? void 0 : _a.state;
    return n5("div", { class: c15.base }, "loading" === e24 ? this.renderLoading() : this.renderCreated());
  }
  _attachToNode(e24) {
    const r24 = this;
    e24.appendChild(r24);
  }
};
e([y2()], l12.prototype, "creator", null), e([y2()], l12.prototype, "graphic", null), e([y2({ type: l11 })], l12.prototype, "viewModel", void 0), l12 = e([a3("esri.widgets.Feature.FeatureContent")], l12);
var p8 = l12;

// node_modules/@arcgis/core/widgets/Feature/FeatureFields/FeatureFieldsViewModel.js
var l13 = class extends v3 {
  constructor(o27) {
    super(o27), this.attributes = null, this.expressionInfos = null, this.description = null, this.fieldInfos = null, this.title = null;
  }
  get formattedFieldInfos() {
    const { expressionInfos: o27, fieldInfos: e24 } = this, s27 = [];
    return e24 == null ? void 0 : e24.forEach((e25) => {
      if (!(!e25.hasOwnProperty("visible") || e25.visible))
        return;
      const t30 = e25.clone();
      t30.label = R5(t30, o27), s27.push(t30);
    }), s27;
  }
};
e([y2()], l13.prototype, "attributes", void 0), e([y2({ type: [i11] })], l13.prototype, "expressionInfos", void 0), e([y2()], l13.prototype, "description", void 0), e([y2({ type: [c4] })], l13.prototype, "fieldInfos", void 0), e([y2({ readOnly: true })], l13.prototype, "formattedFieldInfos", null), e([y2()], l13.prototype, "title", void 0), l13 = e([a3("esri.widgets.Feature.FeatureFields.FeatureFieldsViewModel")], l13);
var n13 = l13;

// node_modules/@arcgis/core/widgets/support/uriUtils.js
var s13 = [{ pattern: /^\s*(https?:\/\/([^\s]+))\s*$/i, target: "_blank", label: "{messages.view}" }, { pattern: /^\s*(tel:([^\s]+))\s*$/i, label: "{hierPart}" }, { pattern: /^\s*(mailto:([^\s]+))\s*$/i, label: "{hierPart}" }, { pattern: /^\s*(arcgis-appstudio-player:\/\/([^\s]+))\s*$/i, label: "{messages.openInApp}", appName: "App Studio Player" }, { pattern: /^\s*(arcgis-collector:\/\/([^\s]+))\s*$/i, label: "{messages.openInApp}", appName: "Collector" }, { pattern: /^\s*(arcgis-explorer:\/\/([^\s]+))\s*$/i, label: "{messages.openInApp}", appName: "Explorer" }, { pattern: /^\s*(arcgis-navigator:\/\/([^\s]+))\s*$/i, label: "{messages.openInApp}", appName: "Navigator" }, { pattern: /^\s*(arcgis-survey123:\/\/([^\s]+))\s*$/i, label: "{messages.openInApp}", appName: "Survey123" }, { pattern: /^\s*(arcgis-trek2there:\/\/([^\s]+))\s*$/i, label: "{messages.openInApp}", appName: "Trek2There" }, { pattern: /^\s*(arcgis-workforce:\/\/([^\s]+))\s*$/i, label: "{messages.openInApp}", appName: "Workforce" }, { pattern: /^\s*(iform:\/\/([^\s]+))\s*$/i, label: "{messages.openInApp}", appName: "iForm" }, { pattern: /^\s*(flow:\/\/([^\s]+))\s*$/i, label: "{messages.openInApp}", appName: "FlowFinity" }, { pattern: /^\s*(lfmobile:\/\/([^\s]+))\s*$/i, label: "{messages.openInApp}", appName: "Laserfische" }, { pattern: /^\s*(mspbi:\/\/([^\s]+))\s*$/i, label: "{messages.openInApp}", appName: "Microsoft Power Bi" }];
function a15(e24) {
  let a34 = null;
  return s13.some((s27) => (s27.pattern.test(e24) && (a34 = s27), !!a34)), a34;
}
function p9(s27, p30) {
  if ("string" != typeof p30 || !p30)
    return p30;
  const r24 = a15(p30);
  if (!r24)
    return p30;
  const t30 = p30.match(r24.pattern), n31 = t30 && t30[2], l25 = r2(r2(r24.label, { messages: s27, hierPart: n31 }), { appName: r24.appName }), i34 = r24.target ? ` target="${r24.target}"` : "", o27 = "_blank" === r24.target ? ' rel="noreferrer"' : "";
  return p30.replace(r24.pattern, `<a${i34} href="$1"${o27}>${l25}</a>`);
}

// node_modules/@arcgis/core/widgets/Feature/FeatureFields.js
var f7 = "esri-feature-fields";
var u6 = { base: f7, fieldHeader: `${f7}__field-header`, fieldData: `${f7}__field-data`, fieldDataDate: `${f7}__field-data--date`, esriTable: "esri-widget__table" };
var m9 = class extends W {
  constructor(e24, t30) {
    super(e24, t30), this._featureElementInfo = null, this.viewModel = new n13(), this.messages = null, this.messagesURIUtils = null;
  }
  initialize() {
    this._featureElementInfo = new l10(), this.addHandles(l3(() => {
      var _a, _b;
      return [(_a = this.viewModel) == null ? void 0 : _a.description, (_b = this.viewModel) == null ? void 0 : _b.title];
    }, () => this._setupFeatureElementInfo(), h));
  }
  destroy() {
    var _a;
    (_a = this._featureElementInfo) == null ? void 0 : _a.destroy();
  }
  get attributes() {
    return this.viewModel.attributes;
  }
  set attributes(e24) {
    this.viewModel.attributes = e24;
  }
  get description() {
    return this.viewModel.description;
  }
  set description(e24) {
    this.viewModel.description = e24;
  }
  get expressionInfos() {
    return this.viewModel.expressionInfos;
  }
  set expressionInfos(e24) {
    this.viewModel.expressionInfos = e24;
  }
  get fieldInfos() {
    return this.viewModel.fieldInfos;
  }
  set fieldInfos(e24) {
    this.viewModel.fieldInfos = e24;
  }
  get title() {
    return this.viewModel.title;
  }
  set title(e24) {
    this.viewModel.title = e24;
  }
  renderFieldInfo(e24, t30) {
    const { attributes: s27 } = this.viewModel, i34 = e24.fieldName, r24 = e24.label || i34, o27 = s27 ? null == s27[i34] ? "" : s27[i34] : "", l25 = !(!e24.format || !e24.format.dateFormat), n31 = "number" == typeof o27 && !l25 ? this._forceLTR(o27) : p9(this.messagesURIUtils, o27), a34 = { [u6.fieldDataDate]: l25 };
    return n5("tr", { key: `fields-element-info-row-${i34}-${t30}` }, n5("th", { key: `fields-element-info-row-header-${i34}-${t30}`, class: u6.fieldHeader, innerHTML: r24 }), n5("td", { key: `fields-element-info-row-data-${i34}-${t30}`, class: this.classes(u6.fieldData, a34), innerHTML: n31 }));
  }
  renderFields() {
    const { formattedFieldInfos: e24 } = this.viewModel;
    return (e24 == null ? void 0 : e24.length) ? n5("table", { class: u6.esriTable, summary: this.messages.fieldsSummary }, n5("tbody", null, e24.map((e25, t30) => this.renderFieldInfo(e25, t30)))) : null;
  }
  render() {
    var _a;
    return n5("div", { class: u6.base }, (_a = this._featureElementInfo) == null ? void 0 : _a.render(), this.renderFields());
  }
  _setupFeatureElementInfo() {
    var _a;
    const { description: e24, title: t30 } = this;
    (_a = this._featureElementInfo) == null ? void 0 : _a.set({ description: e24, title: t30 });
  }
  _forceLTR(e24) {
    return `&lrm;${e24}`;
  }
};
e([y2()], m9.prototype, "attributes", null), e([y2()], m9.prototype, "description", null), e([y2()], m9.prototype, "expressionInfos", null), e([y2()], m9.prototype, "fieldInfos", null), e([y2()], m9.prototype, "title", null), e([y2({ type: n13, nonNullable: true })], m9.prototype, "viewModel", void 0), e([y2(), e4("esri/widgets/Feature/t9n/Feature")], m9.prototype, "messages", void 0), e([y2(), e4("esri/widgets/support/t9n/uriUtils")], m9.prototype, "messagesURIUtils", void 0), m9 = e([a3("esri.widgets.Feature.FeatureFields")], m9);
var c16 = m9;

// node_modules/@arcgis/core/widgets/Feature/support/relatedFeatureUtils.js
var c17 = "esri.widgets.Feature.support.relatedFeatureUtils";
var f8 = s2.getLogger(c17);
var d6 = /* @__PURE__ */ new Map();
function m10(e24) {
  if (!ue(e24))
    return null;
  const [t30, r24] = e24.split("/").slice(1);
  return { layerId: t30, fieldName: r24 };
}
function y6(e24, t30) {
  if (!t30.relationships)
    return null;
  let r24 = null;
  const { relationships: s27 } = t30;
  return s27.some((t31) => t31.id === parseInt(e24, 10) && (r24 = t31, true)), r24;
}
function j7({ originRelationship: e24, relationships: t30, layerId: r24 }) {
  let s27 = null;
  return t30 && t30.some((t31) => (`${t31.relatedTableId}` === r24 && t31.id === (e24 == null ? void 0 : e24.id) && (s27 = t31), !!s27)), s27;
}
function h7(e24, t30) {
  const r24 = t30.toLowerCase();
  for (const s27 in e24)
    if (s27.toLowerCase() === r24)
      return e24[s27];
  return null;
}
function g6(e24, t30) {
  const r24 = y6(e24, t30);
  if (!r24)
    return;
  return { url: `${t30.url}/${r24.relatedTableId}`, sourceSpatialReference: t30.spatialReference, relation: r24, relatedFields: [], outStatistics: [] };
}
function F3(e24, t30) {
  if (!t30)
    return;
  if (!e24)
    return;
  const { features: r24, statsFeatures: s27 } = e24, o27 = r24 && r24.value;
  t30.relatedFeatures = o27 ? o27.features : [];
  const i34 = s27 && s27.value;
  t30.relatedStatsFeatures = i34 ? i34.features : [];
}
function I3(e24, t30, r24, s27) {
  var _a;
  const o27 = new d3();
  return o27.outFields = ["*"], o27.relationshipId = "number" == typeof t30.id ? t30.id : parseInt(t30.id, 10), o27.objectIds = [e24.attributes[r24.objectIdField]], ((_a = r24.queryRelatedFeatures) == null ? void 0 : _a.call(r24, o27, s27)) ?? Promise.resolve({});
}
function S4(e24, t30, r24) {
  let s27 = 0;
  const o27 = [];
  for (; s27 < t30.length; )
    o27.push(`${e24} IN (${t30.slice(s27, r24 + s27)})`), s27 += r24;
  return o27.join(" OR ");
}
async function w10(e24, t30, r24, s27) {
  const l25 = r24.layerId.toString(), { layerInfo: u21, relation: p30, relatedFields: c37, outStatistics: f18, url: d18, sourceSpatialReference: m25 } = t30;
  if (!u21 || !p30)
    return null;
  const y16 = j7({ originRelationship: p30, relationships: u21.relationships, layerId: l25 });
  if ((y16 == null ? void 0 : y16.relationshipTableId) && y16.keyFieldInRelationshipTable) {
    const t31 = (await I3(e24, y16, r24, s27))[e24.attributes[r24.objectIdField]];
    if (!t31)
      return null;
    const i34 = t31.features.map((e25) => e25.attributes[u21.objectIdField]);
    if ((f18 == null ? void 0 : f18.length) && u21.supportsStatistics) {
      const e25 = new x();
      e25.where = S4(u21.objectIdField, i34, 1e3), e25.outFields = c37, e25.outStatistics = f18, e25.sourceSpatialReference = m25;
      const r25 = { features: Promise.resolve(t31), statsFeatures: s10(d18, e25) };
      return E(r25);
    }
  }
  const g17 = y16 == null ? void 0 : y16.keyField;
  if (g17) {
    const r25 = ie(T4(u21.fields, g17)), l26 = h7(e24.attributes, p30.keyField), c38 = r25 ? `${g17}=${l26}` : `${g17}='${l26}'`, f19 = s10(d18, new x({ where: c38, outFields: t30.relatedFields, sourceSpatialReference: m25 }), s27), y17 = t30.outStatistics && t30.outStatistics.length > 0 && u21.supportsStatistics ? s10(d18, new x({ where: c38, outFields: t30.relatedFields, outStatistics: t30.outStatistics, sourceSpatialReference: m25 }), s27) : null, j10 = { features: f19 };
    return y17 && (j10.statsFeatures = y17), E(j10);
  }
  return null;
}
function b7(t30, r24) {
  return U3(t30, { query: { f: "json" }, signal: r24 && r24.signal });
}
function R6({ relatedInfos: e24, layer: r24 }, i34) {
  const n31 = {};
  return e24.forEach((e25, s27) => {
    const { relation: o27 } = e25;
    if (!o27) {
      const e26 = new s3("relation-required", "A relation is required on a layer to retrieve related records.");
      throw f8.error(e26), e26;
    }
    const { relatedTableId: i35 } = o27;
    if ("number" != typeof i35) {
      const e26 = new s3("A related table ID is required on a layer to retrieve related records.");
      throw f8.error(e26), e26;
    }
    const a34 = `${r24.url}/${i35}`, l25 = d6.get(a34), u21 = l25 || b7(a34);
    l25 || d6.set(a34, u21), n31[s27] = u21;
  }), y(E(n31), i34);
}
function $2({ graphic: e24, relatedInfos: t30, layer: r24 }, s27) {
  const i34 = {};
  return t30.forEach((t31, o27) => {
    t31.layerInfo && (i34[o27] = w10(e24, t31, r24, s27));
  }), E(i34);
}
function U6({ relatedInfo: e24, fieldName: t30, fieldInfo: r24 }) {
  var _a, _b;
  if ((_a = e24.relatedFields) == null ? void 0 : _a.push(t30), r24.statisticType) {
    const s27 = new m4({ statisticType: r24.statisticType, onStatisticField: t30, outStatisticFieldName: t30 });
    (_b = e24.outStatistics) == null ? void 0 : _b.push(s27);
  }
}
function T4(e24, t30) {
  if (null != e24) {
    t30 = t30.toLowerCase();
    for (const r24 of e24)
      if (r24 && r24.name.toLowerCase() === t30)
        return r24;
  }
  return null;
}

// node_modules/@arcgis/core/widgets/Feature/FeatureMedia/FeatureMediaViewModel.js
var I4 = { chartAnimation: true };
var v11 = class extends v3 {
  constructor(t30) {
    super(t30), this.abilities = { ...I4 }, this.activeMediaInfoIndex = 0, this.attributes = null, this.description = null, this.fieldInfoMap = null, this.formattedAttributes = null, this.expressionAttributes = null, this.isAggregate = false, this.layer = null, this.mediaInfos = null, this.popupTemplate = null, this.relatedInfos = null, this.title = null;
  }
  castAbilities(t30) {
    return { ...I4, ...t30 };
  }
  get activeMediaInfo() {
    return this.formattedMediaInfos[this.activeMediaInfoIndex] || null;
  }
  get formattedMediaInfos() {
    return this._formatMediaInfos() || [];
  }
  get formattedMediaInfoCount() {
    return this.formattedMediaInfos.length;
  }
  setActiveMedia(t30) {
    this._setContentElementMedia(t30);
  }
  next() {
    this._pageContentElementMedia(1);
  }
  previous() {
    this._pageContentElementMedia(-1);
  }
  _setContentElementMedia(t30) {
    const { formattedMediaInfoCount: e24 } = this, i34 = (t30 + e24) % e24;
    this.activeMediaInfoIndex = i34;
  }
  _pageContentElementMedia(t30) {
    const { activeMediaInfoIndex: e24 } = this, i34 = e24 + t30;
    this._setContentElementMedia(i34);
  }
  _formatMediaInfos() {
    const { mediaInfos: t30, layer: e24 } = this, o27 = this.attributes ?? {}, r24 = this.formattedAttributes ?? {}, a34 = this.expressionAttributes ?? {}, s27 = this.fieldInfoMap ?? /* @__PURE__ */ new Map();
    return (t30 == null ? void 0 : t30.map((t31) => {
      const i34 = t31 == null ? void 0 : t31.clone();
      if (!i34)
        return null;
      if (i34.title = S3({ attributes: o27, fieldInfoMap: s27, globalAttributes: r24, expressionAttributes: a34, layer: e24, text: i34.title }), i34.caption = S3({ attributes: o27, fieldInfoMap: s27, globalAttributes: r24, expressionAttributes: a34, layer: e24, text: i34.caption }), i34.altText = S3({ attributes: o27, fieldInfoMap: s27, globalAttributes: r24, expressionAttributes: a34, layer: e24, text: i34.altText }), "image" === i34.type) {
        const { value: t32 } = i34;
        return this._setImageValue({ value: t32, formattedAttributes: r24, layer: e24 }), i34.value.sourceURL ? i34 : void 0;
      }
      if ("pie-chart" === i34.type || "line-chart" === i34.type || "column-chart" === i34.type || "bar-chart" === i34.type) {
        const { value: t32 } = i34;
        return this._setChartValue({ value: t32, chartType: i34.type, attributes: o27, formattedAttributes: r24, layer: e24, expressionAttributes: a34 }), i34;
      }
      return null;
    }).filter(r)) ?? [];
  }
  _setImageValue(t30) {
    const e24 = this.fieldInfoMap ?? /* @__PURE__ */ new Map(), { value: i34, formattedAttributes: o27, layer: r24 } = t30, { linkURL: a34, sourceURL: s27 } = i34;
    if (s27) {
      const t31 = _3(s27, r24);
      i34.sourceURL = G({ formattedAttributes: o27, template: t31, fieldInfoMap: e24 });
    }
    if (a34) {
      const t31 = _3(a34, r24);
      i34.linkURL = G({ formattedAttributes: o27, template: t31, fieldInfoMap: e24 });
    }
  }
  _setChartValue(t30) {
    const { value: e24, attributes: i34, formattedAttributes: o27, chartType: r24, layer: a34, expressionAttributes: s27 } = t30, { popupTemplate: l25, relatedInfos: n31 } = this, { fields: p30, normalizeField: d18 } = e24, c37 = a34;
    e24.fields = U5(p30, c37), d18 && (e24.normalizeField = L4(d18, c37));
    if (!p30.some((t31) => !!(null != o27[t31] || ue(t31) && (n31 == null ? void 0 : n31.size))))
      return;
    const h20 = (l25 == null ? void 0 : l25.fieldInfos) ?? [];
    p30.forEach((t31) => {
      if (ue(t31))
        return void (e24.series = [...e24.series, ...this._getRelatedChartInfos({ fieldInfos: h20, fieldName: t31, formattedAttributes: o27, chartType: r24, value: e24 })]);
      const a35 = this._getChartOption({ value: e24, attributes: i34, chartType: r24, formattedAttributes: o27, expressionAttributes: s27, fieldName: t31, fieldInfos: h20 });
      e24.series.push(a35);
    });
  }
  _getRelatedChartInfos(t30) {
    var _a;
    const { fieldInfos: e24, fieldName: i34, formattedAttributes: o27, chartType: r24, value: a34 } = t30, s27 = [], l25 = m10(i34), n31 = l25 && ((_a = this.relatedInfos) == null ? void 0 : _a.get(l25.layerId.toString()));
    if (!n31)
      return s27;
    const { relatedFeatures: p30, relation: d18 } = n31;
    if (!d18 || !p30)
      return s27;
    const { cardinality: u21 } = d18;
    p30.forEach((t31) => {
      const { attributes: n32 } = t31;
      n32 && Object.keys(n32).forEach((t32) => {
        t32 === l25.fieldName && s27.push(this._getChartOption({ value: a34, attributes: n32, formattedAttributes: o27, fieldName: i34, chartType: r24, relatedFieldName: t32, hasMultipleRelatedFeatures: (p30 == null ? void 0 : p30.length) > 1, fieldInfos: e24 }));
      });
    });
    return "one-to-many" === u21 || "many-to-many" === u21 ? s27 : [s27[0]];
  }
  _getTooltip({ label: t30, value: e24, chartType: i34 }) {
    return "pie-chart" === i34 ? `${t30}` : `${t30}: ${e24}`;
  }
  _getChartOption(t30) {
    var _a;
    const { value: e24, attributes: i34, formattedAttributes: o27, expressionAttributes: r24, fieldName: a34, relatedFieldName: n31, fieldInfos: p30, chartType: d18, hasMultipleRelatedFeatures: u21 } = t30, I7 = this.layer, v16 = this.fieldInfoMap ?? /* @__PURE__ */ new Map(), { normalizeField: M7, tooltipField: A8 } = e24, g17 = M7 ? ue(M7) ? i34[m10(M7).fieldName] : i34[M7] : null, x4 = M3(a34) && r24 && void 0 !== r24[a34] ? r24[a34] : n31 && void 0 !== i34[n31] ? i34[n31] : void 0 !== i34[a34] ? i34[a34] : o27[a34], _10 = new i9({ fieldName: a34, value: void 0 === x4 ? null : x4 && g17 ? x4 / g17 : x4 });
    if (ue(a34)) {
      const t31 = v16.get(a34.toLowerCase()), e25 = A8 && v16.get(A8.toLowerCase()), r25 = (t31 == null ? void 0 : t31.fieldName) ?? a34, s27 = u21 && A8 ? m10(A8).fieldName : (e25 == null ? void 0 : e25.fieldName) ?? A8, l25 = u21 && s27 ? i34[s27] : o27[s27] ?? (t31 == null ? void 0 : t31.label) ?? (t31 == null ? void 0 : t31.fieldName) ?? n31, p31 = u21 && n31 ? i34[n31] : o27[r25];
      return _10.tooltip = this._getTooltip({ label: l25, value: p31, chartType: d18 }), _10;
    }
    const C9 = J2(p30, a34), T6 = L4(a34, I7), N3 = A8 && void 0 !== o27[A8] ? o27[A8] : R5(C9 || new c4({ fieldName: T6 }), (_a = this.popupTemplate) == null ? void 0 : _a.expressionInfos), F7 = o27[T6];
    return _10.tooltip = this._getTooltip({ label: N3, value: F7, chartType: d18 }), _10;
  }
};
e([y2()], v11.prototype, "abilities", void 0), e([s4("abilities")], v11.prototype, "castAbilities", null), e([y2()], v11.prototype, "activeMediaInfoIndex", void 0), e([y2({ readOnly: true })], v11.prototype, "activeMediaInfo", null), e([y2()], v11.prototype, "attributes", void 0), e([y2()], v11.prototype, "description", void 0), e([y2()], v11.prototype, "fieldInfoMap", void 0), e([y2()], v11.prototype, "formattedAttributes", void 0), e([y2()], v11.prototype, "expressionAttributes", void 0), e([y2({ readOnly: true })], v11.prototype, "formattedMediaInfos", null), e([y2()], v11.prototype, "isAggregate", void 0), e([y2()], v11.prototype, "layer", void 0), e([y2({ readOnly: true })], v11.prototype, "formattedMediaInfoCount", null), e([y2()], v11.prototype, "mediaInfos", void 0), e([y2()], v11.prototype, "popupTemplate", void 0), e([y2()], v11.prototype, "relatedInfos", void 0), e([y2()], v11.prototype, "title", void 0), v11 = e([a3("esri.widgets.Feature.FeatureMedia.FeatureMediaViewModel")], v11);
var M4 = v11;

// node_modules/@esri/calcite-colors/dist/colors.module.js
var f9 = ["#ffffff", "#858585", "#ffbebe", "#ffebbe", "#ffebaf", "#ffffbe", "#e9ffbe", "#d3ffbe", "#beffe8", "#bee8ff", "#bed2ff", "#e8beff", "#ffbee8", "#ebebeb", "#707070", "#ff7f7f", "#ffa77f", "#ffd37f", "#ffff73", "#d1ff73", "#a3ff73", "#73ffdf", "#73dfff", "#73b2ff", "#df73ff", "#ff73df", "#d6d6d6", "#5c5c5c", "#ff0000", "#ff5500", "#ffaa00", "#ffff00", "#aaff00", "#55ff00", "#00ffc5", "#00c5ff", "#0070ff", "#c500ff", "#ff00c5", "#c2c2c2", "#474747", "#e60000", "#e64c00", "#e69800", "#e6e600", "#98e600", "#4ce600", "#00e6a9", "#00a9e6", "#005ce6", "#a900e6", "#e600a9", "#adadad", "#242424", "#a80000", "#a83800", "#a87000", "#a8a800", "#70a800", "#38a800", "#00a884", "#0084a8", "#004da8", "#8400a8", "#a80084", "#999999", "#1a1a1a", "#730000", "#732600", "#734c00", "#737300", "#4c7300", "#267300", "#00734c", "#004c73", "#002673", "#4c0073", "#73004"];
var b8 = [].concat(f9.slice(30, 39), f9.slice(28, 30).reverse());
var e13 = [{ name: "default", colors: b8 }, { name: "cat-dark", colors: ["#ed5151", "#149ece", "#a7c636", "#9e559c", "#fc921f", "#ffde3e", "#f789d8", "#b7814a", "#3caf99", "#6b6bd6", "#b54779", "#7f7f7f"] }, { name: "tropical-bliss", colors: ["#fce138", "#ff9399", "#fcd27e", "#f1983c", "#a553b7", "#b1a9d0", "#6ecffc", "#4c81cd", "#fc6f84", "#fc3e5a", "#6af689", "#48885c"] }, { name: "desert-blooms", colors: ["#102432", "#144d59", "#ffc730", "#ed9310", "#a64f1b", "#661510", "#d9351a", "#b31515", "#4a0932", "#8c213f", "#18382e", "#2c6954"] }, { name: "under-the-sea", colors: ["#bf9727", "#607100", "#00734c", "#704489", "#01acca", "#024e76", "#f09100", "#ea311f", "#c6004b", "#7570b3", "#666666", "#333333"] }, { name: "vibrant-rainbow", colors: ["#fffb00", "#f5cb11", "#9fd40c", "#46e39c", "#32b8a6", "#7ff2fa", "#ac08cc", "#dd33ff", "#eb7200", "#e8a784", "#bf2e2e", "#6c7000"] }, { name: "ocean-bay", colors: ["#191921", "#11495c", "#78b1c2", "#454f4b", "#8f8f82", "#9be0c0", "#87b051", "#f7ec88", "#ebdcc1", "#dbb658", "#c43541", "#75351e"] }, { name: "prairie-summer", colors: ["#332424", "#751555", "#d47013", "#d68989", "#211173", "#82aad6", "#7bfaeb", "#6ec9a8", "#6b6408", "#eada40", "#ccc54a", "#1fc235"] }, { name: "pastel-chalk", colors: ["#fffd99", "#f5e6a4", "#c1d48c", "#b8e3d0", "#a0b8b5", "#cbf7fa", "#d791f2", "#dfc1eb", "#f2b983", "#e8c4b2", "#bf8e8e", "#94995c"] }, { name: "seq-yellow-orange-red-bright", colors: ["#910000", "#b1260b", "#c0370f", "#e05919", "#ef6a1d", "#ff7b22", "#ffa143", "#ffb454", "#ffda74", "#ffed85"] }, { name: "seq-reds-bright", colors: ["#57453b", "#7b4238", "#9f4036", "#c23d33", "#d7483c", "#ec5244", "#f3696c", "#f9816c", "#ffc4ae", "#fff0dc"] }, { name: "seq-purples-bright", colors: ["#4e465c", "#5a4a78", "#695291", "#775baa", "#8663c3", "#946bdc", "#aa89e8", "#c1a6f3", "#d7c4ff", "#e6e1ff"] }, { name: "seq-blues-bright", colors: ["#404d54", "#435c6c", "#48799d", "#4b88b6", "#4d96ce", "#50a5e7", "#74bbed", "#98d0f3", "#bce6f9", "#e6faff"] }, { name: "seq-greens-bright", colors: ["#39544c", "#386757", "#368165", "#359b73", "#33b581", "#4bc392", "#64d2a2", "#7ce0b3", "#cbf6d9", "#f4ffea"] }, { name: "seq-browns-bright", colors: ["#524834", "#715b38", "#8f6e3c", "#ae8140", "#cc9444", "#eba748", "#eeb664", "#f0c47f", "#f9e0b7", "#fff8eb"] }];

// node_modules/@arcgis/core/widgets/support/chartUtils.js
var n14 = "en-us";
var h8 = /* @__PURE__ */ new Map([["ar", () => import("./ar-RPQLOCS3.js").then((t30) => t30.a)], ["bg-bg", () => import("./bg_BG-T53OPNJP.js").then((t30) => t30.b)], ["bs-ba", () => import("./bs_BA-6MRXKB53.js").then((t30) => t30.b)], ["ca-es", () => import("./ca_ES-OMNAKB6H.js").then((t30) => t30.c)], ["cs-cz", () => import("./cs_CZ-HRORQNHF.js").then((t30) => t30.c)], ["da-dk", () => import("./da_DK-SYKIF23R.js").then((t30) => t30.d)], ["de-de", () => import("./de_DE-2U5JCBCZ.js").then((t30) => t30.d)], ["de-ch", () => import("./de_CH-GEXQU2J7.js").then((t30) => t30.d)], ["el-gr", () => import("./el_GR-EPK6ILLS.js").then((t30) => t30.e)], ["en-us", () => import("./en_US-DWNEHTCF.js").then((t30) => t30.e)], ["en-ca", () => import("./en_CA-T5H3J2C5.js").then((t30) => t30.e)], ["es-es", () => import("./es_ES-HSC7DV54.js").then((t30) => t30.e)], ["et-ee", () => import("./et_EE-VQ3DKX3T.js").then((t30) => t30.e)], ["fi-fi", () => import("./fi_FI-PODKKXDJ.js").then((t30) => t30.f)], ["fr-fr", () => import("./fr_FR-Z2XACOSY.js").then((t30) => t30.f)], ["he-il", () => import("./he_IL-LWCSGSX3.js").then((t30) => t30.h)], ["hr-hr", () => import("./hr_HR-GYUE3JWA.js").then((t30) => t30.h)], ["hu-hu", () => import("./hu_HU-I4BKZSC2.js").then((t30) => t30.h)], ["id-id", () => import("./id_ID-RBEBXLW3.js").then((t30) => t30.i)], ["it-it", () => import("./it_IT-WLLSAQBD.js").then((t30) => t30.i)], ["ja-jp", () => import("./ja_JP-J5NDZQQC.js").then((t30) => t30.j)], ["ko-kr", () => import("./ko_KR-Y5FYPTOZ.js").then((t30) => t30.k)], ["lt-lt", () => import("./lt_LT-XEPAGPEE.js").then((t30) => t30.l)], ["lv-lv", () => import("./lv_LV-ARNCNOSV.js").then((t30) => t30.l)], ["nb-no", () => import("./nb_NO-XQ3O6TPF.js").then((t30) => t30.n)], ["nl-nl", () => import("./nl_NL-DKSH4YW4.js").then((t30) => t30.n)], ["pl-pl", () => import("./pl_PL-PLPYYV76.js").then((t30) => t30.p)], ["pt-br", () => import("./pt_BR-GSDY4JGT.js").then((t30) => t30.p)], ["pt-pt", () => import("./pt_PT-ODWM7E2Z.js").then((t30) => t30.p)], ["ro-ro", () => import("./ro_RO-EUAQRU7A.js").then((t30) => t30.r)], ["ru-ru", () => import("./ru_RU-JIQUMLUM.js").then((t30) => t30.r)], ["sk-sk", () => import("./sk_SK-SKF3LWQI.js").then((t30) => t30.s)], ["sl-sl", () => import("./sl_SL-FPS6ZGCD.js").then((t30) => t30.s)], ["sr-rs", () => import("./sr_RS-P3F33WNK.js").then((t30) => t30.s)], ["sv-se", () => import("./sv_SE-BY4A37GO.js").then((t30) => t30.s)], ["th-th", () => import("./th_TH-W4MLRMF7.js").then((t30) => t30.t)], ["tr-tr", () => import("./tr_TR-6VIW4JQG.js").then((t30) => t30.t)], ["uk-ua", () => import("./uk_UA-V4NQ25NK.js").then((t30) => t30.u)], ["vi-vn", () => import("./vi_VN-4XB3H2YH.js").then((t30) => t30.v)], ["zh-cn", () => import("./zh_Hans-VXRZGNKY.js").then((t30) => t30.z)], ["zh-hk", () => import("./zh_Hant-HWP3AJ4H.js").then((t30) => t30.z)], ["zh-tw", () => import("./zh_Hant-HWP3AJ4H.js").then((t30) => t30.z)]]);
function e14(t30) {
  const s27 = t30.split("-")[0].toLowerCase();
  let n31 = null;
  for (const e24 of h8.keys())
    if (e24.startsWith(s27)) {
      n31 = e24;
      break;
    }
  return n31;
}
function r13(t30) {
  return t30 ? h8.has(t30.toLowerCase()) ? t30.toLowerCase() : e14(t30) || n14 : n14;
}
var o9 = null;
var i14 = null;
async function u7(t30 = l2()) {
  if (t30 = r13(t30), o9 && t30 === i14)
    return o9;
  o9 = import("./chunks-XPTWY6UL.js").then((t31) => t31.i), i14 = t30;
  try {
    const [s27, n31] = await Promise.all([o9, h8.get(i14)()]);
    i14 === t30 && (s27.am4core.options.defaultLocale = n31.default), s27.am4core.options.suppressWarnings = true, s27.am4core.options.autoDispose = true;
  } catch {
    return o9 = null, i14 = null, null;
  }
  return o9;
}
function c18(s27, n31 = "default") {
  const h20 = e13.find((t30) => t30.name === n31);
  return h20 ? h20.colors.map((t30) => s27.color(t30)) : null;
}

// node_modules/@arcgis/core/widgets/Feature/FeatureMedia.js
var M5 = "esri-feature-media";
var I5 = { base: M5, mediaContainer: `${M5}__container`, mediaItemContainer: `${M5}__item-container`, mediaItem: `${M5}__item`, mediaItemTitle: `${M5}__item-title`, mediaItemCaption: `${M5}__item-caption`, mediaPrevious: `${M5}__previous`, mediaPreviousIconLTR: `${M5}__previous-icon`, mediaPreviousIconRTL: `${M5}__previous-icon--rtl`, mediaNext: `${M5}__next`, mediaNextIconLTR: `${M5}__next-icon`, mediaNextIconRTL: `${M5}__next-icon--rtl`, mediaChart: `${M5}__chart`, mediaButton: `${M5}__button`, mediaIcon: `${M5}__icon`, iconLeftTriangleArrow: "esri-icon-left-triangle-arrow", iconRightTriangleArrow: "esri-icon-right-triangle-arrow" };
var _4 = 0.05;
var g7 = 0.95;
var w11 = 15;
var y7 = "color";
var T5 = "tooltip";
var b9 = "value";
var C3 = "default-line-value";
var x3 = class extends W {
  constructor(e24, t30) {
    super(e24, t30), this._refreshTimer = null, this._refreshIntervalInfo = null, this._featureElementInfo = null, this.viewModel = new M4(), this.messages = null, this._getChartDependencies = async (e25) => {
      const t31 = await u7(), { destroyed: i34, viewModel: r24 } = this;
      if (i34 || !r24 || !e25)
        return;
      const { activeMediaInfo: s27 } = r24, a34 = await this._getRendererColors(t31);
      this._renderChart({ chartDiv: e25, mediaInfo: s27, chartsModule: t31, colorMap: a34 });
    };
  }
  initialize() {
    this._featureElementInfo = new l10(), this.addHandles([l3(() => {
      var _a, _b;
      return [(_a = this.viewModel) == null ? void 0 : _a.activeMediaInfo, (_b = this.viewModel) == null ? void 0 : _b.activeMediaInfoIndex];
    }, () => this._setupMediaRefreshTimer(), h), l3(() => {
      var _a, _b;
      return [(_a = this.viewModel) == null ? void 0 : _a.description, (_b = this.viewModel) == null ? void 0 : _b.title];
    }, () => this._setupFeatureElementInfo(), h)]);
  }
  destroy() {
    var _a;
    this._clearMediaRefreshTimer(), (_a = this._featureElementInfo) == null ? void 0 : _a.destroy();
  }
  get attributes() {
    return this.viewModel.attributes;
  }
  set attributes(e24) {
    this.viewModel.attributes = e24;
  }
  get activeMediaInfoIndex() {
    return this.viewModel.activeMediaInfoIndex;
  }
  set activeMediaInfoIndex(e24) {
    this.viewModel.activeMediaInfoIndex = e24;
  }
  get description() {
    return this.viewModel.description;
  }
  set description(e24) {
    this.viewModel.description = e24;
  }
  get fieldInfoMap() {
    return this.viewModel.fieldInfoMap;
  }
  set fieldInfoMap(e24) {
    this.viewModel.fieldInfoMap = e24;
  }
  get layer() {
    return this.viewModel.layer;
  }
  set layer(e24) {
    this.viewModel.layer = e24;
  }
  get mediaInfos() {
    return this.viewModel.mediaInfos;
  }
  set mediaInfos(e24) {
    this.viewModel.mediaInfos = e24;
  }
  get popupTemplate() {
    return this.viewModel.popupTemplate;
  }
  set popupTemplate(e24) {
    this.viewModel.popupTemplate = e24;
  }
  get relatedInfos() {
    return this.viewModel.relatedInfos;
  }
  set relatedInfos(e24) {
    this.viewModel.relatedInfos = e24;
  }
  get title() {
    return this.viewModel.title;
  }
  set title(e24) {
    this.viewModel.title = e24;
  }
  render() {
    var _a;
    return n5("div", { bind: this, class: I5.base, onkeyup: this._handleMediaKeyup }, (_a = this._featureElementInfo) == null ? void 0 : _a.render(), this.renderMedia());
  }
  renderMedia() {
    const { formattedMediaInfoCount: e24 } = this.viewModel;
    return e24 ? n5("div", { key: "media-element-container", class: I5.mediaContainer }, this.renderMediaPageButton("previous"), this.renderMediaInfo(), this.renderMediaPageButton("next")) : null;
  }
  renderImageMediaInfo(e24) {
    const { _refreshIntervalInfo: t30 } = this, { activeMediaInfoIndex: i34, formattedMediaInfoCount: r24 } = this.viewModel, { value: s27, refreshInterval: a34, altText: o27, title: n31, type: l25 } = e24, { sourceURL: d18, linkURL: u21 } = s27, m25 = C2(u21 ?? void 0) ? "_blank" : "_self", h20 = "_blank" === m25 ? "noreferrer" : "", p30 = a34 ? t30 : null, v16 = p30 ? p30.timestamp : 0, M7 = p30 ? p30.sourceURL : d18, I7 = n5("img", { alt: o27 || n31, key: `media-${l25}-${i34}-${r24}-${v16}`, src: M7 ?? void 0 }), _10 = u21 ? n5("a", { title: n31, href: u21, rel: h20, target: m25 }, I7) : null;
    return _10 || I7;
  }
  renderChartMediaInfo(e24) {
    const { activeMediaInfoIndex: t30, formattedMediaInfoCount: i34 } = this.viewModel;
    return n5("div", { key: `media-${e24.type}-${t30}-${i34}`, bind: this, class: I5.mediaChart, afterCreate: this._getChartDependencies });
  }
  renderMediaInfoType() {
    const { activeMediaInfo: e24 } = this.viewModel;
    return e24 ? "image" === e24.type ? this.renderImageMediaInfo(e24) : e24.type.includes("chart") ? this.renderChartMediaInfo(e24) : null : null;
  }
  renderMediaInfo() {
    const { activeMediaInfo: e24 } = this.viewModel;
    if (!e24)
      return null;
    const t30 = e24.title ? n5("div", { key: "media-title", class: I5.mediaItemTitle, innerHTML: e24.title }) : null, i34 = e24.caption ? n5("div", { key: "media-caption", class: I5.mediaItemCaption, innerHTML: e24.caption }) : null;
    return n5("div", { key: "media-container", class: I5.mediaItemContainer }, n5("div", { key: "media-item-container", class: I5.mediaItem }, this.renderMediaInfoType()), t30, i34);
  }
  renderMediaPageButton(e24) {
    if (this.viewModel.formattedMediaInfoCount < 2)
      return null;
    const t30 = "previous" === e24, i34 = t30 ? this.messages.previous : this.messages.next, r24 = t30 ? this.classes(I5.mediaButton, I5.mediaPrevious) : this.classes(I5.mediaButton, I5.mediaNext), s27 = t30 ? this.classes(I5.mediaIcon, I5.mediaPreviousIconLTR, I5.iconLeftTriangleArrow) : this.classes(I5.mediaIcon, I5.mediaNextIconLTR, I5.iconRightTriangleArrow), a34 = t30 ? this.classes(I5.mediaIcon, I5.mediaPreviousIconRTL, I5.iconRightTriangleArrow) : this.classes(I5.mediaIcon, I5.mediaNextIconRTL, I5.iconLeftTriangleArrow), o27 = t30 ? "media-previous" : "media-next", n31 = t30 ? this._previous : this._next;
    return n5("button", { type: "button", key: o27, title: i34, "aria-label": i34, tabIndex: 0, class: r24, bind: this, onclick: n31 }, n5("span", { "aria-hidden": "true", class: s27 }), n5("span", { "aria-hidden": "true", class: a34 }));
  }
  _setupFeatureElementInfo() {
    var _a;
    const { description: e24, title: t30 } = this;
    (_a = this._featureElementInfo) == null ? void 0 : _a.set({ description: e24, title: t30 });
  }
  _next() {
    this.viewModel.next();
  }
  _previous() {
    this.viewModel.previous();
  }
  _getRenderer() {
    const { isAggregate: e24, layer: t30 } = this.viewModel;
    return e24 && (t30 == null ? void 0 : t30.featureReduction) && "renderer" in t30.featureReduction ? t30.featureReduction.renderer : t30 == null ? void 0 : t30.renderer;
  }
  async _getRendererColors(e24) {
    const { am4core: t30 } = e24, i34 = /* @__PURE__ */ new Map(), r24 = this._getRenderer(), s27 = "default";
    if (!r24)
      return i34;
    const a34 = await b5(r24);
    a34.delete(s27);
    return Array.from(a34.values()).every((e25) => 1 === (e25 == null ? void 0 : e25.length)) ? (i34.set(C3, t30.color({ r: 50, g: 50, b: 50, a: 1 })), Array.from(a34.keys()).forEach((e25) => {
      var _a;
      e25 && i34.set(e25, t30.color((_a = a34.get(e25)) == null ? void 0 : _a[0].toCss(true)));
    }), i34) : i34;
  }
  _handleMediaKeyup(e24) {
    const i34 = i2(e24);
    "ArrowLeft" === i34 && (e24.stopPropagation(), this.viewModel.previous()), "ArrowRight" === i34 && (e24.stopPropagation(), this.viewModel.next());
  }
  _renderChart(e24) {
    const { abilities: t30 } = this.viewModel, { chartsModule: i34, chartDiv: r24, mediaInfo: s27, colorMap: a34 } = e24, { value: o27, type: n31 } = s27, { am4core: l25 } = i34, d18 = c18(l25);
    function c37(e25) {
      e25 instanceof l25.ColorSet && d18 && (e25.list = d18);
    }
    r6() && l25.useTheme(i34.am4themes_dark);
    const u21 = window.matchMedia("(prefers-reduced-motion: reduce)");
    t30.chartAnimation && !u21.matches ? l25.useTheme(i34.am4themes_animated) : l25.unuseTheme(i34.am4themes_animated), l25.useTheme(c37);
    const h20 = "pie-chart" === n31 ? this._createPieChart(e24) : this._createXYChart(e24);
    r24.setAttribute("aria-label", s27.altText || s27.title), h20.data = o27.series.map((e25) => ({ [T5]: e25.tooltip, [b9]: e25.value, [y7]: a34.get(e25.fieldName) })).filter((e25) => "pie-chart" !== n31 || null != e25.value && e25.value > 0);
  }
  _customizeChartTooltip(e24, t30) {
    e24 && (e24.label.wrap = true, e24.label.maxWidth = 200, e24.autoTextColor = false, e24.getFillFromObject = false, e24.label.fill = t30.color("#ffffff"), e24.background.fill = t30.color({ r: 0, g: 0, b: 0, a: 0.7 }));
  }
  _createPieChart(e24) {
    const { chartDiv: t30, chartsModule: i34 } = e24, { am4core: r24, am4charts: s27 } = i34, a34 = r24.create(t30, s27.PieChart);
    a34.rtl = f4(this.container);
    const o27 = a34.series.push(new s27.PieSeries());
    return o27.labels.template.disabled = true, o27.ticks.template.disabled = true, o27.dataFields.value = b9, o27.dataFields.category = T5, this._customizeChartTooltip(o27.tooltip, r24), o27.slices.template.propertyFields.fill = y7, o27.slices.template.propertyFields.stroke = y7, a34;
  }
  _getMinSeriesValue(e24) {
    let t30 = 0;
    return e24.forEach((e25) => t30 = Math.min(e25.value, t30)), t30;
  }
  _createColumnChart(e24, t30) {
    const { chartsModule: i34, mediaInfo: r24 } = t30, { value: s27 } = r24, { am4core: a34, am4charts: o27 } = i34, n31 = e24.xAxes.push(new o27.CategoryAxis());
    n31.dataFields.category = T5, n31.renderer.labels.template.disabled = true;
    const l25 = n31.tooltip;
    this._customizeChartTooltip(l25, a34), l25.events.on("sizechanged", () => {
      l25.dy = -l25.contentHeight;
    });
    const d18 = e24.yAxes.push(new o27.ValueAxis()), c37 = d18.renderer.labels.template;
    d18.renderer.minLabelPosition = _4, d18.renderer.maxLabelPosition = g7, d18.min = this._getMinSeriesValue(s27.series), this._customizeChartTooltip(d18.tooltip, a34), c37.wrap = true;
    const u21 = e24.series.push(new o27.ColumnSeries());
    u21.dataFields.valueY = b9, u21.dataFields.categoryX = T5, u21.columns.template.propertyFields.fill = y7, u21.columns.template.propertyFields.stroke = y7, e24.cursor = new o27.XYCursor(), s27.series.length > w11 && (e24.scrollbarX = new a34.Scrollbar());
  }
  _createBarChart(e24, t30) {
    const { chartsModule: i34, mediaInfo: r24 } = t30, { value: s27 } = r24, { am4core: a34, am4charts: o27 } = i34, n31 = e24.yAxes.push(new o27.CategoryAxis());
    n31.dataFields.category = T5, n31.renderer.inversed = true, n31.renderer.labels.template.disabled = true;
    const l25 = n31.tooltip;
    this._customizeChartTooltip(l25, a34), l25.events.on("sizechanged", () => {
      l25.dx = l25.contentWidth;
    });
    const d18 = e24.xAxes.push(new o27.ValueAxis()), c37 = d18.renderer.labels.template;
    d18.renderer.minLabelPosition = _4, d18.renderer.maxLabelPosition = g7, d18.min = this._getMinSeriesValue(s27.series), this._customizeChartTooltip(d18.tooltip, a34), c37.wrap = true;
    const u21 = e24.series.push(new o27.ColumnSeries());
    u21.dataFields.valueX = b9, u21.dataFields.categoryY = T5, u21.columns.template.propertyFields.fill = y7, u21.columns.template.propertyFields.stroke = y7, e24.cursor = new o27.XYCursor(), s27.series.length > w11 && (e24.scrollbarY = new a34.Scrollbar());
  }
  _createLineChart(e24, t30) {
    const { chartsModule: i34, mediaInfo: r24, colorMap: s27 } = t30, { value: a34 } = r24, { am4core: o27, am4charts: n31 } = i34, l25 = e24.xAxes.push(new n31.CategoryAxis());
    l25.dataFields.category = T5, l25.renderer.labels.template.disabled = true;
    const d18 = l25.tooltip;
    this._customizeChartTooltip(d18, o27), d18.events.on("sizechanged", () => {
      d18.dy = -d18.contentHeight;
    });
    const c37 = e24.yAxes.push(new n31.ValueAxis()), u21 = c37.renderer.labels.template;
    c37.renderer.minLabelPosition = _4, c37.renderer.maxLabelPosition = g7, c37.min = this._getMinSeriesValue(a34.series), this._customizeChartTooltip(c37.tooltip, o27), u21.wrap = true;
    const m25 = e24.series.push(new n31.LineSeries());
    m25.dataFields.categoryX = T5, m25.dataFields.valueY = b9, m25.strokeWidth = 1;
    const h20 = s27.get(C3);
    h20 && (m25.stroke = h20);
    const p30 = m25.bullets.push(new n31.CircleBullet());
    p30.propertyFields.fill = y7, p30.propertyFields.stroke = y7, e24.cursor = new n31.XYCursor(), a34.series.length > w11 && (e24.scrollbarX = new o27.Scrollbar());
  }
  _createXYChart(e24) {
    const { chartDiv: t30, chartsModule: i34, mediaInfo: r24 } = e24, { type: s27 } = r24, { am4core: a34, am4charts: o27 } = i34, n31 = a34.create(t30, o27.XYChart);
    return n31.rtl = f4(this.container), "column-chart" === s27 && this._createColumnChart(n31, e24), "bar-chart" === s27 && this._createBarChart(n31, e24), "line-chart" === s27 && this._createLineChart(n31, e24), n31;
  }
  _clearMediaRefreshTimer() {
    const { _refreshTimer: e24 } = this;
    e24 && (clearTimeout(e24), this._refreshTimer = null);
  }
  _updateMediaInfoTimestamp(e24) {
    const t30 = Date.now();
    this._refreshIntervalInfo = { timestamp: t30, sourceURL: e24 && this._getImageSource(e24, t30) }, this.scheduleRender();
  }
  _setupMediaRefreshTimer() {
    this._clearMediaRefreshTimer();
    const { activeMediaInfo: e24 } = this.viewModel;
    e24 && "image" === e24.type && e24.refreshInterval && this._setRefreshTimeout(e24);
  }
  _setRefreshTimeout(e24) {
    const { refreshInterval: t30, value: i34 } = e24;
    if (!t30)
      return;
    const r24 = 6e4 * t30;
    this._updateMediaInfoTimestamp(i34.sourceURL);
    const s27 = setInterval(() => {
      this._updateMediaInfoTimestamp(i34.sourceURL);
    }, r24);
    this._refreshTimer = s27;
  }
  _getImageSource(e24, t30) {
    const i34 = e24.includes("?") ? "&" : "?", [r24, s27 = ""] = e24.split("#");
    return `${r24}${i34}timestamp=${t30}${s27 ? "#" : ""}${s27}`;
  }
};
e([y2()], x3.prototype, "attributes", null), e([y2()], x3.prototype, "activeMediaInfoIndex", null), e([y2()], x3.prototype, "description", null), e([y2()], x3.prototype, "fieldInfoMap", null), e([y2()], x3.prototype, "layer", null), e([y2()], x3.prototype, "mediaInfos", null), e([y2()], x3.prototype, "popupTemplate", null), e([y2()], x3.prototype, "relatedInfos", null), e([y2()], x3.prototype, "title", null), e([y2({ type: M4 })], x3.prototype, "viewModel", void 0), e([y2(), e4("esri/widgets/Feature/t9n/Feature")], x3.prototype, "messages", void 0), x3 = e([a3("esri.widgets.Feature.FeatureMedia")], x3);
var R7 = x3;

// node_modules/@arcgis/core/widgets/Feature/support/arcadeFeatureUtils.js
var n15 = ["$datastore", "$map", "$layer", "$aggregatedfeatures"];
var s14 = "esri.widgets.Feature.support.arcadeFeatureUtils";
var o10 = s2.getLogger(s14);
function c19(e24) {
  return "string" == typeof e24 ? re(te(e24)) : Array.isArray(e24) ? p10(e24) : "esri.arcade.Dictionary" === (e24 == null ? void 0 : e24.declaredClass) ? l14(e24) : e24;
}
function p10(e24) {
  return `<ul class="esri-widget__list">${e24.map((e25) => `<li>${"string" == typeof e25 ? re(te(e25)) : e25}</li>`).join("")}</ul>`;
}
function l14(e24) {
  return `<table class="esri-widget__table">${e24.keys().map((r24) => {
    const t30 = e24.field(r24);
    return `<tr><th>${r24}</th><td>${"string" == typeof t30 ? re(te(t30)) : t30}</td></tr>`;
  }).join("")}</table>`;
}
function u8({ aggregatedFeatures: e24, arcadeUtils: r24, featureSetVars: a34, context: i34, viewInfo: n31, map: s27, graphic: o27, interceptor: c37 }) {
  a34.forEach((a35) => {
    const p30 = a35.toLowerCase(), l25 = n31.sr, u21 = { map: s27, spatialReference: l25, interceptor: c37 };
    if ("$map" === p30 && (i34.vars[p30] = r24.convertMapToFeatureSetCollection(u21)), "$layer" === p30 && (i34.vars[p30] = r24.convertFeatureLayerToFeatureSet({ layer: o27.sourceLayer, spatialReference: l25, interceptor: c37 })), "$datastore" === p30 && (i34.vars[p30] = r24.convertServiceUrlToWorkspace({ url: o27.sourceLayer.url, spatialReference: l25, interceptor: c37 })), "$aggregatedfeatures" === p30) {
      const a36 = o27.layer, { fields: n32, objectIdField: s28, geometryType: l26, spatialReference: u22, displayField: f18 } = a36, g17 = new He({ fields: n32, objectIdField: s28, geometryType: l26, spatialReference: u22, displayField: f18, ..."feature" === a36.type ? { templates: a36.templates, typeIdField: a36.typeIdField, types: a36.types } : null, source: e24 });
      i34.vars[p30] = r24.convertFeatureLayerToFeatureSet({ layer: g17, spatialReference: u22, interceptor: c37 });
    }
  });
}
function f10() {
  return import("./arcadeUtils-S4AZ7ZVE.js");
}
function g8(e24) {
  return "createQuery" in e24 && "queryFeatures" in e24;
}
async function y8({ graphic: e24, view: r24 }) {
  const { isAggregate: t30, layer: a34 } = e24;
  if (!t30 || !a34 || "2d" !== (r24 == null ? void 0 : r24.type))
    return [];
  const i34 = await r24.whenLayerView(a34);
  if (!g8(i34))
    return [];
  const n31 = i34.createQuery(), s27 = e24.getObjectId();
  n31.aggregateIds = null != s27 ? [s27] : [];
  const { features: o27 } = await i34.queryFeatures(n31);
  return o27;
}
async function d7({ expressionInfo: e24, arcadeUtils: r24, interceptor: t30, spatialReference: a34, map: i34, graphic: s27, view: c37 }) {
  if (!e24 || !e24.expression)
    return null;
  const p30 = r24.createSyntaxTree(e24.expression), l25 = n15.filter((e25) => r24.hasVariable(p30, e25)), [f18] = await Promise.all([y8({ graphic: s27, view: c37 }), r24.loadScriptDependencies(p30, true, l25)]), g17 = r24.getViewInfo({ spatialReference: a34 }), d18 = r24.createExecContext(s27, g17);
  d18.interceptor = t30, d18.useAsync = true, u8({ aggregatedFeatures: f18, arcadeUtils: r24, featureSetVars: l25, context: d18, viewInfo: g17, map: i34, graphic: s27, interceptor: t30 });
  const m25 = r24.createFunction(p30, d18);
  return r24.executeAsyncFunction(m25, d18).catch((r25) => o10.error("arcade-execution-error", { error: r25, graphic: s27, expressionInfo: e24 }));
}
async function m11({ expressionInfos: e24, spatialReference: t30, graphic: a34, interceptor: i34, map: n31, view: s27 }) {
  if (!e24 || !e24.length)
    return {};
  const o27 = await f10(), p30 = {};
  for (const r24 of e24)
    p30[`expression/${r24.name}`] = d7({ expressionInfo: r24, arcadeUtils: o27, interceptor: i34, spatialReference: t30, map: n31, graphic: a34, view: s27 });
  const l25 = await E(p30), u21 = {};
  for (const r24 in l25)
    u21[r24] = c19(l25[r24].value);
  return u21;
}

// node_modules/@arcgis/core/widgets/Feature/FeatureExpression/FeatureExpressionViewModel.js
var w12 = 1;
var j8 = class extends a9(v3) {
  constructor(t30) {
    super(t30), this._abortController = null, this.expressionInfo = null, this.graphic = null, this.contentElement = null, this.contentElementViewModel = null, this.interceptor = null, this.view = null, this._cancelQuery = () => {
      const { _abortController: t31 } = this;
      t31 && t31.abort(), this._abortController = null;
    }, this._createVM = () => {
      var _a, _b;
      const t31 = (_a = this.contentElement) == null ? void 0 : _a.type;
      (_b = this.contentElementViewModel) == null ? void 0 : _b.destroy();
      const e24 = "fields" === t31 ? new n13() : "media" === t31 ? new M4() : "text" === t31 ? new l11() : null;
      this._set("contentElementViewModel", e24);
    }, this._compile = async () => {
      this._cancelQuery();
      const t31 = new AbortController();
      this._abortController = t31, await this._compileExpression(), this._abortController === t31 && (this._abortController = null);
    }, this._compileThrottled = e9(this._compile, w12, this), this._compileExpression = async () => {
      const { expressionInfo: t31, graphic: e24, interceptor: o27, spatialReference: r24, map: n31, view: s27, _abortController: i34 } = this;
      if (!(t31 && e24 && r24 && n31))
        return void this._set("contentElement", null);
      const l25 = await f10();
      if (i34 !== this._abortController)
        return;
      const p30 = await d7({ arcadeUtils: l25, expressionInfo: t31, graphic: e24, interceptor: o27, map: n31, spatialReference: r24, view: s27 });
      if (!p30 || "esri.arcade.Dictionary" !== p30.declaredClass)
        return void this._set("contentElement", null);
      const h20 = await p30.castAsJsonAsync(i34 == null ? void 0 : i34.signal), u21 = h20 == null ? void 0 : h20.type, d18 = "media" === u21 ? I.fromJSON(h20) : "text" === u21 ? c6.fromJSON(h20) : "fields" === u21 ? c5.fromJSON(h20) : null;
      this._set("contentElement", d18);
    }, this.handles.add([l3(() => [this.expressionInfo, this.graphic, this.map, this.spatialReference, this.view], () => this._compileThrottled(), h), l3(() => [this.contentElement], () => this._createVM(), h)]);
  }
  destroy() {
    var _a;
    this._cancelQuery(), (_a = this.contentElementViewModel) == null ? void 0 : _a.destroy(), this._set("contentElementViewModel", null), this._set("contentElement", null);
  }
  get spatialReference() {
    var _a;
    return ((_a = this.view) == null ? void 0 : _a.spatialReference) ?? null;
  }
  set spatialReference(t30) {
    this._override("spatialReference", t30);
  }
  get state() {
    const { _abortController: t30, contentElement: e24, contentElementViewModel: o27 } = this;
    return t30 ? "loading" : e24 || o27 ? "ready" : "disabled";
  }
  get map() {
    var _a;
    return ((_a = this.view) == null ? void 0 : _a.map) ?? null;
  }
  set map(t30) {
    this._override("map", t30);
  }
};
e([y2()], j8.prototype, "_abortController", void 0), e([y2({ type: i8 })], j8.prototype, "expressionInfo", void 0), e([y2({ type: g3 })], j8.prototype, "graphic", void 0), e([y2({ readOnly: true })], j8.prototype, "contentElement", void 0), e([y2({ readOnly: true })], j8.prototype, "contentElementViewModel", void 0), e([y2()], j8.prototype, "interceptor", void 0), e([y2()], j8.prototype, "spatialReference", null), e([y2({ readOnly: true })], j8.prototype, "state", null), e([y2()], j8.prototype, "map", null), e([y2()], j8.prototype, "view", void 0), j8 = e([a3("esri.widgets.Feature.FeatureExpression.FeatureExpressionViewModel")], j8);
var C4 = j8;

// node_modules/@arcgis/core/widgets/Feature/FeatureExpression.js
var c20 = { iconLoading: "esri-icon-loading-indicator esri-rotating", base: "esri-feature-expression", loadingSpinnerContainer: "esri-feature__loading-container", spinner: "esri-feature__loading-spinner" };
var u9 = class extends W {
  constructor(e24, t30) {
    super(e24, t30), this._contentWidget = null, this.viewModel = new C4();
  }
  initialize() {
    this.addHandles(l3(() => {
      var _a;
      return (_a = this.viewModel) == null ? void 0 : _a.contentElementViewModel;
    }, () => this._setupExpressionWidget(), h));
  }
  destroy() {
    this._destroyContentWidget();
  }
  renderLoading() {
    return n5("div", { key: "loading-container", class: c20.loadingSpinnerContainer }, n5("span", { class: this.classes(c20.iconLoading, c20.spinner) }));
  }
  render() {
    var _a;
    const { state: e24 } = this.viewModel;
    return n5("div", { class: c20.base }, "loading" === e24 ? this.renderLoading() : "disabled" === e24 ? null : (_a = this._contentWidget) == null ? void 0 : _a.render());
  }
  _destroyContentWidget() {
    const { _contentWidget: e24 } = this;
    e24 && (e24.viewModel = null, e24.destroy()), this._contentWidget = null;
  }
  _setupExpressionWidget() {
    const { contentElementViewModel: e24, contentElement: t30 } = this.viewModel, s27 = t30 == null ? void 0 : t30.type;
    this._destroyContentWidget();
    const i34 = e24 ? "fields" === s27 ? new c16({ viewModel: e24 }) : "media" === s27 ? new R7({ viewModel: e24 }) : "text" === s27 ? new p8({ viewModel: e24 }) : null : null;
    this._contentWidget = i34, this.scheduleRender();
  }
};
e([y2({ type: C4 })], u9.prototype, "viewModel", void 0), u9 = e([a3("esri.widgets.Feature.FeatureExpression")], u9);
var m12 = u9;

// node_modules/@arcgis/core/widgets/Feature/FeatureRelationship/FeatureRelationshipViewModel.js
var b10 = 100;
var F4 = class extends i3(s9(a9(v3))) {
  constructor(e24) {
    super(e24), this._queryAbortController = null, this._queryPageAbortController = null, this._queryFeatureCountAbortController = null, this.featuresPerPage = 10, this.description = null, this.graphic = null, this.layer = null, this.map = null, this.orderByFields = null, this.featureCount = 0, this.relationshipId = null, this.showAllEnabled = false, this.title = null, this._cancelQuery = () => {
      const { _queryAbortController: e25 } = this;
      e25 && e25.abort(), this._queryAbortController = null;
    }, this._cancelQueryFeatureCount = () => {
      const { _queryFeatureCountAbortController: e25 } = this;
      e25 && e25.abort(), this._queryFeatureCountAbortController = null;
    }, this._cancelQueryPage = () => {
      const { _queryPageAbortController: e25 } = this;
      e25 && e25.abort(), this._queryPageAbortController = null;
    }, this._queryController = async () => {
      this._cancelQuery();
      const e25 = new AbortController();
      this._queryAbortController = e25, await g(this._query()), this._queryAbortController === e25 && (this._queryAbortController = null);
    }, this._queryFeatureCountController = async () => {
      this._cancelQueryFeatureCount();
      const e25 = new AbortController();
      this._queryFeatureCountAbortController = e25, await g(this._queryFeatureCount()), this._queryFeatureCountAbortController === e25 && (this._queryFeatureCountAbortController = null);
    }, this._queryPageController = async () => {
      const e25 = new AbortController();
      this._queryPageAbortController = e25, await g(this._queryPage()), this._queryPageAbortController === e25 && (this._queryPageAbortController = null);
    }, this._queryThrottled = e9(this._queryController, b10, this), this._queryFeatureCountThrottled = e9(this._queryFeatureCountController, b10, this), this._queryPageThrottled = e9(this._queryPageController, b10, this), this._query = async () => {
      const { _queryAbortController: e25, relatedFeatures: t30 } = this;
      this._destroyRelatedFeatureViewModels(), this.featurePage = 1, t30.removeAll(), t30.addMany(this._sliceFeatures(await this._queryRelatedFeatures({ signal: e25 == null ? void 0 : e25.signal })));
    }, this.handles.add([l3(() => [this.displayCount, this.graphic, this.layer, this.map, this.orderByFieldsFixedCasing, this.relationshipId, this.featuresPerPage, this.showAllEnabled, this.canQuery, this.featureCount], () => this._queryThrottled(), h), l3(() => [this.featurePage, this.showAllEnabled], () => this._queryPageThrottled()), l3(() => [this.layer, this.relationshipId, this.objectId, this.canQuery], () => this._queryFeatureCountThrottled())]);
  }
  destroy() {
    this._destroyRelatedFeatureViewModels(), this.relatedFeatures.removeAll(), this._cancelQuery(), this._cancelQueryFeatureCount(), this._cancelQueryPage();
  }
  set featurePage(e24) {
    const { featuresPerPage: t30, featureCount: r24 } = this, o27 = 1, l25 = Math.ceil(r24 / t30) || 1;
    this._set("featurePage", Math.min(Math.max(e24, o27), l25));
  }
  get featurePage() {
    return this._get("featurePage");
  }
  get orderByFieldsFixedCasing() {
    const { orderByFields: e24, relatedLayer: t30 } = this;
    return e24 && (t30 == null ? void 0 : t30.loaded) ? e24.map((e25) => {
      const r24 = e25.clone(), o27 = L4(e25.field, t30);
      return r24.field = o27, r24;
    }) : e24 ?? [];
  }
  get supportsCacheHint() {
    var _a, _b, _c;
    return !!((_c = (_b = (_a = this.layer) == null ? void 0 : _a.capabilities) == null ? void 0 : _b.queryRelated) == null ? void 0 : _c.supportsCacheHint);
  }
  get canQuery() {
    var _a, _b;
    const e24 = (_b = (_a = this.layer) == null ? void 0 : _a.capabilities) == null ? void 0 : _b.queryRelated;
    return !!(this.relatedLayer && this.relationship && "number" == typeof this.relationshipId && "number" == typeof this.objectId && (e24 == null ? void 0 : e24.supportsCount) && (e24 == null ? void 0 : e24.supportsPagination));
  }
  get itemDescriptionFieldName() {
    var _a, _b;
    return ((_b = (_a = this.orderByFieldsFixedCasing) == null ? void 0 : _a[0]) == null ? void 0 : _b.field) || null;
  }
  set displayCount(e24) {
    const t30 = 0, r24 = 10;
    this._set("displayCount", Math.min(Math.max(e24, t30), r24));
  }
  get displayCount() {
    return this._get("displayCount");
  }
  get objectId() {
    var _a, _b;
    return (this.objectIdField && ((_b = (_a = this.graphic) == null ? void 0 : _a.attributes) == null ? void 0 : _b[this.objectIdField])) ?? null;
  }
  get objectIdField() {
    var _a;
    return ((_a = this.layer) == null ? void 0 : _a.objectIdField) || null;
  }
  get relatedFeatures() {
    return this._get("relatedFeatures") || new j2();
  }
  get relatedLayer() {
    const { layer: e24, map: t30, relationship: r24 } = this;
    return (e24 == null ? void 0 : e24.loaded) && t30 && r24 ? ge(t30, e24, r24) ?? null : null;
  }
  get relationship() {
    var _a;
    const { relationshipId: e24, layer: t30 } = this;
    return "number" == typeof e24 ? ((_a = t30 == null ? void 0 : t30.relationships) == null ? void 0 : _a.find(({ id: t31 }) => t31 === e24)) ?? null : null;
  }
  get relatedFeatureViewModels() {
    return this._get("relatedFeatureViewModels") || new j2();
  }
  get state() {
    const { _queryAbortController: e24, _queryFeatureCountAbortController: t30, _queryPageAbortController: r24, canQuery: o27 } = this;
    return t30 ? "loading" : e24 || r24 ? "querying" : o27 ? "ready" : "disabled";
  }
  _destroyRelatedFeatureViewModels() {
    var _a;
    (_a = this.relatedFeatureViewModels) == null ? void 0 : _a.forEach((e24) => !e24.destroyed && e24.destroy()), this.relatedFeatureViewModels.removeAll();
  }
  async _queryFeatureCount() {
    const { layer: e24, relatedLayer: t30, relationshipId: r24, objectId: o27, _queryFeatureCountAbortController: l25, canQuery: s27, supportsCacheHint: a34 } = this;
    if (await (e24 == null ? void 0 : e24.load()), await (t30 == null ? void 0 : t30.load()), !s27 || !e24 || !t30)
      return void this._set("featureCount", 0);
    const n31 = t30.createQuery(), u21 = new d3({ cacheHint: a34, relationshipId: r24, returnGeometry: false, objectIds: [o27], where: s(n31.where, void 0) }), d18 = await e24.queryRelatedFeaturesCount(u21, { signal: l25 == null ? void 0 : l25.signal });
    this._set("featureCount", d18[o27] || 0);
  }
  _sliceFeatures(e24) {
    const { showAllEnabled: t30, displayCount: r24 } = this;
    return t30 ? e24 : r24 ? e24.slice(0, r24) : [];
  }
  async _queryPage() {
    const { relatedFeatures: e24, featurePage: t30, showAllEnabled: r24, _queryPageAbortController: o27 } = this;
    !r24 || t30 < 2 || e24.addMany(await this._queryRelatedFeatures({ signal: o27 == null ? void 0 : o27.signal }));
  }
  async _queryRelatedFeatures(e24) {
    var _a;
    const { orderByFieldsFixedCasing: t30, showAllEnabled: r24, featuresPerPage: o27, displayCount: l25, layer: s27, relationshipId: a34, featurePage: u21, featureCount: d18, relatedLayer: y16, supportsCacheHint: h20 } = this, { canQuery: p30, objectId: c37 } = this;
    if (!p30 || !s27 || !y16)
      return [];
    const _10 = r24 ? ((u21 - 1) * o27 + d18) % d18 : 0, g17 = r24 ? o27 : l25, b17 = y16.objectIdField, F7 = [...t30 == null ? void 0 : t30.map((e25) => e25.field), b17].filter(r), m25 = t30 == null ? void 0 : t30.map((e25) => `${e25.field} ${e25.order}`), f18 = y16.createQuery(), q2 = new d3({ orderByFields: m25, start: _10, num: g17, outFields: F7, cacheHint: h20, relationshipId: a34, returnGeometry: false, objectIds: [c37], where: s(f18.where, void 0) }), A8 = ((_a = (await s27.queryRelatedFeatures(q2, { signal: e24 == null ? void 0 : e24.signal }))[c37]) == null ? void 0 : _a.features) || [];
    return A8.forEach((e25) => {
      e25.sourceLayer = y16, e25.layer = y16;
    }), A8;
  }
};
e([y2()], F4.prototype, "_queryAbortController", void 0), e([y2()], F4.prototype, "_queryPageAbortController", void 0), e([y2()], F4.prototype, "_queryFeatureCountAbortController", void 0), e([y2({ value: 1 })], F4.prototype, "featurePage", null), e([y2()], F4.prototype, "featuresPerPage", void 0), e([y2({ readOnly: true })], F4.prototype, "orderByFieldsFixedCasing", null), e([y2({ readOnly: true })], F4.prototype, "supportsCacheHint", null), e([y2({ readOnly: true })], F4.prototype, "canQuery", null), e([y2()], F4.prototype, "description", void 0), e([y2({ readOnly: true })], F4.prototype, "itemDescriptionFieldName", null), e([y2({ value: 3 })], F4.prototype, "displayCount", null), e([y2({ type: g3 })], F4.prototype, "graphic", void 0), e([y2()], F4.prototype, "layer", void 0), e([y2()], F4.prototype, "map", void 0), e([y2({ readOnly: true })], F4.prototype, "objectId", null), e([y2({ readOnly: true })], F4.prototype, "objectIdField", null), e([y2()], F4.prototype, "orderByFields", void 0), e([y2({ readOnly: true })], F4.prototype, "relatedFeatures", null), e([y2({ readOnly: true })], F4.prototype, "relatedLayer", null), e([y2({ readOnly: true })], F4.prototype, "relationship", null), e([y2()], F4.prototype, "featureCount", void 0), e([y2({ readOnly: true })], F4.prototype, "relatedFeatureViewModels", null), e([y2()], F4.prototype, "relationshipId", void 0), e([y2()], F4.prototype, "showAllEnabled", void 0), e([y2()], F4.prototype, "state", null), e([y2()], F4.prototype, "title", void 0), F4 = e([a3("esri.widgets.Feature.FeatureRelationship.FeatureRelationshipViewModel")], F4);
var m13 = F4;

// node_modules/@arcgis/core/widgets/Feature/FeatureRelationship.js
var g9 = "esri-feature";
var w13 = `${g9}-relationship`;
var b11 = { base: w13, esriWidget: "esri-widget", listContainer: `${w13}__list`, listContainerQuerying: `${w13}__list--querying`, featureObserver: `${g9}__feature-observer`, stickySpinnerContainer: `${g9}__sticky-loading-container`, loadingSpinnerContainer: `${g9}__loading-container`, spinner: `${g9}__loading-spinner`, iconLoading: "esri-icon-loading-indicator esri-rotating" };
var f11 = { title: true, description: true };
var y9 = class extends W {
  constructor(e24, t30) {
    super(e24, t30), this._featureElementInfo = null, this._relatedFeatureIntersectionObserverNode = null, this._relatedFeatureIntersectionObserver = new IntersectionObserver(([e25]) => {
      (e25 == null ? void 0 : e25.isIntersecting) && this._increaseFeaturePage();
    }, { root: window.document }), this.headingLevel = 2, this.viewModel = new m13(), this.messages = null, this.messagesCommon = null, this.visibleElements = { ...f11 }, this._increaseFeaturePage = () => {
      const { state: e25, showAllEnabled: t31, relatedFeatures: s27, featuresPerPage: r24, featurePage: i34 } = this.viewModel;
      "ready" === e25 && t31 && s27.length >= r24 * i34 && this.viewModel.featurePage++;
    };
  }
  initialize() {
    this._featureElementInfo = new l10(), this.addHandles([l3(() => [this.viewModel.description, this.viewModel.title, this.headingLevel], () => this._setupFeatureElementInfo(), h), l3(() => [this.viewModel.state, this.viewModel.showAllEnabled, this._relatedFeatureIntersectionObserverNode], () => this._handleRelatedFeatureObserverChange()), a6(() => this.viewModel.relatedFeatureViewModels, "change", () => this._setupRelatedFeatureViewModels())]);
  }
  loadDependencies() {
    return Promise.all([import("./calcite-list-CYM6NIPS.js"), import("./calcite-list-item-Q44SK22G.js"), import("./calcite-icon-E63XSY7C.js"), import("./calcite-notice-Y2VG5WCK.js")]);
  }
  destroy() {
    this._unobserveRelatedFeatureObserver(), this._featureElementInfo = a(this._featureElementInfo);
  }
  get displayShowAllButton() {
    const { showAllEnabled: e24, featureCount: t30, displayCount: s27 } = this.viewModel;
    return !e24 && !!t30 && (t30 > s27 || 0 === s27);
  }
  get displayListItems() {
    return this.displayShowAllButton || this.viewModel.relatedFeatureViewModels.length > 0;
  }
  get description() {
    return this.viewModel.description;
  }
  set description(e24) {
    this.viewModel.description = e24;
  }
  get featureCountDescription() {
    const { messages: e24 } = this, { featureCount: t30 } = this.viewModel;
    return s6(1 === t30 ? e24 == null ? void 0 : e24.numberRecord : e24 == null ? void 0 : e24.numberRecords, { number: t30 });
  }
  get title() {
    return this.viewModel.title;
  }
  set title(e24) {
    this.viewModel.title = e24;
  }
  castVisibleElements(e24) {
    return { ...f11, ...e24 };
  }
  renderStickyLoading() {
    return "querying" === this.viewModel.state ? n5("div", { key: "sticky-loader", class: b11.stickySpinnerContainer }, this.renderLoadingIcon()) : null;
  }
  renderLoadingIcon() {
    return n5("span", { class: this.classes(b11.iconLoading, b11.spinner) });
  }
  renderLoading() {
    return n5("div", { key: "loading-container", class: b11.loadingSpinnerContainer }, this.renderLoadingIcon());
  }
  renderShowAllIconNode() {
    return n5("calcite-icon", { scale: "s", icon: "list", slot: "content-end" });
  }
  renderChevronIconNode() {
    const e24 = f4(this.container) ? "chevron-left" : "chevron-right";
    return n5("calcite-icon", { scale: "s", icon: e24, slot: "content-end" });
  }
  renderRelatedFeature(e24) {
    var _a, _b;
    const { itemDescriptionFieldName: t30 } = this.viewModel, s27 = e24.title;
    e24.description = t30 && ((_a = e24.formattedAttributes) == null ? void 0 : _a.global[t30]);
    const r24 = "loading" === e24.state;
    return n5("calcite-list-item", { key: e24.uid, label: r24 ? `${(_b = this.messagesCommon) == null ? void 0 : _b.loading}…` : s27, description: r24 ? "…" : e24.description ?? "", onCalciteListItemSelect: () => this.emit("select-record", { featureViewModel: e24 }) }, this.renderChevronIconNode());
  }
  renderShowAllListItem() {
    var _a;
    return this.displayShowAllButton ? n5("calcite-list-item", { key: "show-all-item", label: (_a = this.messages) == null ? void 0 : _a.showAll, description: this.featureCountDescription, onCalciteListItemSelect: () => this.emit("show-all-records") }, this.renderShowAllIconNode()) : null;
  }
  renderNoRelatedFeaturesMessage() {
    var _a;
    return n5("calcite-notice", { key: "no-related-features-message", icon: "information", open: true, kind: "brand", scale: "s", width: "full" }, n5("div", { slot: "message" }, (_a = this.messages) == null ? void 0 : _a.noRelatedFeatures));
  }
  renderFeatureObserver() {
    return n5("div", { key: "feature-observer", class: b11.featureObserver, bind: this, afterCreate: this._relatedFeatureIntersectionObserverCreated });
  }
  renderList() {
    const { relatedFeatureViewModels: e24 } = this.viewModel;
    return n5("calcite-list", null, e24.toArray().map((e25) => this.renderRelatedFeature(e25)), this.renderShowAllListItem());
  }
  renderRelatedFeatures() {
    const { displayListItems: e24 } = this, { state: t30 } = this.viewModel;
    return n5("div", { key: "list-container", class: this.classes(b11.listContainer, { [b11.listContainerQuerying]: "querying" === t30 }) }, e24 ? this.renderList() : "ready" === t30 ? this.renderNoRelatedFeaturesMessage() : null, this.renderStickyLoading(), this.renderFeatureObserver());
  }
  renderRelationshipNotFound() {
    var _a;
    return n5("calcite-notice", { key: "relationship-not-found", icon: "exclamation-mark-triangle", open: true, kind: "danger", scale: "s", width: "full" }, n5("div", { slot: "message" }, (_a = this.messages) == null ? void 0 : _a.relationshipNotFound));
  }
  render() {
    var _a;
    const { state: e24 } = this.viewModel;
    return n5("div", { class: this.classes(b11.base, b11.esriWidget) }, (_a = this._featureElementInfo) == null ? void 0 : _a.render(), "loading" === e24 ? this.renderLoading() : "disabled" === e24 ? this.renderRelationshipNotFound() : this.renderRelatedFeatures());
  }
  _setupRelatedFeatureViewModels() {
    const { relatedFeatureViewModels: e24 } = this.viewModel, t30 = "related-feature-viewmodels";
    this.removeHandles(t30), e24 == null ? void 0 : e24.forEach((e25) => {
      this.addHandles(l3(() => [e25.title, e25.state], () => this.scheduleRender(), h), t30);
    }), this.scheduleRender();
  }
  _setupFeatureElementInfo() {
    var _a;
    const { headingLevel: e24, visibleElements: t30 } = this, s27 = t30.description && this.description, r24 = t30.title && this.title;
    (_a = this._featureElementInfo) == null ? void 0 : _a.set({ description: s27, title: r24, headingLevel: e24 });
  }
  async _handleRelatedFeatureObserverChange() {
    this._unobserveRelatedFeatureObserver();
    const { state: e24, showAllEnabled: t30 } = this.viewModel;
    await U(0), this._relatedFeatureIntersectionObserverNode && "ready" === e24 && t30 && this._relatedFeatureIntersectionObserver.observe(this._relatedFeatureIntersectionObserverNode);
  }
  _relatedFeatureIntersectionObserverCreated(e24) {
    this._relatedFeatureIntersectionObserverNode = e24;
  }
  _unobserveRelatedFeatureObserver() {
    this._relatedFeatureIntersectionObserverNode && this._relatedFeatureIntersectionObserver.unobserve(this._relatedFeatureIntersectionObserverNode);
  }
};
e([y2()], y9.prototype, "_relatedFeatureIntersectionObserverNode", void 0), e([y2({ readOnly: true })], y9.prototype, "displayShowAllButton", null), e([y2({ readOnly: true })], y9.prototype, "displayListItems", null), e([y2()], y9.prototype, "description", null), e([y2({ readOnly: true })], y9.prototype, "featureCountDescription", null), e([y2()], y9.prototype, "headingLevel", void 0), e([y2()], y9.prototype, "title", null), e([y2({ type: m13 })], y9.prototype, "viewModel", void 0), e([y2(), e4("esri/widgets/Feature/t9n/Feature")], y9.prototype, "messages", void 0), e([y2(), e4("esri/t9n/common")], y9.prototype, "messagesCommon", void 0), e([y2()], y9.prototype, "visibleElements", void 0), e([s4("visibleElements")], y9.prototype, "castVisibleElements", null), y9 = e([a3("esri.widgets.Feature.FeatureRelationship")], y9);
var F5 = y9;

// node_modules/@arcgis/core/arcade/featureset/support/FeatureSetQueryInterceptor.js
var e15 = class {
  constructor(e24, a34) {
    this.preLayerQueryCallback = e24, this.preRequestCallback = a34, this.preLayerQueryCallback || (this.preLayerQueryCallback = (e25) => {
    }), this.preRequestCallback || (this.preLayerQueryCallback = (e25) => {
    });
  }
};

// node_modules/@arcgis/core/widgets/Feature/FeatureViewModel.js
var G2;
var H3 = 1;
var z3 = "content-view-models";
var J3 = "relationship-view-models";
var K3 = { attachmentsContent: true, chartAnimation: true, customContent: true, expressionContent: true, fieldsContent: true, mediaContent: true, textContent: true, relationshipContent: true };
var W3 = G2 = class extends s9(v3) {
  constructor(e24) {
    super(e24), this._handles = new t3(), this._error = null, this._featureAbortController = null, this._graphicChangedThrottled = e9(this._graphicChanged, H3, this), this._expressionAttributes = null, this._graphicExpressionAttributes = null, this.abilities = { ...K3 }, this.content = null, this.contentViewModels = [], this.description = null, this.defaultPopupTemplateEnabled = false, this.formattedAttributes = null, this.lastEditInfo = null, this.relatedInfos = /* @__PURE__ */ new Map(), this.title = "", this.view = null, this._isAllowedContentType = (e25) => {
      const { abilities: t30 } = this;
      return "attachments" === e25.type && !!t30.attachmentsContent || "custom" === e25.type && !!t30.customContent || "fields" === e25.type && !!t30.fieldsContent || "media" === e25.type && !!t30.mediaContent || "text" === e25.type && !!t30.textContent || "expression" === e25.type && !!t30.expressionContent || "relationship" === e25.type && !!t30.relationshipContent;
    }, this._handles.add(l3(() => [this.graphic, this._effectivePopupTemplate, this.abilities], () => this._graphicChangedThrottled(), h));
  }
  destroy() {
    this._clear(), this._cancelFeatureQuery(), this._error = null, this._handles.destroy(), this.graphic = null, this._destroyContentViewModels(), this.relatedInfos.clear();
  }
  get _effectivePopupTemplate() {
    return r(this.graphic) ? this.graphic.getEffectivePopupTemplate(this.defaultPopupTemplateEnabled) : null;
  }
  get _fieldInfoMap() {
    return Y2(ee(this._effectivePopupTemplate), this._sourceLayer);
  }
  get _sourceLayer() {
    return j6(this.graphic);
  }
  castAbilities(e24) {
    return { ...K3, ...e24 };
  }
  get isTable() {
    var _a;
    return ((_a = this._sourceLayer) == null ? void 0 : _a.isTable) || false;
  }
  get state() {
    return this.graphic ? this._error ? "error" : this.waitingForContent ? "loading" : "ready" : "disabled";
  }
  set graphic(e24) {
    this._set("graphic", e24 ? e24.clone() : null);
  }
  get spatialReference() {
    var _a;
    return ((_a = this.view) == null ? void 0 : _a.spatialReference) ?? null;
  }
  set spatialReference(e24) {
    this._override("spatialReference", e24);
  }
  get map() {
    var _a;
    return ((_a = this.view) == null ? void 0 : _a.map) || null;
  }
  set map(e24) {
    this._override("map", e24);
  }
  get waitingForContent() {
    return !!this._featureAbortController;
  }
  setActiveMedia(e24, t30) {
    const r24 = this.contentViewModels[e24];
    r24 instanceof M4 && r24.setActiveMedia(t30);
  }
  nextMedia(e24) {
    const t30 = this.contentViewModels[e24];
    t30 instanceof M4 && t30.next();
  }
  previousMedia(e24) {
    const t30 = this.contentViewModels[e24];
    t30 instanceof M4 && t30.previous();
  }
  async updateGeometry() {
    var _a, _b;
    const { graphic: e24, spatialReference: t30, _sourceLayer: r24 } = this;
    await (r24 == null ? void 0 : r24.load());
    const i34 = r24 == null ? void 0 : r24.objectIdField;
    if (!i34 || !e24 || !r24)
      return;
    const s27 = (_a = e24 == null ? void 0 : e24.attributes) == null ? void 0 : _a[i34];
    if (null == s27)
      return;
    const o27 = [s27];
    if (!e24.geometry) {
      const i35 = (_b = await oe({ layer: r24, graphic: e24, outFields: [], objectIds: o27, returnGeometry: true, spatialReference: t30 })) == null ? void 0 : _b.geometry;
      i35 && (e24.geometry = i35);
    }
  }
  _clear() {
    this._set("title", ""), this._set("content", null), this._set("formattedAttributes", null);
  }
  async _graphicChanged() {
    this._cancelFeatureQuery(), this._error = null, this._clear();
    const { graphic: e24 } = this;
    if (!e24)
      return;
    const t30 = new AbortController();
    this._featureAbortController = t30;
    try {
      await this._queryFeature({ signal: t30.signal });
    } catch (r24) {
      j(r24) || (this._error = r24, s2.getLogger(this.declaredClass).error("error", "The popupTemplate could not be displayed for this feature.", { error: r24, graphic: e24, popupTemplate: this._effectivePopupTemplate }));
    }
    this._featureAbortController === t30 && (this._featureAbortController = null);
  }
  _cancelFeatureQuery() {
    const { _featureAbortController: e24 } = this;
    e24 && e24.abort(), this._featureAbortController = null;
  }
  _compileContentElement(e24, t30) {
    return "attachments" === e24.type ? this._compileAttachments(e24, t30) : "custom" === e24.type ? this._compileCustom(e24, t30) : "fields" === e24.type ? this._compileFields(e24, t30) : "media" === e24.type ? this._compileMedia(e24, t30) : "text" === e24.type ? this._compileText(e24, t30) : "expression" === e24.type ? this._compileExpression(e24, t30) : "relationship" === e24.type ? this._compileRelationship(e24, t30) : void 0;
  }
  _compileContent(e24) {
    if (this._destroyContentViewModels(), this.graphic)
      return Array.isArray(e24) ? e24.filter(this._isAllowedContentType).map((e25, t30) => this._compileContentElement(e25, t30)).filter(r) : "string" == typeof e24 ? this._compileText(new c6({ text: e24 }), 0).text : e24;
  }
  _destroyContentViewModels() {
    var _a, _b;
    (_a = this._handles) == null ? void 0 : _a.remove(J3), (_b = this._handles) == null ? void 0 : _b.remove(z3), this.contentViewModels.forEach((e24) => e24 && !e24.destroyed && e24.destroy()), this._set("contentViewModels", []);
  }
  _matchesFeature(e24, t30) {
    var _a;
    const r24 = (_a = e24 == null ? void 0 : e24.graphic) == null ? void 0 : _a.getObjectId(), i34 = t30 == null ? void 0 : t30.getObjectId();
    return r(r24) && r(i34) && r24 === i34;
  }
  _setRelatedFeaturesViewModels({ relatedFeatureViewModels: e24, relatedFeatures: t30, map: r24 }) {
    const { view: i34, spatialReference: s27 } = this;
    t30 == null ? void 0 : t30.filter(Boolean).forEach((t31) => {
      e24.find((e25) => this._matchesFeature(e25, t31)) || e24.add(new G2({ abilities: { relationshipContent: false }, map: r24, view: i34, spatialReference: s27, graphic: t31 }));
    }), e24.forEach((r25) => {
      const i35 = t30 == null ? void 0 : t30.find((e25) => this._matchesFeature(r25, e25));
      i35 || e24.remove(r25);
    });
  }
  _setExpressionContentVM(e24, t30) {
    const r24 = this.formattedAttributes, { contentElement: i34, contentElementViewModel: s27 } = e24, o27 = i34 == null ? void 0 : i34.type;
    s27 && o27 && ("fields" === o27 && (this._createFieldsFormattedAttributes({ contentElement: i34, contentElementIndex: t30, formattedAttributes: r24 }), s27.set(this._createFieldsVMParams(i34, t30))), "media" === o27 && (this._createMediaFormattedAttributes({ contentElement: i34, contentElementIndex: t30, formattedAttributes: r24 }), s27.set(this._createMediaVMParams(i34, t30))), "text" === o27 && s27.set(this._createTextVMParams(i34)));
  }
  _compileRelationship(e24, t30) {
    const { displayCount: r24, orderByFields: i34, relationshipId: s27, title: o27, description: n31 } = e24, { _sourceLayer: a34, graphic: l25, map: p30 } = this, c37 = new m13({ displayCount: r24, graphic: l25, orderByFields: i34, relationshipId: s27, layer: a34, map: p30, ...this._compileTitleAndDesc({ title: o27, description: n31 }) });
    return this.contentViewModels[t30] = c37, this._handles.add(a6(() => c37.relatedFeatures, "change", () => this._setRelatedFeaturesViewModels(c37)), J3), e24;
  }
  _compileExpression(e24, t30) {
    const { expressionInfo: r24 } = e24, { graphic: i34, map: s27, spatialReference: o27, view: n31 } = this, a34 = new C4({ expressionInfo: r24, graphic: i34, interceptor: G2.interceptor, map: s27, spatialReference: o27, view: n31 });
    return this.contentViewModels[t30] = a34, this._handles.add(l3(() => a34.contentElementViewModel, () => this._setExpressionContentVM(a34, t30), h), z3), e24;
  }
  _compileAttachments(e24, t30) {
    const { graphic: r24 } = this, { description: i34, title: s27 } = e24;
    return this.contentViewModels[t30] = new c12({ graphic: r24, ...this._compileTitleAndDesc({ title: s27, description: i34 }) }), e24;
  }
  _compileCustom(e24, t30) {
    const { graphic: r24 } = this, { creator: i34, destroyer: s27 } = e24;
    return this.contentViewModels[t30] = new l11({ graphic: r24, creator: i34, destroyer: s27 }), e24;
  }
  _compileTitleAndDesc({ title: e24, description: t30 }) {
    const { _fieldInfoMap: r24, _sourceLayer: i34, graphic: s27, formattedAttributes: o27 } = this, n31 = s27 == null ? void 0 : s27.attributes, a34 = this._expressionAttributes, l25 = o27.global;
    return { title: S3({ attributes: n31, fieldInfoMap: r24, globalAttributes: l25, expressionAttributes: a34, layer: i34, text: e24 }), description: S3({ attributes: n31, fieldInfoMap: r24, globalAttributes: l25, expressionAttributes: a34, layer: i34, text: t30 }) };
  }
  _createFieldsVMParams(e24, t30) {
    var _a;
    const r24 = this._effectivePopupTemplate, i34 = this.formattedAttributes, s27 = { ...i34 == null ? void 0 : i34.global, ...i34 == null ? void 0 : i34.content[t30] }, o27 = (_a = (e24 == null ? void 0 : e24.fieldInfos) || (r24 == null ? void 0 : r24.fieldInfos)) == null ? void 0 : _a.filter(({ fieldName: e25 }) => M3(e25) || ue(e25) || s27.hasOwnProperty(e25)), n31 = r24 == null ? void 0 : r24.expressionInfos, { description: a34, title: l25 } = e24;
    return { attributes: s27, expressionInfos: n31, fieldInfos: o27, ...this._compileTitleAndDesc({ title: l25, description: a34 }) };
  }
  _compileFields(e24, t30) {
    const r24 = e24.clone(), i34 = new n13(this._createFieldsVMParams(e24, t30));
    return this.contentViewModels[t30] = i34, r24.fieldInfos = i34.formattedFieldInfos.slice(0), r24;
  }
  _createMediaVMParams(e24, t30) {
    const { abilities: r24, graphic: i34, _fieldInfoMap: s27, _effectivePopupTemplate: o27, relatedInfos: n31, _sourceLayer: a34, _expressionAttributes: l25 } = this, p30 = this.formattedAttributes, c37 = (i34 == null ? void 0 : i34.attributes) ?? {}, { description: d18, mediaInfos: u21, title: h20 } = e24;
    return { abilities: { chartAnimation: r24.chartAnimation }, activeMediaInfoIndex: e24.activeMediaInfoIndex || 0, attributes: c37, isAggregate: i34 == null ? void 0 : i34.isAggregate, layer: a34, fieldInfoMap: s27, formattedAttributes: { ...p30 == null ? void 0 : p30.global, ...p30 == null ? void 0 : p30.content[t30] }, expressionAttributes: l25, mediaInfos: u21, popupTemplate: o27, relatedInfos: n31, ...this._compileTitleAndDesc({ title: h20, description: d18 }) };
  }
  _compileMedia(e24, t30) {
    const r24 = e24.clone(), i34 = new M4(this._createMediaVMParams(e24, t30));
    return r24.mediaInfos = i34.formattedMediaInfos.slice(0), this.contentViewModels[t30] = i34, r24;
  }
  _createTextVMParams(e24) {
    var _a;
    const { graphic: t30, _fieldInfoMap: r24, _sourceLayer: i34, _expressionAttributes: s27 } = this;
    if (e24 && e24.text) {
      const o27 = (t30 == null ? void 0 : t30.attributes) ?? {}, n31 = ((_a = this.formattedAttributes) == null ? void 0 : _a.global) ?? {};
      e24.text = S3({ attributes: o27, fieldInfoMap: r24, globalAttributes: n31, expressionAttributes: s27, layer: i34, text: e24.text });
    }
    return { graphic: t30, creator: e24.text };
  }
  _compileText(e24, t30) {
    const r24 = e24.clone();
    return this.contentViewModels[t30] = new l11(this._createTextVMParams(r24)), r24;
  }
  _compileLastEditInfo() {
    const { _effectivePopupTemplate: e24, _sourceLayer: t30, graphic: r24 } = this;
    if (!e24)
      return;
    const { lastEditInfoEnabled: i34 } = e24, s27 = t30 == null ? void 0 : t30.editFieldsInfo;
    return i34 && s27 ? X(s27, r24 == null ? void 0 : r24.attributes) : void 0;
  }
  _compileTitle(e24) {
    var _a;
    const { _fieldInfoMap: t30, _sourceLayer: r24, graphic: i34, _expressionAttributes: s27 } = this, o27 = (i34 == null ? void 0 : i34.attributes) ?? {}, n31 = ((_a = this.formattedAttributes) == null ? void 0 : _a.global) ?? {};
    return S3({ attributes: o27, fieldInfoMap: t30, globalAttributes: n31, expressionAttributes: s27, layer: r24, text: e24 });
  }
  async _getTitle() {
    const { _effectivePopupTemplate: e24, graphic: t30 } = this;
    if (!t30)
      return null;
    const r24 = e24 == null ? void 0 : e24.title;
    return x2(r24, { graphic: t30 });
  }
  async _getContent() {
    const { _effectivePopupTemplate: e24, graphic: t30 } = this;
    if (!t30)
      return null;
    const r24 = e24 == null ? void 0 : e24.content;
    return x2(r24, { graphic: t30 });
  }
  async _queryFeature(e24) {
    const { _featureAbortController: t30, _sourceLayer: r24, graphic: i34, _effectivePopupTemplate: s27 } = this, o27 = this.map, n31 = this.view, a34 = this.spatialReference;
    if (t30 !== this._featureAbortController || !i34)
      return;
    await le({ graphic: i34, popupTemplate: s27, layer: r24, spatialReference: a34 }, e24);
    const { content: { value: l25 }, title: { value: c37 } } = await E({ content: this._getContent(), title: this._getTitle() }), { expressionAttributes: { value: d18 } } = await E({ checkForRelatedFeatures: this._checkForRelatedFeatures(e24), expressionAttributes: m11({ expressionInfos: s27 == null ? void 0 : s27.expressionInfos, spatialReference: a34, graphic: i34, map: o27, interceptor: G2.interceptor, view: n31 }) });
    t30 === this._featureAbortController && i34 && (this._expressionAttributes = d18, this._graphicExpressionAttributes = { ...i34.attributes, ...d18 }, this._set("formattedAttributes", this._createFormattedAttributes(l25)), this._set("title", this._compileTitle(c37)), this._set("lastEditInfo", this._compileLastEditInfo() || null), this._set("content", this._compileContent(l25) || null));
  }
  _createMediaFormattedAttributes({ contentElement: e24, contentElementIndex: t30, formattedAttributes: r24 }) {
    const { _effectivePopupTemplate: i34, graphic: s27, relatedInfos: o27, _sourceLayer: n31, _fieldInfoMap: a34, _graphicExpressionAttributes: l25 } = this;
    r24.content[t30] = ie2({ fieldInfos: i34 == null ? void 0 : i34.fieldInfos, graphic: s27, attributes: { ...l25, ...e24.attributes }, layer: n31, fieldInfoMap: a34, relatedInfos: o27 });
  }
  _createFieldsFormattedAttributes({ contentElement: e24, contentElementIndex: t30, formattedAttributes: r24 }) {
    if (e24.fieldInfos) {
      const { graphic: i34, relatedInfos: s27, _sourceLayer: o27, _fieldInfoMap: n31, _graphicExpressionAttributes: a34 } = this;
      r24.content[t30] = ie2({ fieldInfos: e24.fieldInfos, graphic: i34, attributes: { ...a34, ...e24.attributes }, layer: o27, fieldInfoMap: n31, relatedInfos: s27 });
    }
  }
  _createFormattedAttributes(e24) {
    const { _effectivePopupTemplate: t30, graphic: r24, relatedInfos: i34, _sourceLayer: s27, _fieldInfoMap: o27, _graphicExpressionAttributes: n31 } = this, a34 = t30 == null ? void 0 : t30.fieldInfos, l25 = { global: ie2({ fieldInfos: a34, graphic: r24, attributes: n31, layer: s27, fieldInfoMap: o27, relatedInfos: i34 }), content: [] };
    return Array.isArray(e24) && e24.forEach((e25, t31) => {
      "fields" === e25.type && this._createFieldsFormattedAttributes({ contentElement: e25, contentElementIndex: t31, formattedAttributes: l25 }), "media" === e25.type && this._createMediaFormattedAttributes({ contentElement: e25, contentElementIndex: t31, formattedAttributes: l25 });
    }), l25;
  }
  _checkForRelatedFeatures(e24) {
    const { graphic: t30, _effectivePopupTemplate: r24 } = this;
    return this._queryRelatedInfos(t30, ee(r24), e24);
  }
  async _queryRelatedInfos(e24, t30, r24) {
    const { relatedInfos: i34, _sourceLayer: s27 } = this;
    i34.clear();
    const o27 = r(s27 == null ? void 0 : s27.associatedLayer) ? await (s27 == null ? void 0 : s27.associatedLayer.load(r24)) : s27;
    if (!o27 || !e24)
      return;
    const n31 = t30.filter((e25) => e25 && ue(e25.fieldName));
    if (!n31 || !n31.length)
      return;
    t30.forEach((e25) => this._configureRelatedInfo(e25, o27));
    const l25 = await R6({ relatedInfos: i34, layer: o27 }, r24);
    Object.keys(l25).forEach((e25) => {
      var _a;
      const t31 = i34.get(e25.toString()), r25 = (_a = l25[e25]) == null ? void 0 : _a.value;
      t31 && r25 && (t31.layerInfo = r25.data);
    });
    const p30 = await $2({ graphic: e24, relatedInfos: i34, layer: o27 }, r24);
    Object.keys(p30).forEach((e25) => {
      var _a;
      F3((_a = p30[e25]) == null ? void 0 : _a.value, i34.get(e25.toString()));
    });
  }
  _configureRelatedInfo(e24, t30) {
    const { relatedInfos: r24 } = this, i34 = m10(e24.fieldName);
    if (!i34)
      return;
    const { layerId: s27, fieldName: o27 } = i34;
    if (!s27)
      return;
    const n31 = r24.get(s27.toString()) || g6(s27, t30);
    n31 && (U6({ relatedInfo: n31, fieldName: o27, fieldInfo: e24 }), this.relatedInfos.set(s27, n31));
  }
};
W3.interceptor = new e15(me, ye), e([y2()], W3.prototype, "_error", void 0), e([y2()], W3.prototype, "_featureAbortController", void 0), e([y2({ readOnly: true })], W3.prototype, "_effectivePopupTemplate", null), e([y2({ readOnly: true })], W3.prototype, "_fieldInfoMap", null), e([y2({ readOnly: true })], W3.prototype, "_sourceLayer", null), e([y2()], W3.prototype, "abilities", void 0), e([s4("abilities")], W3.prototype, "castAbilities", null), e([y2({ readOnly: true })], W3.prototype, "content", void 0), e([y2({ readOnly: true })], W3.prototype, "contentViewModels", void 0), e([y2()], W3.prototype, "description", void 0), e([y2({ type: Boolean })], W3.prototype, "defaultPopupTemplateEnabled", void 0), e([y2({ readOnly: true })], W3.prototype, "isTable", null), e([y2({ readOnly: true })], W3.prototype, "state", null), e([y2({ readOnly: true })], W3.prototype, "formattedAttributes", void 0), e([y2({ type: g3, value: null })], W3.prototype, "graphic", null), e([y2({ readOnly: true })], W3.prototype, "lastEditInfo", void 0), e([y2({ readOnly: true })], W3.prototype, "relatedInfos", void 0), e([y2()], W3.prototype, "spatialReference", null), e([y2({ readOnly: true })], W3.prototype, "title", void 0), e([y2()], W3.prototype, "map", null), e([y2({ readOnly: true })], W3.prototype, "waitingForContent", null), e([y2()], W3.prototype, "view", void 0), W3 = G2 = e([a3("esri.widgets.FeatureViewModel")], W3);
var X2 = W3;

// node_modules/@arcgis/core/widgets/Feature/resources.js
var e16 = "esri-feature";
var t12 = { iconText: "esri-icon-font-fallback-text", iconLoading: "esri-icon-loading-indicator esri-rotating", esriTable: "esri-widget__table", esriWidget: "esri-widget", base: e16, container: `${e16}__size-container`, title: `${e16}__title`, main: `${e16}__main-container`, btn: `${e16}__button`, icon: `${e16}__icon`, content: `${e16}__content`, contentNode: `${e16}__content-node`, contentElement: `${e16}__content-element`, text: `${e16}__text`, lastEditedInfo: `${e16}__last-edited-info`, fields: `${e16}__fields`, fieldHeader: `${e16}__field-header`, fieldData: `${e16}__field-data`, fieldDataDate: `${e16}__field-data--date`, loadingSpinnerContainer: `${e16}__loading-container`, spinner: `${e16}__loading-spinner` };

// node_modules/@arcgis/core/widgets/Feature/support/FeatureContentMixin.js
var i15 = (i34) => {
  let n31 = class extends i34 {
    constructor() {
      super(...arguments), this.renderNodeContent = (e24) => e6(e24) && !e24.destroyed ? n5("div", { class: t12.contentNode, key: e24 }, e24.render()) : e24 instanceof HTMLElement ? n5("div", { class: t12.contentNode, key: e24, bind: e24, afterCreate: this._attachToNode }) : t9(e24) ? n5("div", { class: t12.contentNode, key: e24, bind: e24.domNode, afterCreate: this._attachToNode }) : null;
    }
    _attachToNode(e24) {
      const o27 = this;
      e24.appendChild(o27);
    }
  };
  return n31 = e([a3("esri.widgets.Feature.ContentMixin")], n31), n31;
};

// node_modules/@arcgis/core/widgets/Feature.js
var E4;
var b12 = { title: true, content: true, lastEditedInfo: true };
var _5 = "relationship-handles";
var W4 = E4 = class extends i15(W) {
  constructor(e24, t30) {
    super(e24, t30), this._contentWidgets = [], this.flowItems = null, this.headingLevel = 2, this.messages = null, this.messagesCommon = null, this.messagesURIUtils = null, this.visibleElements = { ...b12 }, this.viewModel = new X2();
  }
  initialize() {
    this.addHandles(l3(() => {
      var _a;
      return (_a = this.viewModel) == null ? void 0 : _a.contentViewModels;
    }, () => this._setupContentWidgets(), h));
  }
  loadDependencies() {
    return import("./calcite-notice-Y2VG5WCK.js");
  }
  destroy() {
    this._destroyContentWidgets();
  }
  get graphic() {
    return this.viewModel.graphic;
  }
  set graphic(e24) {
    this.viewModel.graphic = e24;
  }
  get defaultPopupTemplateEnabled() {
    return this.viewModel.defaultPopupTemplateEnabled;
  }
  set defaultPopupTemplateEnabled(e24) {
    this.viewModel.defaultPopupTemplateEnabled = e24;
  }
  get isTable() {
    return this.viewModel.isTable;
  }
  get label() {
    var _a;
    return ((_a = this.messages) == null ? void 0 : _a.widgetLabel) ?? "";
  }
  set label(e24) {
    this._overrideIfSome("label", e24);
  }
  get spatialReference() {
    return this.viewModel.spatialReference;
  }
  set spatialReference(e24) {
    this.viewModel.spatialReference = e24;
  }
  get title() {
    return this.viewModel.title;
  }
  castVisibleElements(e24) {
    return { ...b12, ...e24 };
  }
  get map() {
    return this.viewModel.map;
  }
  set map(e24) {
    this.viewModel.map = e24;
  }
  get view() {
    return this.viewModel.view;
  }
  set view(e24) {
    this.viewModel.view = e24;
  }
  render() {
    const { state: e24 } = this.viewModel, t30 = n5("div", { class: t12.container, key: "container" }, this.renderTitle(), "error" === e24 ? this.renderError() : "loading" === e24 ? this.renderLoading() : this.renderContentContainer());
    return n5("div", { class: this.classes(t12.base, t12.esriWidget) }, t30);
  }
  setActiveMedia(e24, t30) {
    return this.viewModel.setActiveMedia(e24, t30);
  }
  nextMedia(e24) {
    return this.viewModel.nextMedia(e24);
  }
  previousMedia(e24) {
    return this.viewModel.previousMedia(e24);
  }
  renderError() {
    const { messagesCommon: e24, messages: t30, visibleElements: s27 } = this;
    return n5("calcite-notice", { open: true, kind: "danger", icon: "exclamation-mark-circle", scale: "s" }, s27.title ? n5("div", { key: "error-title", slot: "title" }, e24.errorMessage) : null, n5("div", { key: "error-message", slot: "message" }, t30.loadingError));
  }
  renderLoading() {
    return n5("div", { key: "loading-container", class: t12.loadingSpinnerContainer }, n5("span", { class: this.classes(t12.iconLoading, t12.spinner) }));
  }
  renderContentContainer() {
    const { visibleElements: e24 } = this;
    return e24.content ? n5("div", { class: t12.main }, [this.renderContent(), this.renderLastEditInfo()]) : null;
  }
  renderTitle() {
    const { visibleElements: e24, title: t30 } = this;
    return e24.title ? n5(n9, { level: this.headingLevel, class: t12.title, innerHTML: t30 }) : null;
  }
  renderContent() {
    const e24 = this.viewModel.content, t30 = "content";
    if (!e24)
      return null;
    if (Array.isArray(e24))
      return e24.length ? n5("div", { class: t12.contentNode, key: `${t30}-content-elements` }, e24.map(this.renderContentElement, this)) : null;
    if ("string" == typeof e24) {
      const e25 = this._contentWidgets[0];
      return !e25 || e25.destroyed ? null : n5("div", { class: t12.contentNode, key: `${t30}-content` }, e25.render());
    }
    return this.renderNodeContent(e24);
  }
  renderContentElement(e24, t30) {
    var _a;
    const { visibleElements: s27 } = this;
    if ("boolean" != typeof s27.content && !((_a = s27.content) == null ? void 0 : _a[e24.type]))
      return null;
    switch (e24.type) {
      case "attachments":
        return this.renderAttachments(t30);
      case "custom":
        return this.renderCustom(e24, t30);
      case "fields":
        return this.renderFields(t30);
      case "media":
        return this.renderMedia(t30);
      case "text":
        return this.renderText(e24, t30);
      case "expression":
        return this.renderExpression(t30);
      case "relationship":
        return this.renderRelationship(t30);
      default:
        return null;
    }
  }
  renderAttachments(e24) {
    const t30 = this._contentWidgets[e24];
    if (!t30 || t30.destroyed)
      return null;
    const { state: s27, attachmentInfos: i34 } = t30.viewModel;
    return "loading" === s27 || i34.length > 0 ? n5("div", { key: this._buildKey("attachments-element", e24), class: this.classes(t12.contentElement) }, t30.render()) : null;
  }
  renderRelationship(e24) {
    const t30 = this._contentWidgets[e24];
    return t30 && !t30.destroyed && this.flowItems ? n5("div", { key: this._buildKey("relationship-element", e24), class: t12.contentElement }, t30.render()) : null;
  }
  renderExpression(e24) {
    const t30 = this._contentWidgets[e24];
    return !t30 || t30.destroyed ? null : n5("div", { key: this._buildKey("expression-element", e24), class: t12.contentElement }, t30.render());
  }
  renderCustom(e24, t30) {
    const { creator: s27 } = e24, i34 = this._contentWidgets[t30];
    return !i34 || i34.destroyed ? null : s27 ? n5("div", { key: this._buildKey("custom-element", t30), class: t12.contentElement }, i34.render()) : null;
  }
  renderFields(e24) {
    const t30 = this._contentWidgets[e24];
    return !t30 || t30.destroyed ? null : n5("div", { key: this._buildKey("fields-element", e24), class: t12.contentElement }, t30.render());
  }
  renderMedia(e24) {
    const t30 = this._contentWidgets[e24];
    return !t30 || t30.destroyed ? null : n5("div", { key: this._buildKey("media-element", e24), class: t12.contentElement }, t30.render());
  }
  renderLastEditInfo() {
    const { visibleElements: e24, messages: t30 } = this, { lastEditInfo: s27 } = this.viewModel;
    if (!s27 || !e24.lastEditedInfo)
      return null;
    const { date: i34, user: n31 } = s27, r24 = "edit" === s27.type ? n31 ? t30.lastEditedByUser : t30.lastEdited : n31 ? t30.lastCreatedByUser : t30.lastCreated, o27 = s6(r24, { date: i34, user: n31 });
    return n5("div", { key: "edit-info-element", class: this.classes(t12.lastEditedInfo, t12.contentElement) }, o27);
  }
  renderText(e24, t30) {
    const s27 = e24.text, i34 = this._contentWidgets[t30];
    return !i34 || i34.destroyed ? null : s27 ? n5("div", { key: this._buildKey("text-element", t30), class: this.classes(t12.contentElement, t12.text) }, i34.render()) : null;
  }
  _buildKey(e24, ...t30) {
    return `${e24}__${this.get("viewModel.graphic.uid") || "0"}-${t30.join("-")}`;
  }
  _destroyContentWidget(e24) {
    e24 && (e24.viewModel = null, !e24.destroyed && e24.destroy());
  }
  _destroyContentWidgets() {
    this.removeHandles(_5), this._contentWidgets.forEach((e24) => this._destroyContentWidget(e24)), this._contentWidgets = [];
  }
  _addFeatureRelationshipHandles(e24) {
    const { flowItems: t30, visibleElements: i34 } = this;
    this.addHandles([a6(() => e24, "select-record", ({ featureViewModel: e25 }) => {
      t30 && (e25.abilities = { relationshipContent: true }, t30.push(new E4({ flowItems: t30, viewModel: e25, visibleElements: i34 })));
    }), a6(() => e24, "show-all-records", () => {
      if (!t30)
        return;
      const { viewModel: s27 } = e24;
      s27.showAllEnabled = true;
      const i35 = new F5({ visibleElements: { title: false, description: false }, viewModel: s27 });
      this._addFeatureRelationshipHandles(i35), t30.push(i35);
    })], _5);
  }
  _setupContentWidgets() {
    this._destroyContentWidgets();
    const { headingLevel: e24, visibleElements: t30 } = this, s27 = this.get("viewModel.content"), { contentViewModels: i34 } = this.viewModel;
    if (Array.isArray(s27))
      s27.forEach((s28, n31) => {
        if ("attachments" === s28.type && (this._contentWidgets[n31] = new h6({ displayType: s28.displayType, headingLevel: t30.title ? e24 + 1 : e24, viewModel: i34[n31] })), "fields" === s28.type && (this._contentWidgets[n31] = new c16({ viewModel: i34[n31] })), "media" === s28.type && (this._contentWidgets[n31] = new R7({ viewModel: i34[n31] })), "text" === s28.type && (this._contentWidgets[n31] = new p8({ viewModel: i34[n31] })), "custom" === s28.type && (this._contentWidgets[n31] = new p8({ viewModel: i34[n31] })), "expression" === s28.type && (this._contentWidgets[n31] = new m12({ viewModel: i34[n31] })), "relationship" === s28.type) {
          const e25 = new F5({ viewModel: i34[n31] });
          this._addFeatureRelationshipHandles(e25), this._contentWidgets[n31] = e25;
        }
      }, this);
    else {
      const e25 = i34[0];
      e25 && !e25.destroyed && (this._contentWidgets[0] = new p8({ viewModel: e25 }));
    }
    this.scheduleRender();
  }
};
e([y2()], W4.prototype, "graphic", null), e([y2()], W4.prototype, "defaultPopupTemplateEnabled", null), e([y2()], W4.prototype, "flowItems", void 0), e([y2()], W4.prototype, "headingLevel", void 0), e([y2({ readOnly: true })], W4.prototype, "isTable", null), e([y2()], W4.prototype, "label", null), e([y2(), e4("esri/widgets/Feature/t9n/Feature")], W4.prototype, "messages", void 0), e([y2(), e4("esri/t9n/common")], W4.prototype, "messagesCommon", void 0), e([y2(), e4("esri/widgets/support/t9n/uriUtils")], W4.prototype, "messagesURIUtils", void 0), e([y2()], W4.prototype, "spatialReference", null), e([y2({ readOnly: true })], W4.prototype, "title", null), e([y2()], W4.prototype, "visibleElements", void 0), e([s4("visibleElements")], W4.prototype, "castVisibleElements", null), e([y2()], W4.prototype, "map", null), e([y2()], W4.prototype, "view", null), e([y2({ type: X2 })], W4.prototype, "viewModel", void 0), W4 = E4 = e([a3("esri.widgets.Feature")], W4);
var C5 = W4;

// node_modules/@arcgis/core/widgets/support/AnchorElementViewModel.js
var l15;
var d8 = Symbol("anchorHandles");
var m14 = class extends n4.EventedAccessor {
  constructor(e24) {
    super(e24), this[l15] = new t3(), this.location = null, this.screenLocationEnabled = false, this.view = null, this[d8].add([f3(() => o2(this.screenLocationEnabled ? this.view : null, (e25) => [e25.size, "3d" === e25.type ? e25.camera : e25.viewpoint]), () => this.notifyChange("screenLocation")), l3(() => this.screenLocation, (e25, o27) => {
      r(e25) && r(o27) && this.emit("view-change");
    })]);
  }
  destroy() {
    this.view = null, this[d8] = a(this[d8]);
  }
  get screenLocation() {
    var _a;
    const { location: e24, view: o27, screenLocationEnabled: t30 } = this;
    return t30 && r(e24) && r(o27) && o27.ready ? (_a = o27.toScreen) == null ? void 0 : _a.call(o27, e24) : null;
  }
};
l15 = d8, e([y2()], m14.prototype, "location", void 0), e([y2()], m14.prototype, "screenLocation", null), e([y2()], m14.prototype, "screenLocationEnabled", void 0), e([y2()], m14.prototype, "view", void 0), m14 = e([a3("esri.widgets.support.AnchorElementViewModel")], m14);
var h9 = m14;

// node_modules/@arcgis/core/widgets/Spinner/SpinnerViewModel.js
var t13 = "esri.widgets.CompassViewModel";
var p11 = class extends h9 {
  constructor(s27) {
    super(s27), this.visible = false;
  }
};
e([y2()], p11.prototype, "visible", void 0), p11 = e([a3(t13)], p11);
var c21 = p11;

// node_modules/@arcgis/core/widgets/Spinner.js
var c22 = "esri-spinner";
var p12 = { base: c22, spinnerStart: `${c22}--start`, spinnerFinish: `${c22}--finish` };
var h10 = class extends W {
  constructor(i34, e24) {
    super(i34, e24), this._animationDelay = 500, this._animationPromise = null, this.viewModel = new c21();
  }
  initialize() {
    this.addHandles(l3(() => this.visible, (i34) => this._visibleChange(i34)));
  }
  destroy() {
    this._animationPromise = null;
  }
  get location() {
    return this.viewModel.location;
  }
  set location(i34) {
    this.viewModel.location = i34;
  }
  get view() {
    return this.viewModel.view;
  }
  set view(i34) {
    this.viewModel.view = i34;
  }
  get visible() {
    return this.viewModel.visible;
  }
  set visible(i34) {
    this.viewModel.visible = i34;
  }
  show(i34) {
    const { location: e24, promise: t30 } = i34 ?? {};
    e24 && (this.viewModel.location = e24), this.visible = true;
    const s27 = () => this.hide();
    t30 && t30.catch(() => {
    }).then(s27);
  }
  hide() {
    this.visible = false;
  }
  render() {
    const { visible: i34 } = this, { screenLocation: e24 } = this.viewModel, t30 = !!e24, s27 = i34 && t30, o27 = !i34 && t30, r24 = { [p12.spinnerStart]: s27, [p12.spinnerFinish]: o27 }, n31 = this._getPositionStyles();
    return n5("div", { class: this.classes(p12.base, r24), styles: n31 });
  }
  _visibleChange(i34) {
    if (i34)
      return void (this.viewModel.screenLocationEnabled = true);
    const e24 = U(this._animationDelay);
    this._animationPromise = e24, e24.catch(() => {
    }).then(() => {
      this._animationPromise === e24 && (this.viewModel.screenLocationEnabled = false, this._animationPromise = null);
    });
  }
  _getPositionStyles() {
    const { screenLocation: i34, view: t30 } = this.viewModel;
    if (t2(t30) || t2(i34))
      return {};
    const { padding: s27 } = t30;
    return { left: i34.x - s27.left + "px", top: i34.y - s27.top + "px" };
  }
};
e([y2()], h10.prototype, "location", null), e([y2()], h10.prototype, "view", null), e([y2({ type: c21 })], h10.prototype, "viewModel", void 0), e([y2()], h10.prototype, "visible", null), h10 = e([a3("esri.widgets.Spinner")], h10);
var m15 = h10;

// node_modules/@arcgis/core/widgets/Popup/actions.js
var s15 = { iconZoom: "esri-icon-zoom-in-magnifying-glass", iconTrash: "esri-icon-trash", iconBrowseClusteredFeatures: "esri-icon-table" };
var o11 = new a12({ id: "zoom-to-feature", title: "{messages.zoom}", className: s15.iconZoom });
var t14 = new a12({ id: "remove-selected-feature", title: "{messages.remove}", className: s15.iconTrash });
var r14 = new a12({ id: "zoom-to-clustered-features", title: "{messages.zoom}", className: s15.iconZoom });
var i16 = new a12({ id: "browse-clustered-features", title: "{messages.browseClusteredFeatures}", className: s15.iconBrowseClusteredFeatures });

// node_modules/@arcgis/core/widgets/Popup/actionUtils.js
var u10 = "esri.widgets.Popup.PopupViewModel";
var l16 = s2.getLogger(u10);
var d9 = (t30) => {
  const { event: r24, view: o27 } = t30, { action: u21 } = r24, l25 = o27 && o27.popup;
  if (!u21)
    return Promise.reject(new s3("trigger-action:missing-arguments", "Event has no action"));
  if (!l25)
    return Promise.reject(new s3("trigger-action:missing-arguments", "view.popup is missing"));
  const { disabled: d18, id: g17 } = u21;
  if (!g17)
    return Promise.reject(new s3("trigger-action:invalid-action", "action.id is missing"));
  if (d18)
    return Promise.reject(new s3("trigger-action:invalid-action", "Action is disabled"));
  if (g17 === o11.id)
    return p13(l25.viewModel).catch(b);
  if (g17 === r14.id)
    return m16(l25.viewModel);
  if (g17 === i16.id)
    return l25.featureMenuOpen = !l25.featureMenuOpen, l25.viewModel.browseClusterEnabled = !l25.viewModel.browseClusterEnabled, Promise.resolve();
  if (l25.viewModel.browseClusterEnabled = false, g17 === t14.id) {
    l25.close();
    const { selectedFeature: t31 } = l25;
    if (!t31)
      return Promise.reject(new s3(`trigger-action:${t14.id}`, "selectedFeature is required", { selectedFeature: t31 }));
    const { sourceLayer: r25 } = t31;
    return r25 ? r25.remove(t31) : o27.graphics.remove(t31), Promise.resolve();
  }
  return Promise.resolve();
};
function g10(e24) {
  const { selectedFeature: t30, location: r24, view: o27 } = e24;
  if (!o27)
    return null;
  if ("3d" === o27.type)
    return t30 ?? r24 ?? null;
  return e24.get("selectedFeature.geometry") || r24;
}
function w14(e24) {
  var _a, _b;
  return !!e24 && e24.isAggregate && "cluster" === ((_b = (_a = e24.sourceLayer) == null ? void 0 : _a.featureReduction) == null ? void 0 : _b.type);
}
async function f12(e24, t30) {
  if ("3d" !== (t30 == null ? void 0 : t30.type) || !e24 || "esri.Graphic" !== e24.declaredClass)
    return true;
  const r24 = t30.getViewForGraphic(e24);
  if (r24 && "whenGraphicBounds" in r24) {
    let t31;
    try {
      t31 = await r24.whenGraphicBounds(e24, { useViewElevation: true });
    } catch (o27) {
    }
    return !t31 || !t31.boundingBox || t31.boundingBox[0] === t31.boundingBox[3] && t31.boundingBox[1] === t31.boundingBox[4] && t31.boundingBox[2] === t31.boundingBox[5];
  }
  return true;
}
async function p13(t30) {
  var _a;
  const { location: o27, selectedFeature: i34, view: a34, zoomFactor: s27 } = t30, c37 = g10(t30);
  if (!a34 || !c37) {
    const t31 = new s3("zoom-to:invalid-target-or-view", "Cannot zoom to location without a target and view.", { target: c37, view: a34 });
    throw l16.error(t31), t31;
  }
  const u21 = a34.scale / s27, d18 = (_a = t30.selectedFeature) == null ? void 0 : _a.geometry, w18 = d18 ?? o27, p30 = r(w18) && "point" === w18.type && await f12(i34, a34);
  o11.active = true, o11.disabled = true;
  try {
    await t30.zoomTo({ target: { target: c37, scale: p30 ? u21 : void 0 } });
  } catch (m25) {
    const t31 = new s3("zoom-to:invalid-graphic", "Could not zoom to the location of the graphic.", { graphic: i34 });
    l16.error(t31);
  } finally {
    o11.active = false, o11.disabled = false, t30.zoomToLocation = null, p30 && (t30.location = w18);
  }
}
async function m16(t30) {
  const { selectedFeature: r24, view: o27 } = t30;
  if ("2d" !== (o27 == null ? void 0 : o27.type)) {
    const t31 = new s3("zoomToCluster:invalid-view", "View must be 2d MapView.", { view: o27 });
    throw l16.error(t31), t31;
  }
  if (!r24 || !w14(r24)) {
    const t31 = new s3("zoomToCluster:invalid-selectedFeature", "Selected feature must represent an aggregate/cluster graphic.", { selectedFeature: r24 });
    throw l16.error(t31), t31;
  }
  const [i34, n31] = await h11(o27, r24);
  r14.active = true, r14.disabled = true;
  const { extent: s27 } = await i34.queryExtent(n31);
  await t30.zoomTo({ target: s27 }), r14.active = false, r14.disabled = false;
}
async function v12(e24) {
  const { view: t30, selectedFeature: r24 } = e24;
  if (!t30 || !r24)
    return;
  const [o27, i34] = await h11(t30, r24), { extent: n31 } = await o27.queryExtent(i34);
  e24.selectedClusterBoundaryFeature.geometry = n31, t30.graphics.add(e24.selectedClusterBoundaryFeature);
}
async function y10(e24) {
  var _a;
  const { selectedFeature: t30, view: r24 } = e24;
  if (!r24 || !t30)
    return;
  const [o27, i34] = await h11(r24, t30);
  i16.active = true, i16.disabled = true;
  const { features: n31 } = await o27.queryFeatures(i34);
  i16.active = false, i16.disabled = false, (_a = r24.popup) == null ? void 0 : _a.open({ features: [t30].concat(n31), featureMenuOpen: true });
}
async function h11(e24, t30) {
  const r24 = await e24.whenLayerView(t30.sourceLayer), o27 = r24.createQuery(), i34 = t30.getObjectId();
  return o27.aggregateIds = null != i34 ? [i34] : [], [r24, o27];
}
function b13(e24) {
  const t30 = e24.features.filter((e25) => w14(e25));
  t30.length && (e24.features = t30);
}
function F6(e24) {
  var _a;
  if (t2(e24))
    return null;
  switch (e24.type) {
    case "point":
      return e24;
    case "extent":
      return e24.center;
    case "polygon":
      return e24.centroid;
    case "multipoint":
    case "polyline":
      return (_a = e24.extent) == null ? void 0 : _a.center;
    default:
      return null;
  }
}

// node_modules/@arcgis/core/widgets/Popup/css.js
var e17 = "esri-popup";
var t15 = `${e17}__header`;
var o12 = `${e17}--is-docked`;
var n16 = { calciteThemeLight: "calcite-mode-light", calciteThemeDark: "calcite-mode-dark", iconLeftTriangleArrow: "esri-icon-left-triangle-arrow", iconRightTriangleArrow: "esri-icon-right-triangle-arrow", iconDockToTop: "esri-icon-maximize", iconDockToBottom: "esri-icon-dock-bottom", iconDockToLeft: "esri-icon-dock-left", iconDockToRight: "esri-icon-dock-right", iconClose: "esri-icon-close", iconUndock: "esri-icon-minimize", iconCheckMark: "esri-icon-check-mark", iconLoading: "esri-icon-loading-indicator", iconDefaultAction: "esri-icon-default-action", iconActionsMenu: "esri-icon-handle-horizontal", rotating: "esri-rotating", base: e17, widget: "esri-widget", main: `${e17}__main-container`, loadingContainer: `${e17}__loading-container`, isCollapsible: `${e17}--is-collapsible`, isCollapsed: `${e17}--is-collapsed`, shadow: `${e17}--shadow`, isDocked: o12, isDockedTopLeft: `${o12}-top-left`, isDockedTopCenter: `${o12}-top-center`, isDockedTopRight: `${o12}-top-right`, isDockedBottomLeft: `${o12}-bottom-left`, isDockedBottomCenter: `${o12}-bottom-center`, isDockedBottomRight: `${o12}-bottom-right`, alignTopCenter: `${e17}--aligned-top-center`, alignBottomCenter: `${e17}--aligned-bottom-center`, alignTopLeft: `${e17}--aligned-top-left`, alignBottomLeft: `${e17}--aligned-bottom-left`, alignTopRight: `${e17}--aligned-top-right`, alignBottomRight: `${e17}--aligned-bottom-right`, isFeatureMenuOpen: `${e17}--feature-menu-open`, isActionsMenuOpen: `${e17}--actions-menu-open`, hasFeatureUpdated: `${e17}--feature-updated`, header: t15, headerButtons: `${t15}-buttons`, headerContainer: `${t15}-container`, headerContainerButton: `${t15}-container--button`, headerTitle: `${t15}-title`, content: `${e17}__content`, contentHasFlows: "esri-content--has-flows", contentFlowItem: "esri-content__flow-item", footer: `${e17}__footer`, footerHasPagination: `${e17}__footer--has-pagination`, footerHasActions: `${e17}__footer--has-actions`, footerHasActionsMenu: `${e17}__footer--has-actions-menu`, button: `${e17}__button`, buttonDisabled: `${e17}__button--disabled`, buttonDock: `${e17}__button--dock`, icon: `${e17}__icon`, iconDock: `${e17}__icon--dock-icon`, inlineActionsContainer: `${e17}__inline-actions-container`, actionsMenuButton: `${e17}__actions-menu-button`, actions: `${e17}__actions`, action: `${e17}__action`, actionImage: `${e17}__action-image`, actionText: `${e17}__action-text`, actionToggle: `${e17}__action-toggle`, actionToggleOn: `${e17}__action-toggle--on`, actionExit: `${e17}__action--exit`, actionSelectFeature: `${e17}__action--select-feature`, pointer: `${e17}__pointer`, pointerDirection: `${e17}__pointer-direction`, navigation: `${e17}__navigation`, paginationPrevious: `${e17}__pagination-previous`, paginationNext: `${e17}__pagination-next`, paginationPreviousIconLTR: `${e17}__pagination-previous-icon`, paginationPreviousIconRTL: `${e17}__pagination-previous-icon--rtl`, paginationNextIconLTR: `${e17}__pagination-next-icon`, paginationNextIconRTL: `${e17}__pagination-next-icon--rtl`, featureMenu: `${e17}__feature-menu`, featureMenuList: `${e17}__feature-menu-list`, featureMenuItem: `${e17}__feature-menu-item`, featureMenuViewport: `${e17}__feature-menu-viewport`, featureMenuHeader: `${e17}__feature-menu-header`, featureMenuNote: `${e17}__feature-menu-note`, featureMenuSelected: `${e17}__feature-menu-item--selected`, featureMenuButton: `${e17}__feature-menu-button`, featureMenuTitle: `${e17}__feature-menu-title`, featureMenuObserver: `${e17}__feature-menu-observer`, featureMenuLoader: `${e17}__feature-menu-loader`, collapseButton: `${e17}__collapse-button`, collapseIcon: `${e17}__collapse-icon` };

// node_modules/@arcgis/core/layers/LayerConstants.js
var o13 = "OBJECTID";

// node_modules/@arcgis/core/views/support/layerViewUtils.js
function t16(n31) {
  return n31 && "function" == typeof n31.highlight;
}

// node_modules/@arcgis/core/widgets/support/GoTo.js
var t17 = (t30) => {
  let i34 = class extends t30 {
    constructor(...o27) {
      super(...o27), this.goToOverride = null, this.view = null;
    }
    callGoTo(o27) {
      const { view: e24 } = this;
      return i(e24), this.goToOverride ? this.goToOverride(e24, o27) : e24.goTo(o27.target, o27.options);
    }
  };
  return e([y2()], i34.prototype, "goToOverride", void 0), e([y2()], i34.prototype, "view", void 0), i34 = e([a3("esri.widgets.support.GoTo")], i34), i34;
};

// node_modules/@arcgis/core/widgets/Popup/PopupViewModel.js
var B3 = j2.ofType({ key: "type", defaultKeyValue: "button", base: c9, typeMap: { button: a12, toggle: a13 } });
var R8 = () => [o11.clone()];
var G3 = () => [r14.clone(), i16.clone()];
var z4 = class extends t17(h9) {
  get isLoadingFeature() {
    return this.featureViewModels.some((e24) => e24.waitingForContent);
  }
  constructor(e24) {
    super(e24), this._handles = new t3(), this._pendingPromises = /* @__PURE__ */ new Set(), this._fetchFeaturesController = null, this._highlightSelectedFeaturePromise = null, this._highlightActiveFeaturePromise = null, this._selectedClusterFeature = null, this.featurePage = null, this.actions = new B3(), this.activeFeature = null, this.defaultPopupTemplateEnabled = false, this.autoCloseEnabled = false, this.autoOpenEnabled = true, this.browseClusterEnabled = false, this.content = null, this.featuresPerPage = 20, this.featureViewModelAbilities = null, this.featureViewModels = [], this.highlightEnabled = true, this.includeDefaultActions = true, this.selectedClusterBoundaryFeature = new g3({ symbol: new S2({ outline: { width: 1.5, color: "cyan" }, style: "none" }) }), this.title = null, this.updateLocationEnabled = false, this.view = null, this.visible = false, this.zoomFactor = 4, this.zoomToLocation = null;
  }
  initialize() {
    this._handles.add([l3(() => [this.autoOpenEnabled, this.view], () => this._autoOpenEnabledChange()), this.on("view-change", () => this._autoClose()), l3(() => [this.highlightEnabled, this.selectedFeature, this.visible, this.view], () => this._highlightSelectedFeature()), l3(() => [this.highlightEnabled, this.activeFeature, this.visible, this.view], () => this._highlightActiveFeature()), l3(() => {
      var _a, _b;
      return (_b = (_a = this.view) == null ? void 0 : _a.animation) == null ? void 0 : _b.state;
    }, (e24) => this._animationStateChange(e24)), l3(() => this.location, (e24) => this._locationChange(e24)), l3(() => this.selectedFeature, (e24) => this._selectedFeatureChange(e24)), l3(() => [this.selectedFeatureIndex, this.featureCount, this.featuresPerPage], () => this._selectedFeatureIndexChange()), l3(() => [this.featurePage, this.selectedFeatureIndex, this.featureCount, this.featuresPerPage, this.featureViewModels], () => this._setGraphicOnFeatureViewModels()), l3(() => this.featureViewModels, () => this._featureViewModelsChange()), this.on("trigger-action", (e24) => d9({ event: e24, view: this.view })), f3(() => !this.waitingForResult, () => this._waitingForResultChange(), U2), l3(() => {
      var _a, _b;
      return [this.features, (_a = this.view) == null ? void 0 : _a.map, (_b = this.view) == null ? void 0 : _b.spatialReference];
    }, () => this._updateFeatureVMs()), l3(() => {
      var _a;
      return (_a = this.view) == null ? void 0 : _a.scale;
    }, () => this._viewScaleChange()), f3(() => !this.visible, () => this.browseClusterEnabled = false), l3(() => this.browseClusterEnabled, (e24) => e24 ? this.enableClusterBrowsing() : this.disableClusterBrowsing())]);
  }
  destroy() {
    this._cancelFetchingFeatures(), this._handles.destroy(), this._pendingPromises.clear(), this.browseClusterEnabled = false, this.view = null;
  }
  get active() {
    return !(!this.visible || this.waitingForResult);
  }
  get allActions() {
    const e24 = this._get("allActions") || new B3();
    e24.removeAll();
    const { actions: t30, defaultActions: s27, defaultPopupTemplateEnabled: i34, includeDefaultActions: r24, selectedFeature: o27 } = this, a34 = r24 ? s27.concat(t30) : t30, n31 = o27 && ("function" == typeof o27.getEffectivePopupTemplate && o27.getEffectivePopupTemplate(i34) || o27.popupTemplate), l25 = n31 && n31.actions, h20 = n31 && n31.overwriteActions ? l25 : l25 ? l25.concat(a34) : a34;
    return h20 && h20.filter(Boolean).forEach((t31) => e24.add(t31)), e24;
  }
  get defaultActions() {
    const e24 = this._get("defaultActions") || new B3();
    return e24.removeAll(), e24.addMany(w14(this.selectedFeature) ? G3() : R8()), e24;
  }
  get featureCount() {
    return this.features.length;
  }
  get features() {
    return this._get("features") || [];
  }
  set features(e24) {
    const t30 = e24 || [];
    this._set("features", t30);
    const { pendingPromisesCount: s27, promiseCount: i34, selectedFeatureIndex: r24 } = this, o27 = i34 && t30.length;
    o27 && s27 && -1 === r24 ? this.selectedFeatureIndex = 0 : o27 && -1 !== r24 || (this.selectedFeatureIndex = t30.length ? 0 : -1);
  }
  get location() {
    return this._get("location") || null;
  }
  set location(e24) {
    var _a, _b, _c;
    let t30 = e24;
    const s27 = (_b = (_a = this.view) == null ? void 0 : _a.spatialReference) == null ? void 0 : _b.isWebMercator;
    e24 && ((_c = e24 == null ? void 0 : e24.spatialReference) == null ? void 0 : _c.isWGS84) && s27 && (t30 = R(e24)), this._set("location", t30);
  }
  get pendingPromisesCount() {
    return this._pendingPromises.size;
  }
  get waitingForResult() {
    return !(!(!!this._fetchFeaturesController || this.pendingPromisesCount > 0) || 0 !== this.featureCount);
  }
  get promiseCount() {
    return this.promises.length;
  }
  get promises() {
    return this._get("promises") || [];
  }
  set promises(e24) {
    if (this._pendingPromises.clear(), this.features = [], !Array.isArray(e24) || !e24.length)
      return this._set("promises", []), void this.notifyChange("pendingPromisesCount");
    this._set("promises", e24), (e24 = e24.slice(0)).forEach((e25) => {
      this._pendingPromises.add(e25);
      const t30 = (t31) => {
        this._pendingPromises.has(e25) && this._updateFeatures(t31), this._updatePendingPromises(e25);
      }, s27 = () => this._updatePendingPromises(e25);
      e25.then(t30, s27);
    }), this.notifyChange("pendingPromisesCount");
  }
  get selectedFeature() {
    const { features: e24, selectedFeatureIndex: t30 } = this;
    if (-1 === t30)
      return null;
    return e24[t30] || null;
  }
  get selectedFeatureIndex() {
    const e24 = this._get("selectedFeatureIndex");
    return "number" == typeof e24 ? e24 : -1;
  }
  set selectedFeatureIndex(e24) {
    const { featureCount: t30 } = this;
    e24 = isNaN(e24) || e24 < -1 || !t30 ? -1 : (e24 + t30) % t30, this.activeFeature = null, this._set("selectedFeatureIndex", e24);
  }
  get selectedFeatureViewModel() {
    return this.featureViewModels[this.selectedFeatureIndex] || null;
  }
  get state() {
    return this.get("view.ready") ? "ready" : "disabled";
  }
  centerAtLocation() {
    const { view: e24 } = this, t30 = g10(this);
    return t30 && e24 ? this.callGoTo({ target: { target: t30, scale: e24.scale } }) : Promise.reject(new s3("center-at-location:invalid-target-or-view", "Cannot center at a location without a target and view.", { target: t30, view: e24 }));
  }
  zoomTo(e24) {
    return this.callGoTo(e24);
  }
  clear() {
    this.set({ promises: [], features: [], content: null, title: null, location: null, activeFeature: null });
  }
  fetchFeatures(e24, t30) {
    const { view: s27 } = this;
    if (!s27 || !e24)
      throw new s3("fetch-features:invalid-screenpoint-or-view", "Cannot fetch features without a screenPoint and view.", { screenPoint: e24, view: s27 });
    return s27.fetchPopupFeatures(e24, { event: t30 && t30.event, defaultPopupTemplateEnabled: this.defaultPopupTemplateEnabled, signal: t30 && t30.signal });
  }
  open(e24) {
    const t30 = { updateLocationEnabled: false, promises: [], fetchFeatures: false, ...e24, visible: true }, { fetchFeatures: s27 } = t30;
    delete t30.fetchFeatures, s27 && this._setFetchFeaturesPromises(t30.location);
    const i34 = ["actionsMenuOpen", "collapsed", "featureMenuOpen"];
    for (const r24 of i34)
      delete t30[r24];
    this.set(t30);
  }
  triggerAction(e24) {
    const t30 = this.allActions.getItemAt(e24);
    t30 && !t30.disabled && this.emit("trigger-action", { action: t30 });
  }
  next() {
    return this.selectedFeatureIndex = this.selectedFeatureIndex + 1, this;
  }
  previous() {
    return this.selectedFeatureIndex = this.selectedFeatureIndex - 1, this;
  }
  disableClusterBrowsing() {
    b13(this), this._clearBrowsedClusterGraphics();
  }
  async enableClusterBrowsing() {
    const { view: e24, selectedFeature: t30 } = this;
    "2d" === (e24 == null ? void 0 : e24.type) ? w14(t30) ? (await v12(this), await y10(this)) : s2.getLogger(this.declaredClass).warn("enableClusterBrowsing:invalid-selectedFeature: Selected feature must represent an aggregate/cluster graphic.", t30) : s2.getLogger(this.declaredClass).warn("enableClusterBrowsing:invalid-view: View must be 2d MapView.", t30);
  }
  _animationStateChange(e24) {
    this.zoomToLocation || (o11.disabled = "waiting-for-target" === e24);
  }
  _clearBrowsedClusterGraphics() {
    var _a;
    const e24 = (_a = this.view) == null ? void 0 : _a.graphics;
    e24 && (e24.remove(this.selectedClusterBoundaryFeature), this._selectedClusterFeature && e24.remove(this._selectedClusterFeature)), this._selectedClusterFeature = null, this.selectedClusterBoundaryFeature.geometry = null;
  }
  _viewScaleChange() {
    if (w14(this.selectedFeature))
      return this.browseClusterEnabled = false, this.visible = false, void this.clear();
    this.browseClusterEnabled && (this.features = this.selectedFeature ? [this.selectedFeature] : []);
  }
  _locationChange(e24) {
    const { selectedFeature: t30, updateLocationEnabled: s27 } = this;
    s27 && e24 && (!t30 || t30.geometry) && this.centerAtLocation();
  }
  _selectedFeatureIndexChange() {
    this.featurePage = this.featureCount > 1 ? Math.floor(this.selectedFeatureIndex / this.featuresPerPage) + 1 : null;
  }
  _featureViewModelsChange() {
    this.featurePage = this.featureCount > 1 ? 1 : null;
  }
  _setGraphicOnFeatureViewModels() {
    const { features: e24, featureCount: t30, featurePage: s27, featuresPerPage: i34, featureViewModels: r24 } = this;
    if (null === s27)
      return;
    const o27 = ((s27 - 1) * i34 + t30) % t30, a34 = o27 + i34;
    r24.slice(o27, a34).forEach((t31, s28) => {
      t31 && !t31.graphic && (t31.graphic = e24[o27 + s28]);
    });
  }
  async _selectedFeatureChange(e24) {
    const { location: t30, updateLocationEnabled: s27, view: i34 } = this;
    if (e24 && i34) {
      if (this.browseClusterEnabled) {
        if (this._selectedClusterFeature && (i34.graphics.remove(this._selectedClusterFeature), this._selectedClusterFeature = null), w14(e24))
          return;
        return e24.symbol = await R3(e24), this._selectedClusterFeature = e24, void i34.graphics.add(this._selectedClusterFeature);
      }
      !s27 && t30 || !e24.geometry ? s27 && !e24.geometry && this.centerAtLocation().then(() => {
        var _a;
        const e25 = (_a = i34.center) == null ? void 0 : _a.clone();
        e25 && (this.location = e25);
      }) : this.location = e2(F6(e24.geometry));
    }
  }
  _waitingForResultChange() {
    !this.featureCount && this.promises && (this.visible = false);
  }
  _setFetchFeaturesPromises(e24) {
    return this._fetchFeaturesWithController(this._getScreenPoint(e24 || this.location)).then((e25) => {
      const { clientOnlyGraphics: t30, promisesPerLayerView: s27 } = e25, i34 = Promise.resolve(t30), r24 = s27.map((e26) => e26.promise);
      this.promises = [i34, ...r24];
    });
  }
  _destroyFeatureVMs() {
    this.featureViewModels.forEach((e24) => e24 && !e24.destroyed && e24.destroy()), this._set("featureViewModels", []);
  }
  _updateFeatureVMs() {
    const { selectedFeature: e24, features: t30, featureViewModels: s27 } = this;
    if (w14(e24) || (this.browseClusterEnabled = false), this._destroyFeatureVMs(), !t30 || !t30.length)
      return;
    const i34 = s27.slice(0), r24 = [];
    t30.forEach((t31, s28) => {
      var _a, _b;
      if (!t31)
        return;
      let o27 = null;
      if (i34.some((e25, s29) => (e25 && e25.graphic === t31 && (o27 = e25, i34.splice(s29, 1)), !!o27)), o27)
        r24[s28] = o27;
      else {
        const i35 = new X2({ abilities: this.featureViewModelAbilities, defaultPopupTemplateEnabled: this.defaultPopupTemplateEnabled, spatialReference: (_a = this.view) == null ? void 0 : _a.spatialReference, graphic: t31 === e24 ? t31 : null, map: (_b = this.view) == null ? void 0 : _b.map, view: this.view });
        r24[s28] = i35;
      }
    }), i34.forEach((e25) => e25 && !e25.destroyed && e25.destroy()), this._set("featureViewModels", r24);
  }
  _getScreenPoint(e24) {
    const { view: t30 } = this;
    return t30 && e24 && "function" == typeof t30.toScreen ? t30.toScreen(e24) : null;
  }
  _autoOpenEnabledChange() {
    const e24 = "auto-fetch-features", { _handles: t30, autoOpenEnabled: s27 } = this;
    if (t30.remove(e24), s27 && this.view) {
      const s28 = this.view.on("click", (e25) => {
        "mouse" === e25.pointerType && 0 !== e25.button || this._fetchFeaturesAndOpen(e25);
      }, P.WIDGET);
      t30.add(s28, e24);
    }
  }
  _cancelFetchingFeatures() {
    const e24 = this._fetchFeaturesController;
    e24 && e24.abort(), this._fetchFeaturesController = null, this.notifyChange("waitingForResult");
  }
  _fetchFeaturesWithController(e24, t30) {
    this._cancelFetchingFeatures();
    const s27 = new AbortController(), { signal: i34 } = s27;
    this._fetchFeaturesController = s27, this.notifyChange("waitingForResult");
    const r24 = this.fetchFeatures(e24, { signal: i34, event: t30 });
    return r24.catch(() => {
    }).then(() => {
      this._fetchFeaturesController = null, this.notifyChange("waitingForResult");
    }), r24;
  }
  _fetchFeaturesAndOpen(e24) {
    const { screenPoint: t30, mapPoint: s27 } = e24, { view: i34 } = this;
    this._fetchFeaturesWithController(t30, e24).then((e25) => {
      var _a;
      const { clientOnlyGraphics: t31, promisesPerLayerView: r24, location: o27 } = e25, a34 = [Promise.resolve(t31), ...r24.map((e26) => e26.promise)];
      return (_a = i34 == null ? void 0 : i34.popup) == null ? void 0 : _a.open({ location: o27 || s27, promises: a34 }), e25;
    });
  }
  _updatePendingPromises(e24) {
    e24 && this._pendingPromises.has(e24) && (this._pendingPromises.delete(e24), this.notifyChange("pendingPromisesCount"));
  }
  _autoClose() {
    this.autoCloseEnabled && (this.visible = false);
  }
  async _getLayerView(e24, t30) {
    return await e24.when(), e24.whenLayerView(t30);
  }
  _getHighlightLayer(e24) {
    const { layer: t30, sourceLayer: s27 } = e24;
    return s27 && "layer" in s27 && s27.layer ? s27.layer : "map-notes" === (s27 == null ? void 0 : s27.type) || "subtype-group" === (s27 == null ? void 0 : s27.type) ? s27 : t30;
  }
  _getHighlightTarget(e24, t30) {
    const s27 = "imagery" === t30.type ? void 0 : "objectIdField" in t30 ? t30.objectIdField || o13 : null, i34 = e24.attributes;
    return i34 && s27 && i34[s27] || e24;
  }
  async _highlightActiveFeature() {
    const e24 = "highlight-active-feature";
    this._handles.remove(e24);
    const { highlightEnabled: t30, view: s27, activeFeature: i34, visible: r24 } = this;
    if (!(i34 && s27 && t30 && r24))
      return;
    const o27 = this._getHighlightLayer(i34);
    if (!(o27 && o27 instanceof b4))
      return;
    const a34 = this._getLayerView(s27, o27);
    this._highlightActiveFeaturePromise = a34;
    const n31 = await a34;
    if (!(n31 && t16(n31) && this._highlightActiveFeaturePromise === a34 && this.activeFeature && this.highlightEnabled))
      return;
    const l25 = n31.highlight(this._getHighlightTarget(i34, o27));
    this._handles.add(l25, e24);
  }
  async _highlightSelectedFeature() {
    const e24 = "highlight-selected-feature";
    this._handles.remove(e24);
    const { selectedFeature: t30, highlightEnabled: s27, view: i34, visible: r24 } = this;
    if (!(t30 && i34 && s27 && r24))
      return;
    const o27 = this._getHighlightLayer(t30);
    if (!(o27 && o27 instanceof b4))
      return;
    const a34 = this._getLayerView(i34, o27);
    this._highlightSelectedFeaturePromise = a34;
    const n31 = await a34;
    if (!(n31 && t16(n31) && this._highlightSelectedFeaturePromise === a34 && this.selectedFeature && this.highlightEnabled && this.visible))
      return;
    const l25 = n31.highlight(this._getHighlightTarget(t30, o27));
    this._handles.add(l25, e24);
  }
  _updateFeatures(e24) {
    const { features: t30 } = this;
    if (!e24 || !e24.length)
      return;
    if (!t30.length)
      return void (this.features = e24);
    const s27 = e24.filter((e25) => !t30.includes(e25));
    this.features = t30.concat(s27);
  }
};
e([y2()], z4.prototype, "featurePage", void 0), e([y2()], z4.prototype, "isLoadingFeature", null), e([y2({ type: B3 })], z4.prototype, "actions", void 0), e([y2({ readOnly: true })], z4.prototype, "active", null), e([y2()], z4.prototype, "activeFeature", void 0), e([y2({ readOnly: true })], z4.prototype, "allActions", null), e([y2({ type: Boolean })], z4.prototype, "defaultPopupTemplateEnabled", void 0), e([y2()], z4.prototype, "autoCloseEnabled", void 0), e([y2()], z4.prototype, "autoOpenEnabled", void 0), e([y2()], z4.prototype, "browseClusterEnabled", void 0), e([y2()], z4.prototype, "content", void 0), e([y2({ type: B3, readOnly: true })], z4.prototype, "defaultActions", null), e([y2({ readOnly: true })], z4.prototype, "featureCount", null), e([y2()], z4.prototype, "features", null), e([y2()], z4.prototype, "featuresPerPage", void 0), e([y2()], z4.prototype, "featureViewModelAbilities", void 0), e([y2({ readOnly: true })], z4.prototype, "featureViewModels", void 0), e([y2()], z4.prototype, "highlightEnabled", void 0), e([y2()], z4.prototype, "includeDefaultActions", void 0), e([y2({ type: w2 })], z4.prototype, "location", null), e([y2({ readOnly: true })], z4.prototype, "pendingPromisesCount", null), e([y2({ readOnly: true })], z4.prototype, "selectedClusterBoundaryFeature", void 0), e([y2({ readOnly: true })], z4.prototype, "waitingForResult", null), e([y2({ readOnly: true })], z4.prototype, "promiseCount", null), e([y2()], z4.prototype, "promises", null), e([y2({ value: null, readOnly: true })], z4.prototype, "selectedFeature", null), e([y2({ value: -1 })], z4.prototype, "selectedFeatureIndex", null), e([y2({ readOnly: true })], z4.prototype, "selectedFeatureViewModel", null), e([y2({ readOnly: true })], z4.prototype, "state", null), e([y2()], z4.prototype, "title", void 0), e([y2()], z4.prototype, "updateLocationEnabled", void 0), e([y2()], z4.prototype, "view", void 0), e([y2()], z4.prototype, "visible", void 0), e([y2()], z4.prototype, "zoomFactor", void 0), e([y2()], z4.prototype, "zoomToLocation", void 0), e([y2()], z4.prototype, "centerAtLocation", null), z4 = e([a3("esri.widgets.Popup.PopupViewModel")], z4);
var H4 = z4;

// node_modules/@arcgis/core/widgets/Popup.js
var B4 = "selected-index";
var D3 = 0;
var L5 = "popup-spinner";
var S5 = { buttonEnabled: true, position: "auto", breakpoint: { width: 544 } };
var R9 = "esri-popup";
function V2(e24, t30) {
  return void 0 === t30 ? `${R9}__${e24}` : `${R9}__${e24}-${t30}`;
}
var U7 = { closeButton: true, featureNavigation: true };
var W5 = class extends i15(W) {
  constructor(e24, i34) {
    super(e24, i34), this._blurClose = false, this._blurContainer = false, this._containerNode = null, this._mainContainerNode = null, this._featureMenuNode = null, this._actionsMenuNode = null, this._focusClose = false, this._focusContainer = false, this._focusDockButton = false, this._focusFeatureMenuButton = false, this._focusActionsMenuButton = false, this._focusFirstFeature = false, this._focusFirstAction = false, this._handles = new t3(), this._pointerOffsetInPx = 16, this._spinner = null, this._feature = null, this._featureMenuIntersectionObserverNode = null, this._featureMenuViewportNode = null, this._rootFlowItemNode = null, this._featureMenuIntersectionObserverCallback = ([e25]) => {
      (e25 == null ? void 0 : e25.isIntersecting) && null != this.viewModel.featurePage && this.viewModel.featurePage++;
    }, this._featureMenuIntersectionObserver = new IntersectionObserver(this._featureMenuIntersectionObserverCallback, { root: window.document }), this._displaySpinnerThrottled = e9(() => this._displaySpinner(), D3), this._exitRelatedRecordsActions = /* @__PURE__ */ new WeakMap(), this._featureSelectionActions = /* @__PURE__ */ new WeakMap(), this._flowItems = new j2(), this.alignment = "auto", this.collapsed = false, this.collapseEnabled = true, this.dockEnabled = false, this.featureMenuOpen = false, this.headingLevel = 2, this.maxInlineActions = 3, this.messages = null, this.messagesCommon = null, this.spinnerEnabled = true, this.viewModel = new H4(), this.visibleElements = { ...U7 }, this._handleOpenRelatedFeature = (e25) => {
      this._openRelatedFeature(e25);
    }, this._addSelectedFeatureIndexHandle(), this.addHandles([l3(() => {
      var _a;
      return (_a = this.viewModel) == null ? void 0 : _a.screenLocation;
    }, () => this._positionContainer()), l3(() => {
      var _a;
      return [(_a = this.viewModel) == null ? void 0 : _a.active, this.dockEnabled];
    }, () => this._toggleScreenLocationEnabled()), l3(() => {
      var _a;
      return (_a = this.viewModel) == null ? void 0 : _a.screenLocation;
    }, (e25, t30) => {
      !!e25 != !!t30 && this.reposition();
    }), l3(() => {
      var _a, _b, _c, _d, _e2, _f;
      return [(_b = (_a = this.viewModel) == null ? void 0 : _a.view) == null ? void 0 : _b.padding, (_d = (_c = this.viewModel) == null ? void 0 : _c.view) == null ? void 0 : _d.size, (_e2 = this.viewModel) == null ? void 0 : _e2.active, (_f = this.viewModel) == null ? void 0 : _f.location, this.alignment];
    }, () => this.reposition()), l3(() => this.spinnerEnabled, (e25) => this._spinnerEnabledChange(e25)), l3(() => {
      var _a, _b;
      return (_b = (_a = this.viewModel) == null ? void 0 : _a.view) == null ? void 0 : _b.size;
    }, (e25, t30) => this._updateDockEnabledForViewSize(e25, t30)), l3(() => {
      var _a;
      return (_a = this.viewModel) == null ? void 0 : _a.view;
    }, (e25, t30) => this._viewChange(e25, t30)), l3(() => {
      var _a, _b;
      return (_b = (_a = this.viewModel) == null ? void 0 : _a.view) == null ? void 0 : _b.ready;
    }, (e25, t30) => this._viewReadyChange(e25 ?? false, t30 ?? false)), l3(() => {
      var _a, _b;
      return [(_a = this.viewModel) == null ? void 0 : _a.waitingForResult, (_b = this.viewModel) == null ? void 0 : _b.location];
    }, () => {
      this._hideSpinner(), this._displaySpinnerThrottled();
    }), l3(() => this.selectedFeatureWidget, () => this._destroyFlowItemWidgets()), l3(() => {
      var _a, _b, _c, _d;
      return [(_b = (_a = this.selectedFeatureWidget) == null ? void 0 : _a.viewModel) == null ? void 0 : _b.title, (_d = (_c = this.selectedFeatureWidget) == null ? void 0 : _c.viewModel) == null ? void 0 : _d.state];
    }, () => this._setTitleFromFeatureWidget()), l3(() => {
      var _a, _b, _c, _d;
      return [(_b = (_a = this.selectedFeatureWidget) == null ? void 0 : _a.viewModel) == null ? void 0 : _b.content, (_d = (_c = this.selectedFeatureWidget) == null ? void 0 : _c.viewModel) == null ? void 0 : _d.state];
    }, () => this._setContentFromFeatureWidget()), f3(() => !this.collapsed, () => {
      var _a, _b;
      "xsmall" === ((_b = (_a = this.viewModel) == null ? void 0 : _a.view) == null ? void 0 : _b.widthBreakpoint) && this.viewModel.active && this.collapseEnabled && this.viewModel.centerAtLocation();
    }), a6(() => {
      var _a;
      return (_a = this.viewModel) == null ? void 0 : _a.allActions;
    }, "change", () => this._watchActions()), l3(() => {
      var _a;
      return (_a = this.viewModel) == null ? void 0 : _a.allActions;
    }, () => this._watchActions(), h), l3(() => {
      var _a;
      return (_a = this.viewModel) == null ? void 0 : _a.featureViewModels;
    }, () => this._featureMenuViewportScrollTop()), a6(() => this._flowItems, "change", () => {
      this.notifyChange("_activeFlowItemWidget"), this.scheduleRender();
    }), l3(() => {
      var _a, _b, _c, _d;
      return [(_b = (_a = this._activeFlowItemWidget) == null ? void 0 : _a.viewModel) == null ? void 0 : _b.state, (_d = (_c = this._activeFlowItemWidget) == null ? void 0 : _c.viewModel) == null ? void 0 : _d.title];
    }, () => this.scheduleRender())]);
  }
  loadDependencies() {
    return Promise.all([import("./calcite-flow-ZWHQDOGO.js"), import("./calcite-flow-item-5T44OAZD.js"), import("./calcite-action-5SIJA2CD.js"), import("./calcite-tooltip-QCZYXLFE.js"), import("./calcite-icon-E63XSY7C.js")]);
  }
  destroy() {
    var _a, _b;
    this._destroyFlowItemWidgets(), this._destroySelectedFeatureWidget(), this._destroySpinner(), (_a = this._handles) == null ? void 0 : _a.destroy(), this._unobserveFeatureMenuObserver(), (_b = this._featureMenuIntersectionObserver) == null ? void 0 : _b.disconnect();
  }
  get actionsMenuId() {
    return `${this.id}-actions-menu`;
  }
  get actionsMenuButtonId() {
    return `${this.id}-actions-menu-button`;
  }
  get featureMenuId() {
    return `${this.id}-feature-menu`;
  }
  get titleId() {
    return `${this.id}-popup-title`;
  }
  get contentId() {
    return `${this.id}-popup-content`;
  }
  get hasContent() {
    const { selectedFeatureWidget: e24, viewModel: t30 } = this;
    if (!e24)
      return !!(t30 == null ? void 0 : t30.content);
    const i34 = e24.viewModel;
    if ((i34 == null ? void 0 : i34.waitingForContent) || "error" === (i34 == null ? void 0 : i34.state))
      return true;
    const o27 = i34 == null ? void 0 : i34.content;
    return Array.isArray(o27) ? !!o27.length : !!o27;
  }
  get featureNavigationVisible() {
    return this.viewModel.active && this.viewModel.featureCount > 1 && null != this.visibleElements.featureNavigation;
  }
  get collapsible() {
    return !!(this.collapseEnabled && this.viewModel.title && this.hasContent);
  }
  get featureMenuVisible() {
    return this.featureNavigationVisible && this.featureMenuOpen;
  }
  get contentCollapsed() {
    return this.collapsible && !this.featureMenuVisible && this.collapsed;
  }
  get dividedActions() {
    return this._divideActions();
  }
  get _activeFlowItemWidget() {
    const { _flowItems: e24 } = this;
    return e24.getItemAt(e24.length - 1) || null;
  }
  get actions() {
    return this.viewModel.actions;
  }
  set actions(e24) {
    this.viewModel.actions = e24;
  }
  set actionsMenuOpen(e24) {
    this._set("actionsMenuOpen", !!e24);
  }
  get actionsMenuOpen() {
    return !!this.viewModel.active && this._get("actionsMenuOpen");
  }
  get autoCloseEnabled() {
    return this.viewModel.autoCloseEnabled;
  }
  set autoCloseEnabled(e24) {
    this.viewModel.autoCloseEnabled = e24;
  }
  get autoOpenEnabled() {
    return this.viewModel.autoOpenEnabled;
  }
  set autoOpenEnabled(e24) {
    this.viewModel.autoOpenEnabled = e24;
  }
  get defaultPopupTemplateEnabled() {
    return this.viewModel.defaultPopupTemplateEnabled;
  }
  set defaultPopupTemplateEnabled(e24) {
    this.viewModel.defaultPopupTemplateEnabled = e24;
  }
  get content() {
    return this.viewModel.content;
  }
  set content(e24) {
    this.viewModel.content = e24;
  }
  get currentAlignment() {
    return this._getCurrentAlignment();
  }
  get currentDockPosition() {
    return this._getCurrentDockPosition();
  }
  get dockOptions() {
    return this._get("dockOptions") || S5;
  }
  set dockOptions(e24) {
    var _a, _b;
    const t30 = { ...S5 }, i34 = (_b = (_a = this.viewModel) == null ? void 0 : _a.view) == null ? void 0 : _b.breakpoints, o27 = {};
    i34 && (o27.width = i34.xsmall, o27.height = i34.xsmall);
    const n31 = { ...t30, ...e24 }, s27 = { ...t30.breakpoint, ...o27 }, { breakpoint: r24 } = n31;
    "object" == typeof r24 ? n31.breakpoint = { ...s27, ...r24 } : r24 && (n31.breakpoint = s27), this._set("dockOptions", n31), this._setCurrentDockPosition(), this.reposition();
  }
  get featureCount() {
    return this.viewModel.featureCount;
  }
  get features() {
    return this.viewModel.features;
  }
  set features(e24) {
    this.viewModel.features = e24;
  }
  get goToOverride() {
    return this.viewModel.goToOverride;
  }
  set goToOverride(e24) {
    this.viewModel.goToOverride = e24;
  }
  get highlightEnabled() {
    return this.viewModel.highlightEnabled;
  }
  set highlightEnabled(e24) {
    this.viewModel.highlightEnabled = e24;
  }
  get location() {
    return this.viewModel.location;
  }
  set location(e24) {
    this.viewModel.location = e24;
  }
  get label() {
    var _a;
    return ((_a = this.messages) == null ? void 0 : _a.widgetLabel) ?? "";
  }
  set label(e24) {
    this._overrideIfSome("label", e24);
  }
  get promises() {
    return this.viewModel.promises;
  }
  set promises(e24) {
    this.viewModel.promises = e24;
  }
  get selectedFeature() {
    return this.viewModel.selectedFeature;
  }
  get selectedFeatureIndex() {
    return this.viewModel.selectedFeatureIndex;
  }
  set selectedFeatureIndex(e24) {
    this.viewModel.selectedFeatureIndex = e24;
  }
  get selectedFeatureWidget() {
    const { _feature: e24, visibleElements: t30, headingLevel: i34, _flowItems: o27 } = this, { selectedFeatureViewModel: n31 } = this.viewModel, s27 = { ...t30, title: false };
    return n31 ? (e24 ? (e24.viewModel = n31, e24.visibleElements = s27) : this._feature = new C5({ flowItems: o27, headingLevel: i34 + 1, viewModel: n31, visibleElements: s27 }), this._feature) : null;
  }
  get title() {
    return this.viewModel.title;
  }
  set title(e24) {
    this.viewModel.title = e24;
  }
  get updateLocationEnabled() {
    return this.viewModel.updateLocationEnabled;
  }
  set updateLocationEnabled(e24) {
    this.viewModel.updateLocationEnabled = e24;
  }
  get view() {
    return this.viewModel.view;
  }
  set view(e24) {
    this.viewModel.view = e24;
  }
  get visible() {
    return this.viewModel.visible;
  }
  set visible(e24) {
    this.viewModel.visible = e24;
  }
  castVisibleElements(e24) {
    return { ...U7, ...e24 };
  }
  blur() {
    const { active: e24 } = this.viewModel;
    e24 || s2.getLogger(this.declaredClass).warn("Popup can only be blurred when currently active."), this.visibleElements.closeButton ? this._blurClose = true : this._blurContainer = true, this.scheduleRender();
  }
  clear() {
    return this.viewModel.clear();
  }
  close() {
    this.visible = false;
  }
  fetchFeatures(e24, t30) {
    return this.viewModel.fetchFeatures(e24, t30);
  }
  focus() {
    const { active: e24 } = this.viewModel;
    e24 || s2.getLogger(this.declaredClass).warn("Popup can only be focused when currently active."), this.visibleElements.closeButton ? this._focusClose = true : this._focusContainer = true, this.scheduleRender();
  }
  next() {
    return this.viewModel.next();
  }
  open(e24) {
    var _a, _b;
    this._handles.remove(B4);
    const t30 = !!e24 && !!e24.featureMenuOpen, i34 = !!e24 && !!e24.actionsMenuOpen, o27 = { collapsed: !!e24 && !!e24.collapsed, actionsMenuOpen: i34, featureMenuOpen: t30 };
    "xsmall" === ((_b = (_a = this.viewModel) == null ? void 0 : _a.view) == null ? void 0 : _b.widthBreakpoint) && (o27.collapsed = true), this.set(o27), this.viewModel.open(e24), this._shouldFocus(e24), this._addSelectedFeatureIndexHandle();
  }
  previous() {
    return this.viewModel.previous();
  }
  reposition() {
    this.renderNow(), this._positionContainer(), this._setCurrentAlignment();
  }
  triggerAction(e24) {
    return this.viewModel.triggerAction(e24);
  }
  render() {
    var _a, _b, _c, _d;
    const { actionsMenuOpen: e24, dockEnabled: t30, featureMenuVisible: i34, dividedActions: o27, currentAlignment: n31, currentDockPosition: s27 } = this, { active: r24 } = this.viewModel, { menuActions: l25 } = o27, a34 = r24 && l25.length > 1 && e24, c37 = r24 && t30, d18 = r24 && !t30, u21 = (_b = (_a = this.selectedFeature) == null ? void 0 : _a.layer) == null ? void 0 : _b.title, h20 = (_d = (_c = this.selectedFeature) == null ? void 0 : _c.layer) == null ? void 0 : _d.id, p30 = { [n16.alignTopCenter]: "top-center" === n31, [n16.alignBottomCenter]: "bottom-center" === n31, [n16.alignTopLeft]: "top-left" === n31, [n16.alignBottomLeft]: "bottom-left" === n31, [n16.alignTopRight]: "top-right" === n31, [n16.alignBottomRight]: "bottom-right" === n31, [n16.isDocked]: c37, [n16.shadow]: d18, [n16.isDockedTopLeft]: "top-left" === s27, [n16.isDockedTopCenter]: "top-center" === s27, [n16.isDockedTopRight]: "top-right" === s27, [n16.isDockedBottomLeft]: "bottom-left" === s27, [n16.isDockedBottomCenter]: "bottom-center" === s27, [n16.isDockedBottomRight]: "bottom-right" === s27, [n16.isFeatureMenuOpen]: i34, [n16.isActionsMenuOpen]: a34 };
    return n5("div", { class: this.classes(n16.base, p30), role: "presentation", "data-layer-title": u21, "data-layer-id": h20, bind: this, afterCreate: this._positionContainer, afterUpdate: this._positionContainer }, r24 ? [this.renderMainContainer(), this.renderPointer()] : null);
  }
  renderLoadingIcon() {
    return n5("span", { "aria-hidden": "true", class: this.classes(n16.icon, n16.iconLoading, n16.rotating) });
  }
  renderNavigationLoading() {
    const { messagesCommon: e24 } = this;
    return this.viewModel.pendingPromisesCount ? n5("div", { key: V2("loading-container"), role: "presentation", class: n16.loadingContainer, "aria-label": e24.loading, title: e24.loading }, this.renderLoadingIcon()) : null;
  }
  renderPreviousIcon() {
    const e24 = f4(this.container), t30 = { [n16.iconRightTriangleArrow]: e24, [n16.paginationPreviousIconRTL]: e24, [n16.iconLeftTriangleArrow]: !e24, [n16.paginationPreviousIconLTR]: !e24 };
    return n5("span", { "aria-hidden": "true", class: this.classes(n16.icon, t30) });
  }
  renderPreviousButton() {
    const { messages: e24 } = this;
    return n5("div", { role: "button", tabIndex: 0, bind: this, onclick: this._previous, onkeydown: this._previous, class: this.classes(n16.button, n16.paginationPrevious), "aria-label": e24.previous, title: e24.previous }, this.renderPreviousIcon());
  }
  renderNextIcon() {
    const e24 = f4(this.container), t30 = { [n16.iconLeftTriangleArrow]: e24, [n16.paginationNextIconRTL]: e24, [n16.iconRightTriangleArrow]: !e24, [n16.paginationNextIconLTR]: !e24 };
    return n5("span", { "aria-hidden": "true", class: this.classes(n16.icon, t30) });
  }
  renderNextButton() {
    const { messages: e24 } = this;
    return n5("div", { role: "button", tabIndex: 0, bind: this, onclick: this._next, onkeydown: this._next, class: this.classes(n16.button, n16.paginationNext), "aria-label": e24.next, title: e24.next }, this.renderNextIcon());
  }
  renderFeatureMenuButton() {
    const { featureMenuOpen: e24, featureMenuId: t30, messagesCommon: i34 } = this, { featureCount: o27, selectedFeatureIndex: n31 } = this.viewModel;
    return n5("div", { role: "button", tabIndex: 0, bind: this, onclick: this._toggleFeatureMenu, onkeydown: this._toggleFeatureMenu, afterCreate: this._focusFeatureMenuButtonNode, afterUpdate: this._focusFeatureMenuButtonNode, class: this.classes(n16.button, n16.featureMenuButton), "aria-haspopup": "true", "aria-controls": t30, "aria-expanded": e24.toString(), "aria-label": i34.menu, title: i34.menu }, this._getPageText(o27, n31));
  }
  renderNavigationButtons() {
    return this.featureNavigationVisible ? [this.renderPreviousButton(), this.renderNavigationLoading() || this.renderFeatureMenuButton(), this.renderNextButton()] : [];
  }
  renderDockIcon() {
    const { dockEnabled: e24 } = this, t30 = this._wouldDockTo(), i34 = { [n16.iconUndock]: e24, [n16.iconDock]: !e24, [n16.iconDockToRight]: !e24 && ("top-right" === t30 || "bottom-right" === t30), [n16.iconDockToLeft]: !e24 && ("top-left" === t30 || "bottom-left" === t30), [n16.iconDockToTop]: !e24 && "top-center" === t30, [n16.iconDockToBottom]: !e24 && "bottom-center" === t30 };
    return n5("span", { "aria-hidden": "true", class: this.classes(i34, n16.icon) });
  }
  renderDockButton() {
    var _a, _b, _c;
    const { dockEnabled: e24, messages: t30 } = this, i34 = (_b = (_a = this.viewModel) == null ? void 0 : _a.view) == null ? void 0 : _b.widthBreakpoint, o27 = e24 ? t30.undock : t30.dock;
    return "xsmall" !== i34 && ((_c = this.dockOptions) == null ? void 0 : _c.buttonEnabled) ? n5("div", { role: "button", "aria-label": o27, title: o27, tabIndex: 0, bind: this, onclick: this._toggleDockEnabled, onkeydown: this._toggleDockEnabled, afterCreate: this._focusDockButtonNode, afterUpdate: this._focusDockButtonNode, class: this.classes(n16.button, n16.buttonDock) }, this.renderDockIcon()) : null;
  }
  renderTitle() {
    const { title: e24 } = this.viewModel, { titleId: t30, collapsible: i34, contentCollapsed: o27, messagesCommon: n31 } = this, s27 = { [n16.headerContainerButton]: i34 }, r24 = n5(n9, { level: this.headingLevel, class: n16.headerTitle, innerHTML: e24 ?? "" }), l25 = i34 ? n5("button", { key: `${e24}--collapsible`, id: t30, title: o27 ? n31.expand : n31.collapse, bind: this, enterAnimation: this._createFeatureUpdatedAnimation(), class: this.classes(n16.headerContainer, s27), "aria-expanded": o27 ? "false" : "true", onclick: this._toggleCollapsed, type: "button" }, r24, n5("calcite-icon", { class: n16.collapseIcon, key: "collapse-icon", icon: o27 ? "chevron-down" : "chevron-up", scale: "m" })) : n5("div", { key: e24 ?? "title", id: t30, bind: this, enterAnimation: this._createFeatureUpdatedAnimation(), class: this.classes(n16.headerContainer, s27) }, r24);
    return e24 ? l25 : null;
  }
  renderCloseIcon() {
    return n5("span", { "aria-hidden": "true", class: this.classes(n16.icon, n16.iconClose) });
  }
  renderCloseButton() {
    const { visibleElements: e24, messagesCommon: t30 } = this;
    return e24.closeButton ? n5("div", { role: "button", tabIndex: 0, bind: this, onclick: this._close, onkeydown: this._close, class: n16.button, "aria-label": t30.close, title: t30.close, afterCreate: this._closeButtonNodeUpdated, afterUpdate: this._closeButtonNodeUpdated }, this.renderCloseIcon()) : null;
  }
  renderHeader() {
    return n5("header", { class: n16.header }, this.renderTitle(), n5("div", { class: n16.headerButtons }, this.renderDockButton(), this.renderCloseButton()));
  }
  renderContentContainer() {
    const { contentId: e24, hasContent: t30, contentCollapsed: i34, _flowItems: o27 } = this, { content: n31 } = this.viewModel, s27 = o27.toArray(), r24 = { [n16.contentHasFlows]: !!s27.length };
    return t30 && !i34 ? n5("div", { key: n31 ?? "content", enterAnimation: this._createFeatureUpdatedAnimation(), id: e24, class: this.classes(n16.content, r24) }, n5("calcite-flow", { bind: this }, n5("calcite-flow-item", { bind: this, "data-node-ref": "_rootFlowItemNode", afterCreate: v5, key: "root-flow-item", onCalciteFlowItemBack: this._handleBackClick }, this.renderContent()), s27.map((e25) => this.renderFlowItem(e25))), s27.map((e25) => this.renderFlowItemTooltips(e25))) : null;
  }
  renderFlowItem(e24) {
    const { messages: t30 } = this, i34 = r6(), o27 = "graphic" in e24 && !e24.isTable;
    return n5("calcite-flow-item", { bind: this, class: this.classes({ [n16.calciteThemeDark]: !i34, [n16.calciteThemeLight]: i34 }), heading: e24.title ?? "", description: this._getFlowItemDescription(e24), onCalciteFlowItemBack: this._handleBackClick, key: `flow-item-${e24.viewModel.uid}` }, n5("calcite-action", { class: n16.actionExit, icon: "move-up", label: t30 == null ? void 0 : t30.exitRelatedRecords, text: t30 == null ? void 0 : t30.exitRelatedRecords, slot: "header-actions-start", bind: this, afterCreate: (t31) => this._storeExitRelatedRecordsAction(e24, t31), onclick: this._destroyFlowItemWidgets }), o27 ? n5("calcite-action", { class: n16.actionSelectFeature, icon: "zoom-to-object", label: t30 == null ? void 0 : t30.selectFeature, text: t30 == null ? void 0 : t30.selectFeature, slot: "header-actions-end", bind: this, afterCreate: (t31) => this._storeFeatureSelectionAction(e24, t31), onclick: () => this._handleOpenRelatedFeature(e24) }) : null, n5("div", { class: this.classes(n16.contentFlowItem, { [n16.calciteThemeDark]: i34, [n16.calciteThemeLight]: !i34 }) }, e24.render()));
  }
  renderFlowItemTooltips(e24) {
    const { messages: t30, _exitRelatedRecordsActions: i34, _featureSelectionActions: o27 } = this, n31 = r6(), s27 = o27.get(e24);
    return [n5("calcite-tooltip", { class: this.classes({ [n16.calciteThemeDark]: !n31, [n16.calciteThemeLight]: n31 }), key: `exit-related-records-tooltip-${e24.viewModel.uid}`, label: t30 == null ? void 0 : t30.exitRelatedRecords, overlayPositioning: "fixed", referenceElement: i34.get(e24), placement: "top" }, t30 == null ? void 0 : t30.exitRelatedRecords), s27 ? n5("calcite-tooltip", { class: this.classes({ [n16.calciteThemeDark]: !n31, [n16.calciteThemeLight]: n31 }), key: `select-related-record-tooltip-${e24.viewModel.uid}`, label: t30 == null ? void 0 : t30.selectFeature, overlayPositioning: "fixed", referenceElement: s27, placement: "top" }, t30 == null ? void 0 : t30.selectFeature) : null];
  }
  renderActionsMenuButton() {
    const { actionsMenuId: e24, actionsMenuButtonId: t30, actionsMenuOpen: i34, dividedActions: o27, messagesCommon: n31 } = this, s27 = i34 ? n31.close : n31.open, { menuActions: r24 } = o27;
    return r24.length ? n5("div", { key: V2("actions-menu-button"), class: this.classes(n16.button, n16.actionsMenuButton), role: "button", id: t30, "aria-haspopup": "true", "aria-controls": i34 ? e24 : null, tabIndex: 0, bind: this, onclick: this._toggleActionsMenu, onkeydown: this._toggleActionsMenu, afterCreate: this._focusActionsMenuButtonNode, afterUpdate: this._focusActionsMenuButtonNode, "aria-label": s27, title: s27 }, n5("span", { "aria-hidden": "true", class: n16.iconActionsMenu })) : null;
  }
  renderMenuActions() {
    const { actionsMenuId: e24, actionsMenuButtonId: t30, actionsMenuOpen: i34, dividedActions: o27 } = this, { menuActions: n31 } = o27;
    return n31.length && i34 ? n5("ul", { id: e24, role: "menu", "aria-labelledby": t30, key: V2("actions"), class: n16.actions, bind: this, onkeyup: this._handleActionMenuKeyup, afterCreate: this._actionsMenuNodeUpdated, afterUpdate: this._actionsMenuNodeUpdated }, n31.toArray().map((e25) => this.renderAction({ action: e25, type: "menu-item" }))) : null;
  }
  renderInlineActions() {
    const { inlineActions: e24 } = this.dividedActions;
    return e24.length ? e24.toArray().map((e25) => this.renderAction({ action: e25, type: "inline" })) : [];
  }
  renderInlineActionsContainer() {
    const { inlineActions: e24, menuActions: t30 } = this.dividedActions, i34 = !!e24.length, o27 = !!t30.length;
    return i34 || o27 ? n5("div", { key: "inline-actions-container", "data-inline-actions": i34.toString(), "data-menu-actions": o27.toString(), class: n16.inlineActionsContainer }, this.renderInlineActions(), this.renderActionsMenuButton(), this.renderMenuActions()) : null;
  }
  renderNavigation() {
    return this.featureNavigationVisible ? n5("section", { key: V2("navigation"), class: this.classes(n16.navigation) }, this.renderNavigationButtons()) : null;
  }
  renderFooter() {
    const { featureNavigationVisible: e24, dividedActions: t30 } = this, { inlineActions: i34, menuActions: o27 } = t30, n31 = !!i34.length, s27 = !!o27.length, r24 = { [n16.footerHasPagination]: e24, [n16.footerHasActions]: n31, [n16.footerHasActionsMenu]: s27 };
    return e24 || n31 ? n5("div", { key: V2("feature-buttons"), class: this.classes(n16.footer, r24) }, this.renderInlineActionsContainer(), this.renderNavigation()) : null;
  }
  renderFeatureMenuContainer() {
    const { messages: e24 } = this, { featureViewModels: t30, isLoadingFeature: i34 } = this.viewModel, o27 = s6(e24.selectedFeatures, { total: t30.length });
    return n5("section", { key: V2("menu"), class: n16.featureMenu }, n5("strong", { class: n16.featureMenuHeader }, o27), n5("nav", { bind: this, class: n16.featureMenuViewport, "data-node-ref": "_featureMenuViewportNode", afterCreate: v5 }, this.renderFeatureMenu(), n5("div", { class: n16.featureMenuObserver, bind: this, afterCreate: this._featureMenuIntersectionObserverCreated }), i34 ? n5("div", { class: n16.featureMenuLoader }, this.renderLoadingIcon()) : null));
  }
  renderPointer() {
    return this.dockEnabled ? null : n5("div", { key: V2("pointer"), class: n16.pointer, role: "presentation" }, n5("div", { class: this.classes(n16.pointerDirection, n16.shadow) }));
  }
  renderMainContainer() {
    const { dockEnabled: e24, currentAlignment: t30, currentDockPosition: i34, titleId: o27, contentId: n31, collapsible: s27, hasContent: r24, contentCollapsed: l25, visibleElements: a34 } = this, { title: c37 } = this.viewModel, d18 = "bottom-left" === t30 || "bottom-center" === t30 || "bottom-right" === t30 || "top-left" === i34 || "top-center" === i34 || "top-right" === i34, u21 = "top-left" === t30 || "top-center" === t30 || "top-right" === t30 || "bottom-left" === i34 || "bottom-center" === i34 || "bottom-right" === i34, h20 = { [n16.shadow]: e24, [n16.isCollapsible]: s27, [n16.isCollapsed]: l25 };
    return n5("div", { class: this.classes(n16.main, n16.widget, h20), tabIndex: a34.closeButton ? void 0 : -1, role: "dialog", "aria-labelledby": c37 ? o27 : "", "aria-describedby": r24 && !l25 ? n31 : "", bind: this, onkeyup: this._handleMainKeyup, afterCreate: this._mainContainerNodeUpdated, afterUpdate: this._mainContainerNodeUpdated }, d18 ? this.renderFooter() : null, d18 ? this.renderFeatureMenuContainer() : null, this.renderHeader(), this.renderContentContainer(), u21 ? this.renderFooter() : null, u21 ? this.renderFeatureMenuContainer() : null);
  }
  renderContent() {
    var _a;
    const e24 = (_a = this.viewModel) == null ? void 0 : _a.content;
    return e24 ? "string" == typeof e24 ? n5("div", { class: t12.contentNode, key: e24, innerHTML: e24 }) : this.renderNodeContent(e24) : null;
  }
  renderActionText(e24) {
    return n5("span", { key: "text", class: n16.actionText }, e24);
  }
  renderActionIcon(e24) {
    const t30 = this._getActionClass(e24), i34 = this._getActionImage(e24), o27 = { [n16.iconLoading]: e24.active, [n16.rotating]: e24.active, [n16.icon]: !!t30, [n16.actionImage]: !e24.active && !!i34 };
    return t30 && (o27[t30] = !e24.active), n5("span", { key: "icon", "aria-hidden": "true", class: this.classes(n16.icon, o27), styles: this._getIconStyles(i34) });
  }
  renderAction(e24) {
    const { action: t30, type: i34 } = e24, o27 = this._getActionTitle(t30), n31 = { [n16.action]: "toggle" !== t30.type, [n16.actionToggle]: "toggle" === t30.type, [n16.actionToggleOn]: "toggle" === t30.type && t30.value, [n16.buttonDisabled]: t30.disabled }, s27 = [this.renderActionIcon(t30), this.renderActionText(o27)], r24 = "menu-item" === i34 ? n5("li", { key: t30.uid, role: "menuitem", tabIndex: 0, title: o27, "aria-label": o27, class: this.classes(n16.button, n31), onkeyup: this._handleActionMenuItemKeyup, bind: this, "data-action-uid": t30.uid, onclick: this._triggerAction, onkeydown: this._triggerAction }, s27) : n5("div", { key: t30.uid, role: "button", tabIndex: 0, title: o27, "aria-label": o27, class: this.classes(n16.button, n31), onkeyup: this._handleActionMenuItemKeyup, bind: this, "data-action-uid": t30.uid, onclick: this._triggerAction, onkeydown: this._triggerAction }, s27);
    return t30.visible ? r24 : null;
  }
  renderFeatureMenuItem(e24, t30) {
    const { messages: i34, messagesCommon: o27 } = this, { selectedFeatureIndex: n31, selectedFeatureViewModel: s27 } = this.viewModel, r24 = e24 === s27, l25 = { [n16.featureMenuSelected]: r24 }, a34 = r24 ? n5("span", { key: V2(`feature-menu-selected-feature-${n31}`), title: i34.selectedFeature, "aria-label": i34.selectedFeature, class: n16.iconCheckMark }) : null, c37 = n5("span", { innerHTML: e24.title || o27.untitled });
    return n5("li", { role: "menuitem", tabIndex: -1, key: V2(`feature-menu-feature-${n31}`), class: this.classes(l25, n16.featureMenuItem), bind: this, "data-feature-index": t30, onblur: this._removeActiveFeature, onfocus: this._setActiveFeature, onkeyup: this._handleFeatureMenuItemKeyup, onclick: this._selectFeature, onkeydown: this._selectFeature, onmouseover: this._setActiveFeature, onmouseleave: this._removeActiveFeature }, n5("span", { class: n16.featureMenuTitle }, c37, a34));
  }
  renderFeatureMenu() {
    const { featureMenuId: e24 } = this, { featureViewModels: t30 } = this.viewModel;
    return t30.length > 1 ? n5("ol", { class: n16.featureMenuList, id: e24, bind: this, afterCreate: this._featureMenuNodeUpdated, afterUpdate: this._featureMenuNodeUpdated, onkeyup: this._handleFeatureMenuKeyup, role: "menu" }, t30.filter((e25) => !!e25.graphic).map((e25, t31) => this.renderFeatureMenuItem(e25, t31))) : null;
  }
  _storeFeatureSelectionAction(e24, t30) {
    this._featureSelectionActions.set(e24, t30), this.scheduleRender();
  }
  _storeExitRelatedRecordsAction(e24, t30) {
    this._exitRelatedRecordsActions.set(e24, t30), this.scheduleRender();
  }
  _getFlowItemDescription(e24) {
    return "featureCountDescription" in e24 ? e24.featureCountDescription : e24.viewModel.description ?? "";
  }
  async _openRelatedFeature(e24) {
    await e24.viewModel.updateGeometry();
    const t30 = e24.graphic, i34 = t30 == null ? void 0 : t30.geometry;
    if (t2(i34) || t2(t30))
      return;
    this._destroyFlowItemWidgets(), await this.viewModel.zoomTo({ target: i34 });
    const o27 = F6(i34);
    this.open({ features: [t30], location: r(o27) ? o27 : void 0 });
  }
  _destroyFlowItemWidgets() {
    this._flowItems.removeAll().forEach((e24) => {
      "showAllEnabled" in e24.viewModel && (e24.viewModel.showAllEnabled = false), e24.viewModel = null, e24.destroy();
    });
  }
  _handleBackClick() {
    const e24 = this._flowItems.pop();
    e24 && (this._exitRelatedRecordsActions.delete(e24), this._featureSelectionActions.delete(e24), "showAllEnabled" in e24.viewModel && (e24.viewModel.showAllEnabled = false), e24 && (e24.viewModel = null, e24.destroy()));
  }
  _getActionTitle(e24) {
    const { messages: t30, selectedFeature: i34, messagesCommon: o27 } = this, { id: n31 } = e24, s27 = i34 == null ? void 0 : i34.attributes, r24 = e24.title ?? "", l25 = "zoom-to-feature" === n31 ? s6(r24, { messages: t30 }) : "remove-selected-feature" === n31 ? s6(r24, { messages: o27 }) : "zoom-to-clustered-features" === n31 || "browse-clustered-features" === n31 ? s6(r24, { messages: t30 }) : e24.title;
    return l25 && s27 ? s6(l25, s27) : l25 ?? "";
  }
  _getActionClass(e24) {
    const { selectedFeature: t30 } = this, i34 = t30 == null ? void 0 : t30.attributes, { className: o27, image: n31 } = e24, s27 = n31 || o27 ? o27 : n16.iconDefaultAction;
    return s27 && i34 ? s6(s27, i34) : s27 ?? "";
  }
  _getActionImage(e24) {
    const { selectedFeature: t30 } = this, i34 = t30 == null ? void 0 : t30.attributes, { image: o27 } = e24;
    return o27 && i34 ? s6(o27, i34) : o27 ?? "";
  }
  _createFeatureUpdatedAnimation() {
    return w5("enter", n16.hasFeatureUpdated);
  }
  _getInlineActionCount() {
    const { maxInlineActions: e24, featureNavigationVisible: t30 } = this;
    if ("number" != typeof e24)
      return null;
    const i34 = Math.round(e24);
    return Math.max(t30 ? i34 - 1 : i34, 0);
  }
  _watchActions() {
    const { allActions: e24 } = this.viewModel;
    this.notifyChange("dividedActions");
    const t30 = "actions";
    this._handles.remove(t30), e24 && e24.forEach((e25) => {
      this._handles.add(l3(() => [e25.uid, e25.active, e25.className, e25.disabled, e25.id, e25.title, e25.image, e25.visible], () => this.scheduleRender()), t30);
    });
  }
  _divideActions() {
    const { allActions: e24 } = this.viewModel, i34 = e24.filter((e25) => e25.visible), o27 = this._getInlineActionCount(), n31 = null === o27, s27 = 0 === o27;
    return { inlineActions: n31 ? i34.slice(0) : s27 ? new j2() : i34.slice(0, o27), menuActions: n31 ? new j2() : s27 ? i34.slice(0) : i34.slice(o27) };
  }
  _featureMenuOpenChanged(e24) {
    e24 ? this._focusFirstFeature = true : this._focusFeatureMenuButton = true;
  }
  _actionsMenuOpenChanged(e24) {
    e24 ? this._focusFirstAction = true : this._focusActionsMenuButton = true;
  }
  _setTitleFromFeatureWidget() {
    var _a, _b;
    const { selectedFeatureWidget: e24, messagesCommon: t30 } = this;
    e24 && (this.viewModel.title = "error" === ((_a = e24.viewModel) == null ? void 0 : _a.state) ? t30.errorMessage : ((_b = e24.viewModel) == null ? void 0 : _b.title) || "");
  }
  _setContentFromFeatureWidget() {
    const { selectedFeatureWidget: e24 } = this;
    e24 && (this.viewModel.content = e24);
  }
  _unobserveFeatureMenuObserver() {
    this._featureMenuIntersectionObserverNode && this._featureMenuIntersectionObserver.unobserve(this._featureMenuIntersectionObserverNode);
  }
  _featureMenuIntersectionObserverCreated(e24) {
    this._unobserveFeatureMenuObserver(), this._featureMenuIntersectionObserver.observe(e24), this._featureMenuIntersectionObserverNode = e24;
  }
  _handleFeatureMenuKeyup(e24) {
    "Escape" === i2(e24) && (e24.stopPropagation(), this._focusFeatureMenuButton = true, this.featureMenuOpen = false, this.scheduleRender());
  }
  _handleActionMenuKeyup(e24) {
    "Escape" === i2(e24) && (e24.stopPropagation(), this._focusActionsMenuButton = true, this.actionsMenuOpen = false, this.scheduleRender());
  }
  _setActiveFeature(e24) {
    const { viewModel: t30 } = this, i34 = e24.currentTarget["data-feature-index"];
    t30.activeFeature = t30.features[i34] || null;
  }
  _removeActiveFeature() {
    this.viewModel.activeFeature = null;
  }
  _handleFeatureMenuItemKeyup(e24) {
    const t30 = i2(e24), { _featureMenuNode: o27 } = this, n31 = e24.currentTarget["data-feature-index"];
    if (!o27)
      return;
    const s27 = o27.querySelectorAll("li"), r24 = s27.length;
    if ("ArrowUp" !== t30)
      if ("ArrowDown" !== t30)
        if ("Home" !== t30)
          if ("End" !== t30)
            ;
          else {
            e24.stopPropagation();
            s27[s27.length - 1].focus();
          }
        else {
          e24.stopPropagation();
          s27[0].focus();
        }
      else {
        e24.stopPropagation();
        s27[(n31 + 1 + r24) % r24].focus();
      }
    else {
      e24.stopPropagation();
      s27[(n31 - 1 + r24) % r24].focus();
    }
  }
  _handleActionMenuItemKeyup(e24) {
    const t30 = i2(e24), { _actionsMenuNode: o27 } = this, n31 = e24.currentTarget.dataset.actionUid, { menuActions: s27 } = this.dividedActions, r24 = s27.findIndex((e25) => e25.uid === n31);
    if (!o27)
      return;
    const l25 = o27.querySelectorAll("li"), a34 = l25.length;
    if ("ArrowUp" !== t30)
      if ("ArrowDown" !== t30)
        if ("Home" !== t30)
          if ("End" !== t30)
            ;
          else {
            e24.stopPropagation();
            l25[l25.length - 1].focus();
          }
        else {
          e24.stopPropagation();
          l25[0].focus();
        }
      else {
        e24.stopPropagation();
        l25[(r24 + 1 + a34) % a34].focus();
      }
    else {
      e24.stopPropagation();
      l25[(r24 - 1 + a34) % a34].focus();
    }
  }
  _handleMainKeyup(e24) {
    const t30 = i2(e24);
    "ArrowLeft" === t30 && (e24.stopPropagation(), this.previous()), "ArrowRight" === t30 && (e24.stopPropagation(), this.next());
  }
  _spinnerEnabledChange(e24) {
    if (this._destroySpinner(), !e24)
      return;
    const t30 = this.get("viewModel.view");
    this._createSpinner(t30);
  }
  _hideSpinner() {
    const { _spinner: e24 } = this;
    e24 && (e24.location = null, e24.hide());
  }
  _displaySpinner() {
    const { _spinner: e24 } = this;
    if (!e24)
      return;
    const { location: t30, waitingForResult: i34 } = this.viewModel;
    i34 && t30 ? e24.show({ location: t30 }) : e24.hide();
  }
  _getIconStyles(e24) {
    return { "background-image": e24 ? `url(${e24})` : "" };
  }
  async _shouldFocus(e24) {
    (e24 == null ? void 0 : e24.shouldFocus) && (await j3(() => {
      var _a;
      return true === ((_a = this.viewModel) == null ? void 0 : _a.active);
    }), this.focus());
  }
  _addSelectedFeatureIndexHandle() {
    const e24 = l3(() => {
      var _a;
      return (_a = this.viewModel) == null ? void 0 : _a.selectedFeatureIndex;
    }, (e25, t30) => this._selectedFeatureIndexUpdated(e25, t30));
    this._handles.add(e24, B4);
  }
  _selectedFeatureIndexUpdated(e24, t30) {
    const { featureCount: i34 } = this;
    i34 && e24 !== t30 && -1 !== e24 && (this._destroyFlowItemWidgets(), this.actionsMenuOpen = false, this.featureMenuOpen = false, this._mainContainerNode && (this._mainContainerNode.scrollTop = 0), this._rootFlowItemNode && this._rootFlowItemNode.scrollContentTo({ top: 0 }));
  }
  _destroySelectedFeatureWidget() {
    const { _feature: e24 } = this;
    e24 && (e24.viewModel = null, e24 && !e24.destroyed && e24.destroy()), this._feature = null;
  }
  _isScreenLocationWithinView(e24, t30) {
    return e24.x > -1 && e24.y > -1 && e24.x <= t30.width && e24.y <= t30.height;
  }
  _isOutsideView(e24) {
    const { popupHeight: t30, popupWidth: i34, screenLocation: o27, side: n31, view: s27 } = e24;
    if (isNaN(i34) || isNaN(t30) || !s27 || !o27)
      return false;
    const r24 = s27.padding;
    return "right" === n31 && o27.x + i34 / 2 > s27.width - r24.right || ("left" === n31 && o27.x - i34 / 2 < r24.left || ("top" === n31 && o27.y - t30 < r24.top || "bottom" === n31 && o27.y + t30 > s27.height - r24.bottom));
  }
  _calculateAutoAlignment(e24) {
    if ("auto" !== e24)
      return e24;
    const { _pointerOffsetInPx: t30, _containerNode: i34, _mainContainerNode: o27, viewModel: n31 } = this, { screenLocation: r24, view: l25 } = n31;
    if (t2(r24) || !l25 || !i34)
      return "top-center";
    if (!this._isScreenLocationWithinView(r24, l25))
      return this._get("currentAlignment") || "top-center";
    function a34(e25) {
      return parseInt(e25.replace(/[^-\d\.]/g, ""), 10);
    }
    const c37 = o27 ? window.getComputedStyle(o27, null) : null, d18 = c37 ? a34(c37.getPropertyValue("max-height")) : 0, u21 = c37 ? a34(c37.getPropertyValue("height")) : 0, { height: h20, width: p30 } = i34.getBoundingClientRect(), g17 = p30 + t30, m25 = Math.max(h20, d18, u21) + t30, v16 = this._isOutsideView({ popupHeight: m25, popupWidth: g17, screenLocation: r24, side: "right", view: l25 }), f18 = this._isOutsideView({ popupHeight: m25, popupWidth: g17, screenLocation: r24, side: "left", view: l25 }), _10 = this._isOutsideView({ popupHeight: m25, popupWidth: g17, screenLocation: r24, side: "top", view: l25 }), w18 = this._isOutsideView({ popupHeight: m25, popupWidth: g17, screenLocation: r24, side: "bottom", view: l25 });
    return f18 ? _10 ? "bottom-right" : "top-right" : v16 ? _10 ? "bottom-left" : "top-left" : _10 ? w18 ? "top-center" : "bottom-center" : "top-center";
  }
  _callCurrentAlignment(e24) {
    return "function" == typeof e24 ? e24.call(this) : e24;
  }
  _getCurrentAlignment() {
    const { alignment: e24, dockEnabled: t30 } = this;
    return t30 || !this.viewModel.active ? null : this._calculatePositionResult(this._calculateAutoAlignment(this._callCurrentAlignment(e24)));
  }
  _setCurrentAlignment() {
    this._set("currentAlignment", this._getCurrentAlignment());
  }
  _setCurrentDockPosition() {
    this._set("currentDockPosition", this._getCurrentDockPosition());
  }
  _calculatePositionResult(e24) {
    const t30 = ["left", "right"];
    return f4(this.container) && t30.reverse(), e24.replace(/leading/gi, t30[0]).replace(/trailing/gi, t30[1]);
  }
  _callDockPosition(e24) {
    return "function" == typeof e24 ? e24.call(this) : e24;
  }
  _getDockPosition() {
    var _a;
    return this._calculatePositionResult(this._calculateAutoDockPosition(this._callDockPosition((_a = this.dockOptions) == null ? void 0 : _a.position)));
  }
  _getCurrentDockPosition() {
    return this.dockEnabled && this.viewModel.active ? this._getDockPosition() : null;
  }
  _wouldDockTo() {
    return this.dockEnabled ? null : this._getDockPosition();
  }
  _calculateAutoDockPosition(e24) {
    var _a;
    if ("auto" !== e24)
      return e24;
    const t30 = (_a = this.viewModel) == null ? void 0 : _a.view, i34 = f4(this.container) ? "top-left" : "top-right";
    if (!t30)
      return i34;
    const o27 = t30.padding || { left: 0, right: 0, top: 0, bottom: 0 }, n31 = t30.width - o27.left - o27.right, { breakpoints: s27 } = t30;
    return s27 && n31 <= s27.xsmall ? "bottom-center" : i34;
  }
  _positionContainer(e24 = this._containerNode) {
    if (e24 && (this._containerNode = e24), !this._containerNode)
      return;
    const { screenLocation: t30 } = this.viewModel, { width: i34 } = this._containerNode.getBoundingClientRect(), o27 = this._calculatePositionStyle(t30, i34);
    o27 && Object.assign(this._containerNode.style, o27);
  }
  _calculateFullWidth(e24) {
    const { currentAlignment: t30, _pointerOffsetInPx: i34 } = this;
    return "top-left" === t30 || "bottom-left" === t30 || "top-right" === t30 || "bottom-right" === t30 ? e24 + i34 : e24;
  }
  _calculateAlignmentPosition(e24, t30, i34, o27) {
    const { currentAlignment: n31, _pointerOffsetInPx: s27 } = this;
    if (!i34)
      return;
    const { padding: r24 } = i34, l25 = o27 / 2, a34 = i34.height - t30, c37 = i34.width - e24;
    return "bottom-center" === n31 ? { top: t30 + s27 - r24.top, left: e24 - l25 - r24.left } : "top-left" === n31 ? { bottom: a34 + s27 - r24.bottom, right: c37 + s27 - r24.right } : "bottom-left" === n31 ? { top: t30 + s27 - r24.top, right: c37 + s27 - r24.right } : "top-right" === n31 ? { bottom: a34 + s27 - r24.bottom, left: e24 + s27 - r24.left } : "bottom-right" === n31 ? { top: t30 + s27 - r24.top, left: e24 + s27 - r24.left } : "top-center" === n31 ? { bottom: a34 + s27 - r24.bottom, left: e24 - l25 - r24.left } : void 0;
  }
  _calculatePositionStyle(e24, t30) {
    const { dockEnabled: i34, view: o27 } = this;
    if (!o27)
      return;
    if (i34)
      return { left: "", top: "", right: "", bottom: "" };
    if (t2(e24) || !t30)
      return;
    const n31 = this._calculateFullWidth(t30), r24 = this._calculateAlignmentPosition(e24.x, e24.y, o27, n31);
    return r24 ? { top: void 0 !== r24.top ? `${r24.top}px` : "auto", left: void 0 !== r24.left ? `${r24.left}px` : "auto", bottom: void 0 !== r24.bottom ? `${r24.bottom}px` : "auto", right: void 0 !== r24.right ? `${r24.right}px` : "auto" } : void 0;
  }
  _viewChange(e24, t30) {
    e24 && t30 && (this.close(), this.clear());
  }
  _viewReadyChange(e24, t30) {
    if (e24) {
      const e25 = this.get("viewModel.view");
      this._wireUpView(e25);
    } else
      t30 && (this.close(), this.clear());
  }
  _wireUpView(e24) {
    if (this._destroySpinner(), !e24)
      return;
    const { spinnerEnabled: t30 } = this;
    t30 && this._createSpinner(e24), this._setDockEnabledForViewSize(this.dockOptions);
  }
  _dockingThresholdCrossed(e24, t30, i34) {
    const [o27, n31] = e24, [s27, r24] = t30, { width: l25 = 0, height: a34 = 0 } = i34 ?? {};
    return o27 <= l25 && s27 > l25 || o27 > l25 && s27 <= l25 || n31 <= a34 && r24 > a34 || n31 > a34 && r24 <= a34;
  }
  _updateDockEnabledForViewSize(e24, t30) {
    if (!e24 || !t30)
      return;
    const i34 = this.get("viewModel.view.padding") || { left: 0, right: 0, top: 0, bottom: 0 }, o27 = i34.left + i34.right, n31 = i34.top + i34.bottom, s27 = [], r24 = [];
    s27[0] = e24[0] - o27, s27[1] = e24[1] - n31, r24[0] = t30[0] - o27, r24[1] = t30[1] - n31;
    const { dockOptions: l25 } = this, a34 = l25.breakpoint;
    this._dockingThresholdCrossed(s27, r24, a34) && this._setDockEnabledForViewSize(l25), this._setCurrentDockPosition();
  }
  _focusDockButtonNode(e24) {
    this._focusDockButton && (this._focusDockButton = false, e24.focus());
  }
  _closeButtonNodeUpdated(e24) {
    return this._focusClose ? (this._focusClose = false, void e24.focus()) : this._blurClose ? (this._blurClose = false, void e24.blur()) : void 0;
  }
  _mainContainerNodeUpdated(e24) {
    return this._mainContainerNode = e24, this._focusContainer ? (this._focusContainer = false, void e24.focus()) : this._blurContainer ? (this._blurContainer = false, void e24.blur()) : void 0;
  }
  _featureMenuNodeUpdated(e24) {
    if (this._featureMenuNode = e24, !e24 || !this._focusFirstFeature)
      return;
    this._focusFirstFeature = false;
    const t30 = e24.querySelectorAll("li");
    if (t30.length) {
      t30[0].focus();
    }
  }
  _actionsMenuNodeUpdated(e24) {
    if (this._actionsMenuNode = e24, !e24 || !this._focusFirstAction)
      return;
    this._focusFirstAction = false;
    const t30 = e24.querySelectorAll("li");
    if (t30.length) {
      t30[0].focus();
    }
  }
  _focusFeatureMenuButtonNode(e24) {
    this._focusFeatureMenuButton && (this._focusFeatureMenuButton = false, e24.focus());
  }
  _focusActionsMenuButtonNode(e24) {
    this._focusActionsMenuButton && (this._focusActionsMenuButton = false, e24.focus());
  }
  _featureMenuViewportScrollTop() {
    this._featureMenuViewportNode && (this._featureMenuViewportNode.scrollTop = 0);
  }
  _toggleScreenLocationEnabled() {
    const { dockEnabled: e24, viewModel: t30 } = this;
    if (!t30)
      return;
    const i34 = t30.active && !e24;
    t30.screenLocationEnabled = i34;
  }
  _shouldDockAtCurrentViewSize(e24) {
    var _a, _b;
    const t30 = e24.breakpoint, i34 = (_b = (_a = this.viewModel) == null ? void 0 : _a.view) == null ? void 0 : _b.ui;
    if (!i34)
      return false;
    const { width: o27, height: n31 } = i34;
    if (isNaN(o27) || isNaN(n31))
      return false;
    if (!t30)
      return false;
    const s27 = t30.hasOwnProperty("width") && o27 <= (t30.width ?? 0), r24 = t30.hasOwnProperty("height") && n31 <= (t30.height ?? 0);
    return s27 || r24;
  }
  _setDockEnabledForViewSize(e24) {
    e24.breakpoint && (this.dockEnabled = this._shouldDockAtCurrentViewSize(e24));
  }
  _getPageText(e24, t30) {
    return this.featureNavigationVisible ? s6(this.messages.pageText, { index: t30 + 1, total: e24 }) : null;
  }
  _destroySpinner() {
    const { _spinner: e24, view: t30 } = this;
    e24 && (t30 && t30.ui && t30.ui.remove(e24, L5), e24.destroy(), this._spinner = null);
  }
  _createSpinner(e24) {
    e24 && (this._spinner = new m15({ view: e24 }), e24.ui.add(this._spinner, { key: L5, position: "manual" }));
  }
  _toggleCollapsed() {
    this.collapsed = !this.collapsed;
  }
  _close() {
    this.close(), this.view && this.view.focus();
  }
  _toggleDockEnabled() {
    this.dockEnabled = !this.dockEnabled, this._focusDockButton = true, this.scheduleRender();
  }
  _toggleFeatureMenu() {
    const e24 = !this.featureMenuOpen;
    this._featureMenuOpenChanged(e24), this.actionsMenuOpen = false, this.featureMenuOpen = e24;
  }
  _toggleActionsMenu() {
    const e24 = !this.actionsMenuOpen;
    this._actionsMenuOpenChanged(e24), this.featureMenuOpen = false, this.actionsMenuOpen = e24;
  }
  _triggerAction(e24) {
    const t30 = e24.currentTarget.dataset.actionUid, { allActions: i34 } = this.viewModel, o27 = i34.findIndex((e25) => e25.uid === t30), n31 = i34.getItemAt(o27);
    n31 && "toggle" === n31.type && (n31.value = !n31.value), this.actionsMenuOpen = false, this.viewModel.triggerAction(o27);
  }
  _selectFeature(e24) {
    const t30 = e24.currentTarget["data-feature-index"];
    isNaN(t30) || (this.viewModel.selectedFeatureIndex = t30), this.featureMenuOpen = false, this._focusFeatureMenuButton = true, this.scheduleRender();
  }
  _next() {
    this.next();
  }
  _previous() {
    this.previous();
  }
};
e([y2({ readOnly: true })], W5.prototype, "actionsMenuId", null), e([y2({ readOnly: true })], W5.prototype, "actionsMenuButtonId", null), e([y2({ readOnly: true })], W5.prototype, "featureMenuId", null), e([y2({ readOnly: true })], W5.prototype, "titleId", null), e([y2({ readOnly: true })], W5.prototype, "contentId", null), e([y2({ readOnly: true })], W5.prototype, "hasContent", null), e([y2({ readOnly: true })], W5.prototype, "featureNavigationVisible", null), e([y2({ readOnly: true })], W5.prototype, "collapsible", null), e([y2({ readOnly: true })], W5.prototype, "featureMenuVisible", null), e([y2({ readOnly: true })], W5.prototype, "contentCollapsed", null), e([y2({ readOnly: true })], W5.prototype, "dividedActions", null), e([y2({ readOnly: true, dependsOn: ["_flowItems.length"] })], W5.prototype, "_activeFlowItemWidget", null), e([y2()], W5.prototype, "actions", null), e([y2()], W5.prototype, "actionsMenuOpen", null), e([y2()], W5.prototype, "alignment", void 0), e([y2()], W5.prototype, "autoCloseEnabled", null), e([y2()], W5.prototype, "autoOpenEnabled", null), e([y2()], W5.prototype, "defaultPopupTemplateEnabled", null), e([y2()], W5.prototype, "content", null), e([y2()], W5.prototype, "collapsed", void 0), e([y2()], W5.prototype, "collapseEnabled", void 0), e([y2({ readOnly: true })], W5.prototype, "currentAlignment", null), e([y2({ readOnly: true })], W5.prototype, "currentDockPosition", null), e([y2()], W5.prototype, "dockOptions", null), e([y2()], W5.prototype, "dockEnabled", void 0), e([y2({ readOnly: true })], W5.prototype, "featureCount", null), e([y2()], W5.prototype, "featureMenuOpen", void 0), e([y2()], W5.prototype, "features", null), e([y2()], W5.prototype, "goToOverride", null), e([y2()], W5.prototype, "headingLevel", void 0), e([y2()], W5.prototype, "highlightEnabled", null), e([y2()], W5.prototype, "location", null), e([y2()], W5.prototype, "label", null), e([y2()], W5.prototype, "maxInlineActions", void 0), e([y2(), e4("esri/widgets/Popup/t9n/Popup")], W5.prototype, "messages", void 0), e([y2(), e4("esri/t9n/common")], W5.prototype, "messagesCommon", void 0), e([y2()], W5.prototype, "promises", null), e([y2({ readOnly: true })], W5.prototype, "selectedFeature", null), e([y2()], W5.prototype, "selectedFeatureIndex", null), e([y2({ readOnly: true })], W5.prototype, "selectedFeatureWidget", null), e([y2()], W5.prototype, "spinnerEnabled", void 0), e([y2()], W5.prototype, "title", null), e([y2()], W5.prototype, "updateLocationEnabled", null), e([y2()], W5.prototype, "view", null), e([y2({ type: H4 }), e5(["triggerAction", "trigger-action"])], W5.prototype, "viewModel", void 0), e([y2()], W5.prototype, "visible", null), e([y2()], W5.prototype, "visibleElements", void 0), e([s4("visibleElements")], W5.prototype, "castVisibleElements", null), e([t8()], W5.prototype, "_close", null), e([t8()], W5.prototype, "_toggleDockEnabled", null), e([t8()], W5.prototype, "_toggleFeatureMenu", null), e([t8()], W5.prototype, "_toggleActionsMenu", null), e([t8()], W5.prototype, "_triggerAction", null), e([t8()], W5.prototype, "_selectFeature", null), e([t8()], W5.prototype, "_next", null), e([t8()], W5.prototype, "_previous", null), W5 = e([a3("esri.widgets.Popup")], W5);
var j9 = W5;

// node_modules/@arcgis/core/views/DOMContainer.js
var m17 = [0, 0];
function f13(e24) {
  const t30 = (e24.ownerDocument || window.document).defaultView, s27 = e24.getBoundingClientRect();
  return m17[0] = s27.left + ((t30 == null ? void 0 : t30.pageXOffset) ?? 0), m17[1] = s27.top + ((t30 == null ? void 0 : t30.pageYOffset) ?? 0), m17;
}
function y11(e24) {
  e24 && (t7(e24), e24.parentNode && e24.parentNode.removeChild(e24));
}
function v13(e24) {
  const t30 = document.createElement("div");
  return e24.appendChild(t30), t30;
}
var _6 = 16;
var g11 = 750;
var w15 = 512;
var C6 = 2;
var z5 = (i34) => {
  let m25 = class extends i34 {
    constructor(...e24) {
      var _a;
      super(...e24), this._freqInfo = { freq: _6, time: g11 }, this._overlayRenderTaskHandle = null, this.height = 0, this.overlay = null, this.position = null, this.resizing = false, this.root = null, this.surface = null, this.suspended = true, this.ui = null, this.userContent = null, this.width = 0, this.widthBreakpoint = null, 0 !== e24.length && void 0 !== ((_a = e24[0]) == null ? void 0 : _a.popup) || (this.popup = new j9({ view: this })), this.handles.add([l3(() => this.cursor, (e25) => {
        const { surface: t30 } = this;
        t30 && t30.setAttribute("data-cursor", e25);
      }), l3(() => this.interacting, (e25) => {
        const { surface: t30 } = this;
        t30 && t30.setAttribute("data-interacting", e25.toString());
      })]);
    }
    initialize() {
      this.handles.add(l3(() => this.ui, (e24, t30) => this._handleUIChange(e24, t30))), this._wireUI(this.ui), this.handles.add([this.on("focus", () => this.notifyChange("focused")), this.on("blur", () => this.notifyChange("focused"))]);
    }
    destroy() {
      this.destroyed || (this.ui = a(this.ui), this.popup && !this.popup.destroyed && this.popup.destroy(), this.container = null);
    }
    get container() {
      return this._get("container") ?? null;
    }
    set container(e24) {
      const i35 = this._get("container"), r24 = e3(e24);
      if (r24 || "string" != typeof e24 || s2.getLogger(this.declaredClass).error("#container", `element with id '${e24}' not found`), i35 === r24)
        return;
      const l25 = "dom-size";
      if (this.handles.remove(l25), this._stopMeasuring(), i35 && (i35.classList.remove("esri-view"), this._overlayRenderTaskHandle && (this._overlayRenderTaskHandle.remove(), this._overlayRenderTaskHandle = null), this.overlay && (this.overlay.destroy(), this._set("overlay", null)), this.root && (y11(this.root), this._set("root", null)), this.userContent && (r5(this.userContent, i35), y11(this.userContent), this._set("userContent", null))), !r24)
        return this._set("width", 0), this._set("height", 0), this._set("position", null), this._set("suspended", true), this._set("surface", null), void this._set("container", null);
      r24.classList.add("esri-view");
      const u21 = document.createElement("div");
      u21.className = "esri-view-user-storage", r5(r24, u21), r24.appendChild(u21), this._set("userContent", u21);
      const c37 = document.createElement("div");
      c37.className = "esri-view-root", r24.insertBefore(c37, r24.firstChild), this._set("root", c37);
      const m26 = document.createElement("div");
      m26.className = "esri-view-surface", m26.setAttribute("role", "application"), m26.tabIndex = 0, c37.appendChild(m26), this._set("surface", m26);
      const f18 = new c11();
      c37.appendChild(f18.surface), this._set("overlay", f18), l3(() => f18.needsRender, (e25) => {
        e25 && !this._overlayRenderTaskHandle ? this._overlayRenderTaskHandle = A2({ render: () => {
          var _a;
          return (_a = this.overlay) == null ? void 0 : _a.render();
        } }) : this._overlayRenderTaskHandle = p(this._overlayRenderTaskHandle);
      }), this.forceDOMReadyCycle(), this.handles.add(l3(() => this.size, (e25) => {
        const [t30, s27] = e25, i36 = "esri-view-surface--inset-outline";
        t30 >= document.body.clientWidth || s27 >= document.body.clientHeight ? m26.classList.add(i36) : m26.classList.remove(i36);
      }, h), l25), this._set("container", r24), this._startMeasuring();
    }
    get focused() {
      const e24 = document.activeElement === this.surface;
      return document.hasFocus() && e24;
    }
    set popup(e24) {
      const t30 = this._get("popup");
      t30 && t30 !== e24 && t30.destroy(), this._set("popup", e24);
    }
    get size() {
      return [this.width, this.height];
    }
    blur() {
      this.surface && this.surface.blur();
    }
    focus() {
      this.surface && this.surface.focus();
    }
    pageToContainer(e24, t30, s27) {
      const i35 = this.position;
      return e24 -= i35 ? i35[0] : 0, t30 -= i35 ? i35[1] : 0, s27 ? (s27[0] = e24, s27[1] = t30) : s27 = [e24, t30], s27;
    }
    containerToPage(e24, t30, s27) {
      const i35 = this.position;
      return e24 += i35 ? i35[0] : 0, t30 += i35 ? i35[1] : 0, s27 ? (s27[0] = e24, s27[1] = t30) : s27 = [e24, t30], s27;
    }
    _handleUIChange(e24, t30) {
      t30 && (this.handles.remove("ui"), t30.destroy()), e24 && this._wireUI(e24), this._set("ui", e24);
    }
    _wireUI(e24) {
      this.handles.remove("ui"), e24 && (e24.view = this, this.handles.add([l3(() => this.root, (t30) => {
        e24.container = t30 ? v13(t30) : null;
      }, h), l3(() => this.popup, (t30, s27) => {
        const i35 = "popup", o27 = "manual";
        s27 && e24.remove(s27, i35), t30 && (t30.view = e24.view, e24.add(t30, { key: i35, position: o27 }));
      }, h)], "ui"));
    }
    _stopMeasuring() {
      this.handles.remove("measuring"), this._get("resizing") && this._set("resizing", false);
    }
    _startMeasuring() {
      const e24 = this._freqInfo;
      e24.freq = _6, e24.time = g11, this.handles.add([(() => {
        const t30 = () => {
          e24.freq = _6, e24.time = g11;
        };
        return window.addEventListener("resize", t30), { remove() {
          window.removeEventListener("resize", t30);
        } };
      })(), A2({ prepare: (e25) => {
        const t30 = this._measure(), s27 = this._freqInfo;
        if (s27.time += e25.deltaTime, t30 && (s27.freq = _6, this._get("resizing") || this._set("resizing", true)), s27.time < s27.freq)
          return;
        s27.time = 0;
        const i35 = this._position();
        s27.freq = i35 || t30 ? _6 : Math.min(g11, s27.freq * C6), !t30 && s27.freq >= w15 && this._get("resizing") && this._set("resizing", false);
      } })], "measuring"), this._measure(), this._position();
    }
    _measure() {
      const e24 = this.container, t30 = e24 ? e24.clientWidth : 0, s27 = e24 ? e24.clientHeight : 0;
      if (0 === t30 || 0 === s27)
        return this.suspended || this._set("suspended", true), false;
      const i35 = this.width, o27 = this.height;
      return t30 === i35 && s27 === o27 ? (this.suspended && this._set("suspended", false), false) : (this._set("width", t30), this._set("height", s27), this.suspended && this._set("suspended", false), this.emit("resize", { oldWidth: i35, oldHeight: o27, width: t30, height: s27 }), true);
    }
    _position() {
      const e24 = this.container, t30 = this.position, s27 = e24 && f13(e24);
      return !!s27 && ((!t30 || s27[0] !== t30[0] || s27[1] !== t30[1]) && (this._set("position", [s27[0], s27[1]]), true));
    }
    forceDOMReadyCycle() {
    }
  };
  return e([y2()], m25.prototype, "container", null), e([y2({ readOnly: true })], m25.prototype, "focused", null), e([y2({ readOnly: true })], m25.prototype, "height", void 0), e([y2({ type: j9 })], m25.prototype, "popup", null), e([y2({ type: c11 })], m25.prototype, "overlay", void 0), e([y2({ readOnly: true })], m25.prototype, "position", void 0), e([y2({ readOnly: true })], m25.prototype, "resizing", void 0), e([y2({ readOnly: true })], m25.prototype, "root", void 0), e([y2({ value: null, readOnly: true })], m25.prototype, "size", null), e([y2({ readOnly: true })], m25.prototype, "surface", void 0), e([y2({ readOnly: true })], m25.prototype, "suspended", void 0), e([y2()], m25.prototype, "ui", void 0), e([y2({ readOnly: true })], m25.prototype, "userContent", void 0), e([y2({ readOnly: true })], m25.prototype, "width", void 0), e([y2()], m25.prototype, "widthBreakpoint", void 0), m25 = e([a3("esri.views.DOMContainer")], m25), m25;
};

// node_modules/@arcgis/core/views/PopupView.js
var a16 = (a34) => {
  let p30 = class extends a34 {
    async fetchPopupFeatures(e24, r24) {
      await this.when();
      const { location: i34, queryArea: a35, layerViewsAndGraphics: p31, clientOnlyGraphics: t30 } = await this._prepareFetchPopupFeatures(e24, r24), o27 = Promise.resolve(t30), c37 = this._queryLayerPopupFeatures(a35, p31, r24), n31 = c37.map((e25) => e25.promise);
      return { location: i34, clientOnlyGraphics: t30, allGraphicsPromise: L([o27, ...n31]).then((e25) => Array.from(new Set(e25.flat()))), promisesPerLayerView: c37 };
    }
    _queryLayerPopupFeatures(e24, s27, i34) {
      return s27.map(({ layerView: s28, graphics: a35 }) => {
        const p31 = { clientGraphics: a35, event: r(i34) ? i34.event : void 0, signal: r(i34) ? i34.signal : void 0, defaultPopupTemplateEnabled: !!r(i34) && !!i34.defaultPopupTemplateEnabled }, t30 = s28.fetchPopupFeatures(e24, p31);
        return { layerView: s28, promise: t30 };
      });
    }
    _isValidPopupGraphic(e24, s27) {
      return e24 && !!e24.getEffectivePopupTemplate(r(s27) && s27.defaultPopupTemplateEnabled);
    }
    async _prepareFetchPopupFeatures(e24, r24) {
      const { clientGraphics: s27, queryArea: i34, location: a35 } = await this._popupHitTestGraphics(e24, r24), p31 = this._getFetchPopupLayerViews(), { layerViewsAndGraphics: t30, clientOnlyGraphics: o27 } = this._graphicsPerFetchPopupLayerView(s27, p31);
      return { clientOnlyGraphics: o27, layerViewsAndGraphics: t30, queryArea: i34, location: a35 };
    }
    async _popupHitTestGraphics(e24, r24) {
      const s27 = await this.popupHitTest(e24), i34 = s27.results, a35 = s27.mapPoint, p31 = i34.filter((e25) => "graphic" === e25.type && this._isValidPopupGraphic(e25.graphic, r24)), t30 = p31.length ? p31[0].mapPoint : null;
      return { clientGraphics: p31.map((e25) => e25.graphic), queryArea: a35, location: a35 || t30 };
    }
    _getFetchPopupLayerViews() {
      const e24 = [];
      return this.allLayerViews.forEach((r24) => {
        this._isValidPopupLayerView(r24) && e24.push(r24);
      }), r(this.graphicsView) && this._isValidPopupLayerView(this.graphicsView) && e24.push(this.graphicsView), e24.reverse();
    }
    _isValidPopupLayerView(e24) {
      return r(e24) && (!("layer" in e24) || !e24.suspended) && "fetchPopupFeatures" in e24;
    }
    _graphicsPerFetchPopupLayerView(e24, r24) {
      const s27 = [], i34 = /* @__PURE__ */ new Map(), a35 = r24.map((e25) => {
        const r25 = [];
        return "layer" in e25 ? i34.set(e25.layer, r25) : i34.set(e25.graphics, r25), { layerView: e25, graphics: r25 };
      });
      for (const p31 of e24) {
        const e25 = i34.get(p31.layer) || i34.get(p31.sourceLayer) || null;
        e25 ? e25.push(p31) : s27.push(p31);
      }
      return { layerViewsAndGraphics: a35, clientOnlyGraphics: s27 };
    }
  };
  return p30 = e([a3("esri.views.PopupView")], p30), p30;
};

// node_modules/@arcgis/core/support/AnalysesCollection.js
var i17 = class extends l6 {
  constructor(e24) {
    super(e24), this.handles.add(this.on("before-add", (e25) => {
      t2(e25.item) || e25.item.parent === this.owner && (s2.getLogger(this.declaredClass).warn("Analysis inside the collection must be unique. Not adding this element again."), e25.preventDefault());
    }));
  }
  _own(e24) {
    e24.parent = this.owner;
  }
  _release(e24) {
    e24.parent = null;
  }
};
i17 = e([a3("esri.support.AnalysesCollection")], i17);

// node_modules/@arcgis/core/views/BasemapView.js
var p14 = class extends v3 {
  constructor(e24) {
    super(e24), this.view = null, this.baseLayerViews = new j2(), this.referenceLayerViews = new j2(), this._loadingHandle = l3(() => {
      var _a, _b;
      return (_b = (_a = this.view) == null ? void 0 : _a.map) == null ? void 0 : _b.basemap;
    }, (e25) => {
      e25 && e25.load().catch(() => {
      });
    }, h);
  }
  destroy() {
    this._set("view", null), this._loadingHandle && (this._loadingHandle.remove(), this._loadingHandle = null);
  }
  get suspended() {
    return !this.view || this.view.suspended;
  }
  get updating() {
    var _a, _b;
    if (this.view && this.view.suspended)
      return false;
    const e24 = (_b = (_a = this.view) == null ? void 0 : _a.map) == null ? void 0 : _b.basemap;
    return !!e24 && (!!e24.loaded && (this.baseLayerViews.some((e25) => e25.updating) || this.referenceLayerViews.some((e25) => e25.updating)));
  }
};
e([y2({ constructOnly: true })], p14.prototype, "view", void 0), e([y2({ readOnly: true })], p14.prototype, "baseLayerViews", void 0), e([y2({ readOnly: true })], p14.prototype, "referenceLayerViews", void 0), e([y2({ readOnly: true })], p14.prototype, "suspended", null), e([y2({ type: Boolean, readOnly: true })], p14.prototype, "updating", null), p14 = e([a3("esri.views.BasemapView")], p14);

// node_modules/@arcgis/core/views/LayerViewManager.js
function v14(e24) {
  return "tryRecycleWith" in e24;
}
var V3 = class {
  constructor(e24, r24, t30) {
    this.layer = e24, this.view = r24, this.layerViewImporter = t30, this._controller = new AbortController(), this._deferred = A(), this._started = false, this.done = false, this.promise = this._deferred.promise, v(this._controller.signal, () => {
      const r25 = new s3("cancelled:layerview-create", "layerview creation cancelled", { layer: e24 });
      this._deferred.reject(r25);
    });
  }
  tryRecycle(e24) {
    if (!this.done || !this.layerView || !v14(this.layerView))
      return null;
    const r24 = this.layer.type, i34 = this._controller.signal;
    for (let t30 = 0; t30 < e24.length; t30++) {
      const s27 = e24[t30];
      if (s27.type !== r24)
        continue;
      const a34 = this.layerView.tryRecycleWith(s27, { signal: i34 });
      if (a34) {
        e24.splice(t30, 1), this.layer = s27;
        const r25 = this.layerView, i35 = r25.view;
        return this.promise = Promise.race([a34.then(() => (f(this._controller.signal), s27.emit("layerview-destroy", { view: i35, layerView: r25 }), i35.emit("layerview-destroy", { view: i35, layerView: r25 }), s27.emit("layerview-create", { view: i35, layerView: r25 }), i35.emit("layerview-create", { view: i35, layerView: r25 }), r25)), new Promise((e25, r26) => v(this._controller.signal, () => r26(a2())))]), this.promise;
      }
    }
    return null;
  }
  destroy() {
    this._controller.abort();
    const { layerView: e24 } = this;
    if (!e24)
      return;
    const { layer: r24, view: i34 } = this;
    r24.emit("layerview-destroy", { view: i34, layerView: e24 }), i34.emit("layerview-destroy", { layer: r24, layerView: e24 }), this.done = true, this.layer = null, this.layerView = null, this.view = null, this.layerViewImporter = null;
  }
  async start() {
    var _a, _b, _c;
    if (this._started)
      return;
    this._started = true;
    const { _controller: { signal: e24 }, layer: r24, view: t30 } = this;
    this._map = t30.map;
    try {
      let a34, o27;
      if (await r24.load({ signal: e24 }), "prefetchResources" in r24 && await ((_a = r24.prefetchResources) == null ? void 0 : _a.call(r24, { signal: e24 })), I6(r24))
        a34 = await r24.createLayerView(t30, { signal: e24 });
      else {
        if (!this.layerViewImporter.hasLayerViewModule(r24))
          throw new s3("layer:view-not-supported", "No layerview implementation was found");
        const s27 = await this.layerViewImporter.importLayerView(r24);
        f(e24), a34 = "default" in s27 ? new s27.default({ layer: r24, view: t30 }) : new s27({ layer: r24, view: t30 });
      }
      const n31 = () => {
        o27 = p(o27), a34.destroyed || a34.destroy(), a34.layer = null, a34.parent = null, a34.view = null, this.done = true;
      };
      o27 = v(e24, n31), f(e24);
      try {
        await a34.when();
      } catch (s27) {
        throw n31(), s27;
      }
      const y16 = (_c = (_b = this._map) == null ? void 0 : _b.allLayers) == null ? void 0 : _c.includes(r24);
      if (!y16)
        return n31(), void this._deferred.reject(new s3("view:no-layerview-for-layer", "The layer has been removed from the map", { layer: r24 }));
      this.layerView = a34, r24.emit("layerview-create", { view: t30, layerView: a34 }), t30.emit("layerview-create", { layer: r24, layerView: a34 }), this.done = true, this._deferred.resolve(a34);
    } catch (s27) {
      r24.emit("layerview-create-error", { view: t30, error: s27 }), t30.emit("layerview-create-error", { layer: r24, error: s27 }), this.done = true, this._deferred.reject(new s3("layerview:create-error", "layerview creation failed", { layer: r24, error: s27 }));
    }
  }
};
var L6 = class extends v3 {
  constructor(e24) {
    super(e24), this._layerLayerViewInfoMap = /* @__PURE__ */ new Map(), this._recyclingInfoMap = /* @__PURE__ */ new Map(), this._watchUpdatingTracking = new c3(), this.supportsGround = true, this._preloadLayerViewModules = () => {
      var _a;
      const e25 = (_a = this.view.map) == null ? void 0 : _a.allLayers;
      if (e25)
        for (const r24 of e25)
          this.layerViewImporter.hasLayerViewModule(r24) && this.layerViewImporter.importLayerView(r24);
    }, this._reschedule = () => (t2(this._workPromise) && (this._workPromise = A(), this._workPromise.promise.catch(() => {
    })), this.removeHandles("reschedule"), this.addHandles(v2(this._doWork), "reschedule"), this._workPromise.promise), this._doWork = () => {
      var _a, _b, _c;
      const e25 = this.view.map;
      if (this._map !== e25 && (this.clear(), this._map = e25), t2(this._workPromise))
        return void this.notifyChange("updating");
      this.removeHandles("reschedule"), this.removeHandles("collection-change");
      const r24 = /* @__PURE__ */ new Set(), i34 = [], t30 = this.view.ready, s27 = (e26) => {
        if (!t2(e26)) {
          for (const a34 of e26)
            if (a34) {
              r24.add(a34);
              const e27 = this._layerLayerViewInfoMap.get(a34);
              e27 && t30 ? e27.start() : e27 || this._recyclingInfoMap.has(a34) || i34.push(a34), "layers" in a34 && a34.layers && s27(a34.layers);
            }
        }
      };
      for (const a34 of this._rootCollectionNames)
        s27(this.get(a34));
      for (const [a34, l25] of this._layerLayerViewInfoMap)
        if (!r24.has(a34)) {
          this._layerLayerViewInfoMap.delete(l25.layer);
          const e26 = l25.tryRecycle(i34);
          e26 ? (this._recyclingInfoMap.set(l25.layer, l25), e26.then(() => {
            this._recyclingInfoMap.delete(l25.layer), this._layerLayerViewInfoMap.set(l25.layer, l25), this._reschedule();
          }).catch(() => {
            this._recyclingInfoMap.delete(l25.layer), l25.destroy(), this._reschedule();
          })) : l25.destroy();
        }
      for (const [a34, l25] of this._recyclingInfoMap)
        r24.has(a34) || (this._recyclingInfoMap.delete(l25.layer), l25.destroy());
      for (const a34 of i34)
        this._createLayerView(a34);
      this._refreshCollections();
      const o27 = [(_a = e25 == null ? void 0 : e25.ground) == null ? void 0 : _a.layers, (_b = e25 == null ? void 0 : e25.basemap) == null ? void 0 : _b.baseLayers, (_c = e25 == null ? void 0 : e25.basemap) == null ? void 0 : _c.referenceLayers, e25 == null ? void 0 : e25.layers].filter((e26) => !!e26);
      r24.forEach((e26) => "layers" in e26 && o27.push(e26.layers)), this.addHandles(o27.map((e26) => this._watchUpdatingTracking.addOnCollectionChange(() => e26, this._reschedule)), "collection-change"), this._workPromise.resolve(), this._workPromise = null;
    };
  }
  initialize() {
    this.own([a6(() => {
      var _a, _b;
      return (_b = (_a = this.view) == null ? void 0 : _a.map) == null ? void 0 : _b.allLayers;
    }, "change", this._preloadLayerViewModules, { onListenerAdd: this._preloadLayerViewModules }), l3(() => {
      const e24 = this.view, r24 = e24 == null ? void 0 : e24.map;
      return [r24 == null ? void 0 : r24.basemap, r24 == null ? void 0 : r24.ground, r24 == null ? void 0 : r24.layers, e24 == null ? void 0 : e24.ready];
    }, () => this._reschedule(), w4)]), this._preloadLayerViewModules(), this._reschedule();
  }
  destroy() {
    this.clear(), this._watchUpdatingTracking.destroy(), this._map = null, r(this._workPromise) && (this._workPromise.reject(a2()), this._workPromise = null);
  }
  get _layersToLayerViews() {
    const e24 = [["view.map.basemap.baseLayers", "view.basemapView.baseLayerViews"], ["view.map.layers", "view.layerViews"], ["view.map.basemap.referenceLayers", "view.basemapView.referenceLayerViews"]];
    return this.supportsGround && e24.push(["view.map.ground.layers", "view.groundView.layerViews"]), new Map(e24);
  }
  get _rootCollectionNames() {
    return Array.from(this._layersToLayerViews.keys());
  }
  get updating() {
    return r(this._workPromise) || this._watchUpdatingTracking.updating || n3(this._layerLayerViewInfoMap, (e24) => !e24.done);
  }
  get updatingRemaining() {
    let e24 = 0;
    for (const r24 of this._layerLayerViewInfoMap.values())
      r24.done || ++e24;
    return e24;
  }
  clear() {
    if (!this.destroyed) {
      for (const e24 of this._layerLayerViewInfoMap.values())
        e24.destroy();
      this._layerLayerViewInfoMap.clear(), this._refreshCollections();
    }
  }
  async whenLayerView(e24) {
    if (await this._reschedule(), !this._layerLayerViewInfoMap.has(e24)) {
      if (this._recyclingInfoMap.has(e24))
        return this._recyclingInfoMap.get(e24).promise;
      throw new s3("view:no-layerview-for-layer", "No layerview has been found for the layer", { layer: e24 });
    }
    return this._layerLayerViewInfoMap.get(e24).promise;
  }
  _refreshCollections() {
    for (const [e24, r24] of this._layersToLayerViews)
      this._populateLayerViewsOwners(this.get(e24), this.get(r24), this.view);
    this.notifyChange("updating"), this.notifyChange("updatingRemaining");
  }
  _populateLayerViewsOwners(e24, r24, i34) {
    if (!e24 || !r24)
      return void (r24 && r24.removeAll());
    let t30 = 0;
    for (const s27 of e24) {
      const e25 = this._layerLayerViewInfoMap.get(s27);
      if (!e25 || !e25.layerView)
        continue;
      const a34 = e25.layerView;
      a34.layer = s27, a34.parent = i34, r24.getItemAt(t30) !== a34 && r24.splice(t30, 0, a34), s27.layers && this._populateLayerViewsOwners(s27.layers, a34.layerViews, a34), t30 += 1;
    }
    t30 < r24.length && r24.splice(t30, r24.length);
  }
  _createLayerView(e24) {
    e24.load().catch(() => {
    }), this.layerViewImporter.hasLayerViewModule(e24) && this.layerViewImporter.importLayerView(e24);
    const r24 = new V3(e24, this.view, this.layerViewImporter);
    r24.promise.then(() => this._refreshCollections(), (r25) => {
      r25 && (j(r25) || "cancelled:layerview-create" === r25.name) || s2.getLogger(this.declaredClass).error(`Failed to create layerview for layer title:'${e24.title ?? "no title"}', id:'${e24.id ?? "no id"}' of type '${e24.type}'.`, { layer: e24, error: r25 }), this._refreshCollections();
    }), this._layerLayerViewInfoMap.set(e24, r24), this.view.ready && r24.start(), this.notifyChange("updating"), this.notifyChange("updatingRemaining");
  }
};
e([y2()], L6.prototype, "_workPromise", void 0), e([y2({ readOnly: true })], L6.prototype, "_watchUpdatingTracking", void 0), e([y2({ readOnly: true })], L6.prototype, "_layersToLayerViews", null), e([y2({ readOnly: true })], L6.prototype, "_rootCollectionNames", null), e([y2()], L6.prototype, "layerViewImporter", void 0), e([y2()], L6.prototype, "supportsGround", void 0), e([y2({ readOnly: true })], L6.prototype, "updating", null), e([y2({ readOnly: true })], L6.prototype, "updatingRemaining", null), e([y2({ constructOnly: true })], L6.prototype, "view", void 0), L6 = e([a3("esri.views.LayerViewManager")], L6);
var M6 = L6;
function I6(e24) {
  return "createLayerView" in e24 && null != e24.createLayerView;
}

// node_modules/@arcgis/core/views/Magnifier.js
var i18 = class extends v3 {
  constructor(o27) {
    super(o27), this.factor = 1.5, this.offset = c2(0, 0), this.position = null, this.size = 120, this.maskUrl = null, this.maskEnabled = true, this.overlayUrl = null, this.overlayEnabled = true, this.visible = true;
  }
  get version() {
    return this.commitProperty("factor"), this.commitProperty("offset"), this.commitProperty("position"), this.commitProperty("visible"), this.commitProperty("size"), this.commitProperty("maskUrl"), this.commitProperty("maskEnabled"), this.commitProperty("overlayUrl"), this.commitProperty("overlayEnabled"), (this._get("version") || 0) + 1;
  }
};
e([y2({ type: Number })], i18.prototype, "factor", void 0), e([y2({ nonNullable: true })], i18.prototype, "offset", void 0), e([y2()], i18.prototype, "position", void 0), e([y2({ type: Number, range: { min: 0 } })], i18.prototype, "size", void 0), e([y2()], i18.prototype, "maskUrl", void 0), e([y2()], i18.prototype, "maskEnabled", void 0), e([y2()], i18.prototype, "overlayUrl", void 0), e([y2()], i18.prototype, "overlayEnabled", void 0), e([y2({ readOnly: true })], i18.prototype, "version", null), e([y2({ type: Boolean })], i18.prototype, "visible", void 0), i18 = e([a3("esri.views.Magnifier")], i18);
var p15 = i18;

// node_modules/@arcgis/core/views/3d/support/TextureCollection.js
var n17 = class extends v3 {
  constructor(e24, t30) {
    super({}), this._stage = e24, this._textureRequests = /* @__PURE__ */ new Map(), this._frameTask = (t30 == null ? void 0 : t30.registerTask(R2.TEXTURE_UNLOAD)) ?? D;
  }
  normalizeCtorArgs() {
    return {};
  }
  destroy() {
    super.destroy(), this._frameTask.remove(), this._textureRequests.forEach((e24) => this._releaseTextureRequest(e24)), this._textureRequests.clear();
  }
  get updating() {
    return this._frameTask.updating;
  }
  fromData(e24, t30, r24) {
    const s27 = this.makeUid(e24);
    let o27 = this._textureRequests.get(s27);
    if (!o27) {
      const e25 = t30();
      o27 = { referenceCount: 0, texture: e25, textureAsync: null, abortController: null, onRemove: r24 }, this._stage && (this._stage.add(e25), this._stage.loadImmediate(e25)), this._textureRequests.set(s27, o27);
    }
    return o27.referenceCount++, { uid: s27, texture: o27.texture, release: () => this._release(s27) };
  }
  _release(e24) {
    const t30 = this._textureRequests.get(e24);
    t30 ? (t30.referenceCount < 1 && console.warn("TextureCollection: reference count is < 1 for " + e24), t30.referenceCount--, t30.referenceCount < 1 && this._frameTask.schedule(() => this._releaseNow(e24))) : console.warn(`TextureCollection: texture doesn't exist: '${e24}'`);
  }
  get test() {
    return { textureRequests: this._textureRequests };
  }
  _releaseNow(e24) {
    if (!this._textureRequests)
      return;
    const t30 = this._textureRequests.get(e24);
    !t30 || t30.referenceCount > 0 || (this._releaseTextureRequest(t30), this._textureRequests.delete(e24));
  }
  _releaseTextureRequest(e24) {
    var _a;
    e24.onRemove && e24.onRemove(), e24.texture ? (_a = this._stage) == null ? void 0 : _a.remove(e24.texture) : e24.abortController && (e24.abortController.abort(), e24.abortController = null);
  }
  makeUid(e24, t30 = null) {
    return r(t30) ? `${e24}.${t30}px` : e24;
  }
};
e([y2()], n17.prototype, "_frameTask", void 0), e([y2()], n17.prototype, "updating", null), n17 = e([a3("esri.views.3d.support.TextureCollection")], n17);

// node_modules/@arcgis/core/views/input/IViewEvents.js
var t18;
!function(t30) {
  t30[t30.Left = 0] = "Left", t30[t30.Middle = 1] = "Middle", t30[t30.Right = 2] = "Right";
}(t18 || (t18 = {}));

// node_modules/@arcgis/core/views/input/ViewEvents.js
var r15 = ["click", "double-click", "immediate-click", "immediate-double-click", "hold", "drag", "key-down", "key-up", "pointer-down", "pointer-move", "pointer-up", "pointer-drag", "mouse-wheel", "pointer-enter", "pointer-leave", "gamepad", "focus", "blur"];
var i19 = {};
function o14(t30) {
  return !!i19[t30];
}
function s16(t30) {
  for (const e24 of t30)
    if (!o14(e24))
      return false;
  return true;
}
r15.forEach((t30) => {
  i19[t30] = true;
});
var p16 = class {
  constructor(t30) {
    this._handlers = /* @__PURE__ */ new Map(), this._counter = 0, this._handlerCounts = /* @__PURE__ */ new Map(), this.view = t30, this.inputManager = null;
  }
  connect(t30) {
    t30 && this.disconnect(), this.inputManager = t30, this._handlers.forEach(({ handler: t31, priority: e24 }, a34) => {
      var _a;
      return (_a = this.inputManager) == null ? void 0 : _a.installHandlers(a34, [t31], e24);
    });
  }
  disconnect() {
    this.inputManager && this._handlers.forEach((t30, e24) => {
      var _a;
      return (_a = this.inputManager) == null ? void 0 : _a.uninstallHandlers(e24);
    }), this.inputManager = null;
  }
  destroy() {
    this.disconnect(), this._handlers.clear(), this.view = null;
  }
  on(t30, e24, a34, r24) {
    const i34 = Array.isArray(t30) ? t30 : t30.split(",");
    if (!s16(i34))
      return i34.some(o14) && console.error("Error: registering input events and other events on the view at the same time is not supported."), null;
    let p30, l25;
    Array.isArray(e24) ? l25 = e24 : (p30 = e24, l25 = []), "function" == typeof a34 ? p30 = a34 : r24 = a34, r24 = null != r24 ? r24 : P.DEFAULT;
    const u21 = this._createUniqueGroupName(), m25 = new c23(this.view, i34, l25, p30);
    this._handlers.set(u21, { handler: m25, priority: r24 });
    for (const n31 of i34) {
      const t31 = this._handlerCounts.get(n31) || 0;
      this._handlerCounts.set(n31, t31 + 1);
    }
    return this.inputManager && this.inputManager.installHandlers(u21, [m25], r24), { remove: () => this._removeHandler(u21, i34) };
  }
  hasHandler(t30) {
    return !!this._handlerCounts.get(t30);
  }
  _removeHandler(t30, e24) {
    if (this._handlers.has(t30)) {
      this._handlers.delete(t30);
      for (const t31 of e24) {
        const e25 = this._handlerCounts.get(t31);
        void 0 === e25 ? console.error("Trying to remove handler for event that has no handlers registered: ", t31) : 1 === e25 ? this._handlerCounts.delete(t31) : this._handlerCounts.set(t31, e25 - 1);
      }
    }
    this.inputManager && this.inputManager.uninstallHandlers(t30);
  }
  _createUniqueGroupName() {
    return this._counter += 1, `viewEvents_${this._counter}`;
  }
};
var c23 = class extends i13 {
  constructor(t30, e24, a34, n31) {
    super(true), this._latestDragStart = void 0, this.view = t30;
    for (const r24 of e24)
      switch (r24) {
        case "click":
          this.registerIncoming("click", a34, (t31) => n31(this._wrapClick(t31)));
          break;
        case "double-click":
          this.registerIncoming("double-click", a34, (t31) => n31(this._wrapDoubleClick(t31)));
          break;
        case "immediate-click":
          this.registerIncoming("immediate-click", a34, (t31) => n31(this._wrapImmediateClick(t31)));
          break;
        case "immediate-double-click":
          this.registerIncoming("immediate-double-click", a34, (t31) => n31(this._wrapImmediateDoubleClick(t31)));
          break;
        case "hold":
          this.registerIncoming("hold", a34, (t31) => n31(this._wrapHold(t31)));
          break;
        case "drag":
          this.registerIncoming("drag", a34, (t31) => {
            const e25 = this._wrapDrag(t31);
            e25 && n31(e25);
          });
          break;
        case "key-down":
          this.registerIncoming("key-down", a34, (t31) => n31(this._wrapKeyDown(t31)));
          break;
        case "key-up":
          this.registerIncoming("key-up", a34, (t31) => n31(this._wrapKeyUp(t31)));
          break;
        case "pointer-down":
          this.registerIncoming("pointer-down", a34, (t31) => n31(this._wrapPointer(t31, "pointer-down")));
          break;
        case "pointer-move":
          this.registerIncoming("pointer-move", a34, (t31) => n31(this._wrapPointer(t31, "pointer-move")));
          break;
        case "pointer-up":
          this.registerIncoming("pointer-up", a34, (t31) => n31(this._wrapPointer(t31, "pointer-up")));
          break;
        case "pointer-drag":
          this.registerIncoming("pointer-drag", a34, (t31) => n31(this._wrapPointerDrag(t31)));
          break;
        case "mouse-wheel":
          this.registerIncoming("mouse-wheel", a34, (t31) => n31(this._wrapMouseWheel(t31)));
          break;
        case "pointer-enter":
          this.registerIncoming("pointer-enter", a34, (t31) => n31(this._wrapPointer(t31, "pointer-enter")));
          break;
        case "pointer-leave":
          this.registerIncoming("pointer-leave", a34, (t31) => n31(this._wrapPointer(t31, "pointer-leave")));
          break;
        case "gamepad":
          this.registerIncoming("gamepad", a34, (t31) => {
            n31(this._wrapGamepad(t31));
          });
          break;
        case "focus":
          this.registerIncoming("focus", a34, (t31) => {
            n31(this._wrapFocus(t31));
          });
          break;
        case "blur":
          this.registerIncoming("blur", a34, (t31) => {
            n31(this._wrapBlur(t31));
          });
      }
  }
  _wrapFocus(t30) {
    return { type: "focus", timestamp: t30.timestamp, native: t30.data.native, cancelable: t30.cancelable, stopPropagation: () => t30.stopPropagation(), async: (e24) => t30.async(e24), preventDefault: () => t30.preventDefault() };
  }
  _wrapBlur(t30) {
    return { type: "blur", timestamp: t30.timestamp, native: t30.data.native, cancelable: t30.cancelable, stopPropagation: () => t30.stopPropagation(), async: (e24) => t30.async(e24), preventDefault: () => t30.preventDefault() };
  }
  _wrapClick(t30) {
    const { pointerType: a34, button: n31, buttons: r24, x: i34, y: o27, native: s27, eventId: p30 } = t30.data, { cancelable: c37, timestamp: l25 } = t30;
    return { type: "click", pointerType: a34, button: n31, buttons: r24, x: i34, y: o27, native: s27, timestamp: l25, screenPoint: c2(i34, o27), mapPoint: this._getMapPoint(i34, o27), eventId: p30, cancelable: c37, stopPropagation: () => t30.stopPropagation(), async: (e24) => t30.async(e24), preventDefault: () => t30.preventDefault() };
  }
  _wrapDoubleClick(t30) {
    const { pointerType: e24, button: a34, buttons: n31, x: r24, y: i34, native: o27, eventId: s27 } = t30.data, { cancelable: p30, timestamp: c37 } = t30;
    return { type: "double-click", pointerType: e24, button: a34, buttons: n31, x: r24, y: i34, native: o27, timestamp: c37, mapPoint: this._getMapPoint(r24, i34), eventId: s27, cancelable: p30, stopPropagation: () => t30.stopPropagation(), async: (e25) => t30.async(e25), preventDefault: () => t30.preventDefault() };
  }
  _wrapImmediateClick(t30) {
    const { pointerType: e24, button: a34, buttons: n31, x: r24, y: i34, native: o27, eventId: s27 } = t30.data, p30 = o27.pointerId, { cancelable: c37, timestamp: l25 } = t30;
    return { type: "immediate-click", pointerId: p30, pointerType: e24, button: a34, buttons: n31, x: r24, y: i34, native: o27, timestamp: l25, mapPoint: this._getMapPoint(r24, i34), eventId: s27, cancelable: c37, stopPropagation: () => t30.stopPropagation(), async: (e25) => t30.async(e25), preventDefault: () => t30.preventDefault() };
  }
  _wrapImmediateDoubleClick(t30) {
    const { pointerType: e24, button: a34, buttons: n31, x: r24, y: i34, native: o27, eventId: s27 } = t30.data, p30 = o27.pointerId, { cancelable: c37, timestamp: l25 } = t30;
    return { type: "immediate-double-click", pointerId: p30, pointerType: e24, button: a34, buttons: n31, x: r24, y: i34, native: o27, timestamp: l25, mapPoint: this._getMapPoint(r24, i34), eventId: s27, cancelable: c37, stopPropagation: () => t30.stopPropagation(), async: (e25) => t30.async(e25), preventDefault: () => t30.preventDefault() };
  }
  _wrapHold(t30) {
    const { pointerType: e24, button: a34, buttons: n31, x: r24, y: i34, native: o27 } = t30.data, { cancelable: s27, timestamp: p30 } = t30;
    return { type: "hold", pointerType: e24, button: a34, buttons: n31, x: r24, y: i34, native: o27, timestamp: p30, mapPoint: this._getMapPoint(r24, i34), cancelable: s27, stopPropagation: () => t30.stopPropagation(), async: (e25) => t30.async(e25), preventDefault: () => t30.preventDefault() };
  }
  _getMapPoint(t30, a34) {
    return this.view.toMap(c2(t30, a34), { exclude: [] });
  }
  _wrapDrag(e24) {
    const a34 = e24.data, { x: n31, y: r24 } = a34.center, { action: i34, pointerType: o27, button: s27 } = a34;
    if ("start" === i34 && (this._latestDragStart = a34), !this._latestDragStart)
      return;
    const p30 = a34.pointer.native, c37 = a34.buttons, { cancelable: l25, timestamp: u21 } = e24, m25 = { x: this._latestDragStart.center.x, y: this._latestDragStart.center.y };
    return "end" === i34 && (this._latestDragStart = void 0), { type: "drag", action: i34, x: n31, y: r24, origin: m25, pointerType: o27, button: s27, buttons: c37, radius: a34.radius, angle: b2(a34.angle), native: p30, timestamp: u21, cancelable: l25, stopPropagation: () => e24.stopPropagation(), async: (t30) => e24.async(t30), preventDefault: () => e24.preventDefault() };
  }
  _wrapKeyDown(t30) {
    const { key: e24, repeat: a34, native: n31 } = t30.data, { cancelable: r24, timestamp: i34 } = t30;
    return { type: "key-down", key: e24, repeat: a34, native: n31, timestamp: i34, cancelable: r24, stopPropagation: () => t30.stopPropagation(), async: (e25) => t30.async(e25), preventDefault: () => t30.preventDefault() };
  }
  _wrapKeyUp(t30) {
    const { key: e24, native: a34 } = t30.data, { cancelable: n31, timestamp: r24 } = t30;
    return { type: "key-up", key: e24, native: a34, timestamp: r24, cancelable: n31, stopPropagation: () => t30.stopPropagation(), async: (e25) => t30.async(e25), preventDefault: () => t30.preventDefault() };
  }
  _wrapPointer(t30, e24) {
    const { x: a34, y: n31, button: r24, buttons: i34, native: o27, eventId: s27 } = t30.data, p30 = o27.pointerId, c37 = o27.pointerType, { cancelable: l25, timestamp: u21 } = t30;
    return { type: e24, x: a34, y: n31, pointerId: p30, pointerType: c37, button: r24, buttons: i34, native: o27, timestamp: u21, eventId: s27, cancelable: l25, stopPropagation: () => t30.stopPropagation(), async: (e25) => t30.async(e25), preventDefault: () => t30.preventDefault() };
  }
  _wrapPointerDrag(t30) {
    const { x: e24, y: a34, buttons: n31, native: r24, eventId: i34 } = t30.data.currentEvent, { button: o27 } = t30.data.startEvent, s27 = t30.data.startEvent.native.pointerId, p30 = t30.data.startEvent.native.pointerType, c37 = t30.data.action, l25 = { x: t30.data.startEvent.x, y: t30.data.startEvent.y }, { cancelable: u21, timestamp: m25 } = t30;
    return { type: "pointer-drag", x: e24, y: a34, pointerId: s27, pointerType: p30, button: o27, buttons: n31, action: c37, origin: l25, native: r24, timestamp: m25, eventId: i34, cancelable: u21, stopPropagation: () => t30.stopPropagation(), async: (e25) => t30.async(e25), preventDefault: () => t30.preventDefault() };
  }
  _wrapMouseWheel(t30) {
    const { cancelable: e24, data: a34, timestamp: n31 } = t30, { x: r24, y: i34, deltaY: o27, native: s27 } = a34;
    return { type: "mouse-wheel", x: r24, y: i34, deltaY: o27, native: s27, timestamp: n31, cancelable: e24, stopPropagation: () => t30.stopPropagation(), async: (e25) => t30.async(e25), preventDefault: () => t30.preventDefault() };
  }
  _wrapGamepad(t30) {
    const { action: e24, state: a34, device: n31 } = t30.data, { cancelable: r24, timestamp: i34 } = t30, { buttons: o27, axes: s27 } = a34;
    return { type: "gamepad", device: n31, timestamp: i34, action: e24, buttons: o27, axes: s27, cancelable: r24, stopPropagation: () => t30.stopPropagation(), async: (e25) => t30.async(e25), preventDefault: () => t30.preventDefault() };
  }
};

// node_modules/@arcgis/core/views/interactive/interfaces.js
var o15;
var t19;
var u11;
!function(o27) {
  o27[o27.USER = 0] = "USER", o27[o27.MANAGER = 1] = "MANAGER";
}(o15 || (o15 = {})), function(o27) {
  o27[o27.None = 0] = "None", o27[o27.Unfocused = 1] = "Unfocused", o27[o27.Focused = 2] = "Focused", o27[o27.Unselected = 4] = "Unselected", o27[o27.Selected = 8] = "Selected", o27[o27.All = 15] = "All";
}(t19 || (t19 = {})), function(o27) {
  o27[o27.None = 0] = "None", o27[o27.Custom1 = 16] = "Custom1", o27[o27.Custom2 = 32] = "Custom2", o27[o27.Custom3 = 64] = "Custom3", o27[o27.Custom4 = 128] = "Custom4", o27[o27.Custom5 = 256] = "Custom5", o27[o27.Custom6 = 512] = "Custom6", o27[o27.Custom7 = 1024] = "Custom7", o27[o27.Custom8 = 2048] = "Custom8", o27[o27.Custom9 = 4096] = "Custom9", o27[o27.Custom10 = 8192] = "Custom10", o27[o27.Custom11 = 16384] = "Custom11", o27[o27.Custom12 = 32768] = "Custom12", o27[o27.All = 65520] = "All";
}(u11 || (u11 = {}));

// node_modules/@arcgis/core/views/interactive/interactiveToolUtils.js
function o16(t30) {
  return [t30.on("before-add", (o27) => {
    const i34 = o27.item;
    if (null == i34 || t30.includes(i34))
      return s2.getLogger("esri.views.interactive.interactiveToolUtils").warn("Tool is either already in the list of tools or tool is `null`. Not adding tool."), void o27.preventDefault();
    i34.onAdd();
  }), t30.on("after-remove", (e24) => {
    const t31 = e24.item;
    t31.active && (t31.view.activeTool = null), t31.destroy();
  })];
}
function i20(e24) {
  return e24.visible && null != e24.getEditableFlag && e24.getEditableFlag(o15.USER) && e24.getEditableFlag(o15.MANAGER);
}

// node_modules/@arcgis/core/views/support/screenUtils.js
function n18(t30) {
  return c2(t30.x, t30.y);
}
function i22(t30, n31) {
  var _a;
  const c37 = (_a = t30 instanceof HTMLElement ? t30 : t30.surface) == null ? void 0 : _a.getBoundingClientRect();
  return c37 ? c2(n31.clientX - c37.left, n31.clientY - c37.top) : c2(0, 0);
}
function r16(e24, t30) {
  return t30 instanceof Event ? i22(e24, t30) : n18(t30);
}
function o17(e24) {
  if (e24 instanceof Event)
    return true;
  if ("object" == typeof e24 && "type" in e24) {
    switch (e24.type) {
      case "click":
      case "double-click":
      case "pointer-down":
      case "pointer-drag":
      case "pointer-enter":
      case "pointer-leave":
      case "pointer-up":
      case "pointer-move":
      case "immediate-click":
      case "immediate-double-click":
      case "hold":
      case "drag":
      case "mouse-wheel":
        return true;
      default:
        return false;
    }
  }
  return false;
}

// node_modules/@arcgis/core/views/interactive/ToolViewManagerManipulatorState.js
var c24 = class {
  constructor() {
    this._pointerLocations = /* @__PURE__ */ new Map(), this._hoveredManipulators = /* @__PURE__ */ new Map(), this._grabbedManipulators = /* @__PURE__ */ new Map(), this._draggedManipulators = /* @__PURE__ */ new Map(), this._stopDrag = false, this._revertToNullActiveTool = false, this._cursor = null;
  }
  get cursor() {
    return this._cursor;
  }
  handleInputEvent(t30, e24) {
    const s27 = () => t30.stopPropagation();
    switch (t30.type) {
      case "pointer-move":
        u12(t30.pointerType) && this._pointerLocations.set(t30.pointerId, { x: t30.x, y: t30.y, pointerType: t30.pointerType });
        break;
      case "drag":
        this._grabbedManipulators.size > 0 && (this._stopDrag = true), this._stopDrag && (s27(), "end" === t30.action && (this._stopDrag = false));
        break;
      case "pointer-down": {
        if (!h12(t30))
          break;
        const o27 = n18(t30), a34 = this._intersect(o27, t30.pointerType, e24.forEachTool);
        if (t2(a34))
          break;
        const n31 = a34.manipulator, p30 = a34.tool;
        !(r(n31) && r(p30) && n31.interactive) || n31.grabbable && n31.grabbableForEvent(t30) || !n31.grabbing || n31.dragging || this._ungrabManipulatorBeforeDragging(n31, t30, e24), r(n31) && r(p30) && n31.interactive && n31.grabbable && n31.grabbableForEvent(t30) && !n31.grabbing && (this._grabbedManipulators.set(t30.pointerId, { manipulator: n31, tool: p30, start: o27, pointerType: t30.pointerType }), 1 === this._grabbedManipulators.size && t2(e24.activeTool) && (this._revertToNullActiveTool = true, e24.setActiveTool(a34.tool)), n31.grabbing = true, n31.events.emit("grab-changed", { action: "start", pointerType: t30.pointerType, screenPoint: o27 }), s27());
        break;
      }
      case "pointer-up":
        this._draggedManipulators.has(t30.pointerId) || this._handlePointerEnd(t30, e24);
        break;
      case "pointer-drag": {
        if (!h12(t30))
          break;
        const r24 = this._grabbedManipulators.get(t30.pointerId), p30 = o2(r24, ({ manipulator: t31 }) => t31), c37 = o2(r24, ({ tool: t31 }) => t31);
        if (t2(p30) || t2(c37))
          break;
        const u21 = n18(t30);
        u21.x = a4(u21.x, 0, e24.view.width), u21.y = a4(u21.y, 0, e24.view.height);
        const d18 = e2(r24).start, g17 = this._draggedManipulators.get(t30.pointerId);
        switch (t30.action) {
          case "start":
          case "update":
            "update" !== t30.action && 1 !== this._grabbedManipulators.size || (p30.dragging = true, g17 ? p30.events.emit("drag", { action: "update", start: d18, screenPoint: u21 }) : p30.events.emit("drag", { action: "start", start: d18, screenPoint: u21, pointerType: t30.pointerType }), this._draggedManipulators.set(t30.pointerId, { tool: c37, manipulator: p30, start: d18 }));
            break;
          case "end":
            p30.dragging = false, g17 && p30.events.emit("drag", { action: "end", start: d18, screenPoint: u21 }), this._draggedManipulators.delete(t30.pointerId), this._handlePointerEnd(t30, e24);
        }
        s27();
        break;
      }
      case "immediate-click": {
        const o27 = n18(t30), a34 = this._intersect(o27, t30.pointerType, e24.forEachTool);
        if (d10(t30) || e24.forEachTool((t31) => {
          if ((!r(a34) || a34.tool !== t31 || t31.automaticManipulatorSelection) && t31.manipulators) {
            let e25 = false;
            t31.manipulators.forEach(({ manipulator: t32 }) => {
              t32.selected && (t32.selected = false, e25 = true);
            }), e25 && t31.onManipulatorSelectionChanged && t31.onManipulatorSelectionChanged();
          }
        }), t2(a34))
          break;
        const { manipulator: n31, tool: p30 } = a34;
        if (!n31.interactive)
          break;
        n31.selectable && p30.automaticManipulatorSelection && (n31.selected = !n31.selected, p30.onManipulatorSelectionChanged && p30.onManipulatorSelectionChanged());
        const c37 = t30.native.shiftKey;
        n31.events.emit("immediate-click", { screenPoint: o27, button: t30.button, pointerType: t30.pointerType, shiftKey: c37, stopPropagation: s27 });
        break;
      }
      case "click": {
        const o27 = n18(t30), a34 = this._intersect(o27, t30.pointerType, e24.forEachTool), n31 = r(a34) ? a34.manipulator : null;
        if (t2(n31) || !n31.interactive)
          break;
        const p30 = t30.native.shiftKey;
        n31.events.emit(t30.type, { screenPoint: o27, button: t30.button, pointerType: t30.pointerType, shiftKey: p30 }), s27();
        break;
      }
      case "double-click": {
        const o27 = n18(t30), a34 = this._intersect(o27, t30.pointerType, e24.forEachTool), n31 = r(a34) ? a34.manipulator : null;
        if (t2(n31) || !n31.interactive)
          break;
        const p30 = t30.native.shiftKey;
        n31.events.emit("double-click", { screenPoint: o27, button: t30.button, pointerType: t30.pointerType, shiftKey: p30, stopPropagation: s27 });
        break;
      }
      case "immediate-double-click": {
        const o27 = n18(t30), a34 = this._intersect(o27, t30.pointerType, e24.forEachTool), n31 = r(a34) ? a34.manipulator : null;
        if (t2(n31) || !n31.interactive)
          break;
        const p30 = t30.native.shiftKey;
        n31.events.emit("immediate-double-click", { screenPoint: o27, button: t30.button, pointerType: t30.pointerType, shiftKey: p30, stopPropagation: s27 });
        break;
      }
    }
    this._onFocusChange(e24.forEachTool);
  }
  _ungrabManipulatorBeforeDragging(t30, e24, o27) {
    t30.grabbing = false, t30.events.emit("grab-changed", { action: "end", pointerType: e24.pointerType, screenPoint: n18(e24) }), this._grabbedManipulators.forEach(({ manipulator: e25 }, o28) => {
      e25 === t30 && this._grabbedManipulators.delete(o28);
    }), this._afterManipulatorUngrab(o27.setActiveTool);
  }
  _handlePointerEnd(t30, e24) {
    const o27 = o2(this._grabbedManipulators.get(t30.pointerId), ({ manipulator: t31 }) => t31);
    t2(o27) || o27.grabbing && (o27.grabbing = false, o27.events.emit("grab-changed", { action: "end", pointerType: t30.pointerType, screenPoint: n18(t30) }), this._grabbedManipulators.delete(t30.pointerId), this._afterManipulatorUngrab(e24.setActiveTool));
  }
  _cursorFromMap(t30) {
    let o27 = null;
    return n3(t30, ({ manipulator: t31 }) => !(t2(t31) || !t31.interactive) && (t31.grabbing && t31.grabCursor ? (o27 = t31.grabCursor, true) : !!t31.cursor && (o27 = t31.cursor, true))), o27;
  }
  _onFocusChange(t30) {
    this._updateCursor(), this._updateFocusedManipulatorTools(t30);
  }
  _updateCursor() {
    this._grabbedManipulators.size > 0 ? this._cursor = this._cursorFromMap(this._grabbedManipulators) || "grabbing" : this._hoveredManipulators.size > 0 ? this._cursor = this._cursorFromMap(this._hoveredManipulators) || "pointer" : this._cursor = null;
  }
  _updateFocusedManipulatorTools(e24) {
    const o27 = /* @__PURE__ */ new Set(), i34 = /* @__PURE__ */ new Set();
    this._grabbedManipulators.forEach(({ tool: t30 }) => {
      o27.add(t30);
    }), this._hoveredManipulators.forEach(({ tool: t30 }) => {
      i34.add(t30);
    }), e24((e25) => {
      e25.hasGrabbedManipulators = o27.has(e25), e25.hasHoveredManipulators = i34.has(e25);
      const a34 = this._grabbedManipulators.values(), n31 = o(a34, ({ tool: t30 }) => t30 === e25);
      e25.firstGrabbedManipulator = r(n31) ? n31.manipulator : null;
    });
  }
  clearPointers(t30, { forEachTool: e24, setActiveTool: o27 }, r24 = true, a34) {
    const n31 = (e25, o28) => e25 === t30 && (t2(a34) || a34 === o28);
    this._grabbedManipulators.forEach(({ tool: t31, manipulator: e25, pointerType: o28 }, r25) => {
      n31(t31, e25) && (this._grabbedManipulators.delete(r25), e25.grabbing = false, e25.events.emit("grab-changed", { action: "end", screenPoint: null, pointerType: o28 }));
    }), this._draggedManipulators.forEach(({ tool: t31, manipulator: e25 }, o28) => {
      n31(t31, e25) && (this._draggedManipulators.delete(o28), e25.dragging = false, e25.events.emit("drag", { action: "cancel" }));
    }), r24 && this._hoveredManipulators.forEach(({ tool: t31, manipulator: e25 }, o28) => {
      n31(t31, e25) && (this._hoveredManipulators.delete(o28), e25.hovering = false);
    }), this._afterManipulatorUngrab(o27), this._onFocusChange(e24);
  }
  _intersect(t30, e24, o27) {
    let r24 = null;
    return o27((o28) => {
      if (null == o28.manipulators || !i20(o28))
        return false;
      const a34 = o28.manipulators.intersect(t30, e24);
      return !t2(a34) && (r24 = { tool: o28, manipulator: a34 }, true);
    }), r24;
  }
  updateHoveredStateFromKnownPointers(t30) {
    this._pointerLocations.forEach((e24, o27) => {
      this._updateHoveredStateForPointerAtScreenPosition(c2(e24.x, e24.y), o27, e24.pointerType, t30);
    });
  }
  handleHoverEvent(t30, e24) {
    "pointer-up" !== t30.type && "immediate-click" !== t30.type && "pointer-move" !== t30.type || !u12(t30.pointerType) || this._updateHoveredStateForPointerAtScreenPosition(n18(t30), t30.pointerId, t30.pointerType, e24);
  }
  _updateHoveredStateForPointerAtScreenPosition(t30, e24, o27, i34) {
    let n31 = this._intersect(t30, o27, i34);
    const s27 = o2(this._hoveredManipulators.get(e24), ({ manipulator: t31 }) => t31);
    r(n31) && !n31.manipulator.interactive && (n31 = null), r(n31) && s27 === n31.manipulator || (r(s27) && (s27.hovering = false), r(n31) ? (n31.manipulator.hovering = true, this._hoveredManipulators.set(e24, n31)) : this._hoveredManipulators.delete(e24), this._onFocusChange(i34));
  }
  _afterManipulatorUngrab(t30) {
    0 === this._grabbedManipulators.size && this._revertToNullActiveTool && (t30(null), this._revertToNullActiveTool = false);
  }
};
function u12(t30) {
  return "mouse" === t30;
}
function h12(t30) {
  return "mouse" !== t30.pointerType || 0 === t30.button;
}
function d10(t30) {
  return !!t30.native.shiftKey;
}

// node_modules/@arcgis/core/views/ToolViewManager.js
var E5 = "attached";
var g12 = "tools";
var w16 = class extends d {
  constructor(t30) {
    super(t30), this._manipulatorState = new c24(), this.tools = new j2(), this.cursor = null, this._forEachTool = (t31) => {
      for (const o27 of this.tools.items)
        if (t31(o27))
          return;
    };
  }
  initialize() {
    this.handles.add([this.view.on(r15, (t30) => {
      this._handleInputEvent(t30);
    }, P.TOOL), ...o16(this.tools), this.tools.on("before-add", ({ item: t30 }) => {
      this._updateToolEditableFlag(t30);
    }), this.tools.on("before-remove", ({ item: t30 }) => {
      this._manipulatorState.clearPointers(t30, this._manipulatorStateEventArgs), this._updateCursor();
    }), this.tools.on("change", () => {
      this._refreshToolWatchers();
    })]);
  }
  destroy() {
    this.detach(), this.handles.removeAll();
  }
  get _manipulatorStateEventArgs() {
    return { forEachTool: this._forEachTool, activeTool: this.activeTool, setActiveTool: (t30) => {
      this.activeTool = t30;
    }, view: this.view };
  }
  set activeTool(t30) {
    if (r(t30) && !this.view.ready)
      return void s2.getLogger(this.declaredClass).error("Cannot set active tool while view is not ready.");
    if (t30 === this.activeTool)
      return;
    const o27 = this.activeTool;
    this._set("activeTool", t30), r(o27) && o27.deactivate(), r(t30) && t30.activate(), this._removeIncompleteTools(t30);
    for (const e24 of this.tools) {
      this._updateToolEditableFlag(e24);
      const t31 = i20(e24);
      !t2(this.activeTool) && t31 || this._manipulatorState.clearPointers(e24, this._manipulatorStateEventArgs, !t31);
    }
    this._updateCursor();
  }
  get updating() {
    var _a;
    return this.updatingHandles.updating || this.tools.some((t30) => t30.updating) || (((_a = this.textures) == null ? void 0 : _a.updating) ?? false);
  }
  attach() {
    var _a;
    "3d" === this.view.type ? (this._set("textures", new n17(this.view._stage, this.view.resourceController.scheduler)), this.handles.add([l3(() => {
      const { state: t30 } = this.view;
      return "camera" in t30 && t30.camera;
    }, () => this._forEachManipulator((t30) => t30.onViewChange())), (_a = this.view.elevationProvider) == null ? void 0 : _a.on("elevation-change", (t30) => this._forEachManipulator((o27) => o27.onElevationChange(t30))), n(() => this._set("textures", a(this.textures)))], E5)) : this.handles.add(l3(() => this.view.extent, () => this._forEachManipulator((t30) => t30.onViewChange())));
  }
  detach() {
    r(this.activeTool) && (this.activeTool = null), this.tools.removeAll(), this.handles.remove(E5);
  }
  _forEachManipulator(t30) {
    this._forEachTool((o27) => {
      o27.manipulators && o27.manipulators.forEach(({ manipulator: e24 }) => t30(e24, o27));
    });
  }
  _handleInputEvent(t30) {
    let o27 = false;
    const e24 = { ...t30, stopPropagation: () => {
      o27 = true, t30.stopPropagation();
    } };
    r(this.activeTool) ? this.activeTool.handleInputEvent && this.activeTool.handleInputEvent(e24) : this._forEachTool((t31) => {
      !o27 && t31.visible && t31.handleInputEvent(e24);
    }), !o27 && "key-down" === t30.type && "Escape" === t30.key && this.activeTool && (t30.stopPropagation(), this.activeTool = null), this._manipulatorState.handleInputEvent(e24, this._manipulatorStateEventArgs), !o27 && r(this.activeTool) && this.activeTool.handleInputEventAfter(e24), this._manipulatorState.handleHoverEvent(e24, this._forEachTool), this._updateCursor();
  }
  _refreshToolWatchers() {
    this.handles.remove(g12), this._forEachTool((t30) => {
      if (t30 instanceof v3) {
        const o27 = l3(() => [t30.cursor, t30.visible, t30.editable], () => {
          i20(t30) || this._manipulatorState.clearPointers(t30, this._manipulatorStateEventArgs), this._updateCursor();
        });
        this.handles.add(o27, g12);
      }
      t30.manipulators && this.handles.add([t30.manipulators.on("after-remove", (o27) => {
        this._manipulatorState.clearPointers(t30, this._manipulatorStateEventArgs, true, o27.item.manipulator);
      }), t30.manipulators.on("change", () => {
        this._manipulatorState.updateHoveredStateFromKnownPointers(this._forEachTool), this._updateCursor();
      })], g12);
    }), this._manipulatorState.updateHoveredStateFromKnownPointers(this._forEachTool), this._updateCursor();
  }
  _updateToolEditableFlag(t30) {
    var _a;
    (_a = t30.setEditableFlag) == null ? void 0 : _a.call(t30, o15.MANAGER, t2(this.activeTool) || t30 === this.activeTool);
  }
  _updateCursor() {
    let t30 = this._manipulatorState.cursor;
    t2(t30) && this._forEachTool((o27) => !(!r(o27.cursor) || !o27.visible) && (t30 = o27.cursor, true)), this._get("cursor") !== t30 && this._set("cursor", t30);
  }
  _removeIncompleteTools(t30) {
    this.tools.filter((o27) => (t2(t30) || o27 !== t30) && !o27.created && o27.removeIncompleteOnCancel).forEach((t31) => {
      this.tools.remove(t31);
    });
  }
};
e([y2({ constructOnly: true, nonNullable: true })], w16.prototype, "view", void 0), e([y2({ readOnly: true, nonNullable: true })], w16.prototype, "textures", void 0), e([y2({ value: null })], w16.prototype, "activeTool", null), e([y2({ readOnly: true, type: j2 })], w16.prototype, "tools", void 0), e([y2({ readOnly: true })], w16.prototype, "cursor", void 0), e([y2({ readOnly: true })], w16.prototype, "updating", null), w16 = e([a3("esri.views.ToolViewManager")], w16);
var y12 = w16;

// node_modules/@arcgis/core/views/input/gamepad/GamepadInputDevice.js
var n19 = class extends v3 {
  constructor(e24) {
    super(), this.nativeIndex = null, this._detectedDeviceType = "unknown", "standard" === e24.mapping ? this._detectedDeviceType = "standard" : o18.test(e24.id) ? this._detectedDeviceType = "spacemouse" : this._detectedDeviceType = "unknown", this.nativeIndex = e24.index;
  }
  get native() {
    const e24 = navigator.getGamepads ? navigator.getGamepads() : [];
    return null != this.nativeIndex && this.nativeIndex < e24.length ? e24[this.nativeIndex] : null;
  }
  get deviceType() {
    return this._detectedDeviceType;
  }
  get axisThreshold() {
    return i23[this.deviceType];
  }
};
e([y2({ nonNullable: true, readOnly: true })], n19.prototype, "nativeIndex", void 0), e([y2({ type: String, readOnly: true })], n19.prototype, "deviceType", null), e([y2({ type: Number, readOnly: true })], n19.prototype, "axisThreshold", null), n19 = e([a3("esri.views.input.gamepad.GamepadInputDevice")], n19);
var o18 = new RegExp("^(3dconnexion|space(mouse|navigator|pilot|explorer))", "i");
var i23 = { standard: 0.15, spacemouse: 0.025, unknown: 0 };
var a17 = n19;

// node_modules/@arcgis/core/views/input/gamepad/GamepadSettings.js
var c25 = class extends v3 {
  constructor(...e24) {
    super(...e24), this.devices = new j2(), this.enabledFocusMode = "document";
  }
};
e([y2({ type: j2.ofType(a17), readOnly: true })], c25.prototype, "devices", void 0), e([y2({ type: ["document", "view", "none"] })], c25.prototype, "enabledFocusMode", void 0), c25 = e([a3("esri.views.input.gamepad.GamepadSettings")], c25);
var i24 = c25;

// node_modules/@arcgis/core/views/input/Input.js
var p17 = class extends v3 {
  constructor() {
    super(...arguments), this.gamepad = new i24();
  }
};
e([y2({ readOnly: true })], p17.prototype, "gamepad", void 0), p17 = e([a3("esri.views.input.Input")], p17);
var a18 = p17;

// node_modules/@arcgis/core/views/navigation/gamepad/GamepadSettings.js
var s17 = class extends v3 {
  constructor(o27) {
    super(o27), this.enabled = true, this.device = null, this.mode = "pan", this.tiltDirection = "forward-down", this.velocityFactor = 1;
  }
};
e([y2({ type: Boolean, nonNullable: true })], s17.prototype, "enabled", void 0), e([y2({ type: a17 })], s17.prototype, "device", void 0), e([y2({ type: ["pan", "zoom"], nonNullable: true })], s17.prototype, "mode", void 0), e([y2({ type: ["forward-down", "forward-up"], nonNullable: true })], s17.prototype, "tiltDirection", void 0), e([y2({ type: Number, nonNullable: true })], s17.prototype, "velocityFactor", void 0), s17 = e([a3("esri.views.navigation.gamepad.GamepadSettings")], s17);
var a19 = s17;

// node_modules/@arcgis/core/views/navigation/Navigation.js
var a20 = class extends v3 {
  constructor(o27) {
    super(o27), this.browserTouchPanEnabled = true, this.gamepad = new a19(), this.momentumEnabled = true, this.mouseWheelZoomEnabled = true;
  }
};
e([y2({ type: Boolean })], a20.prototype, "browserTouchPanEnabled", void 0), e([y2({ type: a19, nonNullable: true })], a20.prototype, "gamepad", void 0), e([y2({ type: Boolean })], a20.prototype, "momentumEnabled", void 0), e([y2({ type: Boolean })], a20.prototype, "mouseWheelZoomEnabled", void 0), a20 = e([a3("esri.views.navigation.Navigation")], a20);
var p18 = a20;

// node_modules/@arcgis/core/geometry/support/heightModelInfoUtils.js
var s18;
function h13(e24) {
  var _a;
  const r24 = e24.url ? d2(e24.url) : void 0, o27 = (_a = e24.spatialReference) == null ? void 0 : _a.vcsWkid;
  return !(null == o27 && r(r24) && "ImageServer" === r24.serverType) && u13(e24) && e24.heightModelInfo ? e24.heightModelInfo : g13(e24) ? v7.deriveUnitFromSR(p19, e24.spatialReference) : null;
}
function u13(e24) {
  return "heightModelInfo" in e24;
}
function d11(e24) {
  if ("unknown" === e24.type || !("capabilities" in e24))
    return false;
  switch (e24.type) {
    case "csv":
    case "feature":
    case "geojson":
    case "subtype-group":
    case "ogc-feature":
    case "oriented-imagery":
    case "wfs":
    case "knowledge-graph-sublayer":
      return true;
    default:
      return false;
  }
}
function g13(e24) {
  return d11(e24) ? !!(e24.capabilities && e24.capabilities.data && e24.capabilities.data.supportsZ) : m18(e24);
}
function f14(e24) {
  return null != e24.layers || m18(e24) || d11(e24) || u13(e24);
}
function m18(e24) {
  switch (e24.type) {
    case "building-scene":
    case "elevation":
    case "integrated-mesh":
    case "point-cloud":
    case "scene":
    case "voxel":
      return true;
    case "base-dynamic":
    case "base-elevation":
    case "base-tile":
    case "bing-maps":
    case "csv":
    case "dimension":
    case "geojson":
    case "feature":
    case "subtype-group":
    case "geo-rss":
    case "graphics":
    case "group":
    case "imagery":
    case "imagery-tile":
    case "kml":
    case "knowledge-graph":
    case "link-chart":
    case "knowledge-graph-sublayer":
    case "line-of-sight":
    case "map-image":
    case "map-notes":
    case "media":
    case "ogc-feature":
    case "open-street-map":
    case "oriented-imagery":
    case "route":
    case "stream":
    case "tile":
    case "unknown":
    case "unsupported":
    case "vector-tile":
    case "wcs":
    case "web-tile":
    case "wfs":
    case "wms":
    case "wmts":
    case null:
      return false;
  }
  return false;
}
!function(e24) {
  e24[e24.Ok = 0] = "Ok", e24[e24.Units = 1] = "Units", e24[e24.HeightModel = 2] = "HeightModel", e24[e24.CRS = 3] = "CRS", e24[e24.Unsupported = 4] = "Unsupported";
}(s18 || (s18 = {}));
var p19 = new v7({ heightModel: "gravity-related-height" });

// node_modules/@arcgis/core/views/support/projectionUtils.js
var n20;
var s19 = null;
async function c26(r24) {
  s19 || (s19 = import("./geometryServiceUtils-G4UANKRT.js").then((e24) => n20 = e24)), await s19, f(r24);
}
async function p20(e24, s27, a34, m25) {
  if (!e24)
    return null;
  const l25 = e24.spatialReference;
  return en() || An(l25, s27) ? rn(e24, s27) : n20 ? n20.projectGeometry(e24, s27, a34, m25) : (await Promise.race([c26(m25), tn(m25)]), p20(e24, s27, a34, m25));
}

// node_modules/@arcgis/core/views/support/DefaultsFromMap.js
var h14 = class extends v3 {
  constructor(e24) {
    super(e24), this.required = { tileInfo: false, heightModelInfo: false, extent: false }, this.defaultSpatialReference = null, this.userSpatialReference = null, this.sourcePreloadCount = 10, this.priorityCollection = null, this.requiresExtentInSpatialReference = true, this.suspended = false, this._projectExtentTask = { task: null, input: null, output: null, spatialReference: null };
  }
  destroy() {
    this._projectExtentTask.task && (this._projectExtentTask.task = w(this._projectExtentTask.task)), this._set("map", null);
  }
  get ready() {
    return !this._spatialReferenceTask.updating && !this._tileInfoTask.updating && !this._extentTask.updating;
  }
  get heightModelInfoReady() {
    return !this._heightModelInfoTask.updating;
  }
  get spatialReference() {
    return r(this.userSpatialReference) ? this.userSpatialReference : e2(this._spatialReferenceTask.spatialReference);
  }
  get extent() {
    return e2(this._extentTask.extent);
  }
  get heightModelInfo() {
    return e2(this._heightModelInfoTask.heightModelInfo);
  }
  get vcsWkid() {
    return e2(this._heightModelInfoTask.vcsWkid);
  }
  get latestVcsWkid() {
    return e2(this._heightModelInfoTask.latestVcsWkid);
  }
  get viewingMode() {
    return t2(this.userSpatialReference) || this.userSpatialReference.equals(e2(this._spatialReferenceTask.spatialReference)) ? e2(this._spatialReferenceTask.viewingMode) : null;
  }
  get tileInfo() {
    return e2(this._tileInfoTask.tileInfo);
  }
  get mapCollections() {
    var _a, _b, _c, _d;
    const e24 = (_a = this.map) == null ? void 0 : _a.call(this), t30 = [];
    return r(this.priorityCollection) && t30.push(this.priorityCollection), t30.push({ parent: e24 == null ? void 0 : e24.basemap, layers: (_b = e24 == null ? void 0 : e24.basemap) == null ? void 0 : _b.baseLayers }, { layers: e24 == null ? void 0 : e24.layers }, { parent: e24 == null ? void 0 : e24.ground, layers: (_c = e24 == null ? void 0 : e24.ground) == null ? void 0 : _c.layers }, { parent: e24 == null ? void 0 : e24.basemap, layers: (_d = e24 == null ? void 0 : e24.basemap) == null ? void 0 : _d.referenceLayers }), t30;
  }
  get _allLayers() {
    return this._collectLayers(this.mapCollections);
  }
  get _spatialReferenceTask() {
    if (this.suspended)
      return this._get("_spatialReferenceTask") ?? { updating: false };
    const { layers: e24, updating: t30 } = this._allLayers;
    let a34 = null;
    for (const i34 of e24) {
      const e25 = this._getSupportedSpatialReferences(i34);
      if (e25.length > 0) {
        const t31 = this._narrowDownSpatialReferenceCandidates(a34, e25);
        r(t31) && (a34 = t31);
      }
      if (r(a34) && 1 === a34.length)
        break;
    }
    if (t30 && (t2(a34) || 1 !== a34.length))
      return { updating: true };
    const n31 = this._pickSpatialReferenceCandidate(a34);
    return { spatialReference: r(n31) ? n31.spatialReference : null, viewingMode: r(n31) ? n31.viewingMode : null, updating: false };
  }
  get _tileInfoTask() {
    var _a, _b, _c, _d, _e2, _f, _g;
    if (!this.required.tileInfo)
      return this._get("_tileInfoTask") ?? { updating: false };
    if (!this.spatialReference)
      return { updating: this._spatialReferenceTask.updating };
    const { layers: e24, updating: t30 } = this._collectLayers([{ parent: (_b = (_a = this.map) == null ? void 0 : _a.call(this)) == null ? void 0 : _b.basemap, layers: (_e2 = (_d = (_c = this.map) == null ? void 0 : _c.call(this)) == null ? void 0 : _d.basemap) == null ? void 0 : _e2.baseLayers }, { layers: (_g = (_f = this.map) == null ? void 0 : _f.call(this)) == null ? void 0 : _g.layers }]);
    if (e24 && e24.length > 0 && "tileInfo" in e24[0]) {
      const t31 = e24[0].tileInfo;
      return { tileInfo: t31 && t31.spatialReference.equals(this.spatialReference) ? t31 : null, updating: false };
    }
    return { updating: t30 };
  }
  get _heightModelInfoTask() {
    var _a, _b, _c;
    if (!this.required.heightModelInfo || this.suspended && ((_a = this._get("_heightModelInfoTask")) == null ? void 0 : _a.heightModelInfo))
      return this._get("_heightModelInfoTask") ?? { updating: false };
    const { layers: e24, updating: t30 } = this._allLayers;
    for (const a34 of e24)
      if (f14(a34)) {
        const e25 = h13(a34);
        if (e25)
          return { heightModelInfo: e25, vcsWkid: (_b = a34.spatialReference) == null ? void 0 : _b.vcsWkid, latestVcsWkid: (_c = a34.spatialReference) == null ? void 0 : _c.latestVcsWkid, updating: false };
      }
    return { updating: t30 };
  }
  get _extentCandidatesTask() {
    if (this.suspended || !this.required.extent)
      return this._get("_extentCandidatesTask") ?? { updating: false };
    if (!this.spatialReference)
      return { updating: this._spatialReferenceTask.updating };
    const e24 = this._allLayers, t30 = e24.updating, a34 = [];
    for (const n31 of e24.layers) {
      const e25 = "fullExtents" in n31 && n31.fullExtents || (r(n31.fullExtent) ? [n31.fullExtent] : []), t31 = this.requiresExtentInSpatialReference ? null : e25[0], i34 = e25.find((e26) => e26.spatialReference.equals(this.spatialReference)) ?? t31;
      if (i34)
        return { candidates: [{ extent: i34, layer: n31 }], updating: false };
      if (this._getSupportedSpatialReferences(n31).length > 0)
        for (const s27 of e25)
          a34.push({ extent: s27, layer: n31 });
    }
    return { candidates: a34, updating: t30 };
  }
  get _extentTask() {
    const { candidates: e24, updating: t30 } = this._extentCandidatesTask;
    if (t30)
      return { updating: t30 };
    if (t2(e24) || 0 === e24.length)
      return { updating: false };
    if (!this.spatialReference)
      return { updating: this._spatialReferenceTask.updating };
    const i34 = this._pickExtentCandidate(e24), o27 = this.spatialReference;
    return i34.extent.equals(this._projectExtentTask.input) && o27.equals(this._projectExtentTask.spatialReference) ? { extent: this._projectExtentTask.output, updating: r(this._projectExtentTask.task) && !this._projectExtentTask.task.finished } : (r(this._projectExtentTask.task) && (this._projectExtentTask.task = w(this._projectExtentTask.task)), this._projectExtentTask = { input: i34.extent.clone(), output: null, spatialReference: o27.clone(), task: j4(async (e25) => {
      try {
        const t31 = await p20(i34.extent, o27, i34.layer.portalItem, e25);
        this._projectExtentTask = { ...this._projectExtentTask, task: null, output: t31 };
      } catch (t31) {
        if (p2(e25))
          return;
        this._projectExtentTask = { ...this._projectExtentTask, task: null };
      }
    }) }, { updating: true });
  }
  _narrowDownSpatialReferenceCandidates(e24, t30) {
    if (t2(e24))
      return t30;
    const a34 = [], n31 = (e25, t31) => r(e25) ? r(t31) ? e25 === t31 && e25 : e25 : t31;
    for (const s27 of e24)
      for (const e25 of t30) {
        if (!s27.spatialReference.equals(e25.spatialReference))
          continue;
        const t31 = n31(s27.viewingMode, e25.viewingMode);
        if (false !== t31) {
          a34.push({ spatialReference: s27.spatialReference, viewingMode: t31 });
          break;
        }
      }
    return a34.length > 0 ? a34 : null;
  }
  _pickSpatialReferenceCandidate(e24) {
    const t30 = this.defaultSpatialReference;
    return t2(e24) || e24.length < 1 ? r(t30) ? { spatialReference: t30, viewingMode: null } : null : (r(t30) && e24.length > 1 && e24.some(({ spatialReference: e25 }) => e25.equals(t30)) && (e24 = e24.filter(({ spatialReference: e25 }) => e25.equals(t30))), e24.length > 1 && e24.some(({ viewingMode: e25 }) => e25 !== l5.Local) && (e24 = e24.filter(({ viewingMode: e25 }) => e25 !== l5.Local)), e24[0]);
  }
  _getSupportedSpatialReferences(e24) {
    const t30 = "supportedSpatialReferences" in e24 && e24.supportedSpatialReferences || (e24.spatialReference ? [e24.spatialReference] : []);
    if (0 === t30.length)
      return [];
    const a34 = [];
    for (const n31 of t30) {
      const t31 = this.getSpatialReferenceSupport({ spatialReference: n31, layer: e24 });
      if (r(t31)) {
        const e25 = r(t31.constraints) ? t31.constraints : [{ spatialReference: n31, viewingMode: null }];
        for (const { spatialReference: t32, viewingMode: n32 } of e25)
          (!this.requiresExtentInSpatialReference || t2(this.userSpatialReference) || t32.equals(this.userSpatialReference)) && a34.push({ spatialReference: t32, viewingMode: n32 });
      }
    }
    return a34;
  }
  _pickExtentCandidate(e24) {
    const t30 = this.spatialReference;
    return e24.find(({ extent: e25 }) => t30.equals(e25.spatialReference)) || e24[0];
  }
  _collectLayers(e24) {
    var _a;
    if ("loaded" !== this._loadMaybe((_a = this.map) == null ? void 0 : _a.call(this)))
      return { layers: [], updating: true };
    const t30 = { layers: [], preloading: -1, updating: false };
    for (const a34 of e24)
      if (this._collectCollection(a34, t30), t30.preloading === this.sourcePreloadCount)
        break;
    return { layers: t30.layers, updating: t30.updating };
  }
  _collectCollection(e24, t30) {
    if (e24.layers) {
      switch (this._loadMaybe(e24.parent)) {
        case "loading":
          return t30.updating = true, void ++t30.preloading;
        case "failed":
          return;
      }
      for (const a34 of e24.layers) {
        switch (this._loadMaybe(a34)) {
          case "failed":
            continue;
          case "loading":
            t30.updating = true, ++t30.preloading;
            break;
          case "loaded":
            t30.updating || t30.layers.push(a34), "layers" in a34 && this._collectCollection({ layers: a34.layers }, t30);
        }
        if (t30.preloading === this.sourcePreloadCount)
          break;
      }
    }
  }
  _loadMaybe(e24) {
    return e24 && "loadStatus" in e24 && null != e24.loadStatus ? "not-loaded" === e24.loadStatus ? (e24.load().catch(() => {
    }), "loading") : e24.loadStatus : "loaded";
  }
};
e([y2()], h14.prototype, "required", void 0), e([y2({ constructOnly: true })], h14.prototype, "map", void 0), e([y2({ constructOnly: true })], h14.prototype, "getSpatialReferenceSupport", void 0), e([y2()], h14.prototype, "defaultSpatialReference", void 0), e([y2()], h14.prototype, "userSpatialReference", void 0), e([y2()], h14.prototype, "sourcePreloadCount", void 0), e([y2()], h14.prototype, "priorityCollection", void 0), e([y2()], h14.prototype, "requiresExtentInSpatialReference", void 0), e([y2()], h14.prototype, "suspended", void 0), e([y2({ readOnly: true })], h14.prototype, "ready", null), e([y2({ readOnly: true })], h14.prototype, "heightModelInfoReady", null), e([y2({ readOnly: true })], h14.prototype, "spatialReference", null), e([y2({ readOnly: true })], h14.prototype, "extent", null), e([y2({ readOnly: true })], h14.prototype, "heightModelInfo", null), e([y2({ readOnly: true })], h14.prototype, "vcsWkid", null), e([y2({ readOnly: true })], h14.prototype, "latestVcsWkid", null), e([y2({ readOnly: true })], h14.prototype, "viewingMode", null), e([y2({ readOnly: true })], h14.prototype, "tileInfo", null), e([y2({ readOnly: true })], h14.prototype, "mapCollections", null), e([y2({ readOnly: true })], h14.prototype, "_allLayers", null), e([y2({ readOnly: true })], h14.prototype, "_spatialReferenceTask", null), e([y2({ readOnly: true })], h14.prototype, "_tileInfoTask", null), e([y2({ readOnly: true })], h14.prototype, "_heightModelInfoTask", null), e([y2({ readOnly: true })], h14.prototype, "_extentCandidatesTask", null), e([y2()], h14.prototype, "_extentTask", null), e([y2()], h14.prototype, "_projectExtentTask", void 0), h14 = e([a3("esri.views.support.DefaultsFromMap")], h14);

// node_modules/@arcgis/core/views/View.js
var W6;
var z6 = W6 = class extends a9(n4.EventedMixin(m2(v3))) {
  constructor(e24) {
    super(e24), this._userSpatialReference = null, this._cursor = null, this.allLayerViews = new l4({ getCollections: () => {
      var _a, _b, _c;
      return [(_a = this.basemapView) == null ? void 0 : _a.baseLayerViews, (_b = this.groundView) == null ? void 0 : _b.layerViews, this.layerViews, (_c = this.basemapView) == null ? void 0 : _c.referenceLayerViews];
    }, getChildrenFunction: (e25) => e25.layerViews }), this.groundView = null, this.basemapView = null, this.fatalError = null, this.graphics = new i10(), this.analyses = new i17(), this.typeSpecificPreconditionsReady = true, this.layerViews = new j2(), this.magnifier = new p15(), this.padding = { left: 0, top: 0, right: 0, bottom: 0 }, this.ready = false, this.spatialReferenceWarningDelay = 1e3, this.supportsGround = true, this.timeExtent = null, this.timeReference = new a5(), this.type = null, this.scale = null, this.updating = false, this.initialExtentRequired = true, this.input = new a18(), this.navigation = new p18(), this.layerViewManager = null, this.analysisViewManager = null, this.isHeightModelInfoRequired = false, this.width = null, this.height = null, this.resizing = false, this.suspended = false, this.viewEvents = new p16(this), this.persistableViewModels = new j2(), this._isValid = false, this._readyCycleForced = false, this._currentSpatialReference = null, this.handles.add(l3(() => this.preconditionsReady, (e25) => {
      var _a, _b;
      e25 ? (this._currentSpatialReference = this.spatialReference, W6.views.add(this)) : (this._currentSpatialReference = null, W6.views.remove(this)), this.notifyChange("spatialReference"), !e25 && this.ready ? ((_a = this.toolViewManager) == null ? void 0 : _a.detach(), r(this.analysisViewManager) && this.analysisViewManager.detach(), (_b = this.layerViewManager) == null ? void 0 : _b.clear(), this._teardown()) : e25 && !this.ready && (this._startup(), r(this.analysisViewManager) && this.analysisViewManager.attach(), this.toolViewManager.attach());
    }, U2));
  }
  initialize() {
    this.addResolvingPromise(this.validate().then(() => (this._isValid = true, j3(() => this.ready)))), this.basemapView = new p14({ view: this }), this.layerViewManager = new M6({ view: this, layerViewImporter: { importLayerView: (e24) => this.importLayerView(e24), hasLayerViewModule: (e24) => this.hasLayerViewModule(e24) }, supportsGround: this.supportsGround }), this.toolViewManager = new y12({ view: this }), this._setupSpatialReferenceLogger(), this.handles.add([l3(() => this.initialExtentRequired, (e24) => this.defaultsFromMap.required = { ...this.defaultsFromMap.required, extent: e24 }, { sync: true, initial: true }), l3(() => this.ready, (e24) => {
      this.defaultsFromMap && (this.defaultsFromMap.suspended = e24, this.defaultsFromMap.userSpatialReference = e24 ? this.spatialReference : this._userSpatialReference);
    }, { sync: true }), l3(() => this._userSpatialReference, (e24) => {
      this.defaultsFromMap && (this.defaultsFromMap.userSpatialReference = e24);
    }, { sync: true, initial: true })]);
  }
  _setupSpatialReferenceLogger() {
    let e24 = null;
    this.handles.add([l3(() => {
      var _a;
      return (_a = this.defaultsFromMap) == null ? void 0 : _a.ready;
    }, (t30) => {
      var _a;
      const i34 = ((_a = this.map) == null ? void 0 : _a.allLayers.length) > 0;
      if (t30 && !this.spatialReference && i34) {
        if (r(e24))
          return;
        const t31 = n(() => e24 = w(e24));
        e24 = j4(async (t32) => {
          try {
            await U(this.spatialReferenceWarningDelay, null, t32);
          } catch {
            return;
          } finally {
            e24 = null;
          }
          s2.getLogger(this.declaredClass).warn("#spatialReference", "no spatial reference could be derived from the currently added map layers");
        }), this.handles.add(t31, "spatial-reference-logger-task");
      } else
        this.handles.remove("spatial-reference-logger-task");
    }, { sync: true })]);
  }
  destroy() {
    if (this.destroyed)
      return;
    this.viewEvents.destroy(), this.allLayerViews.destroy(), this.navigation && (this.navigation.destroy(), this._set("navigation", null)), this.graphics = a(this.graphics), this.analyses = a(this.analyses), this.handles.remove("defaultsFromMap"), this.defaultsFromMap.destroy(), this._set("defaultsFromMap", null), a(this.analysisViewManager), this.toolViewManager = a(this.toolViewManager), this.layerViewManager = a(this.layerViewManager), this.basemapView = a(this.basemapView), this.invalidate(), this._emitter.clear(), this.handles.removeAll();
    const e24 = this.map;
    this.map = null, e24 == null ? void 0 : e24.destroy();
  }
  _startup() {
    this._set("ready", true);
  }
  _teardown() {
    this._set("ready", false);
  }
  whenReady() {
    return Promise.resolve(this);
  }
  toMap() {
    return s2.getLogger(this.declaredClass).error("#toMap()", "Not implemented on this instance of View"), null;
  }
  get activeTool() {
    var _a;
    return (_a = this.toolViewManager) == null ? void 0 : _a.activeTool;
  }
  set activeTool(e24) {
    this.toolViewManager && (this.toolViewManager.activeTool = e24);
  }
  get animation() {
    return this._get("animation");
  }
  set animation(e24) {
    this._set("animation", e24);
  }
  get center() {
    return null;
  }
  get _defaultsFromMapSettings() {
    return {};
  }
  get defaultsFromMap() {
    return new h14({ required: { tileInfo: false, heightModelInfo: false, extent: false }, map: () => this.map, getSpatialReferenceSupport: (e24) => this.getSpatialReferenceSupport(e24), ...this._defaultsFromMapSettings });
  }
  get extent() {
    return this._get("extent");
  }
  set extent(e24) {
    this._set("extent", e24);
  }
  get heightModelInfo() {
    return this.getDefaultHeightModelInfo();
  }
  get interacting() {
    return this.navigating;
  }
  get navigating() {
    return false;
  }
  get preconditionsReady() {
    var _a;
    return !(this.fatalError || !this._isValid || this._readyCycleForced || !this.map || m5.isLoadable(this.map) && !this.map.loaded || 0 === this.width || 0 === this.height || !this.spatialReference || !this._validateSpatialReference(this.spatialReference) || !this._currentSpatialReference && !((_a = this.defaultsFromMap) == null ? void 0 : _a.ready) || !this.typeSpecificPreconditionsReady);
  }
  get resolution() {
    return 0;
  }
  set map(e24) {
    e24 !== this._get("map") && ((e24 == null ? void 0 : e24.destroyed) && (s2.getLogger(this.declaredClass).warn("#map", "The provided map is already destroyed", { map: e24 }), e24 = null), m5.isLoadable(e24) && e24.load().catch(() => {
    }), this.constructed && (this.forceReadyCycle(), this._currentSpatialReference = null), this._set("map", e24));
  }
  get spatialReference() {
    var _a, _b;
    let e24 = this._userSpatialReference || this._currentSpatialReference || this.getDefaultSpatialReference() || null;
    return e24 && ((_b = (_a = this.defaultsFromMap) == null ? void 0 : _a.required) == null ? void 0 : _b.heightModelInfo) && (e24 = e24.clone(), e24.vcsWkid = this.defaultsFromMap.vcsWkid, e24.latestVcsWkid = this.defaultsFromMap.latestVcsWkid), e24;
  }
  set spatialReference(e24) {
    const t30 = !E2(e24, this._get("spatialReference"));
    this._set("_userSpatialReference", e24), t30 && (this._set("spatialReference", e24), this._spatialReferenceChanged(e24));
  }
  _spatialReferenceChanged(e24) {
  }
  get stationary() {
    return !this.animation && !this.navigating && !this.resizing;
  }
  get tools() {
    var _a;
    return (_a = this.toolViewManager) == null ? void 0 : _a.tools;
  }
  get initialExtent() {
    var _a;
    return (_a = this.defaultsFromMap) == null ? void 0 : _a.extent;
  }
  get cursor() {
    const e24 = this.toolViewManager ? this.toolViewManager.cursor : null;
    return r(e24) ? e24 : this._cursor || "default";
  }
  set cursor(e24) {
    this._cursor = e24, this.notifyChange("cursor");
  }
  get size() {
    return [this.width, this.height];
  }
  whenLayerView(e24) {
    return this.layerViewManager.whenLayerView(e24);
  }
  getDefaultSpatialReference() {
    var _a;
    return (_a = this.defaultsFromMap) == null ? void 0 : _a.spatialReference;
  }
  getDefaultHeightModelInfo() {
    var _a;
    return (this.map && "heightModelInfo" in this.map ? this.map.heightModelInfo : void 0) ?? ((_a = this.defaultsFromMap) == null ? void 0 : _a.heightModelInfo) ?? null;
  }
  importLayerView(e24) {
    throw new s3("importLayerView() not implemented");
  }
  hasLayerViewModule(e24) {
    return false;
  }
  async validate() {
  }
  invalidate() {
    this._isValid = false;
  }
  getSpatialReferenceSupport() {
    return { constraints: null };
  }
  _validateSpatialReference(e24) {
    return r(this.getSpatialReferenceSupport({ spatialReference: e24 }));
  }
  when(e24, t30) {
    return this.isResolved() && !this.ready && s2.getLogger(this.declaredClass).warn("#when()", "Calling view.when() while the view is no longer ready but was already resolved once will resolve immediately. Use reactiveUtils.whenOnce(() => view.ready).then(...) instead."), super.when(e24, t30);
  }
  forceReadyCycle() {
    this.ready && (f3(() => false === this.preconditionsReady, () => this._readyCycleForced = false, { once: true }), this._readyCycleForced = true);
  }
  addAndActivateTool(e24) {
    this.toolViewManager.tools.add(e24), this.activeTool = e24;
  }
  tryFatalErrorRecovery() {
    this.fatalError = null;
  }
};
z6.views = new j2(), e([y2()], z6.prototype, "_userSpatialReference", void 0), e([y2()], z6.prototype, "activeTool", null), e([y2({ readOnly: true })], z6.prototype, "allLayerViews", void 0), e([y2()], z6.prototype, "groundView", void 0), e([y2()], z6.prototype, "animation", null), e([y2()], z6.prototype, "basemapView", void 0), e([y2()], z6.prototype, "center", null), e([y2({ readOnly: true })], z6.prototype, "_defaultsFromMapSettings", null), e([y2()], z6.prototype, "defaultsFromMap", null), e([y2()], z6.prototype, "fatalError", void 0), e([y2({ type: w3 })], z6.prototype, "extent", null), e([y2(a11(i10, "graphics"))], z6.prototype, "graphics", void 0), e([y2(a11(i17, "analyses"))], z6.prototype, "analyses", void 0), e([y2({ readOnly: true, type: v7 })], z6.prototype, "heightModelInfo", null), e([y2({ readOnly: true })], z6.prototype, "interacting", null), e([y2({ readOnly: true })], z6.prototype, "navigating", null), e([y2({ readOnly: true, dependsOn: ["fatalError", "_isValid", "_readyCycleForced", "map", "map.loaded?", "width", "height", "spatialReference", "_currentSpatialReference", "defaultsFromMap.ready", "typeSpecificPreconditionsReady"] })], z6.prototype, "preconditionsReady", null), e([y2({ readOnly: true })], z6.prototype, "typeSpecificPreconditionsReady", void 0), e([y2({ type: j2, readOnly: true })], z6.prototype, "layerViews", void 0), e([y2()], z6.prototype, "resolution", null), e([y2({ type: p15 })], z6.prototype, "magnifier", void 0), e([y2({ value: null, type: L3 })], z6.prototype, "map", null), e([y2()], z6.prototype, "padding", void 0), e([y2({ readOnly: true })], z6.prototype, "ready", void 0), e([y2({ type: f2 })], z6.prototype, "spatialReference", null), e([y2()], z6.prototype, "spatialReferenceWarningDelay", void 0), e([y2()], z6.prototype, "stationary", null), e([y2({ readOnly: true })], z6.prototype, "supportsGround", void 0), e([y2({ type: T })], z6.prototype, "timeExtent", void 0), e([y2({ type: a5, nonNullable: true })], z6.prototype, "timeReference", void 0), e([y2()], z6.prototype, "tools", null), e([y2()], z6.prototype, "toolViewManager", void 0), e([y2({ readOnly: true })], z6.prototype, "type", void 0), e([y2({ type: Number })], z6.prototype, "scale", void 0), e([y2({ readOnly: true })], z6.prototype, "updating", void 0), e([y2({ readOnly: true })], z6.prototype, "initialExtentRequired", void 0), e([y2({ readOnly: true })], z6.prototype, "initialExtent", null), e([y2()], z6.prototype, "cursor", null), e([y2({ readOnly: true })], z6.prototype, "input", void 0), e([y2({ type: p18, nonNullable: true })], z6.prototype, "navigation", void 0), e([y2()], z6.prototype, "layerViewManager", void 0), e([y2()], z6.prototype, "analysisViewManager", void 0), e([y2()], z6.prototype, "width", void 0), e([y2()], z6.prototype, "height", void 0), e([y2({ readOnly: true })], z6.prototype, "resizing", void 0), e([y2({ value: null, readOnly: true })], z6.prototype, "size", null), e([y2({ readOnly: true })], z6.prototype, "suspended", void 0), e([y2({ readOnly: true })], z6.prototype, "viewEvents", void 0), e([y2({ readOnly: true })], z6.prototype, "persistableViewModels", void 0), e([y2()], z6.prototype, "_isValid", void 0), e([y2()], z6.prototype, "_readyCycleForced", void 0), e([y2()], z6.prototype, "_currentSpatialReference", void 0), z6 = W6 = e([a3("esri.views.View")], z6);
var A7 = z6;

// node_modules/@arcgis/core/views/ViewAnimation.js
var n21 = class extends _ {
  constructor(t30) {
    super(t30), this.state = "running", this.target = null, this._dfd = null;
  }
  initialize() {
    this.addResolvingPromise(new Promise((t30, s27) => this._dfd = { resolve: t30, reject: s27 }));
  }
  get done() {
    return "finished" === this.state || "stopped" === this.state;
  }
  stop() {
    var _a;
    "stopped" !== this.state && "finished" !== this.state && (this._set("state", "stopped"), (_a = this._dfd) == null ? void 0 : _a.reject(new s3("ViewAnimation stopped")));
  }
  finish() {
    var _a;
    "stopped" !== this.state && "finished" !== this.state && (this._set("state", "finished"), (_a = this._dfd) == null ? void 0 : _a.resolve());
  }
  update(t30, s27) {
    s27 || (s27 = C(t30) ? "waiting-for-target" : "running"), this._set("target", t30), this._set("state", s27);
  }
};
e([y2({ readOnly: true })], n21.prototype, "done", null), e([y2({ readOnly: true, type: String })], n21.prototype, "state", void 0), e([y2()], n21.prototype, "target", void 0), n21 = e([a3("esri.views.ViewAnimation")], n21), function(t30) {
  t30.State = { RUNNING: "running", STOPPED: "stopped", FINISHED: "finished", WAITING_FOR_TARGET: "waiting-for-target" };
}(n21 || (n21 = {}));
var p21 = n21;

// node_modules/@arcgis/core/views/2d/AnimationManager.js
var u14 = class {
  constructor(t30, i34, s27, e24) {
    const o27 = t30.targetGeometry, n31 = i34.targetGeometry;
    e24 ? "string" == typeof e24 && (e24 = r11(e24) || t11.ease) : e24 = t11.ease, this.easing = e24, this.duration = s27, this.sCenterX = o27.x, this.sCenterY = o27.y, this.sScale = t30.scale, this.sRotation = t30.rotation, this.tCenterX = n31.x, this.tCenterY = n31.y, this.tScale = i34.scale, this.tRotation = i34.rotation, this.dCenterX = this.tCenterX - this.sCenterX, this.dCenterY = this.tCenterY - this.sCenterY, this.dScale = this.tScale - this.sScale, this.dRotation = this.tRotation - this.sRotation, this.dRotation > 180 ? this.dRotation -= 360 : this.dRotation < -180 && (this.dRotation += 360);
  }
  applyRatio(t30, i34) {
    const s27 = this.easing(i34);
    let e24, o27, n31, a34;
    i34 >= 1 ? (e24 = this.tCenterX, o27 = this.tCenterY, n31 = this.tRotation, a34 = this.tScale) : (e24 = this.sCenterX + s27 * this.dCenterX, o27 = this.sCenterY + s27 * this.dCenterY, n31 = this.sRotation + s27 * this.dRotation, a34 = this.sScale + s27 * this.dScale), t30.targetGeometry.x = e24, t30.targetGeometry.y = o27, t30.scale = a34, t30.rotation = n31;
  }
};
var d12 = class extends v3 {
  constructor(t30) {
    super(t30), this.updateFunction = null, this.animation = null, this.duration = 200, this.transition = null, this.easing = t11.ease, this.view = null, this.viewpoint = new u3({ targetGeometry: new w2(), scale: 0, rotation: 0 }), this._updateTask = A2({ postRender: this._postRender.bind(this) }), this._updateTask.pause();
  }
  destroy() {
    this._updateTask = p(this._updateTask);
  }
  animate(t30, i34, s27) {
    this.stop();
    const e24 = this.viewpoint;
    Z(e24, i34), this.transition = new u14(this.viewpoint, t30.target, s27 && s27.duration || this.duration, s27 && s27.easing || this.easing);
    const o27 = () => {
      var _a, _b;
      this.animation === t30 && this._updateTask && ("finished" === t30.state && ((_a = this.transition) == null ? void 0 : _a.applyRatio(this.viewpoint, 1), ((_b = this.view) == null ? void 0 : _b.state) && (this.view.state.viewpoint = this.viewpoint.clone())), this.animation = null, this.updateFunction = null);
    };
    return t30.when(o27, o27), this._startTime = performance.now(), this._updateTask.resume(), this.animation = t30, t30;
  }
  animateContinous(t30, i34) {
    this.stop(), this.updateFunction = i34, this.viewpoint = t30;
    const s27 = new p21({ target: t30.clone() }), e24 = () => {
      this.animation === s27 && this._updateTask && (this.animation = null, this.updateFunction = null);
    };
    return s27.when(e24, e24), this._startTime = performance.now(), this._updateTask.resume(), this.animation = s27, s27;
  }
  stop() {
    this.animation && (this.animation.stop(), this.animation = null, this.updateFunction = null);
  }
  _postRender(t30) {
    var _a, _b;
    const i34 = this.animation;
    if (i34 && i34.state !== p21.State.STOPPED) {
      if (this.updateFunction)
        this.updateFunction(this.viewpoint, t30.deltaTime);
      else {
        const t31 = this.transition, i35 = (performance.now() - this._startTime) / t31.duration, s27 = i35 >= 1;
        t31.applyRatio(this.viewpoint, i35), s27 && ((_a = this.animation) == null ? void 0 : _a.finish());
      }
      ((_b = this.view) == null ? void 0 : _b.state) && (this.view.state.viewpoint = this.viewpoint.clone());
    } else
      this._updateTask.pause();
  }
};
e([y2()], d12.prototype, "animation", void 0), e([y2()], d12.prototype, "duration", void 0), e([y2()], d12.prototype, "transition", void 0), e([y2()], d12.prototype, "easing", void 0), e([y2()], d12.prototype, "view", void 0), e([y2()], d12.prototype, "viewpoint", void 0), d12 = e([a3("esri.views.2d.AnimationManager")], d12);
var l17 = d12;

// node_modules/@arcgis/core/views/2d/FrameTask.js
var s20 = class {
  constructor(t30) {
    this.view = t30, this._stationaryHandle = null, this._frameTaskHandle = null, this._updateParameters = null, this._updateRequested = false, this.stationary = true, this.animationInProgress = false, this.prepare = () => {
      this._updateParameters && (this._updateParameters.state = this.view.state, this._updateParameters.stationary = this.view.stationary, this._updateParameters.pixelRatio = window.devicePixelRatio, this._updateParameters.renderingOptions = this.view.renderingOptions);
    }, this.update = () => {
      var _a;
      this._updateRequested = false;
      const { basemapView: t31, graphicsView: a34, labelManager: s27, layerViews: i34, state: { id: r24 } } = this.view;
      t31 == null ? void 0 : t31.baseLayerViews.forEach(this._updateLayerView, this), i34.forEach(this._updateLayerView, this), t31 == null ? void 0 : t31.referenceLayerViews.forEach(this._updateLayerView, this), r(s27) && (s27.lastUpdateId !== r24 && (s27.viewChange(), s27.lastUpdateId = r24), s27.updateRequested && s27.processUpdate(this._updateParameters)), r(a34) && (a34.lastUpdateId !== r24 && (a34.viewChange(), a34.lastUpdateId = r24), a34.updateRequested && a34.processUpdate(this._updateParameters)), this.view.graphicsTileStore.setViewState(this._updateParameters.state), this.animationInProgress || this._updateRequested || ((_a = this._frameTaskHandle) == null ? void 0 : _a.pause());
    };
  }
  destroy() {
    this.stop();
  }
  start() {
    if (this._frameTaskHandle)
      return;
    const e24 = this.view;
    this.stationary = e24.stationary, this._updateParameters = { state: e24.state, pixelRatio: window.devicePixelRatio, stationary: this.stationary, renderingOptions: e24.renderingOptions }, this._stationaryHandle = l3(() => e24.stationary, (e25) => {
      this.stationary = e25, this.requestFrame();
    }), this._frameTaskHandle = A2(this), this.requestUpdate();
  }
  stop() {
    var _a;
    this._frameTaskHandle && (this._updateRequested = false, (_a = this._stationaryHandle) == null ? void 0 : _a.remove(), this._frameTaskHandle.remove(), this._updateParameters = this._stationaryHandle = this._frameTaskHandle = null, this.stationary = true, this.animationInProgress = false);
  }
  requestUpdate() {
    this._updateRequested || (this._updateRequested = true, this.requestFrame());
  }
  requestFrame() {
    this._frameTaskHandle && this._frameTaskHandle.resume();
  }
  _updateLayerView(e24) {
    if (!e24.attached)
      return void this.requestUpdate();
    const t30 = this.view.state, a34 = e24.lastUpdateId;
    null != a34 && (this.stationary || e24.moving) || (e24.moving = true, e24.moveStart()), a34 !== t30.id && e24.viewChange(), this.stationary && e24.moving && (e24.moving = false, e24.moveEnd()), e24.lastUpdateId = t30.id, e24.updateRequested && e24.processUpdate(this._updateParameters), "layerViews" in e24 && e24.layerViews.forEach(this._updateLayerView, this);
  }
};

// node_modules/@arcgis/core/views/2d/layerViewModuleImportUtils.js
function t20() {
  return Promise.all([import("./webglDeps-VLNTUIG6.js"), import("./mapViewDeps-SKVZRQBG.js")]);
}
var s21 = () => t20().then(() => import("./TileLayerView2D-PMQDK3ZC.js"));
var i25 = () => t20().then(() => import("./FeatureLayerView2D-7VMP3UCE.js"));
var l18 = { "base-dynamic": () => t20().then(() => import("./BaseDynamicLayerView2D-V6W6AL2B.js")), "base-tile": s21, "bing-maps": s21, csv: i25, "geo-rss": () => t20().then(() => import("./GeoRSSLayerView2D-DXDQ6HXQ.js")), feature: i25, geojson: i25, graphics: () => t20().then(() => import("./GraphicsLayerView2D-IV6W5HYM.js")), group: () => t20().then(() => import("./GroupLayerView2D-I3RQQUS6.js")), imagery: () => t20().then(() => import("./ImageryLayerView2D-I2G7YEXT.js")), "imagery-tile": () => t20().then(() => import("./ImageryTileLayerView2D-2UCIE2BW.js")), kml: () => t20().then(() => import("./KMLLayerView2D-3X4KLJWP.js")), "knowledge-graph": () => t20().then(() => import("./KnowledgeGraphLayerView2D-WLHVQ2IL.js")), "link-chart": () => t20().then(() => import("./KnowledgeGraphLayerView2D-WLHVQ2IL.js")), "knowledge-graph-sublayer": i25, "map-image": () => t20().then(() => import("./MapImageLayerView2D-KNH53IDH.js")), "map-notes": () => t20().then(() => import("./MapNotesLayerView2D-JBCDCZZN.js")), media: () => t20().then(() => import("./MediaLayerView2D-CBGA2O7K.js")), "ogc-feature": () => t20().then(() => import("./OGCFeatureLayerView2D-QAATQNFR.js")), "open-street-map": s21, "oriented-imagery": i25, route: () => t20().then(() => import("./RouteLayerView2D-7W6TFDTP.js")), stream: () => t20().then(() => import("./StreamLayerView2D-2YUBIE3I.js")), "subtype-group": () => t20().then(() => import("./SubtypeGroupLayerView2D-C4N45OQ6.js")), tile: s21, "vector-tile": () => t20().then(() => import("./VectorTileLayerView2D-CRHN2ATK.js")), wcs: () => t20().then(() => import("./ImageryTileLayerView2D-2UCIE2BW.js")), "web-tile": s21, wfs: i25, wms: () => t20().then(() => import("./WMSLayerView2D-M6XKLBEZ.js")), wmts: () => t20().then(() => import("./WMTSLayerView2D-MJ55HQHN.js")), "line-of-sight": null, "base-elevation": null, "building-scene": null, dimension: null, elevation: null, "integrated-mesh": null, "point-cloud": null, voxel: null, scene: null, unknown: null, unsupported: null };
function o19(r24) {
  const a34 = r24.declaredClass ? r24.declaredClass.slice(r24.declaredClass.lastIndexOf(".") + 1) : "Unknown", t30 = a34.replace(/([a-z])([A-Z])/g, "$1-$2").toLowerCase();
  return new s3(`${t30}:view-not-supported`, `${a34} is not supported in 2D`);
}
var n22 = { hasLayerViewModule: (e24) => r(l18[e24.type]), importLayerView: (e24) => {
  const r24 = l18[e24.type];
  if (t2(r24))
    throw o19(e24);
  return r24(e24);
} };

// node_modules/@arcgis/core/geometry/support/near.js
function o20(o27, m25) {
  const { spatialReference: r24 } = m25, i34 = [m25.x, m25.y];
  let s27 = Number.POSITIVE_INFINITY, x4 = 0, c37 = 0;
  const a34 = [0, 0], f18 = "extent" === o27.type ? [[[o27.xmin, o27.ymin], [o27.xmin, o27.ymax], [o27.xmax, o27.ymax], [o27.xmax, o27.ymin], [o27.xmin, o27.ymin]]] : o27.rings;
  for (const n31 of f18)
    for (let o28 = 0; o28 < n31.length - 1; o28++) {
      o3(a34, i34, n31, o28);
      const m26 = m3(i34, a34);
      m26 < s27 && (s27 = m26, x4 = a34[0], c37 = a34[1]);
    }
  return { coordinate: new w2({ x: x4, y: c37, spatialReference: r24 }), distance: s27 };
}

// node_modules/@arcgis/core/views/2d/constraints/GeometryConstraint.js
var l19;
var y13 = l19 = class extends i7(v3) {
  constructor(e24) {
    super(e24), this.geometry = null, this.spatialReference = null;
  }
  get normalizedGeometry() {
    if (t2(this.geometry) || !this.spatialReference)
      return null;
    if (!this.spatialReference.equals(this.geometry.spatialReference))
      try {
        return rn(this.geometry, this.spatialReference);
      } catch (e24) {
        return s2.getLogger(this.declaredClass).error("#constraints.geometry", "could not project the geometry to the view's spatial reference", { geometry: this.geometry, spatialReference: this.spatialReference, error: e24 }), null;
      }
    return this.geometry;
  }
  constrain(e24, r24) {
    if (t2(this.normalizedGeometry))
      return e24;
    const t30 = e24.targetGeometry;
    if ("extent" === this.normalizedGeometry.type ? r3(this.normalizedGeometry, t30) : c(this.normalizedGeometry, t30))
      return e24;
    const { coordinate: o27 } = o20(this.normalizedGeometry, t30);
    return o27 ? (e24.targetGeometry = o27, e24) : e24;
  }
  clone() {
    var _a, _b;
    return new l19({ geometry: (_a = this.geometry) == null ? void 0 : _a.clone(), spatialReference: (_b = this.spatialReference) == null ? void 0 : _b.clone() });
  }
};
e([y2({ constructOnly: true })], y13.prototype, "geometry", void 0), e([y2({ readOnly: true })], y13.prototype, "normalizedGeometry", null), e([y2({ constructOnly: true })], y13.prototype, "spatialReference", void 0), y13 = l19 = e([a3("esri.views.2d.constraints.GeometryConstraint")], y13);

// node_modules/@arcgis/core/views/2d/constraints/RotationConstraint.js
var a21;
var n23 = a21 = class extends i7(v3) {
  constructor() {
    super(...arguments), this.enabled = true, this.rotationEnabled = true;
  }
  constrain(o27, r24) {
    return this.enabled && r24 ? (this.rotationEnabled || (o27.rotation = r24.rotation), o27) : o27;
  }
  clone() {
    return new a21({ enabled: this.enabled, rotationEnabled: this.rotationEnabled });
  }
};
e([y2()], n23.prototype, "enabled", void 0), e([y2()], n23.prototype, "rotationEnabled", void 0), n23 = a21 = e([a3("esri.views.2d.constraints.RotationConstraint")], n23);
var i26 = n23;

// node_modules/@arcgis/core/views/2d/constraints/ZoomConstraint.js
var a22;
var c27 = a22 = class extends i7(v3) {
  constructor(e24) {
    super(e24), this._lodByScale = {}, this._scales = [], this.effectiveLODs = null, this.effectiveMinZoom = -1, this.effectiveMaxZoom = -1, this.effectiveMinScale = 0, this.effectiveMaxScale = 0, this.lods = null, this.minZoom = -1, this.maxZoom = -1, this.minScale = 0, this.maxScale = 0, this.snapToZoom = true;
  }
  initialize() {
    let e24, { lods: t30, minScale: o27, maxScale: s27, minZoom: i34, maxZoom: a34 } = this, c37 = -1, r24 = -1, l25 = false, n31 = false;
    if (0 !== o27 && 0 !== s27 && o27 < s27 && ([o27, s27] = [s27, o27]), !t30 || !t30.length)
      return this._set("effectiveMinScale", o27), void this._set("effectiveMaxScale", s27);
    t30 = t30.map((e25) => e25.clone()), t30.sort((e25, t31) => t31.scale - e25.scale), t30.forEach((e25, t31) => e25.level = t31);
    for (const f18 of t30)
      !l25 && o27 > 0 && o27 >= f18.scale && (c37 = f18.level, l25 = true), !n31 && s27 > 0 && s27 >= f18.scale && (r24 = e24 ? e24.level : -1, n31 = true), e24 = f18;
    -1 === i34 && (i34 = 0 === o27 ? 0 : c37), -1 === a34 && (a34 = 0 === s27 ? t30.length - 1 : r24), i34 = Math.max(i34, 0), i34 = Math.min(i34, t30.length - 1), a34 = Math.max(a34, 0), a34 = Math.min(a34, t30.length - 1), i34 > a34 && ([i34, a34] = [a34, i34]), o27 = t30[i34].scale, s27 = t30[a34].scale, t30.splice(0, i34), t30.splice(a34 - i34 + 1, t30.length), t30.forEach((e25, t31) => {
      this._lodByScale[e25.scale] = e25, this._scales[t31] = e25.scale;
    }), this._set("effectiveLODs", t30), this._set("effectiveMinZoom", i34), this._set("effectiveMaxZoom", a34), this._set("effectiveMinScale", o27), this._set("effectiveMaxScale", s27);
  }
  constrain(e24, t30) {
    if (t30 && e24.scale === t30.scale)
      return e24;
    const o27 = this.effectiveMinScale, s27 = this.effectiveMaxScale, i34 = e24.targetGeometry, a34 = t30 && t30.targetGeometry, c37 = 0 !== s27 && e24.scale < s27, r24 = 0 !== o27 && e24.scale > o27;
    if (c37 || r24) {
      const c38 = r24 ? o27 : s27;
      if (t30 && a34) {
        const o28 = (c38 - t30.scale) / (e24.scale - t30.scale);
        i34.x = a34.x + (i34.x - a34.x) * o28, i34.y = a34.y + (i34.y - a34.y) * o28;
      }
      e24.scale = c38;
    }
    return this.snapToZoom && this.effectiveLODs && (e24.scale = this._getClosestScale(e24.scale)), e24;
  }
  fit(e24) {
    if (!this.effectiveLODs || !this.snapToZoom)
      return this.constrain(e24, null);
    const t30 = this.scaleToZoom(e24.scale), o27 = Math.abs(t30 - Math.floor(t30));
    return e24.scale = this.zoomToScale(o27 > 0.99 ? Math.round(t30) : Math.floor(t30)), e24;
  }
  zoomToScale(e24) {
    if (!this.effectiveLODs)
      return 0;
    e24 -= this.effectiveMinZoom, e24 = Math.max(0, e24);
    const t30 = this._scales;
    if (e24 <= 0)
      return t30[0];
    if (e24 >= t30.length)
      return t30[t30.length - 1];
    const o27 = Math.round(e24 - 0.5), s27 = Math.round(e24);
    return t30[s27] + (s27 - e24) * (t30[o27] - t30[s27]);
  }
  scaleToZoom(e24) {
    if (!this.effectiveLODs)
      return -1;
    const t30 = this._scales;
    let o27, s27;
    if (e24 >= t30[0])
      return this.effectiveMinZoom;
    if (e24 <= t30[t30.length - 1])
      return this.effectiveMaxZoom;
    for (let i34 = 0; i34 < t30.length - 1; i34++) {
      if (o27 = t30[i34], s27 = t30[i34 + 1], s27 === e24) {
        return i34 + this.effectiveMinZoom + 1;
      }
      if (o27 > e24 && s27 < e24) {
        return i34 + this.effectiveMinZoom + 1 - (e24 - s27) / (o27 - s27);
      }
    }
    return -1;
  }
  snapToClosestScale(e24) {
    if (!this.effectiveLODs)
      return e24;
    const t30 = this.scaleToZoom(e24);
    return this.zoomToScale(Math.round(t30));
  }
  snapToNextScale(e24, t30 = 0.5) {
    if (!this.effectiveLODs)
      return e24 * t30;
    const o27 = Math.round(this.scaleToZoom(e24));
    return this.zoomToScale(o27 + 1);
  }
  snapToPreviousScale(e24, t30 = 2) {
    if (!this.effectiveLODs)
      return e24 * t30;
    const o27 = Math.round(this.scaleToZoom(e24));
    return this.zoomToScale(o27 - 1);
  }
  clone() {
    return new a22({ lods: this.lods, minZoom: this.minZoom, maxZoom: this.maxZoom, minScale: this.minScale, maxScale: this.maxScale });
  }
  _getClosestScale(e24) {
    return this._lodByScale[e24] || (e24 = this._scales.reduce((t30, o27) => Math.abs(o27 - e24) <= Math.abs(t30 - e24) ? o27 : t30, this._scales[0])), this._lodByScale[e24].scale;
  }
};
e([y2({ readOnly: true })], c27.prototype, "effectiveLODs", void 0), e([y2({ readOnly: true })], c27.prototype, "effectiveMinZoom", void 0), e([y2({ readOnly: true })], c27.prototype, "effectiveMaxZoom", void 0), e([y2({ readOnly: true })], c27.prototype, "effectiveMinScale", void 0), e([y2({ readOnly: true })], c27.prototype, "effectiveMaxScale", void 0), e([y2()], c27.prototype, "lods", void 0), e([y2()], c27.prototype, "minZoom", void 0), e([y2()], c27.prototype, "maxZoom", void 0), e([y2()], c27.prototype, "minScale", void 0), e([y2()], c27.prototype, "maxScale", void 0), e([y2()], c27.prototype, "snapToZoom", void 0), c27 = a22 = e([a3("esri.views.2d.constraints.ZoomConstraint")], c27);
var r17 = c27;

// node_modules/@arcgis/core/views/2d/MapViewConstraints.js
var p22 = { base: null, key: "type", typeMap: { extent: w3, polygon: v4 } };
var c28 = class extends v3 {
  constructor(o27) {
    super(o27), this.lods = null, this.minScale = 0, this.maxScale = 0, this.minZoom = -1, this.maxZoom = -1, this.rotationEnabled = true, this.snapToZoom = true;
  }
  destroy() {
    this.view = null;
  }
  get effectiveLODs() {
    return this._zoom.effectiveLODs;
  }
  get effectiveMinScale() {
    return this._zoom.effectiveMinScale;
  }
  get effectiveMaxScale() {
    return this._zoom.effectiveMaxScale;
  }
  get effectiveMinZoom() {
    return this._zoom.effectiveMinZoom;
  }
  get effectiveMaxZoom() {
    return this._zoom.effectiveMaxZoom;
  }
  set geometry(o27) {
    o27 ? this._set("geometry", o27) : this._set("geometry", null);
  }
  get version() {
    var _a, _b, _c;
    return `${(_a = this._zoom) == null ? void 0 : _a.uid}/${(_b = this._rotation) == null ? void 0 : _b.uid}/${(_c = this._geometry) == null ? void 0 : _c.uid}`;
  }
  get _defaultLODs() {
    var _a, _b, _c;
    const o27 = (_b = (_a = this.view) == null ? void 0 : _a.defaultsFromMap) == null ? void 0 : _b.tileInfo, e24 = (_c = this.view) == null ? void 0 : _c.spatialReference;
    return o27 && e24 && o27.spatialReference.equals(e24) ? o27.lods : null;
  }
  get _geometry() {
    var _a;
    return new y13({ geometry: this.geometry, spatialReference: (_a = this.view) == null ? void 0 : _a.spatialReference });
  }
  get _rotation() {
    return new i26({ rotationEnabled: this.rotationEnabled });
  }
  get _zoom() {
    const o27 = this._get("_zoom"), e24 = this.lods || this._defaultLODs, t30 = this.minZoom, r24 = this.maxZoom, s27 = this.minScale, i34 = this.maxScale, n31 = this.snapToZoom;
    return o27 && o27.lods === e24 && o27.minZoom === t30 && o27.maxZoom === r24 && o27.minScale === s27 && o27.maxScale === i34 && o27.snapToZoom === n31 ? o27 : new r17({ lods: e24, minZoom: t30, maxZoom: r24, minScale: s27, maxScale: i34, snapToZoom: n31 });
  }
  canZoomInTo(o27) {
    const e24 = this.effectiveMaxScale;
    return 0 === e24 || o27 >= e24;
  }
  canZoomOutTo(o27) {
    const e24 = this.effectiveMinScale;
    return 0 === e24 || o27 <= e24;
  }
  constrain(o27, e24) {
    return this._zoom.constrain(o27, e24), this._rotation.constrain(o27, e24), this._geometry.constrain(o27, e24), o27;
  }
  constrainByGeometry(o27) {
    return this._geometry.constrain(o27);
  }
  fit(o27) {
    return this._zoom.fit(o27);
  }
  zoomToScale(o27) {
    return this._zoom.zoomToScale(o27);
  }
  scaleToZoom(o27) {
    return this._zoom.scaleToZoom(o27);
  }
  snapScale(o27) {
    return this._zoom.snapToClosestScale(o27);
  }
  snapToNextScale(o27) {
    return this._zoom.snapToNextScale(o27);
  }
  snapToPreviousScale(o27) {
    return this._zoom.snapToPreviousScale(o27);
  }
};
e([y2({ readOnly: true })], c28.prototype, "effectiveLODs", null), e([y2({ readOnly: true })], c28.prototype, "effectiveMinScale", null), e([y2({ readOnly: true })], c28.prototype, "effectiveMaxScale", null), e([y2({ readOnly: true })], c28.prototype, "effectiveMinZoom", null), e([y2({ readOnly: true })], c28.prototype, "effectiveMaxZoom", null), e([y2({ types: p22, value: null })], c28.prototype, "geometry", null), e([y2({ type: [p3] })], c28.prototype, "lods", void 0), e([y2()], c28.prototype, "minScale", void 0), e([y2()], c28.prototype, "maxScale", void 0), e([y2()], c28.prototype, "minZoom", void 0), e([y2()], c28.prototype, "maxZoom", void 0), e([y2()], c28.prototype, "rotationEnabled", void 0), e([y2()], c28.prototype, "snapToZoom", void 0), e([y2()], c28.prototype, "view", void 0), e([y2({ readOnly: true })], c28.prototype, "version", null), e([y2()], c28.prototype, "_defaultLODs", null), e([y2({ type: y13 })], c28.prototype, "_geometry", null), e([y2({ type: i26 })], c28.prototype, "_rotation", null), e([y2({ readOnly: true, type: r17 })], c28.prototype, "_zoom", null), c28 = e([a3("esri.views.2d.MapViewConstraints")], c28);
var u15 = c28;

// node_modules/@arcgis/core/core/libs/gl-matrix-2/types/vec2.js
function n24(n31) {
  return n31 instanceof Float32Array && n31.length >= 2;
}
function r18(n31) {
  return Array.isArray(n31) && n31.length >= 2;
}
function t21(t30) {
  return n24(t30) || r18(t30);
}

// node_modules/@arcgis/core/views/2d/ViewState.js
var b14;
var G4 = [0, 0];
var O3 = b14 = class extends l {
  constructor(t30) {
    super(t30), this._viewpoint2D = { center: n8(), rotation: 0, scale: 0, spatialReference: void 0 }, this.center = [0, 0], this.extent = new w3(), this.id = 0, this.inverseTransform = e10(), this.resolution = 0, this.rotation = 0, this.scale = 0, this.transform = e10(), this.transformNoRotation = e10(), this.displayMat3 = e8(), this.displayViewMat3 = e8(), this.viewMat3 = e8(), this.viewMat2d = n7(), this.worldScreenWidth = 0, this.size = [0, 0];
  }
  set pixelRatio(t30) {
    this._set("pixelRatio", t30), this._update();
  }
  set size(t30) {
    this._set("size", t30), this._update();
  }
  set viewpoint(t30) {
    if (t30) {
      const s27 = this._viewpoint2D, i34 = t30.targetGeometry;
      s27.center[0] = i34.x, s27.center[1] = i34.y, s27.rotation = t30.rotation, s27.scale = t30.scale, s27.spatialReference = i34.spatialReference;
    }
    this._update();
  }
  copy(t30) {
    const s27 = this.size, i34 = this.viewpoint;
    return i34 && s27 ? (this.viewpoint = Z(i34, t30.viewpoint), this._set("size", a8(s27, t30.size))) : (this.viewpoint = t30.viewpoint.clone(), this._set("size", [t30.size[0], t30.size[1]])), this._set("pixelRatio", t30.pixelRatio), this;
  }
  clone() {
    return new b14({ size: this.size, viewpoint: this.viewpoint.clone(), pixelRatio: this.pixelRatio });
  }
  toMap(t30, s27, i34) {
    return t21(s27) ? z(t30, s27, this.inverseTransform) : (G4[0] = s27, G4[1] = i34, z(t30, G4, this.inverseTransform));
  }
  toScreen(t30, s27, i34) {
    return t21(s27) ? z(t30, s27, this.transform) : (G4[0] = s27, G4[1] = i34, z(t30, G4, this.transform));
  }
  toScreenNoRotation(t30, s27, i34) {
    return t21(s27) ? z(t30, s27, this.transformNoRotation) : (G4[0] = s27, G4[1] = i34, z(t30, G4, this.transformNoRotation));
  }
  getScreenTransform(t30, s27) {
    const { center: i34 } = this._viewpoint2D, e24 = this._get("pixelRatio") || 1, o27 = this._get("size");
    return ut(t30, i34, o27, s27, 0, e24), t30;
  }
  _update() {
    const { center: t30, spatialReference: i34, scale: e24, rotation: o27 } = this._viewpoint2D, c37 = this._get("pixelRatio") || 1, m25 = this._get("size"), d18 = new u3({ targetGeometry: new w2(t30[0], t30[1], i34), scale: e24, rotation: o27 });
    if (this._set("viewpoint", d18), !m25 || !i34 || !e24)
      return;
    this.resolution = ot(d18), this.rotation = o27, this.scale = e24, this.spatialReference = i34, a8(this.center, t30);
    const y16 = 0 !== m25[0] ? 2 / m25[0] : 0, _10 = 0 !== m25[1] ? -2 / m25[1] : 0;
    s7(this.displayMat3, y16, 0, 0, 0, _10, 0, -1, 1, 1);
    const x4 = r8(this.viewMat3), z8 = t10(m25[0] / 2, m25[1] / 2), g17 = t10(-m25[0] / 2, -m25[1] / 2), D4 = r4(o27);
    M2(x4, x4, z8), h3(x4, x4, D4), M2(x4, x4, g17), i5(this.displayViewMat3, this.displayMat3, x4);
    const b17 = f5(this.viewMat2d, z8);
    return e7(b17, b17, D4), i6(b17, b17, g17), _2(this.extent, d18, m25), ft(this.transform, d18, m25, c37), r9(this.inverseTransform, this.transform), lt(this.transformNoRotation, d18, m25, c37), this.worldScreenWidth = yt(this.spatialReference, this.resolution), this._set("id", this.id + 1), this;
  }
};
e([y2({ readOnly: true })], O3.prototype, "id", void 0), e([y2({ value: 1, json: { write: true } })], O3.prototype, "pixelRatio", null), e([y2({ json: { write: true } })], O3.prototype, "size", null), e([y2()], O3.prototype, "spatialReference", void 0), e([y2({ type: u3, json: { write: true } })], O3.prototype, "viewpoint", null), O3 = b14 = e([a3("esri.views.2d.ViewState")], O3);
var U8 = O3;

// node_modules/@arcgis/core/views/2d/PaddedViewState.js
var l20;
var m19;
var w17 = l20 = class extends v3 {
  constructor() {
    super(...arguments), this.left = 0, this.top = 0, this.right = 0, this.bottom = 0;
  }
  clone() {
    return new l20({ left: this.left, top: this.top, right: this.right, bottom: this.bottom });
  }
};
e([y2()], w17.prototype, "left", void 0), e([y2()], w17.prototype, "top", void 0), e([y2()], w17.prototype, "right", void 0), e([y2()], w17.prototype, "bottom", void 0), w17 = l20 = e([a3("esri.views.2d.PaddedViewState.Padding")], w17);
var u16 = m19 = class extends U8 {
  constructor(...t30) {
    super(...t30), this.paddedViewState = new U8(), this._updateContent = (() => {
      const t31 = n8();
      return () => {
        const e24 = this._get("size"), i34 = this._get("padding");
        if (!e24 || !i34)
          return;
        const o27 = this.paddedViewState;
        r7(t31, i34.left + i34.right, i34.top + i34.bottom), o5(t31, e24, t31), a8(o27.size, t31);
        const s27 = o27.viewpoint;
        s27 && (this.viewpoint = s27);
      };
    })(), this.addHandles(l3(() => [this.size, this.padding], () => this._updateContent(), U2)), this.padding = new w17(), this.size = [0, 0];
  }
  set padding(t30) {
    this._set("padding", t30 || new w17());
  }
  set viewpoint(t30) {
    if (t30) {
      const e24 = t30.clone();
      this.paddedViewState.viewpoint = t30, gt(e24, t30, this._get("size"), this._get("padding"));
      const i34 = this._viewpoint2D, o27 = e24.targetGeometry;
      i34.center[0] = o27.x, i34.center[1] = o27.y, i34.rotation = e24.rotation, i34.scale = e24.scale, i34.spatialReference = o27.spatialReference, this._update();
    }
  }
  clone() {
    return new m19({ padding: this.padding.clone(), size: this.size.slice(), viewpoint: this.paddedViewState.viewpoint.clone(), pixelRatio: this.pixelRatio });
  }
};
e([y2()], u16.prototype, "paddedViewState", void 0), e([y2({ type: w17 })], u16.prototype, "padding", null), e([y2()], u16.prototype, "viewpoint", null), u16 = m19 = e([a3("esri.views.2d.PaddedViewState")], u16);
var f15 = u16;

// node_modules/@arcgis/core/views/input/handlers/support.js
function t22(t30, r24) {
  switch (r24) {
    case "primary":
      return "touch" === t30.pointerType || 0 === t30.button;
    case "secondary":
      return "touch" !== t30.pointerType && 2 === t30.button;
    case "tertiary":
      return "touch" !== t30.pointerType && 1 === t30.button;
  }
}

// node_modules/@arcgis/core/views/2d/input/handlers/DoubleClickZoom.js
var a23 = class extends i13 {
  constructor(t30, i34) {
    super(true), this._view = t30, this.registerIncoming("double-click", i34, (t31) => this._handleDoubleClick(t31, i34));
  }
  _handleDoubleClick(t30, a34) {
    t22(t30.data, "primary") && (t30.stopPropagation(), a34 ? this._view.mapViewNavigation.zoomOut([t30.data.x, t30.data.y]) : this._view.mapViewNavigation.zoomIn([t30.data.x, t30.data.y]));
  }
};

// node_modules/@arcgis/core/views/2d/input/handlers/DoubleTapDragZoom.js
var e18 = class extends i13 {
  constructor(t30, e24, a34) {
    super(true), this.view = t30, this.pointerType = e24, this.registerIncoming("double-tap-drag", a34, (t31) => this._handleDoubleTapDrag(t31));
  }
  _handleDoubleTapDrag(t30) {
    const { data: e24 } = t30, { pointerType: a34 } = e24;
    if (a34 !== this.pointerType)
      return;
    t30.stopPropagation();
    const { action: s27, delta: i34 } = e24, { view: r24 } = this, { mapViewNavigation: n31 } = r24;
    switch (s27) {
      case "begin": {
        const { scale: t31 } = r24;
        this._startScale = t31, this._currentScale = t31, this._previousDelta = i34, n31.begin();
        break;
      }
      case "update": {
        if (this._previousDelta.y === i34.y)
          return;
        this._previousDelta = i34;
        const t31 = 1.015 ** i34.y, e25 = this._startScale * t31, a35 = e25 / this._currentScale;
        n31.setViewpointImmediate(a35), this._currentScale = e25;
        break;
      }
      case "end": {
        const { constraints: t31 } = r24, { effectiveLODs: e25, snapToZoom: a35 } = t31;
        if (!a35 || !e25)
          return void n31.end();
        const s28 = t31.snapScale(this._currentScale), o27 = (i34.y > 0 ? Math.max(s28, t31.snapToPreviousScale(this._startScale)) : Math.min(s28, t31.snapToNextScale(this._startScale))) / this._currentScale;
        n31.zoom(o27);
        break;
      }
    }
  }
};

// node_modules/@arcgis/core/views/input/DragEventSeparator.js
var t23 = class {
  constructor(t30) {
    this._callbacks = t30, this._currentCount = 0, this._callbacks.condition || (this._callbacks.condition = () => true);
  }
  handle(t30) {
    const s27 = t30.data, i34 = s27.pointers.size;
    switch (s27.action) {
      case "start":
        this._currentCount = i34, this._emitStart(t30);
        break;
      case "added":
        this._emitEnd(this._previousEvent), this._currentCount = i34, this._emitStart(t30);
        break;
      case "update":
        this._emitUpdate(t30);
        break;
      case "removed":
        this._startEvent && this._emitEnd(this._previousEvent), this._currentCount = i34, this._emitStart(t30);
        break;
      case "end":
        this._emitEnd(t30), this._currentCount = 0;
    }
    this._previousEvent = t30;
  }
  _emitStart(t30) {
    var _a, _b;
    this._startEvent = t30, ((_b = (_a = this._callbacks).condition) == null ? void 0 : _b.call(_a, this._currentCount, t30)) && this._callbacks.start(this._currentCount, t30, this._startEvent);
  }
  _emitUpdate(t30) {
    var _a, _b;
    ((_b = (_a = this._callbacks).condition) == null ? void 0 : _b.call(_a, this._currentCount, t30)) && this._callbacks.update(this._currentCount, t30, this._startEvent);
  }
  _emitEnd(t30) {
    var _a, _b;
    ((_b = (_a = this._callbacks).condition) == null ? void 0 : _b.call(_a, this._currentCount, t30)) && this._callbacks.end(this._currentCount, t30, this._startEvent), this._startEvent = null;
  }
};

// node_modules/@arcgis/core/views/2d/input/handlers/DragPan.js
var n25 = class extends i13 {
  constructor(t30, i34, a34) {
    super(true), this.view = t30, this.pointerAction = i34, this.registerIncoming("drag", a34, (t31) => this._handleDrag(t31)), this.registerIncoming("pointer-down", () => this.stopMomentumNavigation());
  }
  onInstall(i34) {
    super.onInstall(i34), this._dragEventSeparator = new t23({ start: (t30, i35) => {
      this.view.mapViewNavigation.pan.begin(this.view, i35.data), i35.stopPropagation();
    }, update: (t30, i35) => {
      this.view.mapViewNavigation.pan.update(this.view, i35.data), i35.stopPropagation();
    }, end: (t30, i35) => {
      this.view.mapViewNavigation.pan.end(this.view, i35.data), i35.stopPropagation();
    }, condition: (t30, i35) => 1 === t30 && t22(i35.data, this.pointerAction) });
  }
  _handleDrag(t30) {
    const i34 = this.view.mapViewNavigation;
    i34.pinch.zoomMomentum || i34.pinch.rotateMomentum ? this.stopMomentumNavigation() : this._dragEventSeparator.handle(t30);
  }
  stopMomentumNavigation() {
    this.view.mapViewNavigation.pan.stopMomentumNavigation();
  }
};

// node_modules/@arcgis/core/views/2d/input/handlers/DragRotate.js
var o21 = class extends i13 {
  constructor(a34, o27, r24) {
    super(true), this._view = a34, this.pointerAction = o27;
    const e24 = this._view.mapViewNavigation;
    this._dragEventSeparator = new t23({ start: (t30, a35) => {
      e24.rotate.begin(this._view, a35.data), a35.stopPropagation();
    }, update: (t30, a35) => {
      e24.rotate.update(this._view, a35.data), a35.stopPropagation();
    }, end: (t30, a35) => {
      e24.rotate.end(), a35.stopPropagation();
    }, condition: (t30, a35) => 1 === t30 && t22(a35.data, this.pointerAction) }), this.registerIncoming("drag", r24, (t30) => this._dragEventSeparator.handle(t30));
  }
};

// node_modules/@arcgis/core/views/navigation/gamepadAndKeyboardUtils.js
function n26(t30) {
  let n31 = t30 * t30;
  return t30 < 0 && (n31 *= -1), n31;
}
function a24(t30) {
  return t30.translation[0] = 0, t30.translation[1] = 0, t30.translation[2] = 0, t30.heading = 0, t30.tilt = 0, t30;
}
function i27(a34, i34, o27) {
  const s27 = o27, e24 = a34.state, r24 = a34.device, l25 = "forward-down" === i34.tiltDirection ? 1 : -1, c37 = 1;
  return "standard" === r24.deviceType ? (s27.translation[0] = n26(e24.axes[0]), s27.translation[1] = n26(e24.axes[1]), s27.translation[2] = n26(e24.buttons[7]) - n26(e24.buttons[6]), s27.heading = n26(e24.axes[2]), s27.tilt = n26(e24.axes[3])) : "spacemouse" === r24.deviceType && (s27.translation[0] = 1.2 * n26(e24.axes[0]), s27.translation[1] = 1.2 * n26(e24.axes[1]), s27.translation[2] = 2 * -n26(e24.axes[2]), s27.heading = 1.2 * n26(e24.axes[5]), s27.tilt = 1.2 * n26(e24.axes[3])), s27.tilt *= l25, g2(s27.translation, s27.translation, c37), s27;
}
function s22(t30) {
  return 0 === t30.translation[0] && 0 === t30.translation[1] && 0 === t30.translation[2] && 0 === t30.heading && 0 === t30.tilt && 0 === t30.zoom;
}

// node_modules/@arcgis/core/views/2d/input/handlers/GamepadNavigation.js
var d13 = class extends i13 {
  constructor(i34) {
    super(true), this._view = i34, this._frameTask = null, this._watchHandles = new t3(), this._currentDevice = null, this._transformation = { translation: [0, 0, 0], heading: 0, tilt: 0, zoom: 0 }, this._handle = this.registerIncoming("gamepad", (t30) => this._handleGamePadEvent(t30)), this._handle.pause();
  }
  onInstall(t30) {
    super.onInstall(t30), this._watchHandles.add([l3(() => {
      var _a;
      return (_a = this._view.navigation.gamepad) == null ? void 0 : _a.enabled;
    }, (t31) => {
      t31 ? (this._handle.resume(), this._frameTask || (this._frameTask = A2({ update: (t32) => this._frameUpdate(t32.deltaTime) }))) : (this._handle.pause(), this._frameTask && (this._frameTask.remove(), this._frameTask = null));
    }, h)]);
  }
  onUninstall() {
    this._watchHandles.removeAll(), this._frameTask && (this._frameTask.remove(), this._frameTask = null), super.onUninstall();
  }
  _handleGamePadEvent(t30) {
    const i34 = this._view.navigation.gamepad.device;
    i34 && t30.data.device !== i34 || this._currentDevice && this._currentDevice !== t30.data.device || ("end" === t30.data.action ? (this._currentDevice = null, a24(this._transformation)) : (this._currentDevice = t30.data.device, i27(t30.data, this._view.navigation.gamepad, this._transformation)));
  }
  _frameUpdate(t30) {
    const i34 = this._transformation;
    if (s22(i34))
      return;
    const e24 = this._view.viewpoint.clone(), a34 = this._view.navigation.gamepad.velocityFactor, r24 = _7 * a34 * t30;
    St(e24, e24, [i34.translation[0] * r24, -i34.translation[1] * r24]);
    const o27 = 1 + i34.translation[2] * c29 * t30, h20 = this._view.constraints.rotationEnabled ? -i34.heading * m20 * t30 : 0, d18 = this._view.size, v16 = [d18[0] / 2, d18[1]];
    Gt(e24, e24, o27, h20, v16, d18);
    const p30 = this._view.constraints.constrain(e24, this._view.viewpoint);
    this._view.viewpoint = p30;
  }
};
var m20 = 0.06;
var _7 = 0.7;
var c29 = 6e-4;

// node_modules/@arcgis/core/views/2d/input/handlers/KeyPan.js
var i28 = class extends i13 {
  constructor(e24, i34, t30) {
    super(true), this.view = e24, this.keys = i34, this._pressed = false, this._keyMap = { [i34.left]: "left", [i34.right]: "right", [i34.up]: "up", [i34.down]: "down" }, this.registerIncoming("key-down", t30, (e25) => this._handleKeyDown(e25)), this.registerIncoming("key-up", t30, (e25) => this._handleKeyUp(e25)), this.registerIncoming("blur", t30, () => this._handleBlur());
  }
  _handleKeyDown(e24) {
    e24.data.repeat || this._handleKey(e24, true);
  }
  _handleKeyUp(e24) {
    this._handleKey(e24, false);
  }
  _handleBlur() {
    this._pressed && (this._pressed = false, this.view.mapViewNavigation.stop());
  }
  _handleKey(e24, i34) {
    const t30 = this._keyMap[e24.data.key];
    if (this._pressed = null != t30, this._pressed) {
      if (i34)
        switch (this.view.mapViewNavigation.begin(), t30) {
          case "left":
            this.view.mapViewNavigation.continousPanLeft();
            break;
          case "right":
            this.view.mapViewNavigation.continousPanRight();
            break;
          case "up":
            this.view.mapViewNavigation.continousPanUp();
            break;
          case "down":
            this.view.mapViewNavigation.continousPanDown();
        }
      else
        this._pressed = false, this.view.mapViewNavigation.stop();
      e24.stopPropagation();
    }
  }
};

// node_modules/@arcgis/core/views/2d/input/handlers/KeyRotate.js
var i29 = class extends i13 {
  constructor(e24, i34, t30) {
    super(true), this.view = e24, this.keys = i34, this._pressed = false, this._keyToDirection = { [i34.clockwiseOption1]: "clockwise", [i34.clockwiseOption2]: "clockwise", [i34.counterClockwiseOption1]: "counterClockwise", [i34.counterClockwiseOption2]: "counterClockwise", [i34.resetOption1]: "reset", [i34.resetOption2]: "reset" }, this.registerIncoming("key-down", t30, (e25) => this._handleKeyDown(e25)), this.registerIncoming("key-up", t30, (e25) => this._handleKeyUp(e25)), this.registerIncoming("blur", t30, () => this._handleBlur());
  }
  _handleKeyDown(e24) {
    e24.data.repeat || this._handleKey(e24, true);
  }
  _handleKeyUp(e24) {
    this._handleKey(e24, false);
  }
  _handleBlur() {
    this._pressed && (this._pressed = false, this.view.mapViewNavigation.stop());
  }
  _handleKey(e24, i34) {
    const t30 = e24.modifiers;
    if (t30.size > 0 && !t30.has("Shift") || !this.view.constraints.rotationEnabled)
      return;
    const s27 = this._keyToDirection[e24.data.key];
    if (this._pressed = null != s27, this._pressed) {
      if (i34)
        switch (this.view.mapViewNavigation.begin(), s27) {
          case "clockwise":
            this.view.mapViewNavigation.continousRotateClockwise();
            break;
          case "counterClockwise":
            this.view.mapViewNavigation.continousRotateCounterclockwise();
            break;
          case "reset":
            this.view.mapViewNavigation.resetRotation();
        }
      else
        this._pressed = false, this.view.mapViewNavigation.stop();
      e24.stopPropagation();
    }
  }
};

// node_modules/@arcgis/core/views/2d/input/handlers/KeyZoom.js
var t24;
!function(o27) {
  o27[o27.IN = 0] = "IN", o27[o27.OUT = 1] = "OUT";
}(t24 || (t24 = {}));
var e19 = class extends i13 {
  constructor(o27, e24, i34) {
    super(true), this.view = o27, this.keys = e24, this._keysToZoomAction = {}, this.registerIncoming("key-down", i34, (o28) => this._handleKeyDown(o28)), e24.zoomIn.forEach((o28) => this._keysToZoomAction[o28] = t24.IN), e24.zoomOut.forEach((o28) => this._keysToZoomAction[o28] = t24.OUT);
  }
  _handleKeyDown(o27) {
    this._handleKey(o27);
  }
  _handleKey(o27) {
    const e24 = o27.modifiers;
    if (e24.size > 0 && !e24.has("Shift"))
      return;
    const { key: i34 } = o27.data;
    if (!(i34 in this._keysToZoomAction))
      return;
    const n31 = this._keysToZoomAction[i34], { mapViewNavigation: s27 } = this.view;
    let r24 = null;
    switch (n31) {
      case t24.IN:
        r24 = s27.zoomIn();
        break;
      case t24.OUT:
        r24 = s27.zoomOut();
        break;
      default:
        return;
    }
    s27.begin(), r24.then(() => s27.end()), o27.stopPropagation();
  }
};

// node_modules/@arcgis/core/views/2d/input/handlers/MouseWheelZoom.js
var t25 = 0.6;
var o22 = class extends i13 {
  constructor(e24, t30) {
    super(true), this._view = e24, this._canZoom = true, this.registerIncoming("mouse-wheel", t30, (e25) => this._handleMouseWheel(e25));
  }
  _handleMouseWheel(e24) {
    if (!this._view.navigation.mouseWheelZoomEnabled)
      return;
    if (e24.preventDefault(), e24.stopPropagation(), !this._canZoom)
      return;
    const o27 = this._view.mapViewNavigation, { x: n31, y: i34, deltaY: s27 } = e24.data, a34 = 1 / t25 ** (1 / 60 * s27), h20 = o27.zoom(a34, [n31, i34]);
    h20 && (this._canZoom = false, h20.catch(() => {
    }).then(() => {
      this._canZoom = true, o27.end();
    }));
  }
};

// node_modules/@arcgis/core/views/2d/input/handlers/PinchAction.js
var a25 = class extends i13 {
  constructor(i34) {
    super(true), this.view = i34, this.registerIncoming("drag", (t30) => this._handleDrag(t30)), this.registerIncoming("pointer-down", () => this._stopMomentumNavigation());
    const a34 = this.view.mapViewNavigation;
    this._dragEventSeparator = new t23({ start: (t30, i35) => {
      a34.pinch.begin(this.view, i35.data), i35.stopPropagation();
    }, update: (t30, i35) => {
      a34.pinch.update(this.view, i35.data), i35.stopPropagation();
    }, end: (t30, i35) => {
      a34.pinch.end(this.view), i35.stopPropagation();
    }, condition: (t30) => t30 >= 2 });
  }
  _handleDrag(t30) {
    this._dragEventSeparator.handle(t30);
  }
  _stopMomentumNavigation() {
    this.view.mapViewNavigation.pinch.stopMomentumNavigation();
  }
};

// node_modules/@arcgis/core/views/input/gamepad/GamepadState.js
function t26(t30) {
  const n31 = t30.native;
  return n31 ? { buttons: n31.buttons.map((t31) => t31.pressed ? t31.value ? t31.value : 1 : 0), axes: n31.axes.map((n32) => s23(n32, t30.axisThreshold)) } : { buttons: [], axes: [] };
}
function n27(t30, n31) {
  if (t30.axes.length !== n31.axes.length)
    return false;
  if (t30.buttons.length !== n31.buttons.length)
    return false;
  for (let e24 = 0; e24 < t30.axes.length; e24++)
    if (t30.axes[e24] !== n31.axes[e24])
      return false;
  for (let e24 = 0; e24 < t30.buttons.length; e24++)
    if (t30.buttons[e24] !== n31.buttons[e24])
      return false;
  return true;
}
function e20(t30) {
  for (let n31 = 0; n31 < t30.axes.length; n31++)
    if (0 !== t30.axes[n31])
      return false;
  for (let n31 = 0; n31 < t30.buttons.length; n31++)
    if (0 !== t30.buttons[n31])
      return false;
  return true;
}
function s23(t30, n31) {
  const e24 = Math.abs(t30);
  return e24 < n31 ? 0 : Math.sign(t30) * (e24 - n31) / (1 - n31);
}

// node_modules/@arcgis/core/views/input/gamepad/GamepadSource.js
var a26 = class {
  constructor(e24, t30) {
    this._element = e24, this._input = t30, this._hasEventListeners = false, this._onConnectGamepad = (e25) => {
      this._connectGamepad(e25.gamepad);
    }, this._onDisconnectGamepad = (e25) => {
      const t31 = e25.gamepad, i35 = t31.index, n32 = this._inputDevices[i35];
      n32 && (this._emitGamepadEvent(t31, t26(n32), false), this._inputDevices.splice(i35, 1), this._latestUpdate.splice(i35, 1), this._input.gamepad.devices.remove(n32), this.ensurePollingState());
    }, this._frameTask = null, this._latestUpdate = new Array(), this._inputDevices = new Array(), this._callback = null;
    const i34 = "getGamepads" in window.navigator, n31 = window.isSecureContext;
    this.supported = i34 && n31, this.supported && (this._forEachGamepad((e25) => this._connectGamepad(e25)), window.addEventListener("gamepadconnected", this._onConnectGamepad), window.addEventListener("gamepaddisconnected", this._onDisconnectGamepad), this.ensurePollingState());
  }
  destroy() {
    this.hasEventListeners = false, this.supported && (window.removeEventListener("gamepadconnected", this._onConnectGamepad), window.removeEventListener("gamepaddisconnected", this._onDisconnectGamepad));
  }
  set hasEventListeners(e24) {
    this._hasEventListeners !== e24 && (this._hasEventListeners = e24, this.ensurePollingState());
  }
  get _eventsEnabled() {
    return this.supported && this._inputDevices.length > 0 && this._hasEventListeners;
  }
  set onEvent(e24) {
    this._callback = e24;
  }
  _connectGamepad(e24) {
    const s27 = new a17(e24);
    "unknown" !== s27.deviceType && (this._inputDevices[e24.index] = s27, this._input.gamepad.devices.add(s27)), this.ensurePollingState();
  }
  ensurePollingState() {
    this._eventsEnabled ? this._startPolling() : this._stopPolling();
  }
  _startPolling() {
    null == this._frameTask && (this._frameTask = A2({ update: () => this._readGamepadState() }));
  }
  _stopPolling() {
    null != this._frameTask && (this._frameTask.remove(), this._frameTask = null, this._latestUpdate = new Array());
  }
  _readGamepadState() {
    const e24 = document.hasFocus(), t30 = this._element.contains(document.activeElement), a34 = "document" === this._input.gamepad.enabledFocusMode && !e24 || "view" === this._input.gamepad.enabledFocusMode && !t30;
    this._forEachGamepad((e25) => {
      const t31 = this._inputDevices[e25.index];
      if (!t31)
        return;
      const d18 = this._latestUpdate[e25.index], o27 = t26(t31), r24 = a34 || e20(o27);
      if (d18) {
        if (d18.timestamp === e25.timestamp)
          return;
        if (!d18.active && r24)
          return;
        if (n27(d18.state, o27))
          return;
      }
      this._emitGamepadEvent(e25, o27, !r24);
    });
  }
  _forEachGamepad(e24) {
    const t30 = window.navigator.getGamepads();
    for (let s27 = 0; s27 < t30.length; s27++) {
      const i34 = t30[s27];
      this._validate(i34) && e24(i34);
    }
  }
  _emitGamepadEvent(e24, t30, s27) {
    const i34 = this._latestUpdate[e24.index], n31 = i34 && i34.active;
    if (!n31 && !s27)
      return;
    const a34 = !n31 && s27 ? "start" : n31 && s27 ? "update" : "end";
    this._latestUpdate[e24.index] = { timestamp: e24.timestamp, state: t30, active: s27 }, this._callback && this._callback({ device: this._inputDevices[e24.index], state: t30, action: a34 });
  }
  _validate(e24) {
    if (!e24)
      return false;
    if (!e24.connected)
      return false;
    for (let t30 = 0; t30 < e24.axes.length; t30++)
      if (isNaN(e24.axes[t30]))
        return false;
    return true;
  }
};

// node_modules/@arcgis/core/views/input/BrowserEventSource.js
var o23 = has("edge");
var a27 = has("chrome");
var s24 = has("ff");
var r19 = has("safari");
var h15 = "esri-view-surface";
var l21 = { touchNone: `${h15}--touch-none`, touchPan: `${h15}--touch-pan` };
var c30 = class {
  constructor(e24, t30) {
    this._input = t30, this._active = {}, this._callback = () => {
    }, this._activePointerCaptures = /* @__PURE__ */ new Set(), this._keyDownState = /* @__PURE__ */ new Set(), this._eventId = 1, this._browserTouchPanningEnabled = false, this._element = e24, e24.getAttribute("tabindex") || e24.setAttribute("tabindex", "0"), this._eventHandlers = { "key-down": this._handleKey, "key-up": this._handleKey, "pointer-down": this._handlePointer, "pointer-move": this._handlePointerPreventDefault, "pointer-up": this._handlePointerPreventDefault, "pointer-enter": this._handlePointer, "pointer-leave": this._handlePointer, "pointer-cancel": this._handlePointer, "mouse-wheel": this._handleMouseWheel, "pointer-capture-lost": this._handlePointerCaptureLost }, this._updateTouchAction(), this._element.addEventListener("keydown", this._preventAltKeyDefault), this._gamepadSource = new a26(e24, this._input), this._gamepadSource.onEvent = (e25) => this._callback("gamepad", e25);
  }
  destroy() {
    this._callback = () => {
    }, this.activeEvents = null, this._activePointerCaptures.forEach((e24) => {
      this._releasePointerCaptureSafe(e24);
    }), this._gamepadSource = a(this._gamepadSource), this._activePointerCaptures = null, this._removeTouchAction(), this._element.removeEventListener("keydown", this._preventAltKeyDefault);
  }
  get browserTouchPanningEnabled() {
    return this._browserTouchPanningEnabled;
  }
  set browserTouchPanningEnabled(e24) {
    this._browserTouchPanningEnabled = e24, this._updateTouchAction(), this._updateTouchEventHandling();
  }
  set onEventReceived(e24) {
    this._callback = e24;
  }
  set activeEvents(e24) {
    for (const t30 in this._active)
      if (!e24 || !e24.has(t30)) {
        const e25 = this._active[t30];
        this._element.removeEventListener(u17[t30], e25), delete this._active[t30];
      }
    e24 && e24.forEach((e25) => {
      if (!this._active[e25] && u17[e25]) {
        const t30 = (this._eventHandlers[e25] || this._handleDefault).bind(this, e25);
        this._element.addEventListener(u17[e25], t30), this._active[e25] = t30;
      }
    }), this._gamepadSource.hasEventListeners = (e24 == null ? void 0 : e24.has("gamepad")) ?? false;
  }
  setPointerCapture(e24, t30) {
    t30 ? (this._element.setPointerCapture(e24.pointerId), this._activePointerCaptures.add(e24.pointerId)) : (this._releasePointerCaptureSafe(e24.pointerId), this._activePointerCaptures.delete(e24.pointerId));
  }
  _updateTouchAction() {
    this._element.classList.remove(this._browserTouchPanningEnabled ? l21.touchNone : l21.touchPan), this._element.classList.add(this._browserTouchPanningEnabled ? l21.touchPan : l21.touchNone);
  }
  _updateTouchEventHandling() {
    this._browserTouchPanningEnabled ? this._element.addEventListener("touchmove", this._preventMultiTouchPanning) : this._element.removeEventListener("touchmove", this._preventMultiTouchPanning);
  }
  _removeTouchAction() {
    this._element.classList.remove(l21.touchNone), this._element.classList.remove(l21.touchPan), this._element.removeEventListener("touchmove", this._preventMultiTouchPanning);
  }
  _releasePointerCaptureSafe(e24) {
    try {
      if (this._element.hasPointerCapture && !this._element.hasPointerCapture(e24))
        return;
      this._element.releasePointerCapture(e24);
    } catch (t30) {
    }
  }
  _updateNormalizedPointerLikeEvent(e24, t30) {
    const n31 = i22(this._element, e24);
    return c30.test.disableSubpixelCoordinates && (n31.x = Math.round(n31.x), n31.y = Math.round(n31.y)), t30.x = n31.x, t30.y = n31.y, t30;
  }
  _handleKey(e24, n31) {
    const i34 = o6(n31);
    i34 && "key-up" === e24 && this._keyDownState.delete(i34);
    const o27 = { native: n31, key: i34, repeat: !!i34 && this._keyDownState.has(i34) };
    i34 && "key-down" === e24 && this._keyDownState.add(o27.key), this._callback(e24, o27);
  }
  _handlePointer(e24, t30) {
    const n31 = this._updateNormalizedPointerLikeEvent(t30, { native: t30, x: 0, y: 0, pointerType: t30.pointerType, button: t30.button, buttons: t30.buttons, eventId: this._eventId++ });
    this._callback(e24, n31);
  }
  _handlePointerPreventDefault(e24, t30) {
    const n31 = this._updateNormalizedPointerLikeEvent(t30, { native: t30, x: 0, y: 0, pointerType: t30.pointerType, button: t30.button, buttons: t30.buttons, eventId: this._eventId++ });
    t30.preventDefault(), this._callback(e24, n31);
  }
  _handleMouseWheel(e24, t30) {
    let n31 = t30.deltaY;
    switch (t30.deltaMode) {
      case 0:
        o23 && (n31 = n31 / document.documentElement.clientHeight * 600);
        break;
      case 1:
        n31 *= 30;
        break;
      case 2:
        n31 *= 900;
    }
    o23 ? n31 *= 0.7 : a27 || r19 ? n31 *= 0.6 : s24 && (n31 *= 1.375);
    const i34 = 100, h20 = Math.abs(n31);
    if (h20 > i34) {
      const e25 = 0.02;
      n31 = n31 / h20 * 200 / (1 + Math.exp(-e25 * (h20 - i34)));
    }
    const l25 = this._updateNormalizedPointerLikeEvent(t30, { native: t30, x: 0, y: 0, deltaY: n31 });
    this._callback(e24, l25);
  }
  _handlePointerCaptureLost(e24, t30) {
    this._activePointerCaptures.delete(t30.pointerId), this._handleDefault(e24, t30);
  }
  _handleDefault(e24, t30) {
    const n31 = { native: t30 };
    t30.preventDefault(), this._callback(e24, n31);
  }
  _preventAltKeyDefault(e24) {
    "Alt" === e24.key && e24.preventDefault();
  }
  _preventMultiTouchPanning(e24) {
    e24.touches.length > 1 && e24.preventDefault();
  }
};
c30.test = { disableSubpixelCoordinates: false };
var u17 = { "key-down": "keydown", "key-up": "keyup", "pointer-down": "pointerdown", "pointer-up": "pointerup", "pointer-move": "pointermove", "mouse-wheel": "wheel", "pointer-capture-got": "gotpointercapture", "pointer-capture-lost": "lostpointercapture", "context-menu": "contextmenu", "pointer-enter": "pointerenter", "pointer-leave": "pointerleave", "pointer-cancel": "pointercancel", focus: "focus", blur: "blur" };

// node_modules/@arcgis/core/views/input/handlers/PreventContextMenu.js
var e21 = class extends i13 {
  constructor() {
    super(true), this.registerIncoming("context-menu", (t30) => {
      t30.data.native.preventDefault();
    });
  }
};

// node_modules/@arcgis/core/views/input/recognizers/support.js
function e22(t30, e24) {
  return Math.abs(e24.x - t30.x) + Math.abs(e24.y - t30.y);
}
function n28(t30, e24) {
  const n31 = e24.x - t30.x, r24 = e24.y - t30.y;
  return Math.sqrt(n31 * n31 + r24 * r24);
}
function r20(e24, n31) {
  if (n31 ? (n31.radius = 0, n31.center.x = 0, n31.center.y = 0) : n31 = { radius: 0, center: c2() }, 0 === e24.length)
    return n31;
  if (1 === e24.length)
    return n31.center.x = e24[0].x, n31.center.y = e24[0].y, n31;
  if (2 === e24.length) {
    const [t30, r25] = e24, [c38, o28] = [r25.x - t30.x, r25.y - t30.y];
    return n31.radius = Math.sqrt(c38 * c38 + o28 * o28) / 2, n31.center.x = (t30.x + r25.x) / 2, n31.center.y = (t30.y + r25.y) / 2, n31;
  }
  let r24 = 0, c37 = 0;
  for (let t30 = 0; t30 < e24.length; t30++)
    r24 += e24[t30].x, c37 += e24[t30].y;
  r24 /= e24.length, c37 /= e24.length;
  const o27 = e24.map((t30) => t30.x - r24), s27 = e24.map((t30) => t30.y - c37);
  let u21 = 0, i34 = 0, x4 = 0, y16 = 0, a34 = 0, h20 = 0, l25 = 0;
  for (let t30 = 0; t30 < o27.length; t30++) {
    const e25 = o27[t30], n32 = s27[t30], r25 = e25 * e25, c38 = n32 * n32;
    u21 += r25, i34 += c38, x4 += e25 * n32, y16 += r25 * e25, a34 += c38 * n32, h20 += e25 * c38, l25 += n32 * r25;
  }
  const f18 = 0.5 * (y16 + h20), g17 = 0.5 * (a34 + l25), p30 = u21 * i34 - x4 * x4, d18 = (f18 * i34 - g17 * x4) / p30, m25 = (u21 * g17 - x4 * f18) / p30, M7 = c2(d18 + r24, m25 + c37);
  return { radius: Math.sqrt(d18 * d18 + m25 * m25 + (u21 + i34) / e24.length), center: M7 };
}
function c31(t30) {
  const { native: e24 } = t30, { pointerId: n31, button: r24, pointerType: c37 } = e24;
  return "mouse" === c37 ? `${n31}:${r24}` : `${c37}`;
}

// node_modules/@arcgis/core/views/input/recognizers/SingleAndDoubleClick.js
var l22 = { maximumDoubleClickDelay: 250, maximumDoubleClickDistance: 10, maximumDoubleTouchDelay: 350, maximumDoubleTouchDistance: 35 };
var m21 = class extends i13 {
  constructor(t30 = l22.maximumDoubleClickDelay, i34 = l22.maximumDoubleClickDistance, o27 = l22.maximumDoubleTouchDelay, n31 = l22.maximumDoubleTouchDistance, s27 = t5) {
    super(false), this._maximumDoubleClickDelay = t30, this._maximumDoubleClickDistance = i34, this._maximumDoubleTouchDelay = o27, this._maximumDoubleTouchDistance = n31, this._clock = s27, this._pointerState = /* @__PURE__ */ new Map(), this._click = this.registerOutgoing("click"), this._doubleClick = this.registerOutgoing("double-click"), this.registerIncoming("immediate-click", this._handleImmediateClick.bind(this)), this.registerIncoming("pointer-down", this._handlePointerDown.bind(this));
  }
  onUninstall() {
    this._pointerState.forEach((e24) => e24.doubleClickTimer = p(e24.doubleClickTimer));
  }
  get hasPendingInputs() {
    return n3(this._pointerState, (e24) => null != e24.doubleClickTimer);
  }
  _clearDoubleClickTimer(e24, t30) {
    const o27 = this._pointerState.get(e24);
    o27 && (o27.doubleClickTimer = p(o27.doubleClickTimer), t30 && this._click.emit(o27.event.data, void 0, o27.event.modifiers), this._pointerState.delete(e24), this.refreshHasPendingInputs());
  }
  _doubleClickTimeoutExceeded(e24) {
    const t30 = this._pointerState.get(e24);
    1 === t30.pointerDownCount && this._click.emit(t30.event.data, void 0, t30.event.modifiers), t30.doubleClickTimer = null, this._pointerState.delete(e24), this.refreshHasPendingInputs();
  }
  _getPointerId(e24) {
    const { pointerId: t30, pointerType: i34, button: o27 } = e24.native;
    return "mouse" === i34 ? `${t30}:${o27}` : `${i34}`;
  }
  _handleImmediateClick(e24) {
    const t30 = e24.data, { pointerType: i34 } = t30.native, o27 = this._getPointerId(t30);
    if (!this._pointerState.has(o27))
      return void this._startClick(e24);
    const s27 = this._pointerState.get(o27), { data: l25, modifiers: m25 } = s27.event, c37 = "touch" === i34 ? this._maximumDoubleTouchDistance : this._maximumDoubleClickDistance;
    e22(l25, t30) > c37 ? (this._clearDoubleClickTimer(o27, true), this._startClick(e24)) : (this._clearDoubleClickTimer(o27, false), 2 === s27.pointerDownCount && this._doubleClick.emit(l25, void 0, m25));
  }
  _handlePointerDown(e24) {
    const t30 = c31(e24.data), i34 = this._pointerState.get(t30);
    i34 && (i34.pointerDownCount += 1);
  }
  _startClick(e24) {
    const { data: t30 } = e24, { native: { pointerType: i34 } } = t30, o27 = c31(t30), n31 = "touch" === i34 ? this._maximumDoubleTouchDelay : this._maximumDoubleClickDelay, l25 = this._clock.setTimeout(() => this._doubleClickTimeoutExceeded(o27), n31), m25 = 1;
    this._pointerState.set(o27, { event: e24, doubleClickTimer: l25, pointerDownCount: m25 }), this.refreshHasPendingInputs();
  }
};

// node_modules/@arcgis/core/views/input/recognizers/DoubleTapDrag.js
var p23 = class extends i13 {
  constructor(e24 = l22.maximumDoubleClickDelay, a34 = l22.maximumDoubleClickDistance, r24 = l22.maximumDoubleTouchDelay, n31 = l22.maximumDoubleTouchDistance, u21 = t5) {
    super(false), this._maximumDoubleClickDelay = e24, this._maximumDoubleClickDistance = a34, this._maximumDoubleTouchDelay = r24, this._maximumDoubleTouchDistance = n31, this._clock = u21, this._doubleTapDragReady = false, this._doubleTapDragActive = false, this._dragStartCenter = c2(0, 0), this._pointerState = /* @__PURE__ */ new Map(), this._doubleTapDrag = this.registerOutgoing("double-tap-drag"), this._dragEventSeparator = new t23({ start: (t30, e25) => this._dragStart(t30, e25), update: (t30, e25) => this._dragUpdate(e25), end: (t30, e25) => this._dragEnd(e25) }), this.registerIncoming("drag", (t30) => this._dragEventSeparator.handle(t30)), this.registerIncoming("pointer-down", (t30) => this._handlePointerDown(t30)), this.registerIncoming("pointer-up", () => this._handlePointerUp());
  }
  onUninstall() {
    this._pointerState.forEach((t30) => {
      t30.doubleTapTimeout = p(t30.doubleTapTimeout);
    });
  }
  get hasPendingInputs() {
    return n3(this._pointerState, (t30) => null != t30.doubleTapTimeout);
  }
  _clearPointerDown(t30) {
    const e24 = this._pointerState.get(t30);
    e24 && (e24.doubleTapTimeout = p(e24.doubleTapTimeout), this._pointerState.delete(t30), this.refreshHasPendingInputs());
  }
  _createDoubleTapDragData(t30, e24, a34) {
    const { button: i34, buttons: o27, pointer: r24, pointers: s27, pointerType: n31, timestamp: u21 } = a34;
    return { action: t30, delta: e24, button: i34, buttons: o27, pointer: r24, pointers: s27, pointerType: n31, timestamp: u21 };
  }
  _dragStart(t30, e24) {
    if (!this._doubleTapDragReady || 1 !== t30)
      return;
    this._doubleTapDragReady = false, this._doubleTapDragActive = true;
    const { data: a34, modifiers: o27 } = e24, { center: r24 } = a34;
    this._dragStartCenter = r24;
    const s27 = this._createDoubleTapDragData("begin", c2(0, 0), a34);
    this._doubleTapDrag.emit(s27, void 0, o27), e24.stopPropagation();
  }
  _dragUpdate(t30) {
    if (!this._doubleTapDragActive)
      return;
    const { data: e24, modifiers: a34 } = t30, { center: o27 } = e24, r24 = c2(o27.x - this._dragStartCenter.x, o27.y - this._dragStartCenter.y), s27 = this._createDoubleTapDragData("update", r24, e24);
    this._doubleTapDrag.emit(s27, void 0, a34), t30.stopPropagation();
  }
  _dragEnd(t30) {
    if (!this._doubleTapDragActive)
      return;
    const { data: e24, modifiers: a34 } = t30, { center: o27 } = e24, r24 = c2(o27.x - this._dragStartCenter.x, o27.y - this._dragStartCenter.y), s27 = this._createDoubleTapDragData("end", r24, e24);
    this._doubleTapDrag.emit(s27, void 0, a34), this._doubleTapDragActive = false, t30.stopPropagation();
  }
  _handlePointerDown(t30) {
    const { data: e24 } = t30, a34 = c31(e24), i34 = this._pointerState.get(a34), { pointerType: o27 } = e24.native;
    if (i34) {
      const r24 = "touch" === o27 ? this._maximumDoubleTouchDistance : this._maximumDoubleClickDistance;
      this._clearPointerDown(a34), e22(i34.event.data, e24) > r24 ? this._storePointerDown(t30) : this._doubleTapDragReady = true;
    } else
      this._storePointerDown(t30);
  }
  _handlePointerUp() {
    this._doubleTapDragReady = false;
  }
  _storePointerDown(t30) {
    const { data: e24 } = t30, { pointerType: a34 } = e24.native, i34 = c31(e24), o27 = "touch" === a34 ? this._maximumDoubleTouchDelay : this._maximumDoubleClickDelay, r24 = this._clock.setTimeout(() => this._clearPointerDown(i34), o27);
    this._pointerState.set(i34, { event: t30, doubleTapTimeout: r24 }), this.refreshHasPendingInputs();
  }
};

// node_modules/@arcgis/core/views/input/recognizers/Drag.js
var s25 = class extends i13 {
  constructor(t30) {
    super(false), this._navigationTouch = t30, this._startStateModifiers = /* @__PURE__ */ new Set(), this._activePointerMap = /* @__PURE__ */ new Map(), this._isDragging = false, this._isCurrentDragSuppressed = false, this._drag = this.registerOutgoing("drag"), this.registerIncoming("pointer-drag", this._handlePointerDrag.bind(this)), this.registerIncoming("pointer-up", this._handlePointerUpAndPointerLost.bind(this)), this.registerIncoming("pointer-capture-lost", this._handlePointerUpAndPointerLost.bind(this)), this.registerIncoming("pointer-cancel", this._handlePointerUpAndPointerLost.bind(this));
  }
  _createPayload(t30, e24, i34, n31) {
    return { action: t30, pointerType: this._pointerType, button: this._mouseButton, buttons: e24.buttons, timestamp: n31, pointers: o24(this._activePointerMap), pointer: e24, angle: i34.angle, radius: i34.radius, center: i34.center };
  }
  _addPointer(t30) {
    const e24 = t30.native.pointerId, i34 = a28(this._activePointerMap).angle, n31 = { event: t30, initialAngle: 0, lastAngle: 0 };
    this._activePointerMap.set(e24, n31);
    const s27 = h16(n31, r21(this._activePointerMap));
    n31.initialAngle = s27, n31.lastAngle = s27, this._updatePointerAngles(i34);
  }
  _updatePointer(t30) {
    if (t30 && null == t30.x && null == t30.y)
      return;
    const e24 = t30.native.pointerId, i34 = this._activePointerMap.get(e24);
    i34 ? i34.event = t30 : this._addPointer(t30);
  }
  _removePointer(t30) {
    const e24 = a28(this._activePointerMap).angle;
    this._activePointerMap.delete(t30), this._updatePointerAngles(e24);
  }
  _updatePointerAngles(t30) {
    const e24 = a28(this._activePointerMap);
    this._activePointerMap.forEach((i34) => {
      i34.initialAngle = h16(i34, e24) - t30, i34.lastAngle = h16(i34, e24) - t30;
    });
  }
  _emitEvent(t30, e24, i34) {
    const n31 = a28(this._activePointerMap);
    this._drag.emit(this._createPayload(t30, e24, n31, i34), void 0, this._startStateModifiers);
  }
  _handlePointerUpAndPointerLost(t30) {
    const i34 = t30.data.native.pointerId, n31 = n2(t30.timestamp);
    this._activePointerMap.get(i34) && (1 === this._activePointerMap.size ? (this._updatePointer(t30.data), !this._isCurrentDragSuppressed && this._emitEvent("end", t30.data, n31), this._isDragging = false, this._isCurrentDragSuppressed = false, this._removePointer(i34)) : (this._removePointer(i34), this._emitEvent("removed", t30.data, n2(t30.timestamp))));
  }
  _handlePointerDrag(t30) {
    const i34 = t30.data, n31 = i34.currentEvent, s27 = n2(t30.timestamp);
    switch (i34.action) {
      case "start":
      case "update":
        this._isDragging ? this._activePointerMap.has(n31.native.pointerId) ? (this._updatePointer(n31), !this._isCurrentDragSuppressed && this._emitEvent("update", n31, s27)) : (this._addPointer(n31), this._emitEvent("added", n31, s27), this._isCurrentDragSuppressed = this._isSuppressed) : (this._updatePointer(n31), this._pointerType = t30.data.startEvent.pointerType, this._mouseButton = t30.data.startEvent.button, this._startStateModifiers = t30.modifiers, this._isDragging = true, this._isCurrentDragSuppressed = this._isSuppressed, !this._isCurrentDragSuppressed && this._emitEvent("start", n31, s27));
    }
  }
  get _isSuppressed() {
    return !!this._navigationTouch && !this._navigationTouch.browserTouchPanEnabled && "touch" === this._pointerType && 1 === this._activePointerMap.size;
  }
};
function r21(e24) {
  const i34 = [];
  return e24.forEach((e25) => {
    i34.push(c2(e25.event.x, e25.event.y));
  }), r20(i34);
}
function a28(t30) {
  const e24 = r21(t30);
  let i34 = 0;
  return t30.forEach((t31) => {
    let n31 = h16(t31, e24), s27 = n31 - t31.lastAngle;
    for (; s27 > Math.PI; )
      s27 -= 2 * Math.PI;
    for (; s27 < -Math.PI; )
      s27 += 2 * Math.PI;
    n31 = t31.lastAngle + s27, t31.lastAngle = n31;
    const r24 = n31 - t31.initialAngle;
    i34 += r24;
  }), i34 /= t30.size || 1, { angle: i34, radius: e24.radius, center: e24.center };
}
function o24(t30) {
  const e24 = /* @__PURE__ */ new Map();
  return t30.forEach((t31, i34) => e24.set(i34, t31.event)), e24;
}
function h16(t30, e24) {
  const i34 = t30.event, n31 = i34.x - e24.center.x, s27 = i34.y - e24.center.y;
  return Math.atan2(s27, n31);
}
var p24;
!function(t30) {
  t30[t30.Left = 0] = "Left", t30[t30.Middle = 1] = "Middle", t30[t30.Right = 2] = "Right", t30[t30.Back = 3] = "Back", t30[t30.Forward = 4] = "Forward", t30[t30.Undefined = -1] = "Undefined";
}(p24 || (p24 = {}));

// node_modules/@arcgis/core/views/input/recognizers/ImmediateDoubleClick.js
var m22 = class extends i13 {
  constructor(e24 = l22.maximumDoubleClickDelay, o27 = l22.maximumDoubleClickDistance, a34 = l22.maximumDoubleTouchDelay, m25 = l22.maximumDoubleTouchDistance, n31 = t5) {
    super(false), this._maximumDoubleClickDelay = e24, this._maximumDoubleClickDistance = o27, this._maximumDoubleTouchDelay = a34, this._maximumDoubleTouchDistance = m25, this._clock = n31, this._pointerState = /* @__PURE__ */ new Map(), this._immediateDoubleClick = this.registerOutgoing("immediate-double-click"), this.registerIncoming("pointer-down", this._handlePointerDown.bind(this)), this.registerIncoming("pointer-up", this._handlePointerUp.bind(this));
  }
  onUninstall() {
    this._pointerState.forEach((t30) => {
      t30.immediateDoubleClick && t30.immediateDoubleClick.timeoutHandle.remove();
    }), super.onUninstall();
  }
  _handlePointerDown(t30) {
    const e24 = t30.data, i34 = c31(e24);
    if (!this._pointerState.has(i34)) {
      const t31 = { downButton: e24.native.button, immediateDoubleClick: null };
      this._pointerState.set(i34, t31), this.startCapturingPointer(e24.native);
    }
  }
  _handlePointerUp(t30) {
    const e24 = t30.data, i34 = c31(e24), m25 = this._pointerState.get(i34);
    if (m25 && m25.downButton === e24.native.button) {
      const i35 = m25.immediateDoubleClick;
      if (i35) {
        i35.timeoutHandle.remove();
        const o27 = "touch" === t30.data.native.pointerType ? this._maximumDoubleTouchDistance : this._maximumDoubleClickDistance;
        e22(i35, t30.data) > o27 ? this._startImmediateDoubleClick(t30, m25) : (this._immediateDoubleClick.emit(t30.data, void 0, i35.modifiers), this._removeState(e24));
      } else
        this._startImmediateDoubleClick(t30, m25);
    }
  }
  _startImmediateDoubleClick(t30, e24) {
    const i34 = "touch" === t30.data.native.pointerType ? this._maximumDoubleTouchDelay : this._maximumDoubleClickDelay;
    e24.immediateDoubleClick = { x: t30.data.x, y: t30.data.y, modifiers: t30.modifiers, timeoutHandle: this._clock.setTimeout(() => this._removeState(t30.data), i34) };
  }
  _removeState(t30) {
    const e24 = c31(t30);
    this._pointerState.delete(e24), this.stopCapturingPointer(t30.native), this.refreshHasPendingInputs();
  }
};

// node_modules/@arcgis/core/views/input/recognizers/PointerClickHoldAndDrag.js
var o25 = { maximumClickDelay: 300, movementUntilMouseDrag: 1.5, movementUntilPenDrag: 6, movementUntilTouchDrag: 6, holdDelay: 500 };
var r22 = class extends i13 {
  constructor(e24 = o25.maximumClickDelay, i34 = o25.movementUntilMouseDrag, n31 = o25.movementUntilPenDrag, r24 = o25.movementUntilTouchDrag, s27 = o25.holdDelay, a34 = t5) {
    super(false), this._maximumClickDelay = e24, this._movementUntilMouseDrag = i34, this._movementUntilPenDrag = n31, this._movementUntilTouchDrag = r24, this._holdDelay = s27, this._clock = a34, this._pointerState = /* @__PURE__ */ new Map(), this._pointerDrag = this.registerOutgoing("pointer-drag"), this._immediateClick = this.registerOutgoing("immediate-click"), this._pointerHold = this.registerOutgoing("hold"), this.registerIncoming("pointer-down", this._handlePointerDown.bind(this)), this.registerIncoming("pointer-up", (t30) => {
      this._handlePointerLoss(t30, "pointer-up");
    }), this.registerIncoming("pointer-capture-lost", (t30) => {
      this._handlePointerLoss(t30, "pointer-capture-lost");
    }), this.registerIncoming("pointer-cancel", (t30) => {
      this._handlePointerLoss(t30, "pointer-cancel");
    }), this._moveHandle = this.registerIncoming("pointer-move", this._handlePointerMove.bind(this)), this._moveHandle.pause();
  }
  onUninstall() {
    this._pointerState.forEach((t30) => {
      t30.holdTimeout = p(t30.holdTimeout);
    }), super.onUninstall();
  }
  _handlePointerDown(t30) {
    const e24 = t30.data, i34 = e24.native.pointerId;
    let n31 = null;
    0 === this._pointerState.size && (n31 = this._clock.setTimeout(() => {
      const e25 = this._pointerState.get(i34);
      if (e25) {
        if (!e25.isDragging) {
          const i35 = e25.previousEvent;
          this._pointerHold.emit(i35, void 0, t30.modifiers), e25.holdEmitted = true;
        }
        e25.holdTimeout = null;
      }
    }, this._holdDelay));
    const o27 = { startEvent: e24, previousEvent: e24, startTimestamp: t30.timestamp, isDragging: false, downButton: e24.native.button, holdTimeout: n31, modifiers: /* @__PURE__ */ new Set() };
    this._pointerState.set(i34, o27), this.startCapturingPointer(e24.native), this._moveHandle.resume(), this._pointerState.size > 1 && this._startDragging(t30);
  }
  _createPointerDragData(t30, e24, i34) {
    return { action: t30, startEvent: e24.startEvent, previousEvent: e24.previousEvent, currentEvent: i34 };
  }
  _handlePointerMove(t30) {
    const e24 = t30.data, i34 = e24.native.pointerId, o27 = this._pointerState.get(i34);
    if (o27) {
      if (o27.isDragging)
        this._pointerDrag.emit(this._createPointerDragData("update", o27, e24), void 0, o27.modifiers);
      else {
        n28(e24, o27.startEvent) > this._getDragThreshold(e24.native.pointerType) && this._startDragging(t30);
      }
      o27.previousEvent = e24;
    }
  }
  _getDragThreshold(t30) {
    switch (t30) {
      case "touch":
        return this._movementUntilTouchDrag;
      case "pen":
        return this._movementUntilPenDrag;
      default:
        return this._movementUntilMouseDrag;
    }
  }
  _startDragging(t30) {
    const e24 = t30.data, i34 = e24.native.pointerId;
    this._pointerState.forEach((n31) => {
      null != n31.holdTimeout && (n31.holdTimeout.remove(), n31.holdTimeout = null), n31.isDragging || (n31.modifiers = t30.modifiers, n31.isDragging = true, i34 === n31.startEvent.native.pointerId ? this._pointerDrag.emit(this._createPointerDragData("start", n31, e24)) : this._pointerDrag.emit(this._createPointerDragData("start", n31, n31.previousEvent), t30.timestamp));
    });
  }
  _handlePointerLoss(t30, e24) {
    const i34 = t30.data, n31 = i34.native.pointerId, o27 = this._pointerState.get(n31);
    if (o27) {
      if (null != o27.holdTimeout && (o27.holdTimeout.remove(), o27.holdTimeout = null), o27.isDragging)
        this._pointerDrag.emit(this._createPointerDragData("end", o27, "pointer-up" === e24 ? i34 : o27.previousEvent), void 0, o27.modifiers);
      else if ("pointer-up" === e24 && o27.downButton === i34.native.button) {
        t30.timestamp - o27.startTimestamp <= this._maximumClickDelay && !o27.holdEmitted && this._immediateClick.emit(i34);
      }
      this._pointerState.delete(n31), this.stopCapturingPointer(i34.native), 0 === this._pointerState.size && this._moveHandle.pause();
    }
  }
};

// node_modules/@arcgis/core/views/2d/input/MapViewInputManager.js
var z7 = { counter: "Ctrl", pan: { left: "ArrowLeft", right: "ArrowRight", up: "ArrowUp", down: "ArrowDown" }, zoom: { zoomIn: ["=", "+"], zoomOut: ["-", "_"] }, rotate: { clockwiseOption1: "a", clockwiseOption2: "A", counterClockwiseOption1: "d", counterClockwiseOption2: "D", resetOption1: "n", resetOption2: "N" } };
var k3 = class extends v3 {
  constructor() {
    super(...arguments), this._handles = new t3();
  }
  initialize() {
    const e24 = () => {
      var _a;
      return (_a = this.view) == null ? void 0 : _a.ready;
    };
    this._handles.add([f3(() => !e24(), () => this._disconnect()), f3(e24, () => this._connect())]);
  }
  destroy() {
    this._handles = a(this._handles), this._disconnect();
  }
  get latestPointerType() {
    var _a;
    return (_a = this._inputManager) == null ? void 0 : _a.latestPointerType;
  }
  get latestPointerLocation() {
    var _a;
    return (_a = this._inputManager) == null ? void 0 : _a.latestPointerLocation;
  }
  get multiTouchActive() {
    var _a;
    return ((_a = this._inputManager) == null ? void 0 : _a.multiTouchActive) ?? false;
  }
  _disconnect() {
    this.view.viewEvents.disconnect(), this._inputManager = a(this._inputManager);
  }
  _connect() {
    const e24 = this.view.surface, t30 = new c30(e24, this.view.input), o27 = [new m22(), new r22(), new m21(), new s25(this.view.navigation), new p23()], r24 = new u4({ eventSource: t30, recognizers: o27 });
    r24.installHandlers("prevent-context-menu", [new e21()], P.INTERNAL), r24.installHandlers("navigation", [new a25(this.view), new d13(this.view), new o22(this.view), new a23(this.view), new a23(this.view, [z7.counter]), new n25(this.view, "primary"), new i28(this.view, z7.pan), new e19(this.view, z7.zoom), new i29(this.view, z7.rotate), new o21(this.view, "secondary"), new e18(this.view, "touch")], P.INTERNAL), this.view.viewEvents.connect(r24), this._source = t30, this._inputManager = r24, l3(() => {
      var _a, _b;
      return (_b = (_a = this.view) == null ? void 0 : _a.navigation) == null ? void 0 : _b.browserTouchPanEnabled;
    }, (e25) => {
      this._source && (this._source.browserTouchPanningEnabled = !e25);
    }, h);
  }
  get test() {
    return { inputManager: this._inputManager };
  }
};
e([y2()], k3.prototype, "view", void 0), e([y2()], k3.prototype, "latestPointerType", null), e([y2()], k3.prototype, "latestPointerLocation", null), e([y2()], k3.prototype, "multiTouchActive", null), k3 = e([a3("esri.views.2d.input.MapViewInputManager")], k3);
var C7 = k3;

// node_modules/@arcgis/core/views/support/createScreenshotPlan.js
function t27(t30, h20, i34, e24, l25, d18, n31, o27) {
  t30.ignorePadding && (e24 = { left: 0, right: 0, top: 0, bottom: 0 });
  let u21 = null;
  null != t30.width && null != t30.height ? u21 = [t30.width, t30.height] : null == t30.width && null != t30.height ? u21 = [t30.height, t30.height] : null != t30.width && null == t30.height ? u21 = [t30.width, t30.width] : null == t30.width && null == t30.height && (u21 = null);
  const r24 = i34[0] - (e24.left + e24.right), a34 = i34[1] - (e24.top + e24.bottom);
  let g17, w18, c37 = t30.area || { x: 0, y: 0, width: r24, height: a34 };
  if (u21) {
    const t31 = r24 / a34, h21 = u21[0] / u21[1];
    if (h21 > t31) {
      const t32 = c37.width / h21;
      c37 = { x: c37.x, y: Math.round(c37.y + (c37.height - t32) / 2), width: c37.width, height: Math.round(t32) };
    } else {
      const t32 = c37.height * h21;
      c37 = { x: Math.round(c37.x + (c37.width - t32) / 2), y: c37.y, width: Math.round(t32), height: c37.height };
    }
  } else
    u21 = [c37.width, c37.height];
  u21[0] > c37.width ? (g17 = Math.min(u21[0] / c37.width, h20), w18 = u21[0] / c37.width / g17) : (g17 = 1, w18 = u21[0] / c37.width);
  return { resolutionScale: g17, cropArea: { x: Math.round((c37.x + e24.left) * g17), y: Math.round((c37.y + e24.top) * g17), width: Math.round(c37.width * g17), height: Math.round(c37.height * g17) }, outputScale: w18, format: l25, quality: d18, children: n31, rotation: o27 };
}

// node_modules/@arcgis/core/views/support/WebGLRequirements.js
function i30(i34) {
  const s27 = l7(i34);
  if (!s27.available)
    return new s3("webgl:required", "WebGL is required but not supported.");
  if ("3d" === i34 && s27.majorPerformanceCaveat)
    return new s3("webgl:major-performance-caveat-detected", "Your WebGL implementation doesn't seem to support hardware accelerated rendering. Check your browser settings or if your GPU is in a blocklist.");
  if (!s27.supportsHighPrecisionFragment)
    return new s3("webgl:high-precision-fragment-required", "WebGL support for high precision fragment shaders is required but not supported.");
  if (!s27.supportsVertexShaderSamplers)
    return new s3("webgl:vertex-shader-samplers-required", "WebGL support for vertex shader samplers is required but not supported.");
  if (s27.type === r10.WEBGL1) {
    if (!s27.supportsElementIndexUint)
      return new s3("webgl:element-index-uint-required", "WebGL support for uint vertex indices is required but not supported.");
    if (!s27.supportsStandardDerivatives)
      return new s3("webgl:standard-derivatives-required", "WebGL support for standard derivatives is required but not supported.");
    if (!s27.supportsInstancedArrays)
      return new s3("webgl:instanced-arrays-required", "WebGL support for instanced rendering is required but not supported.");
  }
  return null;
}

// node_modules/@arcgis/core/views/ui/Component.js
function i31(t30) {
  return t30 && "nodeType" in t30;
}
function d14(t30) {
  return t30 && "function" == typeof t30.render;
}
var c32 = { component: "esri-component" };
var p25 = class extends v3 {
  constructor() {
    super(...arguments), this.widget = null;
  }
  destroy() {
    this.widget && this.widget.destroy(), this.node = null;
  }
  get id() {
    return this.get("widget.id") || this.get("node.id");
  }
  set node(t30) {
    const e24 = this._get("node");
    t30 !== e24 && (t30 && t30.classList.add(c32.component), e24 && e24.classList.remove(c32.component), this._set("node", t30));
  }
  castNode(t30) {
    return t30 ? "string" == typeof t30 || i31(t30) ? (this._set("widget", null), e3(t30)) : (d14(t30) && !t30.domNode && (t30.domNode = document.createElement("div")), this._set("widget", t30), t30.domNode) : (this._set("widget", null), null);
  }
};
e([y2({ dependsOn: [] })], p25.prototype, "id", null), e([y2()], p25.prototype, "node", null), e([s4("node")], p25.prototype, "castNode", null), e([y2({ readOnly: true })], p25.prototype, "widget", void 0), p25 = e([a3("esri.views.ui.Component")], p25);
var l23 = p25;

// node_modules/@arcgis/core/views/ui/UI.js
var u18 = { left: 0, top: 0, bottom: 0, right: 0 };
var f16 = { bottom: 30, top: 15, right: 15, left: 15 };
var _8 = "manual";
var g14 = "esri-ui";
var y14 = { ui: g14, corner: `${g14}-corner`, innerContainer: `${g14}-inner-container`, manualContainer: `${g14}-manual-container`, cornerContainer: `${g14}-corner-container`, topLeft: `${g14}-top-left`, topRight: `${g14}-top-right`, bottomLeft: `${g14}-bottom-left`, bottomRight: `${g14}-bottom-right` };
function C8(t30) {
  return t30 && !t30._started && "function" == typeof t30.postMixInProperties && "function" == typeof t30.buildRendering && "function" == typeof t30.postCreate && "function" == typeof t30.startup;
}
function v15(t30) {
  const o27 = t30, i34 = "object" == typeof o27 && null !== o27 && Object.getPrototypeOf(o27);
  return (null === i34 || i34 === Object.prototype) && ("component" in o27 || "index" in o27 || "position" in o27) ? t30 : null;
}
function L7(t30, { top: o27, bottom: i34, left: n31, right: e24 }) {
  t30.style.top = o27, t30.style.bottom = i34, t30.style.left = n31, t30.style.right = e24;
}
var b15 = class extends n4.EventedAccessor {
  constructor(t30) {
    super(t30), this._cornerNameToContainerLookup = {}, this._positionNameToContainerLookup = {}, this._components = new Array(), this._componentToKey = /* @__PURE__ */ new Map(), this._locale = l2(), this.view = null, this._applyViewPadding = () => {
      const t31 = this.container;
      t31 && L7(t31, this._toPxPosition(this._getViewPadding()));
    }, this._applyUIPadding = () => {
      const t31 = this._innerContainer;
      t31 && L7(t31, this._toPxPosition(this.padding));
    }, this._initContainers();
  }
  initialize() {
    this.addHandles([l3(() => {
      var _a;
      return [(_a = this.view) == null ? void 0 : _a.padding, this.container];
    }, this._applyViewPadding, h), l3(() => this.padding, this._applyUIPadding, h), l3(() => [this.container, this._locale], ([t30, o27]) => {
      t30 && t30.setAttribute("lang", o27);
    }, h), s5((t30) => {
      this._locale = t30;
    })]);
  }
  destroy() {
    this.container = null;
    for (const t30 of this._components)
      t30.destroy();
    this._components.length = 0, this._componentToKey.clear();
  }
  set container(t30) {
    const i34 = this._get("container");
    t30 !== i34 && (t30 && (t30.classList.add(y14.ui), n6(t30), this._attachContainers(t30)), i34 && (i34.classList.remove(y14.ui), L7(i34, { top: "", bottom: "", left: "", right: "" }), t7(i34)), this._set("container", t30));
  }
  get height() {
    const t30 = this.get("view.height") || 0;
    if (0 === t30)
      return t30;
    const o27 = this._getViewPadding(), i34 = o27.top + o27.bottom;
    return Math.max(t30 - i34, 0);
  }
  get padding() {
    return this._get("padding");
  }
  set padding(t30) {
    this._overrideIfSome("padding", t30);
  }
  castPadding(t30) {
    return "number" == typeof t30 ? { bottom: t30, top: t30, right: t30, left: t30 } : { ...f16, ...t30 };
  }
  get width() {
    const t30 = this.get("view.width") || 0;
    if (0 === t30)
      return t30;
    const o27 = this._getViewPadding(), i34 = o27.left + o27.right;
    return Math.max(t30 - i34, 0);
  }
  add(t30, o27) {
    let i34, n31;
    if (Array.isArray(t30))
      return void t30.forEach((t31) => this.add(t31, o27));
    const e24 = v15(t30);
    e24 && ({ index: i34, position: o27, component: t30, key: n31 } = e24), o27 && "object" == typeof o27 && ({ index: i34, key: n31, position: o27 } = o27), !t30 || o27 && !this._isValidPosition(o27) || this._add(t30, o27, i34, n31);
  }
  remove(t30, o27) {
    if (!t30)
      return;
    if (Array.isArray(t30))
      return t30.map((t31) => this.remove(t31, o27));
    const i34 = this._find(t30);
    if (i34) {
      const n31 = this._componentToKey;
      if (n31.has(t30) && n31.get(t30) !== o27)
        return;
      const e24 = this._components.indexOf(i34);
      return i34.node.parentNode && i34.node.parentNode.removeChild(i34.node), this._componentToKey.delete(t30), this._components.splice(e24, 1)[0];
    }
  }
  empty(t30) {
    if (Array.isArray(t30))
      return t30.map((t31) => this.empty(t31)).reduce((t31, o27) => t31.concat(o27));
    if ((t30 = t30 || _8) === _8) {
      return Array.prototype.slice.call(this._manualContainer.children).filter((t31) => !t31.classList.contains(y14.corner)).map((t31) => this.remove(t31));
    }
    return this._isValidPosition(t30) ? Array.prototype.slice.call(this._cornerNameToContainerLookup[t30].children).map(this.remove, this) : null;
  }
  move(t30, o27) {
    if (Array.isArray(t30) && t30.forEach((t31) => this.move(t31, o27)), !t30)
      return;
    let i34;
    const n31 = v15(t30) || v15(o27);
    if (n31 && (i34 = n31.index, o27 = n31.position, t30 = n31.component || t30), o27 && !this._isValidPosition(o27))
      return;
    const e24 = this.remove(t30);
    e24 && this.add(e24, { position: o27, index: i34 });
  }
  find(t30) {
    if (!t30)
      return null;
    const o27 = this._findById(t30);
    return o27 && (o27.widget || o27.node);
  }
  getPosition(t30) {
    for (const o27 in this._positionNameToContainerLookup) {
      if (this._positionNameToContainerLookup[o27].contains(t30))
        return o27;
    }
    return null;
  }
  _add(t30, o27, i34, n31) {
    t30 instanceof l23 || (t30 = new l23({ node: t30 })), this._place({ component: t30, position: o27, index: i34 }), this._components.push(t30), n31 && this._componentToKey.set(t30, n31);
  }
  _find(t30) {
    return t30 ? t30 instanceof l23 ? this._findByComponent(t30) : "string" == typeof t30 ? this._findById(t30) : this._findByNode(t30.domNode || t30) : null;
  }
  _getViewPadding() {
    return this.get("view.padding") || u18;
  }
  _attachContainers(t30) {
    t30.appendChild(this._innerContainer), t30.appendChild(this._manualContainer);
  }
  _initContainers() {
    const t30 = document.createElement("div");
    t30.classList.add(y14.innerContainer), t30.classList.add(y14.cornerContainer);
    const o27 = document.createElement("div");
    o27.classList.add(y14.innerContainer), o27.classList.add(y14.manualContainer);
    const i34 = document.createElement("div");
    i34.classList.add(y14.topLeft), i34.classList.add(y14.corner), t30.appendChild(i34);
    const n31 = document.createElement("div");
    n31.classList.add(y14.topRight), n31.classList.add(y14.corner), t30.appendChild(n31);
    const e24 = document.createElement("div");
    e24.classList.add(y14.bottomLeft), e24.classList.add(y14.corner), t30.appendChild(e24);
    const r24 = document.createElement("div");
    r24.classList.add(y14.bottomRight), r24.classList.add(y14.corner), t30.appendChild(r24), this._innerContainer = t30, this._manualContainer = o27;
    const s27 = f4();
    this._cornerNameToContainerLookup = { "top-left": i34, "top-right": n31, "bottom-left": e24, "bottom-right": r24, "top-leading": s27 ? n31 : i34, "top-trailing": s27 ? i34 : n31, "bottom-leading": s27 ? r24 : e24, "bottom-trailing": s27 ? e24 : r24 }, this._positionNameToContainerLookup = { manual: o27, ...this._cornerNameToContainerLookup };
  }
  _isValidPosition(t30) {
    return !!this._positionNameToContainerLookup[t30];
  }
  _place(t30) {
    const o27 = t30.component, n31 = t30.position || _8, e24 = t30.index, r24 = this._positionNameToContainerLookup[n31], s27 = null != e24 && e24 > -1;
    if (C8(o27.widget) && o27.widget.startup(), !s27)
      return void r24.appendChild(o27.node);
    const a34 = Array.prototype.slice.call(r24.children);
    if (0 === e24)
      return void (r24.firstChild ? o4(o27.node, r24.firstChild) : r24.appendChild(o27.node));
    e24 >= a34.length ? r24.appendChild(o27.node) : o4(o27.node, a34[e24]);
  }
  _toPxPosition(t30) {
    return { top: this._toPxUnit(t30.top), left: this._toPxUnit(t30.left), right: this._toPxUnit(t30.right), bottom: this._toPxUnit(t30.bottom) };
  }
  _toPxUnit(t30) {
    return 0 === t30 ? "0" : t30 + "px";
  }
  _findByComponent(t30) {
    let o27, i34 = null;
    return this._components.some((n31) => (o27 = n31 === t30, o27 && (i34 = n31), o27)), i34;
  }
  _findById(t30) {
    let o27, i34 = null;
    return this._components.some((n31) => (o27 = n31.id === t30, o27 && (i34 = n31), o27)), i34;
  }
  _findByNode(t30) {
    let o27, i34 = null;
    return this._components.some((n31) => (o27 = n31.node === t30, o27 && (i34 = n31), o27)), i34;
  }
};
e([y2()], b15.prototype, "_locale", void 0), e([y2()], b15.prototype, "container", null), e([y2()], b15.prototype, "height", null), e([y2({ value: f16 })], b15.prototype, "padding", null), e([s4("padding")], b15.prototype, "castPadding", null), e([y2()], b15.prototype, "view", void 0), e([y2()], b15.prototype, "width", null), b15 = e([a3("esri.views.ui.UI")], b15);
var P3 = b15;

// node_modules/@arcgis/core/widgets/Attribution/AttributionViewModel.js
function d15(t30, e24) {
  return t30 && "copyright" in t30 && (!e24 || "function" == typeof t30.originOf && "user" === t30.originOf("copyright"));
}
function m23(t30, e24) {
  return t30.length !== e24.length || t30.some((t31, i34) => t31.text !== e24[i34].text);
}
function f17(t30, e24, i34) {
  if (!i34 || !e24)
    return;
  t30.find((t31) => t31.layerView === e24 && t31.text === i34) || t30.push({ text: i34, layerView: e24 });
}
function y15(t30) {
  return "bing-maps" === t30.type;
}
var b16 = [];
var g15 = class extends d {
  constructor(t30) {
    super(t30), this._clear = () => {
      this._fetchedAttributionData.clear(), this._pendingAttributions.clear(), this.handles.remove("suspension"), this.notifyChange("state");
    }, this._pendingAttributions = /* @__PURE__ */ new Set(), this._fetchedAttributionData = /* @__PURE__ */ new Map(), this.items = new j2(), this.view = null, this._allLayerViewsChange = (t31) => {
      this.handles.remove("suspension");
      const e24 = this.get("view.allLayerViews");
      e24 && this.handles.add(e24.map((t32) => l3(() => {
        var _a;
        return [t32.suspended, (_a = t32.layer) == null ? void 0 : _a.attributionVisible];
      }, () => this._updateAttributionItems())), "suspension"), t31 && t31.removed && t31.removed.forEach((t32) => {
        this._pendingAttributions.delete(t32), this._fetchedAttributionData.delete(t32);
      }), this._updateAttributionItems();
    }, this.handles.add([a6(() => {
      var _a;
      return (_a = this.view) == null ? void 0 : _a.allLayerViews;
    }, "change", (t31) => this._allLayerViewsChange(t31), { onListenerAdd: () => this._allLayerViewsChange(), onListenerRemove: this._clear }), f3(() => {
      var _a;
      return true === ((_a = this.view) == null ? void 0 : _a.stationary);
    }, () => this._updateAttributionItems())]);
  }
  destroy() {
    this.view = null, this._fetchedAttributionData.clear(), this._pendingAttributions.clear(), this.items.removeAll();
  }
  get state() {
    return this.get("view.ready") ? this._pendingAttributions.size > 0 ? "loading" : "ready" : "disabled";
  }
  _updateAttributionItems() {
    const t30 = this.view, e24 = t30 == null ? void 0 : t30.allLayerViews;
    b16.length = 0, t30 && e24 ? (e24.forEach((e25) => {
      var _a;
      if (e25.suspended || !((_a = e25.layer) == null ? void 0 : _a.attributionVisible))
        return;
      const i34 = e25.layer;
      if (d15(i34, "user"))
        return void f17(b16, e25, i34.copyright);
      if (i34.hasAttributionData) {
        if (this._fetchedAttributionData.has(e25)) {
          const r25 = this._fetchedAttributionData.get(e25);
          return void (r25 ? f17(b16, e25, this._getDynamicAttribution(r25, t30, i34)) : d15(i34) && f17(b16, e25, i34.copyright));
        }
        return void this._fetchAttributionData(e25);
      }
      const r24 = i34.get("portalItem.accessInformation");
      f17(b16, e25, r24 || i34.copyright);
    }), m23(this.items, b16) && (this.items.removeAll(), this.items.addMany(b16)), b16.length = 0, this.notifyChange("state")) : this._clear();
  }
  async _fetchAttributionData(t30) {
    if (this._pendingAttributions.has(t30))
      return;
    this._pendingAttributions.add(t30);
    const i34 = await b3(t30.layer.fetchAttributionData());
    if (this._pendingAttributions.has(t30)) {
      const e24 = i34.ok ? this._createContributionIndex(i34.value, y15(t30.layer)) : null;
      this._pendingAttributions.delete(t30), this._fetchedAttributionData.set(t30, e24);
    }
    this._updateAttributionItems();
  }
  _createContributionIndex(t30, e24) {
    const i34 = t30.contributors, r24 = {};
    if (!i34)
      return r24;
    for (let o27 = 0; o27 < i34.length; o27++) {
      const t31 = i34[o27], s27 = t31.coverageAreas;
      if (!s27)
        return;
      for (const i35 of s27) {
        const s28 = i35.bbox, n31 = i35.zoomMin - (e24 && i35.zoomMin ? 1 : 0), a34 = i35.zoomMax - (e24 && i35.zoomMax ? 1 : 0), c37 = { xmin: s28[1], ymin: s28[0], xmax: s28[3], ymax: s28[2], spatialReference: f2.WGS84 }, u21 = { extent: R(c37), attribution: t31.attribution || "", score: null != i35.score ? i35.score : 100, id: o27 };
        for (let t32 = n31; t32 <= a34; t32++)
          r24[t32] = r24[t32] || [], r24[t32].push(u21);
      }
    }
    return r24.maxKey = Math.max.apply(null, Object.keys(r24)), r24;
  }
  _getDynamicAttribution(t30, e24, i34) {
    var _a;
    const { extent: r24, scale: o27 } = e24;
    let s27 = ((_a = i34.tileInfo) == null ? void 0 : _a.scaleToZoom(o27)) ?? 0;
    if (s27 = Math.min(t30.maxKey ?? 0, Math.round(s27)), !r24 || null == s27 || s27 <= -1)
      return "";
    const n31 = t30[s27], a34 = M(r24.center.clone().normalize(), e24.spatialReference), c37 = {};
    return n31 ? n31.filter((t31) => {
      const e25 = t31.id, i35 = !c37[e25] && a34 && t31.extent && r3(t31.extent, a34);
      return i35 && (c37[e25] = true), i35;
    }).sort((t31, e25) => e25.score - t31.score || t31.objectId - e25.objectId).map((t31) => t31.attribution).join(", ") : "";
  }
};
e([y2({ readOnly: true, type: j2 })], g15.prototype, "items", void 0), e([y2({ readOnly: true })], g15.prototype, "state", null), e([y2()], g15.prototype, "view", void 0), g15 = e([a3("esri.widgets.Attribution.AttributionViewModel")], g15);
var _9 = g15;

// node_modules/@arcgis/core/widgets/Attribution.js
var l24 = "esri-attribution";
var p26 = { base: `${l24} esri-widget`, poweredBy: `${l24}__powered-by`, sources: `${l24}__sources`, open: `${l24}--open`, sourcesOpen: `${l24}__sources--open`, link: `${l24}__link`, widgetIcon: "esri-icon-description", interactive: "esri-interactive" };
var a29 = class extends W {
  constructor(e24, t30) {
    super(e24, t30), this._isOpen = false, this._attributionTextOverflowed = false, this._prevSourceNodeHeight = 0, this._resizeObserver = new ResizeObserver((e25) => e25.forEach(({ target: e26 }) => this._checkSourceTextOverflow(e26))), this.iconClass = p26.widgetIcon, this.itemDelimiter = " | ", this.messages = null, this.viewModel = new _9();
  }
  initialize() {
    this.addHandles(a6(() => {
      var _a;
      return (_a = this.viewModel) == null ? void 0 : _a.items;
    }, "change", () => this.scheduleRender()));
  }
  destroy() {
    var _a;
    (_a = this._resizeObserver) == null ? void 0 : _a.disconnect();
  }
  get _isInteractive() {
    return this._isOpen || this._attributionTextOverflowed;
  }
  get attributionText() {
    return this.viewModel.items.reduce((e24, t30) => (e24.includes(t30.text) || e24.push(t30.text), e24), []).join(this.itemDelimiter);
  }
  get label() {
    var _a;
    return ((_a = this.messages) == null ? void 0 : _a.widgetLabel) ?? "";
  }
  set label(e24) {
    this._overrideIfSome("label", e24);
  }
  get view() {
    return this.viewModel.view;
  }
  set view(e24) {
    this.viewModel.view = e24;
  }
  render() {
    const e24 = { [p26.open]: this._isOpen };
    return n5("div", { bind: this, class: this.classes(p26.base, e24), dir: "ltr", onclick: this._toggleState, onkeydown: this._toggleState }, this.renderSourcesNode(), this.renderPoweredBy());
  }
  renderPoweredBy() {
    return n5("div", { class: p26.poweredBy }, "Powered by", " ", n5("a", { class: p26.link, href: "http://www.esri.com/", target: "_blank", rel: "noreferrer" }, "Esri"));
  }
  renderSourcesNode() {
    const e24 = this._isOpen, t30 = this._isInteractive, i34 = t30 ? "0" : "", { attributionText: r24 } = this, s27 = { [p26.sourcesOpen]: e24, [p26.interactive]: t30 };
    return n5("div", { afterCreate: this._afterSourcesNodeCreate, bind: this, class: this.classes(p26.sources, s27), innerHTML: r24, tabindex: i34 });
  }
  _afterSourcesNodeCreate(e24) {
    this._prevSourceNodeHeight = e24.clientWidth, this._resizeObserver.observe(e24);
  }
  _checkSourceTextOverflow(e24) {
    let t30 = false;
    const { clientHeight: i34, clientWidth: r24, scrollWidth: s27 } = e24, o27 = s27 > r24, n31 = this._attributionTextOverflowed !== o27;
    if (this._attributionTextOverflowed = o27, n31 && (t30 = true), this._isOpen) {
      const e25 = i34 < this._prevSourceNodeHeight;
      this._prevSourceNodeHeight = i34, e25 && (this._isOpen = false, t30 = true);
    }
    t30 && this.scheduleRender();
  }
  _toggleState() {
    this._isInteractive && (this._isOpen = !this._isOpen);
  }
};
e([y2()], a29.prototype, "_isOpen", void 0), e([y2()], a29.prototype, "_isInteractive", null), e([y2()], a29.prototype, "_attributionTextOverflowed", void 0), e([y2()], a29.prototype, "_prevSourceNodeHeight", void 0), e([y2({ readOnly: true, dependsOn: ["viewModel.items.length", "itemDelimiter"] })], a29.prototype, "attributionText", null), e([y2()], a29.prototype, "iconClass", void 0), e([y2()], a29.prototype, "itemDelimiter", void 0), e([y2()], a29.prototype, "label", null), e([y2(), e4("esri/widgets/Attribution/t9n/Attribution")], a29.prototype, "messages", void 0), e([y2()], a29.prototype, "view", null), e([y2({ type: _9 })], a29.prototype, "viewModel", void 0), e([t8()], a29.prototype, "_toggleState", null), a29 = e([a3("esri.widgets.Attribution")], a29);
var h17 = a29;

// node_modules/@arcgis/core/widgets/Compass/CompassViewModel.js
var h18 = "esri.widgets.CompassViewModel";
var d16 = class extends t17(v3) {
  constructor(t30) {
    super(t30), this._handles = new t3(), this.orientation = { x: 0, y: 0, z: 0 }, this.view = null, this._updateForCamera = this._updateForCamera.bind(this), this._updateForRotation = this._updateForRotation.bind(this), this._updateRotationWatcher = this._updateRotationWatcher.bind(this);
  }
  initialize() {
    this._handles.add(l3(() => this.view, this._updateRotationWatcher, h));
  }
  destroy() {
    p(this._handles), this.view = null;
  }
  get canShowNorth() {
    const t30 = this.get("view.spatialReference");
    return !(!t30 || !t30.isWebMercator && !t30.isGeographic);
  }
  get state() {
    return this.get("view.ready") ? this.canShowNorth ? "compass" : "rotation" : "disabled";
  }
  reset() {
    var _a;
    if (!this.get("view.ready"))
      return;
    const t30 = {};
    "2d" === ((_a = this.view) == null ? void 0 : _a.type) ? t30.rotation = 0 : t30.heading = 0, this.callGoTo({ target: t30 });
  }
  _updateForRotation(t30) {
    null != t30 && (this.orientation = { z: t30 });
  }
  _updateForCamera(t30) {
    if (!t30)
      return;
    const o27 = -t30.heading;
    this.orientation = { x: 0, y: 0, z: o27 };
  }
  _updateRotationWatcher(t30) {
    this._handles.removeAll(), t30 && this._handles.add("2d" === t30.type ? l3(() => t30 == null ? void 0 : t30.rotation, this._updateForRotation, h) : l3(() => t30 == null ? void 0 : t30.camera, this._updateForCamera, h));
  }
};
e([y2({ readOnly: true })], d16.prototype, "canShowNorth", null), e([y2()], d16.prototype, "orientation", void 0), e([y2({ readOnly: true })], d16.prototype, "state", null), e([y2()], d16.prototype, "view", void 0), d16 = e([a3(h18)], d16);
var c33 = d16;

// node_modules/@arcgis/core/widgets/Compass/css.js
var i32 = { base: "esri-compass esri-widget--button esri-widget", text: "esri-icon-font-fallback-text", icon: "esri-compass__icon", rotationIcon: "esri-icon-dial", northIcon: "esri-icon-compass", widgetIcon: "esri-icon-locate-circled", interactive: "esri-interactive", disabled: "esri-disabled" };

// node_modules/@arcgis/core/widgets/Compass.js
var n29 = class extends W {
  constructor(e24, s27) {
    super(e24, s27), this.iconClass = i32.widgetIcon, this.messages = null, this.viewModel = new c33();
  }
  get goToOverride() {
    return this.viewModel.goToOverride;
  }
  set goToOverride(e24) {
    this.viewModel.goToOverride = e24;
  }
  get label() {
    var _a;
    return ((_a = this.messages) == null ? void 0 : _a.widgetLabel) ?? "";
  }
  set label(e24) {
    this._overrideIfSome("label", e24);
  }
  get view() {
    return this.viewModel.view;
  }
  set view(e24) {
    this.viewModel.view = e24;
  }
  reset() {
    return this.viewModel.reset();
  }
  render() {
    const { orientation: e24, state: s27 } = this.viewModel, t30 = "disabled" === s27, o27 = "compass" === ("rotation" === s27 ? "rotation" : "compass"), r24 = t30 ? -1 : 0, a34 = { [i32.disabled]: t30, [i32.interactive]: !t30 }, p30 = { [i32.northIcon]: o27, [i32.rotationIcon]: !o27 }, { messages: n31 } = this;
    return n5("div", { bind: this, class: this.classes(i32.base, a34), onclick: this._reset, onkeydown: this._reset, role: "button", tabIndex: r24, "aria-label": n31.reset, title: n31.reset }, n5("span", { "aria-hidden": "true", class: this.classes(i32.icon, p30), styles: this._toRotationTransform(e24) }), n5("span", { class: i32.text }, n31.reset));
  }
  _reset() {
    this.viewModel.reset();
  }
  _toRotationTransform(e24) {
    return { transform: `rotateZ(${e24.z}deg)` };
  }
};
e([y2()], n29.prototype, "goToOverride", null), e([y2()], n29.prototype, "iconClass", void 0), e([y2()], n29.prototype, "label", null), e([y2(), e4("esri/widgets/Compass/t9n/Compass")], n29.prototype, "messages", void 0), e([y2()], n29.prototype, "view", null), e([y2({ type: c33 })], n29.prototype, "viewModel", void 0), e([t8()], n29.prototype, "_reset", null), n29 = e([a3("esri.widgets.Compass")], n29);
var d17 = n29;

// node_modules/@arcgis/core/widgets/NavigationToggle/css.js
var t28 = "esri-navigation-toggle";
var o26 = { base: `${t28} esri-widget`, button: `${t28}__button esri-widget--button`, activeButton: `${t28}__button--active`, panButton: `${t28}__button--pan`, rotateButton: `${t28}__button--rotate`, isLayoutHorizontal: `${t28}--horizontal`, rotationIcon: "esri-icon-rotate", panIcon: "esri-icon-pan", widgetIcon: "esri-icon-pan2", disabled: "esri-disabled" };

// node_modules/@arcgis/core/widgets/NavigationToggle/NavigationToggleViewModel.js
var r23 = class extends v3 {
  constructor(t30) {
    super(t30), this.navigationMode = "pan", this.view = null;
  }
  initialize() {
    this.own(f3(() => {
      var _a;
      return (_a = this.view) == null ? void 0 : _a.inputManager;
    }, () => this._setNavigationMode()));
  }
  destroy() {
    this.view = null;
  }
  get state() {
    var _a;
    return this.get("view.ready") && "3d" === ((_a = this.view) == null ? void 0 : _a.type) ? "ready" : "disabled";
  }
  toggle() {
    "disabled" !== this.state && (this.navigationMode = "pan" !== this.navigationMode ? "pan" : "rotate", this._setNavigationMode());
  }
  _setNavigationMode() {
    this.get("view.inputManager").primaryDragAction = "pan" === this.navigationMode ? "pan" : "rotate";
  }
};
e([y2({ readOnly: true })], r23.prototype, "state", null), e([y2()], r23.prototype, "navigationMode", void 0), e([y2()], r23.prototype, "view", void 0), r23 = e([a3("esri.widgets.NavigationToggleViewModel")], r23);
var a30 = r23;

// node_modules/@arcgis/core/widgets/NavigationToggle.js
var p27 = class extends W {
  constructor(t30, e24) {
    super(t30, e24), this.iconClass = o26.widgetIcon, this.messages = null, this.viewModel = new a30();
  }
  get label() {
    var _a;
    return ((_a = this.messages) == null ? void 0 : _a.widgetLabel) ?? "";
  }
  set label(t30) {
    this._overrideIfSome("label", t30);
  }
  set layout(t30) {
    "horizontal" !== t30 && (t30 = "vertical"), this._set("layout", t30);
  }
  get view() {
    return this.viewModel.view;
  }
  set view(t30) {
    this.viewModel.view = t30;
  }
  toggle() {
    return this.viewModel.toggle();
  }
  render() {
    const t30 = "disabled" === this.get("viewModel.state"), e24 = "pan" === this.get("viewModel.navigationMode"), o27 = { [o26.disabled]: t30, [o26.isLayoutHorizontal]: "horizontal" === this.layout }, s27 = { [o26.activeButton]: e24 }, r24 = { [o26.activeButton]: !e24 }, a34 = t30 ? -1 : 0, l25 = this.messages.toggle;
    return n5("div", { bind: this, class: this.classes(o26.base, o27), onclick: this._toggle, onkeydown: this._toggle, tabIndex: a34, "aria-label": l25, title: l25 }, n5("div", { class: this.classes(o26.button, o26.panButton, s27) }, n5("span", { class: o26.panIcon })), n5("div", { class: this.classes(o26.button, o26.rotateButton, r24) }, n5("span", { class: o26.rotationIcon })));
  }
  _toggle() {
    this.toggle();
  }
};
e([y2()], p27.prototype, "iconClass", void 0), e([y2()], p27.prototype, "label", null), e([y2({ value: "vertical" })], p27.prototype, "layout", null), e([y2(), e4("esri/widgets/NavigationToggle/t9n/NavigationToggle")], p27.prototype, "messages", void 0), e([y2()], p27.prototype, "view", null), e([y2({ type: a30 })], p27.prototype, "viewModel", void 0), e([t8()], p27.prototype, "_toggle", null), p27 = e([a3("esri.widgets.NavigationToggle")], p27);
var g16 = p27;

// node_modules/@arcgis/core/widgets/Zoom/IconButton.js
var c34 = { button: "esri-widget--button esri-widget", disabled: "esri-disabled", interactive: "esri-interactive", iconText: "esri-icon-font-fallback-text", icon: "esri-icon" };
var n30 = class extends W {
  constructor() {
    super(...arguments), this.enabled = true, this.iconClass = "", this.title = "";
  }
  render() {
    const t30 = this.enabled ? 0 : -1, s27 = { [c34.disabled]: !this.enabled, [c34.interactive]: this.enabled }, i34 = { [this.iconClass]: !!this.iconClass };
    return n5("div", { bind: this, class: this.classes(c34.button, s27), onclick: this._triggerAction, onkeydown: this._triggerAction, role: "button", tabIndex: t30, title: this.title }, n5("span", { "aria-hidden": "true", role: "presentation", class: this.classes(c34.icon, i34) }), n5("span", { class: c34.iconText }, this.title));
  }
  _triggerAction() {
    this.action.call(this);
  }
};
e([y2()], n30.prototype, "action", void 0), e([y2()], n30.prototype, "enabled", void 0), e([y2()], n30.prototype, "iconClass", void 0), e([y2()], n30.prototype, "title", void 0), e([t8()], n30.prototype, "_triggerAction", null), n30 = e([a3("esri.widgets.IconButton")], n30);
var a31 = n30;

// node_modules/@arcgis/core/widgets/Zoom/ZoomConditions2D.js
var s26 = class extends v3 {
  get canZoomIn() {
    if (!this.get("view.ready"))
      return false;
    const e24 = this.get("view.animation.target.scale") || this.get("view.scale"), t30 = this.get("view.constraints.effectiveMaxScale");
    return 0 === t30 || e24 > t30;
  }
  get canZoomOut() {
    if (!this.get("view.ready"))
      return false;
    const e24 = this.get("view.animation.target.scale") || this.get("view.scale"), t30 = this.get("view.constraints.effectiveMinScale");
    return 0 === t30 || e24 < t30;
  }
};
e([y2({ readOnly: true })], s26.prototype, "canZoomIn", null), e([y2({ readOnly: true })], s26.prototype, "canZoomOut", null), e([y2()], s26.prototype, "view", void 0), s26 = e([a3("esri.widgets.Zoom.ZoomConditions2D")], s26);
var i33 = s26;

// node_modules/@arcgis/core/widgets/Zoom/ZoomConditions3D.js
var t29 = class extends v3 {
  get canZoomIn() {
    return !!this.view.ready;
  }
  get canZoomOut() {
    return !!this.view.ready;
  }
};
e([y2({ readOnly: true })], t29.prototype, "canZoomIn", null), e([y2({ readOnly: true })], t29.prototype, "canZoomOut", null), e([y2()], t29.prototype, "view", void 0), t29 = e([a3("esri.widgets.Zoom.ZoomConditions3D")], t29);
var c35 = t29;

// node_modules/@arcgis/core/widgets/Zoom/ZoomViewModel.js
var p28 = class extends v3 {
  constructor(o27) {
    super(o27);
  }
  destroy() {
    this.view = null;
  }
  get canZoomIn() {
    return r(this._zoomConditions) && this._zoomConditions.canZoomIn;
  }
  get canZoomOut() {
    var _a;
    return r(this._zoomConditions) && ((_a = this._zoomConditions) == null ? void 0 : _a.canZoomOut);
  }
  get state() {
    var _a;
    return ((_a = this.view) == null ? void 0 : _a.ready) ? "ready" : "disabled";
  }
  set view(o27) {
    o27 ? "2d" === o27.type ? this._zoomConditions = new i33({ view: o27 }) : "3d" === o27.type && (this._zoomConditions = new c35({ view: o27 })) : this._zoomConditions = null, this._set("view", o27);
  }
  zoomIn() {
    if (!this.canZoomIn)
      return;
    const o27 = this.view;
    "2d" === o27.type ? o27.mapViewNavigation.zoomIn() : g(o27.goTo({ zoomFactor: 2 }));
  }
  zoomOut() {
    if (!this.canZoomOut)
      return;
    const o27 = this.view;
    "2d" === o27.type ? o27.mapViewNavigation.zoomOut() : g(o27.goTo({ zoomFactor: 0.5 }));
  }
};
e([y2()], p28.prototype, "_zoomConditions", void 0), e([y2()], p28.prototype, "canZoomIn", null), e([y2()], p28.prototype, "canZoomOut", null), e([y2({ readOnly: true })], p28.prototype, "state", null), e([y2()], p28.prototype, "view", null), p28 = e([a3("esri.widgets.Zoom.ZoomViewModel")], p28);
var a32 = p28;

// node_modules/@arcgis/core/widgets/Zoom.js
var u19 = { base: "esri-zoom esri-widget", horizontalLayout: "esri-zoom--horizontal", zoomInIcon: "esri-icon-plus", zoomOutIcon: "esri-icon-minus", widgetIcon: "esri-icon-zoom-in-magnifying-glass" };
var a33 = class extends W {
  constructor(o27, t30) {
    super(o27, t30), this.iconClass = u19.widgetIcon, this.messages = null, this.viewModel = new a32();
  }
  initialize() {
    this._zoomInButton = new a31({ action: this.zoomIn.bind(this), iconClass: u19.zoomInIcon }), this._zoomOutButton = new a31({ action: this.zoomOut.bind(this), iconClass: u19.zoomOutIcon });
  }
  destroy() {
    this._zoomInButton = a(this._zoomInButton), this._zoomOutButton = a(this._zoomOutButton);
  }
  get label() {
    var _a;
    return ((_a = this.messages) == null ? void 0 : _a.widgetLabel) ?? "";
  }
  set label(o27) {
    this._overrideIfSome("label", o27);
  }
  set layout(o27) {
    "horizontal" !== o27 && (o27 = "vertical"), this._set("layout", o27);
  }
  set view(o27) {
    this.viewModel.view = o27;
  }
  get view() {
    return this.viewModel.view;
  }
  render() {
    const o27 = this.viewModel, t30 = { [u19.horizontalLayout]: "horizontal" === this.layout }, { canZoomIn: s27, canZoomOut: e24 } = o27;
    this._zoomInButton.enabled = s27, this._zoomOutButton.enabled = e24;
    const { zoomIn: i34, zoomOut: r24 } = this.messages;
    return this._zoomInButton.title = i34, this._zoomOutButton.title = r24, n5("div", { class: this.classes(u19.base, t30) }, this._zoomInButton.render(), this._zoomOutButton.render());
  }
  zoomIn() {
    return this.viewModel.zoomIn();
  }
  zoomOut() {
    return this.viewModel.zoomOut();
  }
};
e([y2()], a33.prototype, "iconClass", void 0), e([y2()], a33.prototype, "label", null), e([y2({ value: "vertical" })], a33.prototype, "layout", null), e([y2(), e4("esri/widgets/Zoom/t9n/Zoom")], a33.prototype, "messages", void 0), e([y2()], a33.prototype, "view", null), e([y2({ type: a32 })], a33.prototype, "viewModel", void 0), a33 = e([a3("esri.widgets.Zoom")], a33);
var c36 = a33;

// node_modules/@arcgis/core/views/ui/DefaultUI.js
function m24(t30) {
  return t30 && void 0 !== t30.view;
}
var h19 = class extends P3 {
  constructor(t30) {
    super(t30), this._defaultPositionLookup = { attribution: "manual", compass: "top-left", "navigation-toggle": "top-left", zoom: "top-left" }, this.components = [];
  }
  initialize() {
    this.addHandles([l3(() => this.components, this._componentsWatcher.bind(this), h), l3(() => this.view, this._updateViewAwareWidgets.bind(this), h)]);
  }
  _add(t30, o27, e24, i34) {
    let s27 = t30;
    if ("string" == typeof t30 && this._defaultPositionLookup[t30]) {
      if (this._find(t30))
        return;
      s27 = this._createComponent(t30);
    }
    super._add(s27, o27, e24, i34);
  }
  _removeComponents(t30) {
    t30.forEach((t31) => {
      const o27 = this._find(t31);
      o27 && (this.remove(o27), o27.destroy());
    });
  }
  _updateViewAwareWidgets(t30) {
    this.components.forEach((o27) => {
      const e24 = this._find(o27), i34 = e24 && e24.widget;
      m24(i34) && (i34.view = t30);
    });
  }
  _componentsWatcher(t30, o27) {
    this._removeComponents(o27), this._addComponents(t30), this._adjustPadding(t30);
  }
  _adjustPadding(t30) {
    if (!t30.includes("attribution") && !this._isOverridden("padding")) {
      const { top: t31 } = this.padding;
      this.padding = t31;
    }
  }
  _addComponents(t30) {
    this.constructed && t30.forEach((t31) => this.add(this._createComponent(t31), this._defaultPositionLookup[t31]));
  }
  _createComponent(t30) {
    const o27 = this._createWidget(t30);
    if (o27)
      return new l23({ id: t30, node: o27 });
  }
  _createWidget(t30) {
    return "attribution" === t30 ? this._createAttribution() : "compass" === t30 ? this._createCompass() : "navigation-toggle" === t30 ? this._createNavigationToggle() : "zoom" === t30 ? this._createZoom() : void 0;
  }
  _createAttribution() {
    return new h17({ view: this.view });
  }
  _createCompass() {
    return new d17({ view: this.view });
  }
  _createNavigationToggle() {
    return new g16({ view: this.view });
  }
  _createZoom() {
    return new c36({ view: this.view });
  }
};
e([y2()], h19.prototype, "components", void 0), h19 = e([a3("esri.views.ui.DefaultUI")], h19);
var u20 = h19;

// node_modules/@arcgis/core/views/ui/2d/DefaultUI2D.js
var e23 = class extends u20 {
  constructor(o27) {
    super(o27), this.components = ["attribution", "zoom"];
  }
};
e([y2()], e23.prototype, "components", void 0), e23 = e([a3("esri.views.ui.2d.DefaultUI2D")], e23);
var p29 = e23;

// node_modules/@arcgis/core/views/MapView.js
var pe2;
var he3;
var ce2;
var de2;
var ue2;
var ge2;
async function me2() {
  const [, { GraphicsView2D: e24, GraphicContainer: t30, LabelManager: i34, MapViewNavigation: s27, MagnifierView2D: r24, Stage: n31 }] = await Promise.all([import("./webglDeps-VLNTUIG6.js"), import("./mapViewDeps-SKVZRQBG.js")]);
  he3 = e24, ce2 = t30, de2 = i34, ue2 = s27, ge2 = r24, pe2 = n31;
}
var ye2 = 160;
function we(e24) {
  return e24 && "esri.Viewpoint" === e24.declaredClass;
}
var fe2 = class extends w7(z5(a16(A7))) {
  constructor(e24) {
    super(e24), this._magnifierView = null, this._stage = null, this._resolveWhenReady = [], this.rootLayerViews = new l4({ getCollections: () => {
      var _a, _b;
      return [(_a = this.basemapView) == null ? void 0 : _a.baseLayerViews, this.layerViews, (_b = this.basemapView) == null ? void 0 : _b.referenceLayerViews];
    }, getChildrenFunction: () => null }), this.featuresTilingScheme = null, this.fullOpacity = 1, this.graphicsView = null, this.labelManager = null, this.mapViewNavigation = null, this.renderingOptions = { samplingMode: "dynamic", edgeLabelsVisible: true, labelsAnimationTime: 125, labelCollisionsEnabled: true }, this.rendering = false, this.supersampleScreenshotsEnabled = true, this.supportsGround = false, this._stationaryTimer = null, this._gotoTask = null, this.frameTask = new s20(this), this._pePromise = null, this.floors = new j2(), this.highlightOptions = new c10(), this.inputManager = new C7({ view: this }), this.map = null, this.resizeAlign = "center", this.spatialReferenceLocked = false, this.timeline = new e11(), this.type = "2d", this.ui = new p29(), this._pixelFormat = { flipY: true, premultipliedAlpha: true }, this.constraints = new u15(), this.padding = { top: 0, right: 0, bottom: 0, left: 0 }, this.handles.add([l3(() => this.viewpoint, () => {
      this._lastStationaryEventTimestamp = performance.now(), this._flipStationary(ye2);
    }, U2), this.on("resize", (e25) => this._resizeHandler(e25)), l3(() => {
      var _a;
      return (_a = this.animationManager) == null ? void 0 : _a.animation;
    }, (e25) => {
      this.animation = e25;
    })]), c8();
  }
  destroy() {
    this._set("preconditionsReady", false), this._gotoTask = this.frameTask = null, this.rootLayerViews.destroy(), this.inputManager.destroy(), this._set("inputManager", null);
  }
  get graphicsTileStore() {
    return new d4(this.featuresTilingScheme);
  }
  get initialExtentRequired() {
    var _a;
    const { scale: e24, constraints: t30, center: i34, viewpoint: s27, extent: r24 } = this;
    let n31 = this.zoom;
    return !(this.map && "initialViewProperties" in this.map && ((_a = this.map.initialViewProperties) == null ? void 0 : _a.viewpoint)) && (!r24 && ((t30 == null ? void 0 : t30.effectiveLODs) || (n31 = -1), (!i34 || 0 === e24 && -1 === n31) && (!s27 || !r(s27.targetGeometry) || "extent" !== s27.targetGeometry.type && !s27.scale)));
  }
  get resourceManager() {
    return this._stage.resourceManager;
  }
  get textureManager() {
    return this._stage.painter.textureManager;
  }
  get _defaultsFromMapSettings() {
    return { required: { tileInfo: true, heightModelInfo: false, extent: false }, requiresExtentInSpatialReference: this.spatialReferenceLocked };
  }
  get _projectionEngineLoaded() {
    return !!en() || (this._pePromise || (this._pePromise = tn().finally(() => {
      this._pePromise = null;
    })), false);
  }
  get typeSpecificPreconditionsReady() {
    const e24 = this._getDefaultViewpoint();
    if (!e24)
      return false;
    const t30 = this.spatialReference, i34 = e2(e24.targetGeometry);
    return !!An(i34.spatialReference, t30) || this._projectionEngineLoaded;
  }
  set animation(e24) {
    const t30 = this._get("animation");
    if (e24 === t30)
      return;
    if (t30 && t30.stop(), !e24 || e24.isFulfilled())
      return void this._set("animation", null);
    this._set("animation", e24), this.frameTask.animationInProgress = true;
    const i34 = () => {
      var _a;
      e24 === this._get("animation") && (this._set("animation", null), (_a = this.frameTask) == null ? void 0 : _a.requestFrame()), this.frameTask && (this.frameTask.animationInProgress = false);
    };
    e24.when(i34, i34);
  }
  get background() {
    return Te(this.map) ? this.map.initialViewProperties.background : null;
  }
  set background(e24) {
    this._override("background", e24);
  }
  get center() {
    if (!this.ready)
      return this._get("center");
    const { center: e24, spatialReference: t30 } = this.state.paddedViewState;
    return new w2({ x: e24[0], y: e24[1], spatialReference: t30 });
  }
  set center(e24) {
    if (null == e24)
      return;
    if (!this.ready)
      return this._set("center", e24), void this.notifyChange("initialExtentRequired");
    let t30;
    try {
      t30 = this._project(e24, this.spatialReference);
    } catch (s27) {
      return void s2.getLogger(this.declaredClass).error(new s3("mapview:invalid-center", "could not project the value in the view's spatial reference", { input: e24, error: s27 }));
    }
    const i34 = this.viewpoint;
    xt(i34, i34, t30), this.viewpoint = i34;
  }
  set constraints(e24) {
    const t30 = this._get("constraints");
    t30 && (this.handles.remove("map-view-constraints"), t30.destroy()), this._set("constraints", e24), e24 && (e24.view = this, this.ready && (this.state.viewpoint = e24.fit(this.state.paddedViewState.viewpoint)), this.handles.add(l3(() => e24.version, () => {
      this.ready && this.state && (this.state.viewpoint = e24.fit(this.state.paddedViewState.viewpoint));
    }, U2), "map-view-constraints"));
  }
  get extent() {
    return this.ready ? this.state.paddedViewState.extent.clone() : this._get("extent");
  }
  set extent(e24) {
    if (null == e24)
      return;
    if (!e24.width || !e24.height)
      return void s2.getLogger(this.declaredClass).error(new s3("mapview:invalid-extent", "invalid extent size"));
    if (!this.ready)
      return this._set("extent", e24), this._set("center", null), this._set("viewpoint", null), this._set("scale", 0), this._set("zoom", -1), void this.notifyChange("initialExtentRequired");
    let t30;
    try {
      t30 = this._project(e24, this.spatialReference);
    } catch (s27) {
      return void s2.getLogger(this.declaredClass).error(new s3("mapview:invalid-extent", "could not project the value in the view's spatial reference", { error: s27 }));
    }
    const i34 = this.viewpoint;
    tt(i34, i34, t30, this.size, { constraints: this.constraints }), this.viewpoint = i34;
  }
  get padding() {
    return this.ready ? this.state.padding : this._get("padding");
  }
  set padding(e24) {
    this.ready ? (this.state.padding = e24, this._set("padding", this.state.padding)) : this._set("padding", e24);
  }
  get resolution() {
    return this.state ? this.state.resolution : 0;
  }
  get rotation() {
    return this.ready ? this.state.rotation : this._get("rotation");
  }
  set rotation(e24) {
    if (isNaN(e24))
      return;
    if (!this.ready)
      return void this._set("rotation", e24);
    const t30 = this.viewpoint;
    wt(t30, t30, e24), this.viewpoint = t30;
  }
  get scale() {
    return this.ready ? this.state.scale : this._get("scale");
  }
  set scale(e24) {
    if (!e24 || isNaN(e24))
      return;
    if (!this.ready) {
      this._set("scale", e24), this._set("zoom", -1);
      const t31 = this._get("extent");
      return t31 && (this._set("extent", null), this._set("center", t31.center)), void this.notifyChange("initialExtentRequired");
    }
    const t30 = this.viewpoint;
    jt(t30, t30, e24), this.viewpoint = t30;
  }
  get stationary() {
    return !(this.animation || this.navigating || this.resizing || this._stationaryTimer);
  }
  get updating() {
    var _a, _b, _c;
    const e24 = !this.destroyed && (!this.layerViewManager || !this.labelManager || !this.graphicsView || true === this.layerViewManager.updating || true === this.labelManager.updating || true === this.graphicsView.updating || this.allLayerViews.some((e25) => !e25.destroyed && !("layerViews" in e25) && true === e25.updating));
    if (has("esri-2d-log-updating")) {
      const t30 = this.allLayerViews.reduce((e25, t31) => ({ ...e25, [t31.layer.id]: !t31.destroyed && !("layerViews" in t31) && t31.updating }), {});
      console.log(`Updating MapView: ${e24}
-> Null LayerViewManager: ${!this.layerViewManager}
-> Null LabelManager: ${!this.labelManager}
-> Null GraphicsView: ${!this.graphicsView}
-> layerViewManager.updating: ${(_a = this.layerViewManager) == null ? void 0 : _a.updating}
-> labelManager.updating: ${(_b = this.labelManager) == null ? void 0 : _b.updating}
-> graphicsView.updating: ${(_c = this.graphicsView) == null ? void 0 : _c.updating}
-> allLayerViews: ${JSON.stringify(t30)}
`);
    }
    return e24;
  }
  get viewpoint() {
    if (!this.ready)
      return this._get("viewpoint");
    const e24 = this.state.paddedViewState;
    return e24 && e24.viewpoint.clone();
  }
  set viewpoint(e24) {
    if (null == e24)
      return;
    if (!this.ready)
      return this._set("viewpoint", e24), this._set("extent", null), this._set("center", null), this._set("zoom", -1), this._set("scale", 0), void this.notifyChange("initialExtentRequired");
    let t30, s27;
    try {
      t30 = this._project(e24, this.spatialReference), !e24.scale || isNaN(e24.scale) ? s27 = new s3("mapview:invalid-viewpoint", `invalid scale value of ${e24.scale}`) : t2(e24.targetGeometry) && (s27 = new s3("mapview:invalid-viewpoint", "geometry not defined"));
    } catch (a34) {
      s27 = new s3("mapview:invalid-viewpoint", "could not project the value in the view's spatial reference", { error: a34 });
    }
    if (s27)
      return void s2.getLogger(this.declaredClass).error(s27);
    this._scaleBeforeChangingSpatialReference = null;
    const r24 = new u3({ targetGeometry: new w2(), scale: 0, rotation: 0 });
    Z(r24, t30), this.constraints.constrain(r24, this.state.paddedViewState.viewpoint), this.state.viewpoint = r24, this.frameTask.requestFrame(), this._set("viewpoint", r24);
  }
  get zoom() {
    return this.ready ? this.constraints.scaleToZoom(this.scale) : this._get("zoom");
  }
  set zoom(e24) {
    if (null == e24)
      return;
    if (!this.ready) {
      this._set("zoom", e24), this._set("scale", 0);
      const t31 = this._get("extent");
      return t31 && (this._set("extent", null), this._set("center", t31.center)), void this.notifyChange("initialExtentRequired");
    }
    if (!this.constraints.effectiveLODs)
      return void this._set("zoom", -1);
    const t30 = this.viewpoint;
    jt(t30, t30, this.constraints.zoomToScale(e24)), this.viewpoint = t30, this._set("zoom", this.constraints.scaleToZoom(this.scale));
  }
  get navigating() {
    return !(!this.mapViewNavigation || !this.mapViewNavigation.interacting);
  }
  goTo(e24, t30) {
    if (e24)
      return this.animation && (this.animation = null), this._createAnimation(), j3(() => this.ready, t30).then(() => {
        var _a;
        const i34 = { animate: true, ...t30 }, s27 = Y(e24, this);
        return (_a = this.animation) == null ? void 0 : _a.update(s27), this._gotoTask = {}, i34.animate ? this._gotoAnimated(s27, i34) : this._gotoImmediate(s27, i34);
      });
    s2.getLogger(this.declaredClass).error("#goTo()", "target cannot be null or undefined");
  }
  async hitTest(e24, t30) {
    const i34 = o17(e24) ? r16(this, e24) : e24;
    if (!this.ready || isNaN(i34.x) || isNaN(i34.y))
      return { screenPoint: i34, results: [] };
    let s27 = /* @__PURE__ */ new Set(), r24 = false, n31 = null, a34 = null;
    (t30 == null ? void 0 : t30.include) ? Se(t30.include, Ve(this, (e25) => s27.add(e25), (e25) => {
      n31 || (n31 = /* @__PURE__ */ new Set()), n31.add(e25);
    }, (e25) => s27.add(e25), () => r24 = true)) : (r24 = true, s27 = new Set(this.allLayerViews)), (t30 == null ? void 0 : t30.exclude) && Se(t30.exclude, Ve(this, (e25) => s27.delete(e25), (e25) => {
      a34 || (a34 = /* @__PURE__ */ new Set()), a34.add(e25);
    }));
    const o27 = this.allLayerViews.filter((e25) => !e25.suspended && s27.has(e25)).reverse(), p30 = this.toMap(i34);
    let h20 = [...r24 ? this.graphicsView.hitTest(p30).map((e25) => ({ type: "graphic", graphic: e25, layer: null, mapPoint: p30 })) : [], ...await Promise.all(o27.map((e25) => e25.hitTest(p30, i34)).toArray())].filter(r).flat().filter(r);
    return n31 && (h20 = h20.filter((e25) => !("graphic" in e25) || !e25.graphic || (n31 == null ? void 0 : n31.has(ve(e25.graphic))))), a34 && (h20 = h20.filter((e25) => !("graphic" in e25) || !e25.graphic || (a34 == null ? void 0 : a34.has(ve(e25.graphic))))), { screenPoint: i34, results: h20 };
  }
  async takeScreenshot(e24) {
    const t30 = this._createScreenshotPlan(e24), i34 = await this._stage.takeScreenshot(t30);
    return r12(i34, { format: t30.format, quality: t30.quality, rotation: 0, disableDecorations: false }, this._pixelFormat);
  }
  async _takeScreenshot(e24) {
    const t30 = this._createScreenshotPlan(e24), i34 = await this._stage.takeScreenshot(t30);
    return l8(i34, this._pixelFormat);
  }
  _createScreenshotPlan(e24) {
    e24 = e24 ?? {};
    const t30 = this.supersampleScreenshotsEnabled ? Math.min(4, w6(this.size, Math.min(4096, this._stage.context.parameters.maxTextureSize))) : 1;
    let i34;
    e24.layers ? (i34 = [], e24.layers.forEach((e25) => {
      const t31 = this.allLayerViews.find((t32) => t32.layer.id === e25.id);
      t31 && "container" in t31 && t31.container && i34.push(t31.container);
    })) : i34 = this._stage.children;
    const { format: s27, quality: r24 } = s11(e24.format, e24.quality);
    return t27(e24, t30, this.size, this.padding, s27, r24, i34, e24.rotation);
  }
  get test() {
    return { takeScreenshot: (e24) => this._takeScreenshot(e24) };
  }
  toMap(e24) {
    if (!this.ready)
      return null;
    const t30 = o17(e24) ? r16(this, e24) : e24, i34 = [0, 0], [s27, r24] = this.state.toMap(i34, [t30.x, t30.y]), n31 = this.spatialReference;
    return new w2({ x: s27, y: r24, spatialReference: n31 });
  }
  toScreen(e24) {
    if (!this.ready)
      return null;
    const t30 = this._project(e24, this.spatialReference), i34 = [t30.x, t30.y];
    return this.state.toScreen(i34, i34), c2(i34[0], i34[1]);
  }
  on(e24, t30, i34, s27) {
    const r24 = this.inputManager && this.viewEvents.on(e24, t30, i34, s27);
    return r24 || super.on(e24, t30);
  }
  hasEventListener(e24) {
    return super.hasEventListener(e24) || this.viewEvents.hasHandler(e24);
  }
  whenLayerView(e24) {
    return super.whenLayerView(e24);
  }
  graphicChanged(e24) {
    if (this.graphicsView) {
      this.graphicsView.graphicUpdateHandler(e24);
    }
  }
  whenReady() {
    return new Promise((e24) => {
      this.ready ? e24(this) : this._resolveWhenReady.push(e24);
    });
  }
  forceDOMReadyCycle() {
    this.forceReadyCycle();
  }
  getDefaultSpatialReference() {
    var _a, _b, _c;
    return this.map && "initialViewProperties" in this.map && ((_b = (_a = this.map) == null ? void 0 : _a.initialViewProperties) == null ? void 0 : _b.spatialReference) || ((_c = this.defaultsFromMap) == null ? void 0 : _c.spatialReference) || null;
  }
  hasLayerViewModule(e24) {
    return n22.hasLayerViewModule(e24);
  }
  importLayerView(e24) {
    return n22.importLayerView(e24);
  }
  pixelSizeAt() {
    return this.ready ? this.state.resolution : (s2.getLogger(this.declaredClass).error("#pixelSizeAt()", "Map view cannot be used before it is ready"), null);
  }
  popupHitTest(e24) {
    return this.hitTest(e24).then((t30) => ({ ...t30, mapPoint: this.toMap(e24) }));
  }
  requestUpdate() {
    this.ready && this.frameTask.requestUpdate();
  }
  validate() {
    let e24 = i30(this.type);
    return has("safari") && has("safari") < 9 && (e24 = new s3("mapview:browser-not-supported", "This browser is not supported by MapView (Safari < 9)", { type: "safari", requiredVersion: 9, detectedVersion: has("safari") })), r(e24) ? (s2.getLogger(this.declaredClass).warn("#validate()", e24.message), Promise.reject(e24)) : me2();
  }
  _createAnimation() {
    return this.animation && !this.animation.done || (this.animation = new p21()), this.animation;
  }
  _cancellableGoTo(e24, t30, i34) {
    const s27 = () => e24 === this._gotoTask, r24 = i34.then(() => {
      s27() && (this.animation = null);
    }).catch((e25) => {
      throw s27() && (t30 && !t30.done && (t30.stop(), this.frameTask.animationInProgress = false), this.animation = null), e25;
    }), n31 = new Promise((e25) => e25(r24));
    return t30.when().catch(() => {
      s27() && n31.cancel && n31.cancel();
    }), n31;
  }
  _gotoImmediate(e24, t30) {
    const i34 = this._gotoTask, s27 = this.animation, r24 = e24.then((e25) => {
      if (f(t30), i34 !== this._gotoTask)
        throw new s3("view:goto-interrupted", "Goto was interrupted");
      this.viewpoint = s27.target = e25, s27.finish();
    });
    return this._cancellableGoTo(i34, s27, r24);
  }
  _flipStationary(e24) {
    return null !== this._stationaryTimer || (this._stationaryTimer = setTimeout(() => {
      this._stationaryTimer = null;
      const e25 = performance.now() - this._lastStationaryEventTimestamp;
      e25 < ye2 && (this._stationaryTimer = this._flipStationary(e25));
    }, e24)), this._stationaryTimer;
  }
  _getDefaultViewpoint() {
    var _a, _b, _c, _d;
    const { constraints: e24, initialExtent: t30, map: s27, padding: r24, size: n31 } = this;
    if (!e24)
      return null;
    const a34 = s27 && "initialViewProperties" in s27 ? s27.initialViewProperties : void 0, o27 = { zoom: this._get("zoom"), scale: this._get("scale"), center: this._get("center"), extent: this._get("extent"), rotation: this._get("rotation"), viewpoint: this._get("viewpoint"), spatialReference: this._userSpatialReference };
    e24.effectiveLODs ? -1 !== o27.zoom && (o27.scale = e24.zoomToScale(o27.zoom)) : o27.zoom = -1;
    let h20 = null, c37 = null, d18 = 0;
    const u21 = o27.viewpoint && o27.viewpoint.rotation, g17 = o27.viewpoint && o27.viewpoint.targetGeometry;
    r(g17) && ("extent" === g17.type ? h20 = g17 : "point" === g17.type && (c37 = g17, d18 = o27.viewpoint.scale));
    const m25 = o27.extent || h20 || ((_b = e2((_a = a34 == null ? void 0 : a34.viewpoint) == null ? void 0 : _a.targetGeometry)) == null ? void 0 : _b.extent) || t30, y16 = o27.center || c37 || (m25 == null ? void 0 : m25.center), w18 = o27.scale || d18 || ((_c = a34 == null ? void 0 : a34.viewpoint) == null ? void 0 : _c.scale) || m25 && H(m25, [n31[0] - r24.left - r24.right, n31[1] - r24.top - r24.bottom]), f18 = o27.rotation || u21 || ((_d = a34 == null ? void 0 : a34.viewpoint) == null ? void 0 : _d.rotation) || 0;
    return y16 && w18 ? new u3({ targetGeometry: y16, scale: w18, rotation: f18 }) : null;
  }
  _gotoAnimated(e24, t30) {
    const i34 = this._gotoTask, s27 = this.animation;
    if (!s27)
      return Promise.resolve();
    const r24 = e24.then((e25) => {
      if (f(t30), i34 !== this._gotoTask)
        throw new s3("view:goto-interrupted", "Goto was interrupted");
      return s27.update(e25), this.animationManager.animate(s27, this.viewpoint, t30), s27.when().then(() => {
      }, () => {
      });
    });
    return this._cancellableGoTo(i34, s27, r24);
  }
  _project(e24, t30) {
    var _a;
    const i34 = e24 && e24.targetGeometry || e24;
    if (!t30)
      return e24;
    if (!i34)
      return null;
    if (t30.imageCoordinateSystem || ((_a = i34.spatialReference) == null ? void 0 : _a.imageCoordinateSystem))
      return e24;
    if (E2(t30, i34.spatialReference))
      return e24;
    const s27 = rn(i34, t30);
    if (!s27)
      throw new s3("mapview:projection-not-possible", "projecting input geometry to target spatial reference returned a null value", { geometry: i34, spatialReference: t30 });
    return we(e24) ? (e24.targetGeometry = s27, e24) : s27;
  }
  _resizeHandler(e24) {
    if (!this.ready)
      return;
    const t30 = this.state;
    let i34 = this.state.paddedViewState.viewpoint;
    const s27 = this.state.paddedViewState.size.concat();
    t30.size = [e24.width, e24.height], ht(i34, i34, s27, this.state.paddedViewState.size, this.resizeAlign), i34 = this.constraints.constrain(i34, void 0), this.state.viewpoint = i34;
  }
  _startup() {
    var _a, _b;
    this.timeline.begin("MapView Startup");
    const e24 = this._getDefaultViewpoint(), t30 = e24.targetGeometry;
    try {
      this._project(e24, this.spatialReference);
    } catch (l25) {
      s2.getLogger(this.declaredClass).warn(new t6("mapview:startup-projection-error", "projection of initial viewpoint to the view's spatial reference, defaulting to the initial viewpoint.", { center: t30.toJSON(), spatialReference: this.spatialReference, error: l25 })), e24.targetGeometry = ((_a = this.defaultsFromMap.extent) == null ? void 0 : _a.center) || new w2({ x: 0, y: 0, spatialReference: this.spatialReference });
    }
    (_b = this.constraints) == null ? void 0 : _b.fit(e24), this._set("state", new f15({ padding: this._get("padding"), size: this.size, viewpoint: e24 })), this.graphics.owner = this;
    const i34 = new pe2(this.surface, { canvas: this.renderCanvas, supersampleScreenshots: this.supersampleScreenshotsEnabled, contextOptions: { disabledExtensions: this.deactivatedWebGLExtensions, debugWebGLExtensions: this.debugWebGLExtensions }, renderingOptions: this.renderingOptions, timeline: this.timeline });
    this._stage = i34, this._magnifierView = new ge2(), this._magnifierView.magnifier = this.magnifier;
    const s27 = new de2({ view: this });
    this._set("labelManager", s27);
    const r24 = new l17({ view: this });
    this._set("animationManager", r24);
    const n31 = new ue2({ view: this, animationManager: r24 });
    this._set("mapViewNavigation", n31), this._setupSpatialReferenceDependentProperties(), this.handles.add([this.rootLayerViews.on("change", () => this._updateStageChildren()), i34.on("post-render", () => this._set("rendering", i34.renderRequested)), i34.on("will-render", () => this._set("rendering", i34.renderRequested)), i34.on("webgl-error", (e25) => this.fatalError = e25.error), l3(() => this.stationary, (e25) => i34.stationary = e25, w4), l3(() => this.background, (e25) => {
      i34.background = e25, this._magnifierView.background = e25;
    }, w4), l3(() => this.magnifier, (e25) => this._magnifierView.magnifier = e25, w4), l3(() => this.renderingOptions, (e25) => i34.renderingOptions = e25, w4), l3(() => this.highlightOptions, (e25) => i34.highlightOptions = e25, w4), l3(() => this.state.id, () => i34.state = this.state, w4)], "map-view"), this._updateStageChildren();
    const a34 = this._resolveWhenReady;
    this._resolveWhenReady = [], a34.forEach((e25) => e25(this)), this.timeline.end("MapView Startup"), this.frameTask && this.frameTask.start(), this._set("ready", true);
  }
  _teardown() {
    this._destroySpatialReferenceDependentProperties(), this.handles.remove("map-view"), this.mapViewNavigation.destroy(), this._set("mapViewNavigation", null), this.animationManager.destroy(), this._set("animationManager", null), this.layerViewManager.clear(), this.labelManager.destroy(), this._magnifierView.destroy(), this._stage.destroy(), this._stage = null, this._set("graphicsView", null), this._magnifierView = null, this._set("labelManager", null), this._set("mapViewNavigation", null), this.graphics.owner = null, this.frameTask && this.frameTask.stop(), this._stationaryTimer && (clearTimeout(this._stationaryTimer), this._stationaryTimer = null), this._set("ready", false);
    const { center: [e24, t30], spatialReference: i34, rotation: s27, scale: r24 } = this.state.paddedViewState, n31 = new w2({ x: e24, y: t30, spatialReference: i34 });
    this._set("viewpoint", null), this._set("extent", null), this._set("center", n31), this._set("zoom", -1), this._set("rotation", s27), this._set("scale", r24), this._set("spatialReference", i34), this._set("state", null), this.animation = null;
  }
  _updateStageChildren() {
    this._stage.removeAllChildren(), this.rootLayerViews.forEach((e25) => {
      this._stage.addChild(e25.container);
    });
    const e24 = this.graphicsView;
    this._stage.addChild(e24.container), this._stage.addChild(this._magnifierView);
  }
  _setupSpatialReferenceDependentProperties() {
    const e24 = new h4(j5.create({ spatialReference: this.spatialReference, size: 512, numLODs: 36 }));
    this._set("featuresTilingScheme", e24);
    const t30 = new he3({ view: this, graphics: this.graphics, requestUpdateCallback: () => this.requestUpdate(), container: new ce2(e24) });
    this.frameTask.graphicsView = t30, this._set("graphicsView", t30);
  }
  _destroySpatialReferenceDependentProperties() {
    const e24 = this.graphicsView;
    this._set("graphicsView", null), this.frameTask.graphicsView = null, e24.destroy(), this._set("featuresTilingScheme", null);
  }
  _spatialReferenceChanged(e24) {
    if (!this.ready)
      return;
    this.frameTask.stop();
    for (const i34 of this.allLayerViews)
      i34.processDetach();
    this._destroySpatialReferenceDependentProperties();
    const t30 = this.state.paddedViewState.clone();
    if (t2(this._scaleBeforeChangingSpatialReference))
      this._scaleBeforeChangingSpatialReference = t30.scale;
    else {
      const e25 = t30.viewpoint.clone();
      e25.scale = this._scaleBeforeChangingSpatialReference, t30.viewpoint = e25;
    }
    const s27 = t30.clone(), [r24, n31] = t30.center;
    let a34 = null;
    try {
      a34 = this._project(new w2({ x: r24, y: n31, spatialReference: t30.spatialReference }), e24);
    } catch (p30) {
      en() || s2.getLogger(this.declaredClass).warn(new t6("mapview:spatial-reference-change", "could not project the view's center to the new spatial reference", { center: a34 == null ? void 0 : a34.toJSON(), spatialReference: e24, error: p30 }));
    }
    a34 || (a34 = new w2({ x: 0, y: 0, spatialReference: e24 }));
    const l25 = xt(new u3({ targetGeometry: new w2(), scale: 0, rotation: 0 }), t30.viewpoint, a34);
    s27.viewpoint = l25;
    try {
      const i34 = 20, r25 = [t30.size[0] / 2, t30.size[1] / 2], n32 = [r25[0] + i34, r25[1]], a35 = t30.toMap([0, 0], n32), { x: o27, y: p30 } = this._project(new w2({ x: a35[0], y: a35[1], spatialReference: t30.spatialReference }), e24);
      a35[0] = o27, a35[1] = p30, s27.toScreen(a35, a35);
      const h20 = pt(r25, a35, n32), c37 = Math.hypot(a35[0] - r25[0], a35[1] - r25[1]) / i34;
      !Number.isFinite(c37) || Math.abs(c37) > 4 ? (l25.rotation = 0, l25.targetGeometry = new w2({ x: 0, y: 0, spatialReference: e24 })) : (l25.scale *= c37, l25.scale > has("mapview-srswitch-adjust-rotation-scale-threshold") ? l25.rotation = 0 : l25.rotation += Number.isFinite(h20) ? h20 : 0);
    } catch {
    }
    this._get("constraints").constrain(l25, void 0), this._get("state").viewpoint = l25, this._stage.state = this.state, this._setupSpatialReferenceDependentProperties();
    for (const i34 of this.allLayerViews)
      i34.processAttach();
    this.frameTask.requestFrame(), this.frameTask.start(), this._updateStageChildren();
  }
};
fe2.type = "2d", e([y2({ readOnly: true })], fe2.prototype, "animationManager", void 0), e([y2({ constructOnly: true })], fe2.prototype, "deactivatedWebGLExtensions", void 0), e([y2({ constructOnly: true })], fe2.prototype, "debugWebGLExtensions", void 0), e([y2({ readOnly: true })], fe2.prototype, "featuresTilingScheme", void 0), e([y2({ readOnly: true })], fe2.prototype, "fullOpacity", void 0), e([y2({ readOnly: true })], fe2.prototype, "graphicsTileStore", null), e([y2()], fe2.prototype, "graphicsView", void 0), e([y2({ readOnly: true })], fe2.prototype, "state", void 0), e([y2()], fe2.prototype, "initialExtentRequired", null), e([y2()], fe2.prototype, "labelManager", void 0), e([y2({ readOnly: true })], fe2.prototype, "resourceManager", null), e([y2({ readOnly: true })], fe2.prototype, "textureManager", null), e([y2({ readOnly: true })], fe2.prototype, "mapViewNavigation", void 0), e([y2({ constructOnly: true })], fe2.prototype, "renderCanvas", void 0), e([y2()], fe2.prototype, "renderingOptions", void 0), e([y2({ readOnly: true })], fe2.prototype, "rendering", void 0), e([y2({ constructOnly: true })], fe2.prototype, "supersampleScreenshotsEnabled", void 0), e([y2({ readOnly: true })], fe2.prototype, "supportsGround", void 0), e([y2()], fe2.prototype, "_stationaryTimer", void 0), e([y2()], fe2.prototype, "_defaultsFromMapSettings", null), e([y2()], fe2.prototype, "_pePromise", void 0), e([y2({ readOnly: true })], fe2.prototype, "typeSpecificPreconditionsReady", null), e([y2()], fe2.prototype, "animation", null), e([y2({ type: m6 })], fe2.prototype, "background", null), e([y2({ value: null, type: w2, dependsOn: ["state.id", "ready"] })], fe2.prototype, "center", null), e([y2({ type: u15 })], fe2.prototype, "constraints", null), e([y2({ value: null, type: w3, dependsOn: ["state.id", "ready"] })], fe2.prototype, "extent", null), e([y2()], fe2.prototype, "floors", void 0), e([y2({ type: c10 })], fe2.prototype, "highlightOptions", void 0), e([y2({ readOnly: true })], fe2.prototype, "inputManager", void 0), e([y2()], fe2.prototype, "map", void 0), e([y2({ value: { top: 0, right: 0, bottom: 0, left: 0 }, cast: (e24) => ({ top: 0, right: 0, bottom: 0, left: 0, ...e24 }) })], fe2.prototype, "padding", null), e([y2()], fe2.prototype, "resizeAlign", void 0), e([y2({ readOnly: true, dependsOn: ["state.id"] })], fe2.prototype, "resolution", null), e([y2({ value: 0, type: Number, dependsOn: ["state.id", "ready"] })], fe2.prototype, "rotation", null), e([y2({ value: 0, type: Number, dependsOn: ["state.id", "ready"] })], fe2.prototype, "scale", null), e([y2({ constructOnly: true })], fe2.prototype, "spatialReferenceLocked", void 0), e([y2()], fe2.prototype, "stationary", null), e([y2({ type: e11, readOnly: true })], fe2.prototype, "timeline", void 0), e([y2({ readOnly: true })], fe2.prototype, "type", void 0), e([y2({ readOnly: true })], fe2.prototype, "updating", null), e([y2({ value: null, type: u3, dependsOn: ["state.id", "ready"] })], fe2.prototype, "viewpoint", null), e([y2({ value: -1, dependsOn: ["state.id", "ready"] })], fe2.prototype, "zoom", null), e([y2({ readOnly: true })], fe2.prototype, "navigating", null), e([y2({ type: p29 })], fe2.prototype, "ui", void 0), fe2 = e([a3("esri.views.MapView")], fe2);
var _e = fe2;
function ve(e24) {
  var _a, _b;
  const t30 = e24.getObjectId();
  return t30 ? `${((_a = e24.layer) == null ? void 0 : _a.uid) ?? ((_b = e24.sourceLayer) == null ? void 0 : _b.uid) ?? "MapView"}/${t30}` : `"MapView/${e24.uid}`;
}
function Ve(e24, i34, s27, r24, n31) {
  return (a34) => {
    if (a34 instanceof g3) {
      if (a34.layer === e24)
        n31 == null ? void 0 : n31();
      else {
        const t30 = e24.allLayerViews.find((e25) => e25.layer === a34.layer);
        t30 && (r24 == null ? void 0 : r24(t30));
      }
      s27(ve(a34));
    } else {
      const t30 = e24.allLayerViews.find((e25) => e25.layer === a34);
      t30 && i34(t30);
    }
  };
}
function Se(e24, t30) {
  if (e24)
    if (t(e24))
      for (const i34 of e24)
        if (t(i34))
          for (const e25 of i34)
            t30(e25);
        else
          t30(i34);
    else
      t30(e24);
}
function Te(e24) {
  return "esri.WebMap" === (e24 == null ? void 0 : e24.declaredClass);
}
export {
  _e as default
};
//# sourceMappingURL=@arcgis_core_views_MapView__js.js.map
