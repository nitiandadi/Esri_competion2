import {
  At,
  C,
  F,
  G,
  K,
  M,
  Nt,
  Y,
  tt
} from "./chunk-P6SQPYDS.js";
import {
  e
} from "./chunk-HVCAHUYB.js";

// node_modules/@arcgis/core/chunks/persistableUrlUtils.js
function c(e2, o) {
  const l = o && o.url && o.url.path;
  if (e2 && l && (e2 = F(e2, l, { preserveProtocolRelative: true }), o.portalItem && o.readResourcePaths)) {
    const r = G(e2, o.portalItem.itemUrl);
    null != r && v.test(r) && o.readResourcePaths.push(o.portalItem.resourceFromPath(r).path);
  }
  return I(e2, o && o.portal);
}
function m(e2, n, a = R.YES) {
  if (null == e2)
    return e2;
  !Y(e2) && n && n.blockedRelativeUrls && n.blockedRelativeUrls.push(e2);
  let u = F(e2);
  if (n) {
    const r = n.verifyItemRelativeUrls && n.verifyItemRelativeUrls.rootPath || n.url && n.url.path;
    if (r) {
      const o = I(r, n.portal), l = I(u, n.portal);
      u = G(l, o, o);
      null != u && u !== l && u !== e2 && n.verifyItemRelativeUrls && n.verifyItemRelativeUrls.writtenUrls.push(u);
    }
  }
  return u = y(u, n == null ? void 0 : n.portal), Y(u) && (u = K(u)), (n == null ? void 0 : n.resources) && (n == null ? void 0 : n.portalItem) && !Y(u) && !tt(u) && a === R.YES && n.resources.toKeep.push({ resource: n.portalItem.resourceFromPath(u), compress: false }), u;
}
function p(e2, r, t) {
  return c(e2, t);
}
function f(e2, r, t, o) {
  const l = m(e2, o);
  void 0 !== l && (r[t] = l);
}
var h = /\/items\/([^\/]+)\/resources\/(.*)/;
var v = /^\.\/resources\//;
function U(e2) {
  var _a;
  return ((_a = (e2 == null ? void 0 : e2.match(h)) ?? null) == null ? void 0 : _a[1]) ?? null;
}
function d(r) {
  const t = (r == null ? void 0 : r.match(h)) ?? null;
  if (null == t)
    return null;
  const o = t[2], l = o.lastIndexOf("/");
  if (-1 === l) {
    const { path: r2, extension: t2 } = Nt(o);
    return { prefix: null, filename: r2, extension: e(t2) };
  }
  const { path: s, extension: a } = Nt(o.slice(l + 1));
  return { prefix: o.slice(0, l), filename: s, extension: e(a) };
}
function y(e2, r) {
  return r && !r.isPortal && r.urlKey && r.customBaseUrl ? At(e2, `${r.urlKey}.${r.customBaseUrl}`, r.portalHostname) : e2;
}
function I(e2, r) {
  if (!r || r.isPortal || !r.urlKey || !r.customBaseUrl)
    return e2;
  const t = `${r.urlKey}.${r.customBaseUrl}`, o = C();
  return M(o, `${o.scheme}://${t}`) ? At(e2, r.portalHostname, t) : At(e2, t, r.portalHostname);
}
var R;
!function(e2) {
  e2[e2.YES = 0] = "YES", e2[e2.NO = 1] = "NO";
}(R || (R = {}));
var x = Object.freeze(Object.defineProperty({ __proto__: null, get MarkKeep() {
  return R;
}, ensureMainOnlineDomain: y, fromJSON: c, itemIdFromResourceUrl: U, prefixAndFilenameFromResourceUrl: d, read: p, toJSON: m, write: f }, Symbol.toStringTag, { value: "Module" }));

export {
  c,
  m,
  p,
  f,
  U,
  d,
  y,
  R,
  x
};
//# sourceMappingURL=chunk-CBAVHWPY.js.map
