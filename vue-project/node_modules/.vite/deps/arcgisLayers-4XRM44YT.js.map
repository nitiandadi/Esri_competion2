{
  "version": 3,
  "sources": ["../../@arcgis/core/layers/support/arcgisLayers.js"],
  "sourcesContent": ["/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.26/esri/copyright.txt for details.\n*/\nimport e from\"../../core/Error.js\";import{isNone as r,isSome as a}from\"../../core/maybe.js\";import{getFilename as t,urlToObject as s}from\"../../core/urlUtils.js\";import{parse as l,parseNonStandardSublayerUrl as o}from\"./arcgisLayerUrl.js\";import{fetchFeatureService as n}from\"./fetchService.js\";import{sceneServiceLayerTypeToClassName as u}from\"./layerUtils.js\";import{layerLookupMap as c}from\"./lazyLayerLoader.js\";import{fetchArcGISServiceJSON as i}from\"../../support/requestPresets.js\";const y={FeatureLayer:!0,SceneLayer:!0};async function m(e){const r=e.properties?.customParameters,a=await d(e.url,r),t={...e.properties,url:e.url};if(!a.sublayerIds)return null!=a.layerOrTableId&&(t.layerId=a.layerOrTableId,t.sourceJSON=a.sourceJSON),new a.Constructor(t);const s=new(0,(await import(\"../GroupLayer.js\")).default)({title:a.parsedUrl.title});return f(s,a,t),s}function p(e,r){return e?e.find((e=>e.id===r)):null}function f(e,r,t){function s(e,s){const l={...t,layerId:e,sublayerTitleMode:\"service-name\"};return a(s)&&(l.sourceJSON=s),new r.Constructor(l)}r.sublayerIds.forEach((a=>{const t=s(a,p(r.sublayerInfos,a));e.add(t)})),r.tableIds.forEach((a=>{const t=s(a,p(r.tableInfos,a));e.tables.add(t)}))}async function d(a,t){let s=l(a);if(r(s)&&(s=await I(a,t)),r(s))throw new e(\"arcgis-layers:url-mismatch\",\"The url '${url}' is not a valid arcgis resource\",{url:a});const{serverType:o,sublayer:n}=s;let c;const m={FeatureServer:\"FeatureLayer\",StreamServer:\"StreamLayer\",VectorTileServer:\"VectorTileLayer\"};switch(o){case\"MapServer\":if(null!=n)c=\"FeatureLayer\";else{c=await v(a,t)?\"TileLayer\":\"MapImageLayer\"}break;case\"ImageServer\":{const e=await i(a,{customParameters:t}),{tileInfo:r,cacheType:s}=e;c=r?\"LERC\"!==r?.format?.toUpperCase()||s&&\"elevation\"!==s.toLowerCase()?\"ImageryTileLayer\":\"ElevationLayer\":\"ImageryLayer\";break}case\"SceneServer\":{const e=await i(s.url.path,{customParameters:t});if(c=\"SceneLayer\",e){const r=e?.layers;if(\"Voxel\"===e?.layerType)c=\"VoxelLayer\";else if(r?.length){const e=r[0]?.layerType;null!=e&&null!=u[e]&&(c=u[e])}}break}default:c=m[o]}const p=\"FeatureServer\"===o,f={parsedUrl:s,Constructor:null,layerOrTableId:p?n:void 0,sublayerIds:null,tableIds:null};if(y[c]&&null==n){const e=await S(a,o,t);p&&(f.sublayerInfos=e.layerInfos,f.tableInfos=e.tableInfos);1!==e.layerIds.length+e.tableIds.length?(f.sublayerIds=e.layerIds,f.tableIds=e.tableIds):p&&(f.layerOrTableId=e.layerIds[0]??e.tableIds[0],f.sourceJSON=e.layerInfos?.[0]??e.tableInfos?.[0])}return f.Constructor=await w(c),f}async function I(e,r){const l=await i(e,{customParameters:r});let n=null,u=null;const c=l.type;if(\"Feature Layer\"===c||\"Table\"===c?(n=\"FeatureServer\",u=l.id??null):\"indexedVector\"===c?n=\"VectorTileServer\":l.hasOwnProperty(\"mapName\")?n=\"MapServer\":l.hasOwnProperty(\"bandCount\")&&l.hasOwnProperty(\"pixelSizeX\")?n=\"ImageServer\":l.hasOwnProperty(\"maxRecordCount\")&&l.hasOwnProperty(\"allowGeometryUpdates\")?n=\"FeatureServer\":l.hasOwnProperty(\"streamUrls\")?n=\"StreamServer\":b(l)?(n=\"SceneServer\",u=l.id):l.hasOwnProperty(\"layers\")&&b(l.layers?.[0])&&(n=\"SceneServer\"),!n)return null;const y=null!=u?o(e):null;return{title:a(y)&&l.name||t(e),serverType:n,sublayer:u,url:{path:a(y)?y.serviceUrl:s(e).path}}}function b(e){return null!=e&&e.hasOwnProperty(\"store\")&&e.hasOwnProperty(\"id\")&&\"number\"==typeof e.id}async function S(e,r,a){let t,s=!1;if(\"FeatureServer\"===r){const r=await n(e,{customParameters:a});s=!!r.layersJSON,t=r.layersJSON||r.serviceJSON}else t=await i(e,{customParameters:a});const l=t?.layers,o=t?.tables;return{layerIds:l?.map((e=>e.id)).reverse()||[],tableIds:o?.map((e=>e.id)).reverse()||[],layerInfos:s?l:[],tableInfos:s?o:[]}}async function w(e){return(0,c[e])()}async function v(e,r){return(await i(e,{customParameters:r})).tileInfo}export{m as fromUrl};\n"],
  "mappings": "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",
  "names": ["r", "a", "d", "t", "s", "e", "m", "p", "f", "y"]
}
