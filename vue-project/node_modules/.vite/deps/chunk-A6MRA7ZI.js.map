{
  "version": 3,
  "sources": ["../../@arcgis/core/views/3d/webgl-engine/core/shaderModules/Float2DrawUniform.js", "../../@arcgis/core/views/3d/webgl-engine/core/shaderModules/Texture2DDrawUniform.js", "../../@arcgis/core/chunks/SSAOBlur.glsl.js"],
  "sourcesContent": ["/*\r\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\r\nSee https://js.arcgis.com/4.26/esri/copyright.txt for details.\r\n*/\r\nimport{Uniform as r}from\"./Uniform.js\";import{BindType as e}from\"../shaderTechnique/BindType.js\";class o extends r{constructor(r,o){super(r,\"vec2\",e.Draw,((e,s,t,i)=>e.setUniform2fv(r,o(s,t,i))))}}export{o as Float2DrawUniform};\r\n", "/*\r\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\r\nSee https://js.arcgis.com/4.26/esri/copyright.txt for details.\r\n*/\r\nimport{isSome as r}from\"../../../../../core/maybe.js\";import{s as e}from\"../../../../../chunks/vec2.js\";import{Z as o,a as s}from\"../../../../../chunks/vec2f64.js\";import{TEXTURE_SIZE_UNIFORM_SUFFIX as t,TEXTURE_INVERSE_SIZE_UNIFORM_SUFFIX as i}from\"../shaderLibrary/util/WebGL2Utils.js\";import{Float2DrawUniform as n}from\"./Float2DrawUniform.js\";import{TextureSizeUniformType as m}from\"./TextureSizeUniformType.js\";import{Uniform as c}from\"./Uniform.js\";import{BindType as p}from\"../shaderTechnique/BindType.js\";class f extends c{constructor(r,e){super(r,\"sampler2D\",p.Draw,((o,s,t)=>o.bindTexture(r,e(s,t))))}}function u(s,c,p=m.None){const u=[new f(s,c)];if(p&m.Size){const i=s+t;u.push(new n(i,((s,t)=>{const i=c(s,t);return r(i)?e(a,i.descriptor.width,i.descriptor.height):o})))}if(p&m.InvSize){const t=s+i;u.push(new n(t,((s,t)=>{const i=c(s,t);return r(i)?e(a,1/i.descriptor.width,1/i.descriptor.height):o})))}return u}const a=s();export{f as Texture2DDrawUniform,u as createTexture2DDrawSizeUniforms};\r\n", "/*\r\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\r\nSee https://js.arcgis.com/4.26/esri/copyright.txt for details.\r\n*/\r\nimport{i as e}from\"./vec3.js\";import{ScreenSpacePass as r}from\"../views/3d/webgl-engine/core/shaderLibrary/ScreenSpacePass.glsl.js\";import{ReadLinearDepth as o}from\"../views/3d/webgl-engine/core/shaderLibrary/output/ReadLinearDepth.glsl.js\";import{Float2DrawUniform as t}from\"../views/3d/webgl-engine/core/shaderModules/Float2DrawUniform.js\";import{Float2PassUniform as a}from\"../views/3d/webgl-engine/core/shaderModules/Float2PassUniform.js\";import{FloatPassUniform as n}from\"../views/3d/webgl-engine/core/shaderModules/FloatPassUniform.js\";import{glsl as l}from\"../views/3d/webgl-engine/core/shaderModules/interfaces.js\";import{ShaderBuilder as s}from\"../views/3d/webgl-engine/core/shaderModules/ShaderBuilder.js\";import{Texture2DDrawUniform as i}from\"../views/3d/webgl-engine/core/shaderModules/Texture2DDrawUniform.js\";import{Texture2DPassUniform as d}from\"../views/3d/webgl-engine/core/shaderModules/Texture2DPassUniform.js\";const f=4;function c(){const c=new s,u=c.fragment;c.include(r);const m=(f+1)/2,p=1/(2*m*m);return u.include(o),u.uniforms.add([new d(\"depthMap\",(e=>e.depthTexture)),new i(\"tex\",(e=>e.colorTexture)),new t(\"blurSize\",(e=>e.blurSize)),new n(\"projScale\",((r,o)=>{const t=e(o.camera.eye,o.camera.center);return t>5e4?Math.max(0,r.projScale-(t-5e4)):r.projScale})),new a(\"nearFar\",((e,r)=>r.camera.nearFar))]),u.code.add(l`\r\n    void blurFunction(vec2 uv, float r, float center_d, float sharpness, inout float wTotal, inout float bTotal) {\r\n      float c = texture2D(tex, uv).r;\r\n      float d = linearDepthFromTexture(depthMap, uv, nearFar);\r\n\r\n      float ddiff = d - center_d;\r\n\r\n      float w = exp(-r * r * ${l.float(p)} - ddiff * ddiff * sharpness);\r\n      wTotal += w;\r\n      bTotal += w * c;\r\n    }\r\n  `),u.code.add(l`\r\n    void main(void) {\r\n      float b = 0.0;\r\n      float w_total = 0.0;\r\n\r\n      float center_d = linearDepthFromTexture(depthMap, uv, nearFar);\r\n\r\n      float sharpness = -0.05 * projScale / center_d;\r\n      for (int r = -${l.int(f)}; r <= ${l.int(f)}; ++r) {\r\n        float rf = float(r);\r\n        vec2 uvOffset = uv + rf * blurSize;\r\n        blurFunction(uvOffset, rf, center_d, sharpness, w_total, b);\r\n      }\r\n\r\n      gl_FragColor = vec4(b / w_total);\r\n    }\r\n  `),c}const u=Object.freeze(Object.defineProperty({__proto__:null,build:c},Symbol.toStringTag,{value:\"Module\"}));export{u as S,c as b};\r\n"],
  "mappings": ";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAIiG,IAAMA,KAAN,cAAgB,EAAC;AAAA,EAAC,YAAYC,IAAED,IAAE;AAAC,UAAMC,IAAE,QAAO,EAAE,MAAM,CAACC,IAAE,GAAEC,IAAEC,OAAIF,GAAE,cAAcD,IAAED,GAAE,GAAEG,IAAEC,EAAC,CAAC,CAAE;AAAA,EAAC;AAAC;;;ACA6T,IAAMC,KAAN,cAAgB,EAAC;AAAA,EAAC,YAAYC,IAAEC,IAAE;AAAC,UAAMD,IAAE,aAAY,EAAE,MAAM,CAACE,IAAE,GAAEC,OAAID,GAAE,YAAYF,IAAEC,GAAE,GAAEE,EAAC,CAAC,CAAE;AAAA,EAAC;AAAC;AAAC,SAAS,EAAE,GAAEC,IAAE,IAAEH,GAAE,MAAK;AAAC,QAAMI,KAAE,CAAC,IAAIN,GAAE,GAAEK,EAAC,CAAC;AAAE,MAAG,IAAEH,GAAE,MAAK;AAAC,UAAMK,KAAE,IAAE;AAAE,IAAAD,GAAE,KAAK,IAAIH,GAAEI,IAAG,CAACC,IAAEJ,OAAI;AAAC,YAAMG,KAAEF,GAAEG,IAAEJ,EAAC;AAAE,aAAO,EAAEG,EAAC,IAAEN,GAAEQ,IAAEF,GAAE,WAAW,OAAMA,GAAE,WAAW,MAAM,IAAE;AAAA,IAAC,CAAE,CAAC;AAAA,EAAC;AAAC,MAAG,IAAEL,GAAE,SAAQ;AAAC,UAAME,KAAE,IAAEM;AAAE,IAAAJ,GAAE,KAAK,IAAIH,GAAEC,IAAG,CAACI,IAAEJ,OAAI;AAAC,YAAMG,KAAEF,GAAEG,IAAEJ,EAAC;AAAE,aAAO,EAAEG,EAAC,IAAEN,GAAEQ,IAAE,IAAEF,GAAE,WAAW,OAAM,IAAEA,GAAE,WAAW,MAAM,IAAE;AAAA,IAAC,CAAE,CAAC;AAAA,EAAC;AAAC,SAAOD;AAAC;AAAC,IAAMG,KAAE,EAAE;;;ACAN,IAAME,KAAE;AAAE,SAAS,IAAG;AAAC,QAAMC,KAAE,IAAIC,MAAEC,KAAEF,GAAE;AAAS,EAAAA,GAAE,QAAQC,EAAC;AAAE,QAAM,KAAGF,KAAE,KAAG,GAAE,IAAE,KAAG,IAAE,IAAE;AAAG,SAAOG,GAAE,QAAQC,EAAC,GAAED,GAAE,SAAS,IAAI,CAAC,IAAIH,GAAE,YAAY,CAAAK,OAAGA,GAAE,YAAa,GAAE,IAAIL,GAAE,OAAO,CAAAK,OAAGA,GAAE,YAAa,GAAE,IAAIH,GAAE,YAAY,CAAAG,OAAGA,GAAE,QAAS,GAAE,IAAIH,GAAE,aAAa,CAACI,IAAEJ,OAAI;AAAC,UAAMK,KAAE,EAAEL,GAAE,OAAO,KAAIA,GAAE,OAAO,MAAM;AAAE,WAAOK,KAAE,MAAI,KAAK,IAAI,GAAED,GAAE,aAAWC,KAAE,IAAI,IAAED,GAAE;AAAA,EAAS,CAAE,GAAE,IAAI,EAAE,WAAW,CAACD,IAAEC,OAAIA,GAAE,OAAO,OAAQ,CAAC,CAAC,GAAEH,GAAE,KAAK,IAAI;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,+BAOlyC,EAAE,MAAM,CAAC;AAAA;AAAA;AAAA;AAAA,GAIrC,GAAEA,GAAE,KAAK,IAAI;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,sBAQM,EAAE,IAAIH,EAAC,WAAW,EAAE,IAAIA,EAAC;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,GAQ5C,GAAEC;AAAC;AAAC,IAAME,KAAE,OAAO,OAAO,OAAO,eAAe,EAAC,WAAU,MAAK,OAAM,EAAC,GAAE,OAAO,aAAY,EAAC,OAAM,SAAQ,CAAC,CAAC;",
  "names": ["o", "r", "e", "t", "i", "f", "r", "e", "o", "t", "c", "u", "i", "s", "a", "n", "f", "c", "o", "u", "a", "e", "r", "t"]
}
