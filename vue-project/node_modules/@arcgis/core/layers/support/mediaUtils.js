/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.26/esri/copyright.txt for details.
*/
import"../../geometry.js";import{unwrap as e}from"../../core/maybe.js";import{getInfo as t}from"../../geometry/support/spatialReferenceUtils.js";import n from"./ControlPointsGeoreference.js";import o from"../../geometry/Extent.js";import i from"../../geometry/Point.js";const r=100,a=.5;async function s(e,s){e.loaded||await e.load();const{width:c,height:m}=e.content,{spatialReference:p}=s,l=t(p);let y=!1;if(l){const e=l.valid[1]-l.valid[0];s.width>e&&(s=new o({xmin:l.valid[0],ymin:s.ymin,xmax:l.valid[1],ymax:s.ymax,spatialReference:s.spatialReference}),y=!0)}const x=s.expand(a),{center:f,width:h,height:w}=x,P=y||c>m?h:c/m*w,d=y||c>m?m/c*h:w,u=f.x-P/2,g=f.x+P/2,R=f.y+d/2,j=f.y-d/2;return new n({controlPoints:[{sourcePoint:{x:r,y:m-r},mapPoint:new i({x:u,y:j,spatialReference:p})},{sourcePoint:{x:r,y:r},mapPoint:new i({x:u,y:R,spatialReference:p})},{sourcePoint:{x:c-r,y:r},mapPoint:new i({x:g,y:R,spatialReference:p})},{sourcePoint:{x:c-r,y:m-r},mapPoint:new i({x:g,y:j,spatialReference:p})}],width:c,height:m})}function c(t){const o=e(t.georeference);if("control-points"!==o.type)return null;const r={wkid:0},{width:a,height:s}=o,c=e(o.controlPoints);return new n({controlPoints:c.map((t=>{const{x:n,y:o}=e(e(t).sourcePoint);return{sourcePoint:{x:n,y:o},mapPoint:new i({x:n,y:s-o,spatialReference:r})}})),width:a,height:s})}export{s as createDefaultControlPointsGeoreference,c as createLocalModeControlPointsGeoreference};
