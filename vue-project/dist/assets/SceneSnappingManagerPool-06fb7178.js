import{p as u,D as c,h as l,hr as f,hs as h}from"./mapviewstore-8a6f290e.js";import{n as g,p as s,a as d,w as m,V as w}from"./SnappingManager-e678da87.js";function S(n){let e,t,r=[],i=!1;function p(...o){return i&&e===this&&y(o,r)||(t=n.apply(this,o),e=this,r=o,i=!0),t}return p}function y(n,e){if(n.length!==e.length)return!1;for(let t=0;t<n.length;++t)if(n[t]!==e[t])return!1;return!0}function $(n,e){const t=new g({enabled:!0,selfEnabled:!1,featureEnabled:!0,distance:(e==null?void 0:e.distance)??s.distance,touchSensitivityMultiplier:(e==null?void 0:e.touchSensitivityMultiplier)??s.touchSensitivityMultiplier});return{...u(()=>{var r,i;return((i=(r=n.map)==null?void 0:r.allLayers)==null?void 0:i.toArray())??[]},r=>{t.featureSources=new l(r.map(i=>new d({layer:i,enabled:!0})))},c),options:t}}const a=new Map;function E(n){if(!a.has(n)){const r=$(n,{distance:10}),i=M(n,r.options);a.set(n,{referenceCount:0,snappingManager:i,remove:()=>{r.remove(),i.destroy()}})}const e=a.get(n);e.referenceCount++;const t=f(()=>v(n,e));return{snappingManager:e.snappingManager,...t}}function v(n,e){e.referenceCount--,e.referenceCount>0||h(()=>{e.referenceCount===0&&(e.remove(),a.delete(n))})}function M(n,e){return new m({view:n,options:e,snappingEnginesFactory:(t,r)=>[new w({view:n,spatialReference:n.spatialReference,options:r})]})}export{E as a,S as t};
