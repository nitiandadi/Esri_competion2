var a=Object.defineProperty;var h=(s,t,e)=>t in s?a(s,t,{enumerable:!0,configurable:!0,writable:!0,value:e}):s[t]=e;var n=(s,t,e)=>(h(s,typeof t!="symbol"?t+"":t,e),e);import{bS as p,bT as c,bU as m,bV as y,N as l}from"./MapView-d4248bee.js";function d(s){var t=function(i){this.map=i,this._mapOffset=[0,0]};return t.getDimensionsInfo=function(){return["x","y"]},t.dimensions=["x","y"],t.prototype.dimensions=["x","y"],t.prototype.type="arcmap",t.prototype.setZoom=function(e){this._zoom=e},t.prototype.setMapOffset=function(e){this._mapOffset=e},t.create=function(e){e.eachSeries(function(i){i.get("coordinateSystem")==="arcgis"&&(i.coordinateSystem=new t(s))})},t.prototype.dataToPoint=function(e){let i=new p({x:e[0],y:e[1],spatialReference:{wkid:4326}});const o=this._mapOffset;let r=this.map.toScreen(i);return[r.x-o[0],r.y-o[1]]},t.prototype.pointToData=function(e){const i=this._mapOffset;let o={x:e[0]+i[0],y:e[1]+i[1]},r=this.view.toMap(o);return[r.x,r.y]},t.prototype.getViewRect=function(){return new c(0,0,this.map.width,this.map.height)},t.prototype.getRoamTransform=function(){return m()},t}class g{constructor(t,e={}){n(this,"_echartsContainer");n(this,"mapView");n(this,"chart");n(this,"option");n(this,"handle",null);var i=this._echartsContainer=document.createElement("div");if(this.option=e,this.mapView=t,i.style.position="absolute",i.style.height=t.height+"px",i.style.width=t.width+"px",i.style.bottom="0px",i.style.right="0px",i.style.zIndex="1",i.id="echartLayer",document.getElementsByClassName("esri-view-user-storage")[0].appendChild(i),y("arcgis",d(t)),t.isFulfilled())this.chart=l(i),this._init(),this.chart.setOption(e);else throw new Error("mapView is not ready")}_init(){this.handle=this.mapView.watch("extent",()=>{var e;let t=this._echartsContainer;t.style.width=this.mapView.width+"px",t.style.height=this.mapView.height+"px",(e=this.chart)==null||e.resize()})}destroy(){var t,e,i;(t=this.chart)==null||t.dispose(),this.chart=null,(e=this._echartsContainer)==null||e.remove(),this._echartsContainer=null,(i=this.handle)==null||i.remove()}Redraw(t){var e;this.option=t,(e=this.chart)==null||e.setOption(t)}setVisiable(t){this._echartsContainer.hidden=!t}}export{g as E};
