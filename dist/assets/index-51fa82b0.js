import{N as ue,e as o,y as l,bW as et,bX as ae,a as j,t as S,s as Ne,r as h,I as tt,bY as Ee,bg as ce,a1 as st,bZ as it,b_ as at,au as H,b$ as nt,o as Ce,bn as oe,m as R,c0 as We,a7 as ot,c1 as te,bS as Ae,C as ee,c2 as Oe,c3 as Se,c4 as rt,v as lt,bK as dt,w as Ge,c5 as W,c6 as Pe,j as ut,aN as ct,z as je,c7 as ht,d as Le,G as Ie,W as pt,n as f,c8 as mt,u as gt,c9 as yt,ca as vt,R as _t,H as wt,O as ft,cb as bt}from"./MapView-d4248bee.js";import{u as xt,a as he}from"./useTime-ca88e827.js";import"./liquidFillView-0a9aeed9.js";import{j as Vt,b as m,d as re,o as ke,a4 as Mt,a as F,c as le,f as p,p as Dt,i as Ct,a5 as A,O as pe,a6 as St,_ as Te,a2 as $t,l as qe,n as ne,w as x,g as v,u as g,s as B,W as kt,x as Tt,y as X,v as se,a1 as Et,a7 as At,F as Ot,G as Pt,m as me,U as J,a8 as Lt,q as ge,R as ye}from"./index-9ba3f23e.js";import"./visitorLayer-9a30f3f8.js";import{u as $e}from"./mapviewstore-4805ae67.js";import{c as It}from"./Analysis-34bda3f7.js";import{i as Re,u as Rt,e as Ut}from"./analysisThemeUtils-04a30232.js";import{t as zt,a as Bt,h as Ht,m as Ft,e as Nt,x as Wt,b as Gt}from"./SnappingOperation-24685952.js";import{E as Ue}from"./measurementUtils-a3bdb768.js";import{B as jt,z as qt}from"./dragEventPipeline3D-f09aab35.js";import{e as Ye,N as ze,a as Yt,x as Kt}from"./AnalysisToolBase-c69e0046.js";import{d as Zt}from"./PointVisualElement-97fe269b.js";import{V as Xt,g as Jt,w as Qt}from"./EditGeometryOperations-7a18c435.js";import Be from"./SceneLayer-f1baa9a1.js";import"./viewUtils-653374a2.js";import"./elevationInfoUtils-be893fde.js";import"./colorUtils-a4bfffd5.js";import"./RightAngleQuadVisualElement-7f36d6f3.js";import"./VisualElement-62e5dd07.js";import"./VisualElementResources-d63a6ee6.js";import"./QueryEngineResult-000a2eb4.js";import"./WhereClause-34fcc82f.js";import"./executionError-fb3f283a.js";import"./utils-5fb83578.js";import"./ClassBreaksDefinition-6b9f5256.js";import"./projectionSupport-96272605.js";import"./json-48e3ea08.js";import"./utils-f77fba44.js";import"./dehydratedFeatureComparison-0ac2f54e.js";import"./geometryEngine-803ffc39.js";import"./geometryEngineBase-e1a33b0a.js";import"./hydrated-7f96abbb.js";import"./ImageMaterial-b196cc20.js";import"./SceneService-57b44186.js";import"./I3SIndexInfo-91c13f05.js";import"./saveUtils-ecef96c7.js";import"./resourceUtils-0ca690b6.js";import"./capabilities-a18453f6.js";import"./FetchAssociatedFeatureLayer-c28d3a04.js";import"./I3SLayerDefinitions-b27e7f72.js";import"./persistable-69e9c02c.js";import"./resourceExtension-9abd8498.js";import"./I3SUtil-2d068cb2.js";import"./I3SBinaryReader-0c2e63aa.js";import"./popupUtils-7e1f6d3e.js";const de=[{oid:2,name:"黑陶展厅",destory:"无损坏",year:1,screenPoint:{x:202.66668701171875,y:385.1111145019531}},{oid:4,name:"1号农家合院",destory:"轻度损坏",year:5,screenPoint:{x:277.3333435058594,y:705.1111450195312}},{oid:6,name:"1号休闲房",destory:"无损坏",year:1,screenPoint:{x:436.4444885253906,y:514.0000610351562}},{oid:7,name:"2号民宿",destory:"轻度损坏",year:3,screenPoint:{x:292.4444580078125,y:534.4444580078125}},{oid:8,name:"咨询处",destory:"中度损坏",year:5,screenPoint:{x:396.4444885253906,y:367.3333435058594}},{oid:9,name:"3号农家食堂",destory:"轻度损坏",year:3,screenPoint:{x:520,y:439.3333435058594}},{oid:10,name:"1号农家房",destory:"中度损坏",year:5,screenPoint:{x:657.7777709960938,y:441.1111145019531}},{oid:11,name:"售票房",destory:"中度损坏",year:5,screenPoint:{x:533.3333129882812,y:764.6666870117188}},{oid:12,name:"黑陶展厅",destory:"无损坏",year:1,screenPoint:{x:163.55555725097656,y:334.4444580078125}},{oid:13,name:"3号农家合院",destory:"无损坏",year:1,screenPoint:{x:519.1111450195312,y:379.7778015136719}},{oid:14,name:"陶艺讲堂 ",destory:"无损坏",year:1,screenPoint:{x:369.7778015136719,y:330.888916015625}},{oid:15,name:"1号农家食堂",destory:"轻度损坏",year:5,screenPoint:{x:259.5555725097656,y:322.8888854980469}},{oid:16,name:"小展厅",destory:"轻度损坏",year:5,screenPoint:{x:635.5555419921875,y:210}},{oid:17,name:"2号农家食堂",destory:"中度损坏",year:5,screenPoint:{x:528,y:309.5555725097656}},{oid:18,name:"2号农家合院",destory:"轻度损坏",year:5,screenPoint:{x:176.00001525878906,y:502.4444580078125}},{oid:19,name:"2号农家房",destory:"轻度损坏",year:3,screenPoint:{x:240,y:628.6666870117188}},{oid:20,name:"1号民宿",destory:"轻度损坏",year:5,screenPoint:{x:398.22222900390625,y:587.7777709960938}},{oid:21,name:"2号休闲房",destory:"无损坏",year:1,screenPoint:{x:377.77777099609375,y:537.1111450195312}},{oid:22,name:"大展厅",destory:"轻度损坏",year:5,screenPoint:{x:547.5555419921875,y:476.6666564941406}},{oid:23,name:"3号农家房",destory:"轻度损坏",year:3,screenPoint:{x:464.8888854980469,y:338.8888854980469}}],q=Vt("widget3d",()=>{let s;const e=m(!1),t=m(!0),i=m(!1),n=m(!1),a=m(0),u=["success","warning","error"],r=[30,15,10],d={success:{title:"限流评估等级-优",subTitle:"当日游客承载等级高，建议游客限流量"+r[0]+"+人次"},warning:{title:"限流评估等级-良",subTitle:"当日游客承载等级中等，建议游客限流量"+r[1]+"+人次"},error:{title:"限流评估等级-差",subTitle:"当日游客承载等级低，建议游客限流量"+r[2]+"-人次"}};function V($){s=$}function M(){s.value=!1}let _,C,b;function E($){_=$}function k($){C=$}function K($){b=$}function Z(){const $=(e.value?_[0]:0)+b[0]+(i.value?C[0]:0),U=(e.value?_[1]:0)+b[1]+(i.value?C[1]:0),c=(e.value?_[2]:0)+b[2]+(i.value?C[2]:0);console.log($,U,c);const w=Math.max($,U,c);w===$?a.value=0:w===U?a.value=1:a.value=2}return{setisDisabled:V,changeDisabled:M,checked1:e,checked2:t,checked3:i,setBuildparam:E,setEnvieonmentparam:k,setVisitorparam:K,createResult:Z,result:a,resultArr:u,resultTitle:d,showResult:n}}),Ke={无损坏:1,轻度损坏:2,中度损坏:3};function es(){const s=[];return de.forEach(e=>{s.push(e.name+`
`)}),s}function ts(){const s=[];return de.forEach(e=>{s.push(e.year)}),s}function ss(){const s=[];return de.forEach(e=>{const t=Ke[e.destory];s.push(t)}),s}const ve=m(0),_e=m(0),we=m(0);function fe(s){de.forEach(i=>{const n=Ke[i.destory],a=i.year,u=n*.7+a*.3;u<1.5?ve.value++:u<2.5?_e.value++:we.value++});const e=ve.value+_e.value+we.value,t=[ve.value/e,_e.value/e,we.value/e];return q().setBuildparam(t),t[s]}const is={title:{text:"黄河漂流广场-农家院",textStyle:{color:"#fff"}},legend:{left:"right",data:["年限","损坏程度"],textStyle:{color:"#4c9bfd"}},tooltip:{trigger:"axis",axisPointer:{type:"shadow"},backgroundColor:"#115687",borderColor:"#ccc",borderWidth:1,padding:[5,10],textStyle:{color:"#fff",fontSize:12},extraCssText:"box-shadow: 0 0 10px rgba(0, 0, 0, 0.1);max-width: 200px; max-height: 80px;",formatter:function(s){let e='<div style="font-size: 16px; font-weight: bold;height: 30px; ">'+s[0].name+"</div>";return s.forEach(function(t){e+='<span style="display: inline-block; width: 10px; height: 10px; margin-right: 5px;font-size: 14px; border-radius: 50%; background-color: '+t.color+';"></span>'+t.seriesName+"："+t.value+"<br>"}),e}},dataset:{source:[]},xAxis:{type:"category",data:es(),splitLine:{show:!1},axisLabel:{show:!1,interval:0}},yAxis:{type:"value",axisLabel:{color:"#4c9bfd"}},calculable:!0,grid:{bottom:10,tooltip:{trigger:"axis",axisPointer:{type:"shadow",label:{show:!0,formatter:function(s){return s.value.replace(`
`,"")}}}}},series:[{type:"bar",name:"年限",data:ts()},{type:"bar",name:"损坏程度",data:ss()},{type:"pie",center:["75%","25%"],radius:"28%",z:100,emphasis:{focus:"self"},data:[{name:"优",value:fe(0)},{name:"良",value:fe(1)},{name:"一般",value:fe(2)}]}]},Ze=[["product","1月","2月","3月","4月","5月","6月","7月","8月","9月","10月","11月","12月"],["第一年",650,820,880,720,580,920,850,820,780,700,630,610],["第三年",520,540,590,550,740,710,680,620,580,510,470,440],["第五年",450,670,730,390,480,350,300,280,320,370,420,500]],be=m(0),xe=m(0),Ve=m(0);function Me(s){Ze.forEach(i=>{(i[0]==="第一年"||i[0]==="第三年"||i[0]==="第五年")&&i.forEach((n,a)=>{a!==0&&(n>700?be.value++:n>500?xe.value++:Ve.value++)})});const e=be.value+xe.value+Ve.value,t=[be.value/e,xe.value/e,Ve.value/e];return q().setVisitorparam(t),t[s]}const He={toolbox:{show:!0,orient:"vertical",left:"10",top:"-5",feature:{},itemSize:25},legend:{left:"right",data:["第一年","第三年","第五年"],textStyle:{color:"#4c9bfd"}},tooltip:{trigger:"axis",axisPointer:{type:"shadow"},backgroundColor:"#115687",borderColor:"#ccc",borderWidth:1,padding:[5,10],textStyle:{color:"#fff",fontSize:12},extraCssText:"box-shadow: 0 0 10px rgba(0, 0, 0, 0.1);max-width: 200px; max-height: 90px;",formatter:function(s){let e='<div style="font-size: 16px; font-weight: bold;height: 30px; ">'+s[0].name+"</div>";return s.forEach(function(t,i){e+='<span style="display: inline-block; width: 10px; height: 10px; margin-right: 5px;font-size: 14px; border-radius: 50%; background-color: '+t.color+';"></span>'+t.seriesName+"："+t.value[i+1]+"<br>"}),e}},dataset:{source:Ze},xAxis:{type:"category",axisLabel:{color:"#4c9bfd"}},yAxis:{gridIndex:0,name:"客流量(人次)",nameTextStyle:{color:"#4c9bfd",fontSize:14},axisLabel:{color:"#4c9bfd"}},grid:{bottom:"10%"},series:[{type:"line",smooth:!0,seriesLayoutBy:"row",emphasis:{focus:"series"}},{type:"line",smooth:!0,seriesLayoutBy:"row",emphasis:{focus:"series"}},{type:"line",smooth:!0,seriesLayoutBy:"row",emphasis:{focus:"series"}},{type:"pie",center:["75%","25%"],radius:"28%",z:100,emphasis:{focus:"self"},data:[{name:"优",value:Me(0)},{name:"良",value:Me(1)},{name:"一般",value:Me(2)}]}]},De=xt();function as(){let s=[],e=new Date(De.year.value,De.month.value-1,De.day.value).getTime(),t=24*60*60*1e3;for(let n=0;n<5;n++){let a=new Date(e+(n-4)*t),u=a.getMonth()+1,r=a.getDate(),d=u+"-"+r;s.push(d)}const i=[1/5,3/5,1/5];return q().setEnvieonmentparam(i),s}const ns={tooltip:{trigger:"axis",axisPointer:{type:"shadow"},backgroundColor:"#115687",borderColor:"#ccc",borderWidth:1,padding:[5,10],textStyle:{color:"#fff",fontSize:12},extraCssText:"box-shadow: 0 0 10px rgba(0, 0, 0, 0.1);max-width: 200px; max-height: 50px;",formatter:function(s){let e='<div style="font-size: 16px; font-weight: bold;height: 30px; ">'+s[0].name+"</div>";return s.forEach(function(t){t.seriesIndex!==0&&(e+='<span style="display: inline-block; width: 10px; height: 10px; margin-right: 5px;font-size: 14px; border-radius: 50%; background-color: '+t.color+';"></span>'+t.seriesName+"："+t.value+"<br>")}),e}},legend:{left:"right",data:["环境分级"],textStyle:{color:"#4c9bfd"}},xAxis:[{type:"category",data:as(),axisPointer:{type:"shadow"},axisLabel:{color:"#4c9bfd"}}],yAxis:[{type:"value",name:"环境评估(级)",nameTextStyle:{color:"#4c9bfd",fontSize:14},interval:1,axisLabel:{color:"#4c9bfd"}}],grid:{bottom:20},series:[{name:"环境分级",type:"bar",data:[2,2,1,3,2]},{type:"pie",center:["75%","30%"],radius:"28%",z:100,emphasis:{focus:"self"},data:[{name:"优",value:1/5},{name:"良",value:3/5},{name:"一般",value:1/5}]},{name:"环境分级",type:"line",smooth:!0,lineStyle:{color:"#f7b851",width:2},data:[2,2,1,3,2]}]},Y=s=>(Dt("data-v-88728bf7"),s=s(),Ct(),s),os={class:"Container",ref:"ContainerRef"},rs={class:"Container-panel line"},ls=Y(()=>p("div",{class:"Container-panel-title"},[p("span",null,"设施评估")],-1)),ds=Y(()=>p("div",{class:"Container-panel-footer"},null,-1)),us={class:"Container-panel bar"},cs=Y(()=>p("div",{class:"Container-panel-title"},[p("span",null,"客流量评估")],-1)),hs=Y(()=>p("div",{class:"Container-panel-footer"},null,-1)),ps={class:"Container-panel pie"},ms=Y(()=>p("div",{class:"Container-panel-title"},[p("span",null,"环境评估")],-1)),gs=Y(()=>p("div",{class:"Container-panel-footer"},null,-1)),ys=re({__name:"buildingInfro",setup(s){const e=q(),t=m(null),i=m(null),n=m(null);return ke(()=>{let a=null;t.value&&(a=ue(t.value),he(a,is));let u=null;i.value&&(u=ue(i.value),He.toolbox.feature={myTool1:{show:!0,title:"限流评估",icon:"image://	https://cdn-icons-png.flaticon.com/512/998/998382.png",onclick:function(){e.showResult=!1,Mt({title:"限流评估参数",message:()=>A("div",{style:{display:"flex",flexDirection:"column"}},[A("div",{style:{display:"flex",flexDirection:"row",justifyContent:"space-evenly"}},[A("div",{style:{}},[A("label",{for:"switch1",style:{color:"#fff"}},"设施："),A(pe,{id:"switch1",modelValue:e.checked1,"onUpdate:modelValue":d=>e.checked1=d})]),A("div",{style:{}},[A("label",{for:"switch2",style:{color:"#fff"}},"客流量："),A(pe,{id:"switch2",disabled:!0,modelValue:e.checked2,"onUpdate:modelValue":d=>e.checked2=d})]),A("div",{},[A("label",{for:"switch3",style:{color:"#fff"}},"环境："),A(pe,{id:"switch3",modelValue:e.checked3,"onUpdate:modelValue":d=>e.checked3=d})])]),e.showResult?A(St,{icon:e.resultArr[e.result],title:e.resultTitle[e.resultArr[e.result]].title,subTitle:e.resultTitle[e.resultArr[e.result]].subTitle,style:{color:"#fff"}}):null]),confirmButtonText:"执行分析",closeOnClickModal:!1,beforeClose:(d,V,M)=>{d==="confirm"?(V.confirmButtonLoading=!0,V.confirmButtonText="执行中...",e.createResult(),console.log(e.result),setTimeout(()=>{V.confirmButtonLoading=!1,e.showResult=!0,e.changeDisabled(),V.confirmButtonText="分析成功"},300),setTimeout(()=>{M()},3e3)):M()}})}}},he(u,He));let r=null;n.value&&(r=ue(n.value),he(r,ns))}),(a,u)=>(F(),le("div",os,[p("div",rs,[ls,p("div",{class:"Container-panel-chart",ref_key:"chartBuildRef",ref:t},null,512),ds]),p("div",us,[cs,p("div",{class:"Container-panel-chart",ref_key:"chartVisitorRef",ref:i},null,512),hs]),p("div",ps,[ms,p("div",{class:"Container-panel-chart",ref_key:"chartEnvironmentRef",ref:n},null,512),gs])],512))}});const vs=Te(ys,[["__scopeId","data-v-88728bf7"]]);const _s={},ws={class:"video"};function fs(s,e){return F(),le("div",ws)}const bs=Te(_s,[["render",fs],["__scopeId","data-v-db1fb10d"]]);let N=class extends It{constructor(s){super(s),this.type="area-measurement",this.unit=null}set geometry(s){S(s)?this._set("geometry",null):(s.rings.length>1&&Ne.getLogger(this.declaredClass).warn("Measuring polygons with multiple rings is not supported."),this._set("geometry",s.clone()))}get requiredPropertiesForEditing(){if(h(this.geometry)&&this.geometry.rings.length===1){const s=this.geometry.rings[0];if(s.length<=2||!tt(s[0],s[s.length-1]))return[null]}return[this.geometry]}clear(){this.geometry=null}};o([l({type:["area-measurement"]})],N.prototype,"type",void 0),o([l({value:null,type:et})],N.prototype,"geometry",null),o([l({type:ae,value:null})],N.prototype,"unit",void 0),o([l({readOnly:!0})],N.prototype,"requiredPropertiesForEditing",null),N=o([j("esri.analysis.AreaMeasurementAnalysis")],N);const Xe=N;class xs{constructor(e,t=null){this.screenPoint=e,this.result=t}}class Vs{constructor(e,t){this.scenePoint=e,this.mapPoint=t}}class Ms{constructor(e){this.vertexManipulators=[],this._destroyed=!1,this._isManipulatorsOwner=!0,this._visible=!0,this._laserLine=null,this._cursorManipulator=null,this._listenerHandles=null,this._tempHandlePosition=Ee(),this._defaultStyle={laserLineGlowColor:ce.toUnitRGB(Re()),laserLineGlowWidth:8,laserLineGlowFalloff:8,laserLineInnerColor:ce.toUnitRGB(Rt()),laserLineInnerWidth:1,laserLineGlobalAlpha:.75,laserLineEnabled:!0,handleColor:ce.toUnitRGB(Re()),handleOpacity:.5,handleRadius:5,handleRadiusHovered:10,handleRadiusMouse:10,handleRadiusTouch:25};const{analysisViewData:t,manipulators:i,toolState:n,view:a,visible:u}=e;this._analysisViewData=t,this._toolState=n,i!=null?(this._manipulators=i,this._isManipulatorsOwner=!1):this._manipulators=new Ye,this._view=a;const r=this._style={...this._defaultStyle,...st(e.style)};this._intersector=it(a.state.viewingMode),this._intersector.options.store=at.MIN;const d=ze(a,r.handleColor,r.handleOpacity);d.available=!1,d.radius=r.handleRadius,d.interactive=!1,this._manipulators.add(d),this._cursorManipulator=d,this._laserLine=new Zt({view:a,attached:!0,style:{glowColor:r.laserLineGlowColor,glowWidth:r.laserLineGlowWidth,glowFalloff:r.laserLineGlowFalloff,innerColor:r.laserLineInnerColor,innerWidth:r.laserLineInnerWidth,globalAlpha:r.laserLineGlobalAlpha}}),this._updateVisibility(u||!0)}destroy(){this._listenerHandles=H(this._listenerHandles),this._isManipulatorsOwner?this._manipulators=H(this._manipulators):this._manipulators=null,this._laserLine=H(this._laserLine),this._destroyed=!0}get destroyed(){return this._destroyed}get visible(){return this._visible}set visible(e){e?this.show():this.hide()}get testData(){const e=this._laserLine.testData;return{laserLineRenderer:h(e)?{heightManifoldEnabled:e.heightManifoldEnabled,heightManifoldTarget:e.heightManifoldTarget,pointDistanceEnabled:e.pointDistanceEnabled,pointDistanceOrigin:e.pointDistanceOrigin,pointDistanceTarget:e.pointDistanceTarget,lineVerticalPlaneEnabled:e.lineVerticalPlaneEnabled}:{heightManifoldEnabled:!1,heightManifoldTarget:null,pointDistanceEnabled:!1,pointDistanceOrigin:null,pointDistanceTarget:null,lineVerticalPlaneEnabled:!1}}}show(){this._setVisibility(!0)}hide(){this._setVisibility(!1)}_setVisibility(e){this._destroyed||this._visible===e||this._updateVisibility(e)}_updateVisibility(e){this._visible=e,this._laserLine.visible=e,e?(this._initializeListeners(),this._updateAll()):(this._destroyListeners(),this.vertexManipulators.forEach(t=>this._removeVertexManipulator(t)),this.vertexManipulators=[],this._view.cursor=null)}vertexHandleAt(e,t){const i=this._manipulators.intersect(e,t);return h(i)?i.metadata:null}pick(e){const t=this._view.spatialReference,i=nt(e.screenPoint);this._view.sceneIntersectionHelper.intersectToolIntersectorScreen(i,this._intersector);const n=this._intersector.results.min,a=Ee();if(!n.getIntersectionPoint(a))return null;const u=this._view.renderCoordsHelper.fromRenderCoords(a,t);return S(u)?null:new Vs(a,u)}_updateAll(){this._visible&&(this._updateVertexManipulators(),this._updateLaserLine())}_createVertexManipulator(){const e=ze(this._view,this._style.handleColor,this._style.handleOpacity);return e.radius=this._style.handleRadius,this._manipulators.add(e),e}_removeVertexManipulator(e){this._manipulators.remove(e)}_updateVertexManipulators(){const{viewData:e}=this._analysisViewData,t=this._analysisViewData.path?this._analysisViewData.path.vertices:[],i=this.vertexManipulators;Ds(i,t.length,()=>this._createVertexManipulator(),n=>this._removeVertexManipulator(n)),i.forEach((n,a)=>{n.metadata=t[a],n.renderLocation=e.positionsRenderCoords[a],n.cursor=a===0&&this._toolState.polygonState==="drawing"?"crosshair":null}),this._toolState.polygonState==="drawing"&&h(this._analysisViewData.cursorPoint)?(this._cursorManipulator.available=!0,this._cursorManipulator.location=this._analysisViewData.cursorPoint):this._cursorManipulator.available=!1}_getFocusPoint(){const{lastDraggedVertex:e}=this._analysisViewData;switch(this._toolState.polygonState){case"drawing":return h(this._analysisViewData.cursorPoint)?this._analysisViewData.cursorPoint:h(e)?this._analysisViewData.path.getVertexPositionAsPoint(e):Ce(this._analysisViewData.path.lastPoint);case"editing":return h(e)?this._analysisViewData.path.getVertexPositionAsPoint(e):null;default:return this._analysisViewData.cursorPoint}}_updateLaserLine(){const e=this._style.laserLineEnabled&&this._toolState.polygonState!=="measured"&&this._toolState.active,t=this._getFocusPoint();if(e&&h(t)){const i=this._tempHandlePosition;this._view.renderCoordsHelper.toRenderCoords(t,i),this._laserLine.heightManifoldTarget=i}else this._laserLine.heightManifoldTarget=null}_initializeListeners(){this._listenerHandles=new oe,this._listenerHandles.add([R(()=>this._toolState.polygonState,()=>this._updateLaserLine()),R(()=>this._analysisViewData.viewData,()=>this._updateAll(),We),R(()=>({lastDraggedVertex:this._analysisViewData.lastDraggedVertex,cursorPoint:this._analysisViewData.cursorPoint}),()=>this._updateLaserLine()),R(()=>this._toolState.active,()=>this._updateAll())])}_destroyListeners(){this._listenerHandles=H(this._listenerHandles)}}function Ds(s,e,t,i){for(;s.length<e;)s.push(t());if(i)for(;s.length>e;)i(s.pop());else s.length=e}let T=class extends Yt{constructor(s){super(s),this._handles=new oe,this._updatingHandles=new ot,this.polygonState="initial",this.manipulators=new Ye,this._getSnappingContext=zt(e=>new Nt({elevationInfo:{mode:"absolute-height",offset:0},pointer:e,editGeometryOperations:new Xt(new Jt("point",Qt(!0,!1,this.view.spatialReference))),visualizer:new Wt}))}initialize(){const{view:s,analysisViewData:e,manipulators:t,visible:i}=this;this.measurementView=new Ms({view:s,analysisViewData:e,toolState:this,manipulators:t,visible:i});const n=Bt(s);this._snappingManagerResult=n,this._handles.add(n),this._snappingOperation=new Ht({view:s}),this._updatingHandles.add(()=>this.stagedPoint,a=>{this.analysisViewData.cursorPoint=h(a)?te(a,new Ae):null},ee),Ft(this,()=>{const a=rt(this.view.inputManager.latestPointerType,"mouse"),u=this._getSnappingContext(a);this._updatingHandles.addPromise(Se(this._snappingOperation.resnap(this._snappingManager,u)))}),this._setupManipulators(),this._handles.add(R(()=>this.state,a=>{a==="measured"&&this.finishToolCreation()},ee))}destroy(){this.measurementView.destroy(),this._set("measurementView",null),this._handles=H(this._handles),this._updatingHandles=H(this._updatingHandles)}get _snappingManager(){return this._snappingManagerResult.snappingManager}get state(){return this.analysisViewData.path.numVertices===0?"ready":this.analysisViewData.validMeasurement&&this.polygonState!=="editing"?"measured":"measuring"}get cursor(){return this.state==="ready"||this.polygonState==="drawing"?"crosshair":null}get updating(){return this._updatingHandles.updating||this._snappingManager.updating}get stagedPoint(){return this._snappingOperation.stagedPoint}set stagedPoint(s){this._snappingOperation.stagedPoint=s}get snappingOptions(){return this._snappingManager.options}finishMeasurement(){const{path:s}=this.analysisViewData;s.numVertices<3?(s.clear(),this.polygonState="initial"):(s.close(),this.polygonState="measured"),this._resetSnappingState()}onShow(){this.measurementView.show()}onHide(){this.measurementView.hide()}onDeactivate(){this._resetSnappingState()}onInputEvent(s){switch(s.type){case"immediate-double-click":this._handleImmediateDoubleClick(s);break;case"immediate-click":this._handleImmediateClick(s);break;case"pointer-move":this._handlePointerMove(s);break;case"drag":this._handleDrag(s);break;case"key-down":this._handleKeyDown(s)}}_setupManipulators(){const s=t=>t.events.on("grab-changed",()=>{if(this.analysisViewData.validMeasurement){const i=this.manipulators.some(n=>n.manipulator.grabbing);this.polygonState=i?"editing":"measured"}}),e=t=>{this._handles.add([Kt(t,(i,n,a,u)=>{const r=qt(i),d=i.metadata,V=this._snappingManager,M=this._getSnappingContext(u),_=this._updatingHandles,{snappingStep:C,cancelSnapping:b}=Gt({snappingManager:V,snappingContext:M,updatingHandles:_});a=a.next(r).next(k=>(this.analysisViewData.lastDraggedVertex=null,this.analysisViewData.path.setVertexPosition(d,E),i.location=E,k)).next(b),n.next(r).next(jt(this.view)).next(...C).next(k=>{i.location=k.mapEnd,this.analysisViewData.lastDraggedVertex=k.action==="end"?null:d,this.analysisViewData.path.setVertexPosition(d,te(k.mapEnd))});const E=te(this.analysisViewData.path.getVertexPositionAsPoint(d))}),s(t)],t)};this.manipulators.forEach(({manipulator:t})=>{e(t)}),this._handles.add([this.manipulators.on("after-add",({item:{manipulator:t}})=>{e(t)}),this.manipulators.on("after-remove",({item:{manipulator:t}})=>this._handles.remove(t))])}_handleImmediateDoubleClick(s){Ue(s)&&(this.polygonState==="drawing"&&this.finishMeasurement(),s.stopPropagation())}_handleDrag(s){this.polygonState==="editing"&&s.stopPropagation()}_handleImmediateClick(s){if(!Ue(s))return;const e=Oe(s),{pointerType:t}=s;if(this.active)switch(this.polygonState){case"initial":if(this._addVertexAt(e,t))return this.stagedPoint=null,this.polygonState="drawing",void s.stopPropagation();break;case"drawing":{const i=this.measurementView.vertexHandleAt(e,t);if(S(i)){if(this._addVertexAt(e,t))return this.stagedPoint=null,void s.stopPropagation()}else i.index===0&&(this.finishMeasurement(),s.stopPropagation());break}}s.pointerType==="mouse"&&this._hoverAt(e)}_handlePointerMove(s){if(s.pointerType==="mouse"){const e=Oe(s);this._hoverAt(e)}}_handleKeyDown(s){s.key==="Enter"&&this.polygonState==="drawing"&&(this.finishMeasurement(),s.stopPropagation())}_hoverAt(s){const{polygonState:e}=this;if(this.active&&(e==="initial"||e==="drawing")){const t=this._pick(s);if(h(t)&&h(t.mapPoint)){const i=this._getSnappingContext("mouse");this._updatingHandles.addPromise(Se(this._snappingOperation.snap({point:t.mapPoint},this._snappingManager,i)))}}else this.stagedPoint=null}_addVertexAt(s,e){const t=this._pick(s);if(h(t)&&h(t.mapPoint)){const{mapPoint:i}=t,n=this._getSnappingContext(e),a=this._snappingOperation.update({point:i},this._snappingManager,n),u=te(a,new Ae);return this.analysisViewData.path.add(u),!0}return!1}_pick(s){const e=new xs(s);return this.measurementView.pick(e)}_resetSnappingState(){this._snappingManager.doneSnapping(),this._snappingOperation.abort(),this._snappingOperation.stagedPoint=null}get test(){return{snappingManager:this._snappingManager}}};o([l({readOnly:!0})],T.prototype,"state",null),o([l()],T.prototype,"polygonState",void 0),o([l({readOnly:!0})],T.prototype,"cursor",null),o([l()],T.prototype,"measurementView",void 0),o([l({constructOnly:!0})],T.prototype,"view",void 0),o([l({constructOnly:!0})],T.prototype,"analysis",void 0),o([l({constructOnly:!0})],T.prototype,"analysisViewData",void 0),o([l({readOnly:!0})],T.prototype,"manipulators",void 0),o([l()],T.prototype,"updating",null),o([l()],T.prototype,"stagedPoint",null),o([l()],T.prototype,"snappingOptions",null),T=o([j("esri.views.3d.interactive.measurementTools.areaMeasurement3D.AreaMeasurement3DTool")],T);const Cs=T;let z=class extends lt{constructor(e){super(e),this.tool=null,this._baseHandles=new oe,this._loggedUnsupportedErrorOnce=!1,this.logger=Ne.getLogger(this.declaredClass),e&&e.visible!=null&&(this.visible=e.visible)}initialize(){this._baseHandles.add(R(()=>({ready:h(this.view)&&this.view.ready,supported:this.supported}),({ready:e,supported:t})=>{!e||t||this._loggedUnsupportedErrorOnce||(this.logError(this.unsupportedErrorMessage),this._loggedUnsupportedErrorOnce=!0)},ee))}destroy(){this.removeTool(),this.view=null,this._baseHandles=H(this._baseHandles)}get active(){return h(this.tool)&&this.tool.active}get disabled(){return S(this.view)||!this.view.ready||!this.supported}get supported(){return S(this.view)||this.view.type===this.supportedViewType}get view(){return this._get("view")}set view(e){if(e===this.view)return;this.removeTool(),this._set("view",e);const t="tools";this._baseHandles.remove(t),S(e)||this._baseHandles.add(e.tools.on("after-remove",i=>{i.item===this.tool&&this._set("tool",null)}),t)}set visible(e){this._set("visible",e),h(this.tool)&&(this.tool.visible=e)}createTool(e={interactive:!1}){if(this.removeTool(),S(this.view)||!this.view.ready||!this.supported)return;const t=this.constructTool();t.created?(this._set("tool",t),this.view.tools.add(t)):e.interactive?(this._set("tool",t),this.view.addAndActivateTool(t),dt(()=>t.created,()=>{t.active&&h(this.view)&&(this.view.activeTool=null)},{initial:!0,once:!0})):t.destroy()}removeTool(){const e=this.tool;if(S(e))return;const t=Ge(this.view,i=>i.tools);h(t)?t.remove(e):e.destroy(),this._set("tool",null)}logError(...e){this.logger.error(...e)}};o([l({constructOnly:!0})],z.prototype,"tool",void 0),o([l()],z.prototype,"active",null),o([l()],z.prototype,"disabled",null),o([l()],z.prototype,"supported",null),o([l({value:null})],z.prototype,"view",null),o([l({type:Boolean,value:!0})],z.prototype,"visible",null),z=o([j("esri.widgets.support.InteractiveToolViewModel")],z);var G;(function(s){s[s.PENDING=0]="PENDING",s[s.WAIT_FOR_VIEW_READY=1]="WAIT_FOR_VIEW_READY",s[s.RUNNING=2]="RUNNING"})(G||(G={}));let P=class extends z{constructor(e={}){super(e),this.analysisView=null,this._reconnectViewTask=null,this._analysisBaseHandles=new oe,this._parentChangeFromReconnect=!1,this._startUserOperation=null;const t=e==null?void 0:e.analysis;h(t)?this.analysis=t:(this._set("analysis",this.constructAnalysis()),this._set("isAnalysisOwner",!0))}normalizeCtorArgs(e){const{analysis:t,...i}=e;return i}initialize(){this._analysisBaseHandles.add([R(()=>Ge(this.analysis,({parent:e})=>e),e=>{this._parentChangeFromReconnect||e===this.view||this._set("isAnalysisOwner",!1);const t=!this._parentChangeFromReconnect;this._parentChangeFromReconnect=!1,t&&this._scheduleViewReconnect()},We),R(()=>({view:this.view,ready:h(this.view)&&this.view.ready,supported:this.supported}),({view:e},t)=>{const i=t==null?void 0:t.view;e!==i&&(this._startUserOperation=W(this._startUserOperation),this._disconnectFromView(i)),this._scheduleViewReconnect()},ee),R(()=>this.analysis.isEditable,(e,t)=>{S(this.analysisView)||(e&&!t&&S(this.tool)?this.createTool():!e&&t&&h(this.tool)&&!this.tool.active&&this.removeTool())})])}destroy(){this._analysisBaseHandles=H(this._analysisBaseHandles),this._reconnectViewTask=W(this._reconnectViewTask),this._startUserOperation=W(this._startUserOperation),h(this.analysisView)&&(this.analysisView.visible=void 0),this._disconnectFromView(this.view),h(this.analysis)&&this.isAnalysisOwner&&(this.analysis.destroy(),this._set("analysis",null))}set analysis(e){e!==this._get("analysis")&&(this._startUserOperation=W(this._startUserOperation),this._disconnectFromView(this.view),this._setExternalAnalysis(e),this._scheduleViewReconnect())}get ready(){return h(this.analysisView)&&!this.connectingToView}get connectingToView(){return h(this._reconnectViewTask)}get isAnalysisOwner(){return this._get("isAnalysisOwner")}set visible(e){this._set("visible",e),h(this.analysisView)&&(this.analysisView.visible=e)}async start(){this.clear();const e={task:null,abort:null,state:G.PENDING},t=Pe(async i=>{e.state=G.WAIT_FOR_VIEW_READY,await ut(()=>this.ready,i),e.state=G.RUNNING,this.createTool({interactive:!0})});return e.task=t,e.abort=()=>t.abort(),this._startUserOperation=e,t.promise}clear(){this._startUserOperation=W(this._startUserOperation),this.removeTool(),this.analysis.clear()}onConnectToAnalysisView(e){}onDisconnectFromAnalysisView(){}_scheduleViewReconnect(){this._reconnectViewTask=W(this._reconnectViewTask);const e=Pe(async t=>{try{await this._reconnectView(t)}catch(i){if(ct(t),!je(i))return void this.logger.warn("Failed to use analysis in view model",i);throw i}finally{e===this._reconnectViewTask&&(this._reconnectViewTask=null)}});this._reconnectViewTask=e}async _reconnectView(e){const{view:t}=this,i=h(t)&&t.ready&&this.supported,n=this.analysis;if(this._startUserOperation=Fe(this._startUserOperation),this._disconnectFromView(t),i&&!S(t)&&!S(n)){if(this.isAnalysisOwner){if(h(n.parent))return void this.logError("expected owned analysis to have null parent when connecting to view");this._parentChangeFromReconnect=!0,t.analyses.add(n)}this.analysisView=await t.whenAnalysisView(n),ht(e)?this._startUserOperation=Fe(this._startUserOperation):(this.analysisView.visible=this.visible,this.onConnectToAnalysisView(this.analysisView),this.createTool())}}_disconnectFromView(e){this.removeTool(),h(e)&&this.isAnalysisOwner&&(this._parentChangeFromReconnect=!0,e.analyses.remove(this.analysis),this.analysis.clear()),this.analysisView=null,this.onDisconnectFromAnalysisView()}_setExternalAnalysis(e){h(this.analysisView)&&!this.isAnalysisOwner&&(this.analysisView.visible=!0),this.analysisView=null,this._set("isAnalysisOwner",!1),this._set("analysis",e),this._parentChangeFromReconnect=!1}get testInfo(){return{analysisView:this.analysisView}}};function Fe(s){return h(s)&&s.state>=G.RUNNING?(s.abort(),null):s}o([l({nonNullable:!0})],P.prototype,"analysis",null),o([l()],P.prototype,"analysisView",void 0),o([l()],P.prototype,"ready",null),o([l()],P.prototype,"connectingToView",null),o([l({readOnly:!0})],P.prototype,"isAnalysisOwner",null),o([l({type:Boolean,value:!0})],P.prototype,"visible",null),o([l()],P.prototype,"_reconnectViewTask",void 0),P=o([j("esri.widgets.support.InteractiveAnalysisViewModel")],P);let L=class extends P{constructor(e){super(e),this.analysis=null,this.supportedViewType="3d",this.unsupportedErrorMessage="AreaMeasurement3DViewModel is only supported in 3D views.",this._userUnitOptions=null,this._userUnit=null}initialize(){this.addHandles(R(()=>({analysis:this.analysis,unit:this.unit}),({analysis:e,unit:t})=>{h(e)&&(e.unit=t)},ee))}get state(){return this.disabled||!this.ready?"disabled":S(this.tool)?"ready":this.tool.state}get measurement(){if(S(this.tool)||this.disabled||this.tool.destroyed)return null;const{analysisView:e}=this;if(S(e))return null;const t=e.analysisVisualization,i=t.viewData,n=i.measurementData,a=e.validMeasurement,u=i.mode==="euclidean",r=(u?n.intersectingSegments:n.geodesicIntersectingSegments).size===0,d=r?a?"available":"unavailable":"invalid";return{mode:u?"euclidean":"geodesic",area:{text:r&&a?t.areaLabel:null,state:d},perimeterLength:{text:r&&a?t.perimeterLengthLabel:null,state:d}}}set unitOptions(e){this._userUnitOptions=e,this._set("unitOptions",this._filteredOrAllUnits(this._userUnitOptions))}get unitOptions(){return this._filteredOrAllUnits(this._userUnitOptions)}set unit(e){this._userUnit=e?this._findSelectableUnit(e,this._userUnit):null}get unit(){return h(this._userUnit)?(this._userUnit=this._findSelectableUnit(this._userUnit,this.defaultUnit),this._userUnit):this._findSelectableUnit(this.defaultUnit)}constructAnalysis(){return new Xe}constructTool(){return new Cs({view:Ce(this.view),analysis:this.analysis,analysisViewData:Ce(this.analysisView),visible:this.visible})}_findSelectableUnit(e,t){const{unitOptions:i}=this;return i.includes(e)?e:h(t)?this._findSelectableUnit(t):i[0]}_filteredOrAllUnits(e){if(S(e))return ae.slice();const t=e.filter(i=>ae.includes(i));return t.length===0?ae.slice():t}};o([l({type:Xe})],L.prototype,"analysis",void 0),o([l({readOnly:!0})],L.prototype,"state",null),o([l({readOnly:!0})],L.prototype,"measurement",null),o([l()],L.prototype,"unitOptions",null),o([l()],L.prototype,"unit",null),o([l(Ut)],L.prototype,"defaultUnit",void 0),o([l()],L.prototype,"_userUnit",void 0),L=o([j("esri.widgets.AreaMeasurement3D.AreaMeasurement3DViewModel")],L);const Je=L,I="esri-area-measurement-3d",Q=`${I}__measurement`,ie=`${I}__units`,y={buttonDisabled:"esri-button--disabled",base:`${I} esri-widget esri-widget--panel`,container:`${I}__container`,hint:`${I}__hint`,hintText:`${I}__hint-text`,panelError:`${I}__panel--error`,measurement:Q,measurementItem:`${Q}-item`,measurementItemDisabled:`${Q}-item--disabled`,measurementItemTitle:`${Q}-item-title`,measurementItemValue:`${Q}-item-value`,settings:`${I}__settings`,units:ie,unitsLabel:`${ie}-label`,unitsSelect:`${ie}-select esri-select`,unitsSelectWrapper:`${ie}-select-wrapper`,actionSection:`${I}__actions`,newMeasurementButton:`${I}__clear-button esri-button esri-button--primary`,widgetIcon:"esri-icon-measure-area"};let D=class extends pt{constructor(s,e){super(s,e),this.iconClass=y.widgetIcon,this.viewModel=new Je}get view(){return this.viewModel.view}set view(s){this.viewModel.view=s}get visible(){return this.viewModel.visible}set visible(s){this.viewModel.visible=s}get active(){return this.viewModel.active}get analysis(){return this.viewModel.analysis}set analysis(s){this.viewModel.analysis=s}get label(){var s;return((s=this.messages)==null?void 0:s.widgetLabel)??""}set label(s){this._overrideIfSome("label",s)}get unitOptions(){return this.viewModel.unitOptions}set unitOptions(s){this.viewModel.unitOptions=s}get unit(){return this.viewModel.unit}set unit(s){this.viewModel.unit=s}render(){const{messages:s,messagesUnits:e}=this,{supported:t,active:i,measurement:n,state:a,unit:u}=this.viewModel,r=a==="disabled",d=a==="measuring"||a==="measured",V=i&&a==="ready"?f("section",{key:"esri-area-measurement-3d__hint",class:y.hint},f("p",{class:y.hintText},s.hint),f("p",{class:y.hintText},s.snappingDisablePromptAlternate)):null,M=t?null:f("section",{key:"esri-area-measurement-3d__unsupported",class:y.panelError},f("p",null,s.unsupported)),_=(c,w,O)=>{switch(w.state){case"available":return f("div",{key:`${O}-enabled`,class:y.measurementItem},f("span",{class:y.measurementItemTitle},c),f("span",{"aria-live":"polite",class:y.measurementItemValue},w.text));case"unavailable":return f("div",{key:`${O}-disabled`,class:this.classes(y.measurementItem,y.measurementItemDisabled)},f("span",{class:y.measurementItemTitle},c));case"invalid":return f("div",{key:`${O}-enabled`,class:y.measurementItem},f("span",{class:y.measurementItemTitle},c),f("span",{class:y.measurementItemValue},s.notApplicable))}},C=d&&n?f("section",{key:"esri-area-measurement-3d__measurement",class:y.measurement},_(s.area,n.area,"area"),_(s.perimeterLength,n.perimeterLength,"perimeter-length")):null,b=`${this.id}__units`,E=f("label",{class:y.unitsLabel,for:b},s.unit),k=f("div",{class:y.unitsSelectWrapper},f("select",{class:y.unitsSelect,id:b,onchange:this._changeUnit,bind:this,value:u},this.viewModel.unitOptions.map(c=>{var w;return f("option",{key:c,value:c},mt(c)?e.systems[c]:(w=e.units[c])==null?void 0:w.pluralCapitalized)}))),K=d?f("section",{key:"esri-area-measurement-3d__units",class:y.units},E,k):null,Z=d?f("div",{key:"settings",class:y.settings},K):null,$=!t||i&&!d?null:f("div",{class:y.actionSection},f("button",{bind:this,class:this.classes(y.newMeasurementButton,r&&y.buttonDisabled),disabled:r,onclick:this._newMeasurement,type:"button"},s.newMeasurement)),U=this.visible?f("div",{class:y.container},M,V,Z,C,$):null;return f("div",{"aria-label":s.widgetLabel,key:this,class:y.base,role:"presentation"},U)}_newMeasurement(){Se(this.viewModel.start())}_changeUnit(s){const e=s.target,t=e.options[e.selectedIndex];t&&(this.unit=t.value)}};o([l()],D.prototype,"view",null),o([l()],D.prototype,"visible",null),o([l()],D.prototype,"active",null),o([l({constructOnly:!0,nonNullable:!0})],D.prototype,"analysis",null),o([l()],D.prototype,"iconClass",void 0),o([l()],D.prototype,"label",null),o([l(),Le("esri/widgets/AreaMeasurement3D/t9n/AreaMeasurement3D")],D.prototype,"messages",void 0),o([l(),Le("esri/core/t9n/Units")],D.prototype,"messagesUnits",void 0),o([l()],D.prototype,"uiStrings",void 0),o([l({type:Je})],D.prototype,"viewModel",void 0),o([l()],D.prototype,"unitOptions",null),o([l()],D.prototype,"unit",null),o([Ie()],D.prototype,"_newMeasurement",null),o([Ie()],D.prototype,"_changeUnit",null),D=o([j("esri.widgets.AreaMeasurement3D")],D);const Ss=D,$s=`@charset "UTF-8";.area-card{display:flex;flex-direction:column;position:fixed;left:35%;bottom:8%;width:30%;height:auto;border-radius:6px;background-image:linear-gradient(-90deg,#182940 0%,#115687 100%);pointer-events:auto;border:0px solid var(--el-card-border-color)}.area-card__header{display:flex;justify-content:space-between;align-items:center;color:#fff;font-size:1.6rem;font-weight:700;font-style:italic}.area-card__header__button{background-color:#182940}.area-card__header__button:hover{background-color:#fff}.el-table{--el-table-border-color: var(--el-border-color-lighter);--el-table-border: 1px solid var(--el-table-border-color);--el-table-text-color: #fff;--el-table-header-text-color: #fff;--el-table-row-hover-bg-color: #115687;--el-table-current-row-bg-color: var(--el-color-primary-light-9);--el-table-header-bg-color: #115687;--el-table-fixed-box-shadow: var(--el-box-shadow-light);--el-table-bg-color: #fff;--el-table-tr-bg-color: #ffffff00;--el-table-expanded-cell-bg-color: var(--el-fill-color-blank);--el-table-fixed-left-column: inset 10px 0 10px -10px rgba(0, 0, 0, .15);--el-table-fixed-right-column: inset -10px 0 10px -10px rgba(0, 0, 0, .15)}.el-table__body-wrapper tr td.el-table-fixed-column--right,.el-table__body-wrapper tr td.el-table-fixed-column--left{background-color:#115687}.el-rate__text{color:#fff}
`,ks={class:"area-card__header"},Ts=p("span",null,"面积测量",-1),Es={class:"area-card__content__tag",style:{display:"flex","align-items":"center","padding-top":"10px"}},As=re({__name:"areaInfro",setup(s){const e=m(null);let t=null,i=!1;const n=m(!0),a=()=>{let w=$e().getView();i=!i,u(i,w)};function u(c,w){switch(c){case!0:t=new Ss({view:w}),t.viewModel.start().catch(O=>{if(!je(O))throw O}),n.value=!1;break;case!1:t&&(t.destroy(),t=null,n.value=!0);break}}const r=q(),d=m(r.result>1?1:r.result===1?r.result+1:3),V=m(r.resultArr[r.result]),M=$t([{name:"开发区",switchValue:!1,area:"0m²",perimeter:"0m",areaindex:"0.0%"},{name:"未开发区",switchValue:!1,area:"0m²",perimeter:"0m",areaindex:"0.0%"}]),_=m(0),C=m(0),b=m(0),E=m(0);function k(c){let w=c.replace(/,/g,"");return/^[0-9]+(\.[0-9]+)?\s*[a-zA-Z²]+$/.test(w)&&(w=w.replace(/[a-zA-Z²]+$/,"")),parseFloat(w)}const K=c=>{t!=null&&t.viewModel.measurement.area.text&&(c.name==="开发区"?(_.value+=k(t==null?void 0:t.viewModel.measurement.area.text),c.area=_.value.toFixed(2)+"m²",C.value+=k(t==null?void 0:t.viewModel.measurement.perimeterLength.text),c.perimeter=C.value.toFixed(2)+"m"):(b.value+=k(t==null?void 0:t.viewModel.measurement.area.text),c.area=b.value.toFixed(2)+"m²",E.value+=k(t==null?void 0:t.viewModel.measurement.perimeterLength.text),c.perimeter=E.value.toFixed(2)+"m"))},Z=c=>{d.value=r.result>1?1:r.result===1?r.result+1:3,V.value=r.resultArr[r.result],(c.name="开发区")?(_.value=0,c.area="0m²",C.value=0,c.perimeter="0m",c.areaindex="0.0%"):(b.value=0,c.area="0m²",E.value=0,c.perimeter="0m",c.areaindex="0.0%")},$=()=>{if(console.log(_.value,b.value),_.value===0||b.value===0)alert("请先记录面积");else{let c=_.value+b.value,w=_.value/c;if(M[0].areaindex=(w*100).toFixed(2)+"%",M[1].areaindex=((1-w)*100).toFixed(2)+"%",w<=.5){if(d.value===3)return;d.value++,V.value=r.resultArr[d.value===3?0:d.value===2?1:2]}else return}};qe(()=>{t&&(t.destroy(),t=null)});const U=document.createElement("style");return U.setAttribute("lang","scss"),U.innerHTML=$s,document.head.appendChild(U),(c,w)=>(F(),ne(g(Ot),{class:"area-card","body-style":{height:"80%"}},{header:x(()=>[p("div",ks,[Ts,v(g(B),{onClick:a,id:"areaButton",class:"area-card__header__button"},{default:x(()=>[v(g(kt),{src:"	https://cdn-icons-png.flaticon.com/512/3696/3696467.png",fit:"cover",style:{width:"30 px",height:"30px"}})]),_:1})])]),default:x(()=>[p("div",{class:"area-card__content",ref_key:"areaRef",ref:e},[v(g(Tt),{data:M,border:!0,style:{width:"100%","background-image":"linear-gradient(-90deg, #182940 0%, #115687 100%)"}},{default:x(()=>[v(g(X),{prop:"name",label:"参数",width:"120"}),v(g(X),{prop:"area",label:"面积",width:"120"}),v(g(X),{prop:"perimeter",label:"周长",width:"120"}),v(g(X),{prop:"areaindex",label:"面积占比",width:"120"}),v(g(X),{fixed:"right",label:"选择项",width:"100"},{default:x(({row:O})=>[v(g(B),{link:"",type:"primary",onClick:Qe=>K(O),disabled:n.value},{default:x(()=>[se("记录")]),_:2},1032,["onClick","disabled"]),v(g(B),{link:"",type:"primary",onClick:Qe=>Z(O),disabled:n.value},{default:x(()=>[se("消除")]),_:2},1032,["onClick","disabled"])]),_:1})]),_:1},8,["data"]),p("div",Es,[v(g(Et),{class:"ml-2",type:g(V)},{default:x(()=>[se("开发评估")]),_:1},8,["type"]),v(g(At),{modelValue:d.value,"onUpdate:modelValue":w[0]||(w[0]=O=>d.value=O),max:3,texts:["差","良","优"],"show-text":"",style:{"margin-left":"8px"},disabled:!0},null,8,["modelValue"]),v(g(B),{type:"primary",size:"small",onClick:$,style:{position:"absolute",right:"5%"}},{default:x(()=>[se("占比评估分析")]),_:1})])],512)]),_:1}))}}),Os=`.widget3d-drawbutton{position:absolute;top:50%;left:0;pointer-events:auto;height:auto;width:auto;background-image:linear-gradient(-90deg,#182940 0%,#184f75 100%);color:#e2f1fb}.widget3d-drawer{pointer-events:auto;background-image:linear-gradient(-90deg,#182940 0%,#184f75 100%);border-radius:5px}.widget3d-closebutton,.widget3d-visualization,.widget3d-monitor,.widget3d-area{height:auto;width:auto;background-image:linear-gradient(-90deg,#182940 0%,#184f75 100%);color:#e2f1fb}.el-drawer.ltr,.el-drawer.rtl{height:auto;top:42%;bottom:auto;right:auto;left:0%;pointer-events:auto}.el-drawer__body{display:flex;flex-direction:column;padding:0;overflow:hidden}.el-button+.el-button{margin-left:0}.el-message-box{height:auto;background-image:linear-gradient(-90deg,#182940 0%,#184f75 100%)}.el-message-box__title,.el-result__title p{color:#e2f1fb}.el-result__subtitle p{color:#1eb3ca}
`,Ps=p("svg",{viewBox:"0 0 1024 1024",xmlns:"http://www.w3.org/2000/svg","data-v-ea893728":""},[p("path",{fill:"currentColor",d:"M452.864 149.312a29.12 29.12 0 0 1 41.728.064L826.24 489.664a32 32 0 0 1 0 44.672L494.592 874.624a29.12 29.12 0 0 1-41.728 0 30.592 30.592 0 0 1 0-42.752L764.736 512 452.864 192a30.592 30.592 0 0 1 0-42.688zm-256 0a29.12 29.12 0 0 1 41.728.064L570.24 489.664a32 32 0 0 1 0 44.672L238.592 874.624a29.12 29.12 0 0 1-41.728 0 30.592 30.592 0 0 1 0-42.752L508.736 512 196.864 192a30.592 30.592 0 0 1 0-42.688z"})],-1),Ls=p("svg",{viewBox:"0 0 1024 1024",xmlns:"http://www.w3.org/2000/svg","data-v-ea893728":""},[p("path",{fill:"currentColor",d:"M529.408 149.376a29.12 29.12 0 0 1 41.728 0 30.592 30.592 0 0 1 0 42.688L259.264 511.936l311.872 319.936a30.592 30.592 0 0 1-.512 43.264 29.12 29.12 0 0 1-41.216-.512L197.76 534.272a32 32 0 0 1 0-44.672l331.648-340.224zm256 0a29.12 29.12 0 0 1 41.728 0 30.592 30.592 0 0 1 0 42.688L515.264 511.936l311.872 319.936a30.592 30.592 0 0 1-.512 43.264 29.12 29.12 0 0 1-41.216-.512L453.76 534.272a32 32 0 0 1 0-44.672l331.648-340.224z"})],-1),Is=p("div",{style:{height:"30px"}},null,-1),Rs=p("svg",{viewBox:"0 0 1024 1024",xmlns:"http://www.w3.org/2000/svg","data-v-ea893728":""},[p("path",{fill:"currentColor",d:"M359.168 768H160a32 32 0 0 1-32-32V192H64a32 32 0 0 1 0-64h896a32 32 0 1 1 0 64h-64v544a32 32 0 0 1-32 32H665.216l110.848 192h-73.856L591.36 768H433.024L322.176 960H248.32l110.848-192zM832 192H192v512h640V192zM342.656 534.656a32 32 0 1 1-45.312-45.312L444.992 341.76l125.44 94.08L679.04 300.032a32 32 0 1 1 49.92 39.936L581.632 524.224 451.008 426.24 342.656 534.592z"})],-1),Us=p("svg",{viewBox:"0 0 1024 1024",xmlns:"http://www.w3.org/2000/svg","data-v-ea893728":""},[p("path",{fill:"currentColor",d:"M704 768V256H128v512h576zm64-416 192-96v512l-192-96v128a32 32 0 0 1-32 32H96a32 32 0 0 1-32-32V224a32 32 0 0 1 32-32h640a32 32 0 0 1 32 32v128zm0 71.552v176.896l128 64V359.552l-128 64zM192 320h192v64H192v-64z"})],-1),zs=p("svg",{viewBox:"0 0 1024 1024",xmlns:"http://www.w3.org/2000/svg","data-v-ea893728":""},[p("path",{fill:"currentColor",d:"M512 128a384 384 0 1 0 0 768 384 384 0 0 0 0-768zm0-64a448 448 0 1 1 0 896 448 448 0 0 1 0-896z"}),p("path",{fill:"currentColor",d:"M640 288q64 0 64 64t-64 64q-64 0-64-64t64-64zM214.656 790.656l-45.312-45.312 185.664-185.6a96 96 0 0 1 123.712-10.24l138.24 98.688a32 32 0 0 0 39.872-2.176L906.688 422.4l42.624 47.744L699.52 693.696a96 96 0 0 1-119.808 6.592l-138.24-98.752a32 32 0 0 0-41.152 3.456l-185.664 185.6z"})],-1),Bs=re({__name:"widget3d",setup(s){const e=q(),t=me("buildvisual"),i=me("videovisual"),n=me("areavisual"),a=m(!1),u=m(!0),r=()=>{a.value=!1},d=()=>{t.value=!t.value},V=()=>{i.value=!i.value},M=()=>{n.value=!n.value};ke(()=>{e.setisDisabled(u)});const _=document.createElement("style");return _.setAttribute("lang","scss"),_.innerHTML=Os,document.head.appendChild(_),(C,b)=>(F(),le(Pt,null,[v(g(B),{class:"widget3d-drawbutton",onClick:b[0]||(b[0]=E=>a.value=!0)},{default:x(()=>[v(g(J),{size:20},{default:x(()=>[Ps]),_:1})]),_:1}),v(g(Lt),{class:"widget3d-drawer",modelValue:a.value,"onUpdate:modelValue":b[1]||(b[1]=E=>a.value=E),title:"I am the title","with-header":!1,modal:!1,direction:"ltr",size:"3.3%","z-index":2},{default:x(()=>[v(g(B),{onClick:r,class:"widget3d-closebutton"},{default:x(()=>[v(g(J),{size:20},{default:x(()=>[Ls]),_:1})]),_:1}),Is,v(g(B),{class:"widget3d-visualization",onClick:d},{default:x(()=>[v(g(J),{size:25},{default:x(()=>[Rs]),_:1})]),_:1}),v(g(B),{class:"widget3d-monitor",onClick:V,disabled:u.value},{default:x(()=>[v(g(J),{size:25},{default:x(()=>[Us]),_:1})]),_:1},8,["disabled"]),v(g(B),{class:"widget3d-area",onClick:M,disabled:u.value},{default:x(()=>[v(g(J),{size:25},{default:x(()=>[zs]),_:1})]),_:1},8,["disabled"])]),_:1},8,["modelValue"])],64))}}),Hs=re({__name:"index",setup(s){const e=m(null);gt(e);const t=m(null),i=m(!1),n=m(!1),a=m(!1);return ke(()=>{setTimeout(()=>{let u=$e();u.CreateSceneView();let r=u.getView();r.map=new yt({basemap:"satellite",ground:"world-elevation"});let d=new vt({symbolLayers:[{type:"water",waveDirection:260,color:"#25427c",waveStrength:"moderate",waterbodySize:"medium"}]}),V=new _t({symbol:d}),M=new Be({id:"building",url:"https://tiles.arcgis.com/tiles/U26uBjSD32d7xvm2/arcgis/rest/services/%E9%BB%84%E6%B2%B3%E6%BC%82%E6%B5%81%E5%B9%BF%E5%9C%BA_%E5%86%9C%E5%AE%B6%E9%99%A2/SceneServer"}),_=new Be({id:"model",url:"https://tiles.arcgis.com/tiles/U26uBjSD32d7xvm2/arcgis/rest/services/%E7%99%BD%E6%A8%A1/SceneServer"}),C=new wt({url:"https://services7.arcgis.com/R5nxHh77a68zEsEp/arcgis/rest/services/%E9%BB%84%E6%B2%B3/FeatureServer/2",renderer:V,elevationInfo:{mode:"on-the-ground",offset:100}}),b=new ft({title:"{name}",content:[{type:"fields",fieldInfos:[{fieldName:"area",label:"面积",format:{places:2,digitSeparator:!0}},{fieldName:"destory",label:"损坏程度"},{fieldName:"year",label:"建造年限"}]}]});r.when(async()=>{_.popupTemplate=b,r.map.add(M),r.map.add(C),r.map.add(_),await C.when(()=>{r.goTo(M.fullExtent),r.environment.lighting.directShadowsEnabled=!0}),new bt({view:r,container:t.value,iconClass:"screen3d-icon-pan2"})})},100)}),qe(()=>{$e().isViewType()}),ye("buildvisual",i),ye("videovisual",n),ye("areavisual",a),(u,r)=>(F(),le("div",{ref_key:"screen3dRef",ref:e,class:"screen3d"},[p("div",{class:"screen3d-navigation",ref_key:"navigationRef",ref:t},null,512),v(Bs),i.value?(F(),ne(vs,{key:0})):ge("",!0),n.value?(F(),ne(bs,{key:1})):ge("",!0),a.value?(F(),ne(As,{key:2})):ge("",!0)],512))}});const Ri=Te(Hs,[["__scopeId","data-v-8f38774a"]]);export{Ri as default};
